(self.webpackChunkcharts=self.webpackChunkcharts||[]).push([[179],{1022:(t,e,i)=>{"use strict";i.r(e),i.d(e,{ChartLayout:()=>as,ChartLayoutHeader:()=>bs,ChartLayoutWithGlobalState:()=>rs,FREE_DATE_RANGES:()=>P.mj,Quote:()=>bt.Z,Settings:()=>Ki,Sidebar:()=>yi,StockDetailTimeframeBar:()=>xs,Utils:()=>K.ZP,chartSettingsAsyncModule:()=>X.i,convertTa:()=>s,getFullChartWidth:()=>n.IA,getIntradayChartConfig:()=>n.fS,getTimeframeGroupsWithHref:()=>St.U3,useAsyncModule:()=>a.w,useModelState:()=>lt.l,withSuspense:()=>a.y});var s={};i.r(s),i.d(s,{getPanes:()=>Ms,mergeChartAndTAConfig:()=>Ss});var n=i(9007),a=i(5822),r=(i(8322),i(560)),o=i.n(r),l=i(7218),h=(i(7012),i(6987)),c=i.n(h);function d(t){let{label:e="Background",value:i,onChange:s}=t;return r.createElement(l.InputColorPicker,{label:e,inputDataTestId:"chart-modal-".concat(e.toLocaleLowerCase(),"-fill-color"),color:(0,l.convertColorToHEX)(i),onChange:s})}function u(){return u=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(t[s]=i[s])}return t},u.apply(this,arguments)}function m(t){let{label:e,colorValue:i,colorTestId:s,rangeValue:n,rangeTestId:a,rangeLabel:h,rangeProps:c,onChange:d}=t;const m=(0,r.useCallback)((t=>{const e=t.currentTarget.value;d(i,e)}),[d,i]),g=(0,r.useCallback)((t=>{d(t,n)}),[d,n]);return o().createElement("div",{className:"flex items-end"},o().createElement("div",{className:"flex flex-1 items-center"},o().createElement(l.InputColorPicker,{label:e,color:i,inputDataTestId:s,onChange:g})),o().createElement("div",{className:"ml-2 flex flex-1 items-center"},o().createElement(l.RangeSlider,u({},c,{label:h,rightContent:o().createElement(l.Paragraph,{as:"div",size:"small",className:"text-right tabular-nums text-gray-900 dark:text-white"},n),onChange:m,value:n,"data-testid":a}))))}function g(t){let{label:e="Border",value:i,onChange:s,min:n,max:a}=t;return r.createElement(m,{label:e,colorValue:(0,l.convertColorToHEX)(i.color),colorTestId:"chart-modal-border-color",rangeValue:i.width,rangeProps:{min:null!=n?n:1,max:null!=a?a:5,step:1},rangeLabel:"Width",rangeTestId:"chart-modal-border-range",onChange:(t,e)=>s({color:t,width:e})})}function f(t){let{label:e,value:i,onChange:s}=t;return o().createElement(l.Checkbox,{checked:i,onChange:t=>s(t.currentTarget.checked),"data-testid":"chart-modal-checkbox"},e)}const p=[{value:"Arial",label:"Arial"},{value:"Verdana",label:"Verdana"}];function y(t){var e;let{value:i,onChange:s}=t;const[n,a]=(0,r.useState)(i.family),[h,c]=(0,r.useState)(i.size),[d,u]=(0,r.useState)(i.style),[m,g]=(0,r.useState)(i.weight),f=(0,r.useCallback)(((t,e,i)=>{e(i),s({family:n,size:h,style:d,weight:m,[t]:i})}),[n,h,d,m,s]);return o().createElement("div",null,o().createElement("div",{className:"flex items-end space-x-2"},o().createElement("div",null,o().createElement(l.Select,{label:"Font","aria-label":"Font",className:"w-28",items:p,value:null===(e=p.find((t=>t.value===i.family)))||void 0===e?void 0:e.value,onChange:t=>f("family",a,t.value),"data-testid":"chart-modal-font-select"},p.map((t=>o().createElement(l.SelectOption,{key:t.value},t.label))))),o().createElement(l.Input,{label:"Size",type:"number",min:"5",max:"72",onChange:t=>f("size",c,t.currentTarget.value),value:h,"data-testid":"chart-modal-font-size"}),o().createElement(l.Checkbox,{checked:"bold"===m,onChange:t=>f("weight",g,t.currentTarget.checked?"bold":"normal"),"data-testid":"chart-modal-font-weight"},"Bold"),o().createElement(l.Checkbox,{checked:"italic"===d,onChange:t=>f("style",u,t.currentTarget.checked?"italic":"normal"),"data-testid":"chart-modal-font-style"},"Italic")))}function v(t){let{label:e="Line",value:i,onChange:s}=t;return r.createElement(m,{label:e,colorValue:(0,l.convertColorToHEX)(i.color),colorTestId:"chart-modal-line-color",rangeValue:i.width,rangeProps:{min:1,max:5,step:1},rangeLabel:"Width",rangeTestId:"chart-modal-line-range",onChange:(t,e)=>s({color:t,width:e})})}function b(t){let{label:e,value:i,required:s,onChange:n}=t;return o().createElement(l.Textarea,{label:e,required:s,placeholder:"Insert text here",onChange:t=>n(t.target.value),value:i,autoFocus:!0,"data-testid":"chart-modal-multiline-string-textarea"})}function x(t){const{label:e,name:i,value:s,required:n,min:a,max:r,step:h,allowDecimal:c=!1}=t;return o().createElement(l.Input,{type:"number",label:e,name:i,required:n,pattern:c?"([0-9]*[.])?[0-9]+":"[0-9]*",value:s,min:a||1,max:r,step:h,onChange:e=>t.onChange(c?parseFloat(e.target.value):parseInt(e.target.value,10)),"data-testid":"chart-modal-number-input"})}function C(t){const{label:e,name:i,value:s,required:n}=t;return o().createElement(l.Input,{type:"text",label:e,name:i,required:n,value:s,onChange:e=>t.onChange(e.target.value),"data-testid":"chart-modal-string-textinput"})}function w(t){let{value:e,onChange:i}=t;return o().createElement("div",{className:"flex items-end space-x-2"},o().createElement(l.Checkbox,{checked:e.active,onChange:t=>i({...e,active:t.currentTarget.checked}),"data-testid":"chart-modal-trend-active"}),o().createElement(l.Input,{type:"number",step:"0.1",onChange:t=>i({...e,trend:t.currentTarget.valueAsNumber}),value:e.trend,"data-testid":"chart-modal-trend-value"}),o().createElement(l.InputColorPicker,{color:(0,l.convertColorToHEX)(e.color),onChange:t=>i({...e,color:t}),inputDataTestId:"chart-modal-trend-color"}))}i(6539);var S=i(1045),M=i.n(S),P=i(3888),k=i(5200);function E(t){let{value:e,onChange:i,isCheckboxOnly:s}=t;const[n,a]=o().useState(e.isOff),[r,h]=o().useState(e.from),[c,d]=o().useState(e.to),{macroKey:u}=e,m=u.charAt(0).toUpperCase()+u.slice(1),g=o().useCallback(((t,e,s)=>{e(s),i({macroKey:u,isOff:n,from:r,to:c,[t]:s})}),[u,n,r,c,i]);return o().createElement("div",{key:u,className:"flex items-center "},o().createElement("div",{className:"flex items-center space-x-2"},o().createElement(l.Checkbox,{className:"cursor-pointer",checked:!n,"data-testid":"visibility-checkbox-".concat(u),onChange:t=>g("isOff",a,!t.target.checked)},s&&m),!s&&o().createElement(o().Fragment,null,o().createElement(l.Input,{disabled:n,className:"w-16",type:"number",name:"".concat(u,"-from"),value:r,min:T[u].from,max:Math.min(T[u].to,c),onChange:t=>g("from",h,Number(t.currentTarget.value)),"data-testid":"visibility-input-".concat(u,"-from")}),o().createElement("span",null,"-"),o().createElement(l.Input,{disabled:n,className:"w-16",type:"number",name:"".concat(u,"-to"),value:c,min:Math.max(T[u].from,r),max:T[u].to,onChange:t=>g("to",d,Number(t.currentTarget.value)),"data-testid":"visibility-input-".concat(u,"-to")}),o().createElement(l.Paragraph,null,m))))}const T={[P.iR.minutes]:{isOff:!1,from:1,to:59},[P.iR.hours]:{isOff:!1,from:1,to:24},[P.iR.days]:{isOff:!1,from:1,to:366},[P.iR.weeks]:{isOff:!1,from:1,to:52},[P.iR.months]:{isOff:!1,from:1,to:12}},I=[P.iR.minutes,P.iR.hours],A=t=>{const e=M()({},T);for(const i in e){const s=i,n=null==t?void 0:t[s];n&&(0===Object.keys(n).length?e[s]={...e[s],isOff:!0}:e[s]={...e[s],...n})}return e},L=t=>Object.keys(P.iR).every((e=>{const i=t[e];return i&&(0===Object.keys(i).length||!P.Pw[e].some((t=>{var s,n;return(0,k.mh)({value:t,min:null!==(s=null==i?void 0:i.from)&&void 0!==s?s:T[e].from,max:null!==(n=null==i?void 0:i.to)&&void 0!==n?n:T[e].to})})))}));function D(t){const e=o().useRef(A(t.value)),i=e=>{const i=t.value?M()({},t.value):{};i[e.macroKey]={},e.isOff?t.onChange(i):e.from===T[e.macroKey].from&&e.to===T[e.macroKey].to?(delete i[e.macroKey],t.onChange(i)):(e.from!==T[e.macroKey].from&&(i[e.macroKey].from=e.from),e.to!==T[e.macroKey].to&&(i[e.macroKey].to=e.to),t.onChange(i)),t.handleDisableSubmit(!!L(i)&&"The chosen timeframes would make the drawing invisible on all supported timeframes.")};return Object.keys(e.current).map((t=>o().createElement(E,{key:"visibility-".concat(t),value:{...e.current[t],macroKey:t},isCheckboxOnly:!I.includes(t),onChange:i})))}function O(){return O=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(t[s]=i[s])}return t},O.apply(this,arguments)}const R={type:"button",className:"flex-1",contentClass:"text-center"};function F(t){return t.reduce(((t,e)=>(t[e.name]=e.value,t)),{})}var B;function N(t){var e;const i=t.element.getModalConfig(),s=r.useRef(JSON.parse(JSON.stringify(i.inputs))),[n,a]=r.useState(i.inputs),o=r.useRef(null!==(h=document.querySelector(".chart.active"))&&void 0!==h?h:document.body);var h;const[u,m]=r.useState(B.Style),[p,S]=r.useState(!1),M=t.element.getIsDrawing();r.useEffect((()=>(t.element.isEditInProgress=!0,()=>{t.element.isEditInProgress=!1,t.element.trigger("change",t.element)})),[]);const P=r.useCallback((e=>{let{values:i,shouldSubmit:s=!1,shouldDismiss:n=!1}=e;const a="function"==typeof t.onSubmit,r="function"==typeof t.onDismiss;t.element.set(i),s&&a?t.onSubmit(i):n&&r&&t.onDismiss(),(s||n)&&t.state.hide()}),[t]),k=r.useRef(c()((t=>{const e=F(t);P({values:e})}),50,{maxWait:100}));r.useEffect((()=>()=>{k.current.cancel()}),[]);const E=r.useCallback((t=>{if(t.preventDefault(),t.currentTarget.checkValidity()){const t=F(n);P({values:t,shouldSubmit:!0})}}),[n,P]),T=r.useCallback((()=>{const t=F(s.current);P({values:t,shouldDismiss:!0})}),[P]);return r.createElement(l.Dialog,{isDraggable:!0,className:"w-96","data-testid":"charts-dialog",state:t.state,finalFocusRef:o,"aria-label":null!==(e=i.title)&&void 0!==e?e:"Edit style",onOverlayClick:T,hide:T,onHide:t.onHide},r.createElement(l.DialogHeader,{onCloseClick:T},i.title),r.createElement("form",{onSubmit:E,className:"flex flex-col overflow-hidden"},r.createElement(l.DialogBody,{className:"space-y-4"},M&&r.createElement(l.ButtonGroup,{hasDivider:!1,className:"w-full"},r.createElement(l.Button,O({},R,{active:u===B.Style,onClick:()=>m(B.Style),"data-testid":"dialog-tab-button-style"}),"Style"),r.createElement(l.Button,O({},R,{active:u===B.Visibility,onClick:()=>m(B.Visibility),"data-testid":"dialog-tab-button-visibility"}),"Visibility")),n.map((t=>{const e=function(t){switch(t){case"number":return x;case"string":case"text":return C;case"background":return d;case"border":return g;case"line":return v;case"multiline_string":return b;case"font":return y;case"checkbox":return f;case"trend":return w;case"visibility":return D;default:return()=>r.createElement("div",null,"ERROR: Unknown input type")}}(t.type);return i=t.type,(u===B.Visibility&&"visibility"===i||u!==B.Visibility&&"visibility"!==i)&&r.createElement(e,O({key:t.name},t,{onChange:e=>{a((i=>{const s=i.map((i=>i.name===t.name?{...i,value:e}:i));return k.current(s),s}))},handleDisableSubmit:S}));var i}))),r.createElement(l.DialogFooter,null,r.createElement(l.Button,{type:"button",onClick:T,"data-testid":"dialog-button-cancel",disabled:t.state.animating},"Close"),r.createElement(l.Button,{theme:"blue",type:"submit","data-testid":"dialog-button-confirm",disabled:t.state.animating||!!p,title:p||"Submit"},"Save"))))}!function(t){t[t.Style=0]="Style",t[t.Visibility=1]="Visibility"}(B||(B={}));const Z=r.createContext((()=>{}));function z(t){const[e,i]=r.useState(null),[s,n]=r.useState(null),[a,o]=r.useState(null),h=(0,l.useDialogState)({modal:!1});return r.createElement(Z.Provider,{value:(t,e,s)=>{e&&n((()=>e)),s&&o((()=>s)),i(t),h.show()}},t.children,e&&r.createElement(N,{state:h,element:e,onSubmit:s,onDismiss:a,onHide:()=>{i(null),n(null),o(null)}}))}var X=i(8434),H=(i(4533),i(9841),i(5422),i(6838)),W=i.n(H),U=i(7651),Y=i.n(U),q=i(8821),V=i.n(q),j=i(2127),_=i(221),Q=i(6269),K=i(9431),G=i(5495),J=i(6372),$=i(3926);function tt(t){var e,i;const s=t.mainElement(),n=null!==(e=null==s||null===(i=s.instance)||void 0===i?void 0:i.type)&&void 0!==e?e:null;return null!=s&&s.isIndicator()&&n!==P.A.None?n:null!=s&&s.isChart()?"chart":null}function et(t){const e=[],i=["note"];return t.getAllPanes().forEach((t=>{const s=t.getQuoteRawTicker(),n=tt(t);s&&!e.includes(s)&&e.push(s),n&&!i.includes(n)&&i.push(n)})),{tickers:e,containerTypes:i}}function it(){var t,e,i,s,n;const a=null===(t=null!==(e=null===(i=window.FinvizSettings)||void 0===i?void 0:i.initialDrawingsStore)&&void 0!==e?e:null===(s=window.FinvizChartsSettings)||void 0===s?void 0:s.initialDrawingsStore)||void 0===t?void 0:t.drawings;return null!==(n=null==a?void 0:a.map((t=>ot(t))))&&void 0!==n?n:null}function st(t){let{chartLayoutModel:e,elementMethod:i}=t;e.getAllElements().forEach((t=>{t.isDrawing()&&t[i]()}))}function nt(t){return"note-".concat(t)}function at(t){var e,i;return null!==(e=t?null===(i=JSON.parse(t.elementAttrs))||void 0===i?void 0:i.text:"")&&void 0!==e?e:""}function rt(t){let{ticker:e,elements:i}=t;return at(i.find((t=>{let{elementId:i}=t;return i===nt(e)})))}function ot(t){return{elementId:t.elementId,ticker:t.ticker,zIndex:t.zIndex,changeType:t.changeType,containerType:t.containerType,elementAttrs:t.elementAttrs,lastChange:{ts:t.lastChangeTimestamp,count:t.lastChangeCounter,uuid:t.lastChangeNodeUUID}}}var lt=i(4613),ht=i(3168);const ct=250;var dt=i(5169);const ut=5;function mt(){const t=o().useRef(0),e=o().useRef(0),i=o().useCallback((async t=>{let{tickers:e,containerTypes:i,lastChange:s}=t;try{return(await(0,J.ZP)({location:"/api/auto_save.ashx",queryParameters:{ticker:e.join(","),containerTypes:i.join(",")||void 0,lastChangeTimestamp:s.ts,lastChangeCounter:s.count,lastChangeNodeUUID:s.uuid},throwOnStatusCodes:[403,404]})).drawings.map((t=>ot(t)))}catch{}return[]}),[]),s=o().useCallback((async e=>{if(0!==e.length)try{const s=JSON.stringify(e.map((t=>function(t){return{elementId:t.elementId,ticker:t.ticker,zIndex:t.zIndex,changeType:t.changeType,containerType:t.containerType,elementAttrs:JSON.stringify(t.elementAttrs),lastChangeTimestamp:t.lastChange.ts,lastChangeCounter:t.lastChange.count,lastChangeNodeUUID:t.lastChange.uuid}}(t))));let n=!1;try{n=function(t){let e=0;for(let i=0,s=t.length;i<s;i++){const n=t.charCodeAt(i);if(n<128)e+=1;else if(n<2048)e+=2;else if(n<55296)e+=3;else if(n<56320){const n=t.charCodeAt(++i);if(!(i<s&&n>=56320&&n<=57343))throw new Error("UCS-2 String malformed");e+=4}else{if(n<57344)throw new Error("UCS-2 String malformed");e+=3}}return e}(s)<64e3}catch(t){var i;null===(i=window.Sentry)||void 0===i||i.captureException(t)}await(0,J.ZP)({location:"/api/auto_save.ashx",method:"POST",throwOnStatusCodes:[400,403,404,500],contentType:J.zc.ApplicationJson,body:s,keepalive:n});const[a]=[...e].sort(((t,e)=>(0,$.Fp)(e.lastChange,t.lastChange)));return t.current=0,a.lastChange}catch(i){var n;if(i instanceof J.Hl){if(t.current<ut)return t.current=t.current+1,await new Promise((t=>setTimeout(t,1e3))),s(e);t.current=0}else if(i instanceof J.lY)return;return void(null===(n=window.Sentry)||void 0===n||n.captureException(i,{extra:(i instanceof J.ZS?i.response.invalidItems:e).reduce(((t,e,i)=>({...t,["item-".concat(i)]:JSON.stringify(e)})),{})}))}}),[]),n=o().useCallback((async t=>{let{tickers:i,lastLocalChange:s}=t;try{const t={...(0,$.cS)(s,Date.now()),uuid:(0,k.pB)()};await(0,J.ZP)({location:"/api/auto_save.ashx?ticker=".concat(i.join(","),"&lastChangeTimestamp=").concat(t.ts,"&lastChangeCounter=").concat(t.count,"&lastChangeNodeUUID=").concat(t.uuid),method:"DELETE",throwOnStatusCodes:[403,404,500],keepalive:!0}),e.current=0}catch(t){var a;if(t instanceof J.Hl){if(e.current<ut)return e.current=e.current+1,await new Promise((t=>setTimeout(t,1e3))),n({tickers:i,lastLocalChange:s});e.current=0}else if(t instanceof J.lY)return;null===(a=window.Sentry)||void 0===a||a.captureException(t)}}),[]);return{fetchDrawings:i,saveDrawings:s,deleteAllDrawings:n}}function gt(t){const{fetchDrawings:e,saveDrawings:i,deleteAllDrawings:s}=mt(),n=function(t){const e=(0,lt.l)(t,{watchProperties:["isInit","isPreserveDrawingsActive","idea"]}),{specificChartFunctionality:i,idea:s,isInit:n,isPreserveDrawingsActive:a}=e;return o().useMemo((()=>{if(!window.FinvizSettings.hasUserPremium)return!1;let t=!1;return i===P.oK.chartPage?t=!0:i===P.oK.quotePage&&(t=(0,G.Ie)()),t&&a&&!!n&&!(null!=s&&s.id)}),[i,a,n,null==s?void 0:s.id])}(t),a=o().useMemo((()=>t.drawingsInternalStore()),[t]),r=o().useRef();o().useEffect((()=>()=>{r.current&&clearTimeout(r.current)}),[]);const l=o().useCallback((function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ct,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;r.current&&clearTimeout(r.current);const s=a.elements.filter((t=>(0,$.Fp)(t.lastChange,a.latestLocalUpdateTimestamp)>0&&t.lastChange.uuid===a.instanceUUID&&(null===e||e(t))));if(0===s.length)return;a.setAutoSaveState(_.FZ.Unsaved);const n=async()=>{a.setAutoSaveState(_.FZ.Saving);const t=await i(s);return t&&a.updateAttributes({latestLocalUpdateTimestamp:(0,$.nW)(a.latestLocalUpdateTimestamp,t)}),a.setAutoSaveState(_.FZ.Saved),t};if(0===t)return n();r.current=setTimeout(n,t)}),[i,a]),h=o().useCallback((e=>{if("note"===e.containerType)return;const i="destroy"===e.changeType;t.getAllPanes().forEach((t=>{const s=t.getQuoteRawTicker(),n=tt(t);if(!n||e.ticker!==s)return;const r=a.elements.filter((t=>t.ticker===s&&t.containerType===n));let o;t.getAllElements().forEach((t=>{if(t.isDrawing()&&!t.instance.isCreator){const i=r.find((e=>{let{elementId:i}=e;return i===t.elementId}));i&&"destroy"!==i.changeType?t.elementId&&t.elementId===e.elementId&&(o=t):t.destroyCascade()}}));const l=JSON.parse(e.elementAttrs);if(o)e.elementAttrs!==JSON.stringify(o.instance.toAutosaveConfig())&&(o.pane().selection===o.instance||o.hasOngoingInteraction()||(o.instance.set(l),o.instance.updateScales())),e.zIndex!==o.zIndex&&o.updateAttributes({zIndex:e.zIndex}),(i||n!==e.containerType)&&o.destroyCascade();else if(!i&&n===e.containerType){const i=(0,dt.u)(l.type).fromObject(l,t);t.elements().create({elementId:e.elementId,instance:i,zIndex:e.zIndex}),i.updateScales()}}))}),[t,a]),c=o().useCallback(((t,e)=>{if(e){const i={elementId:nt(e),zIndex:0,ticker:e,lastChange:(0,$.cS)(a.latestLocalUpdateTimestamp,Date.now()),changeType:"update",containerType:"note",elementAttrs:JSON.stringify({text:t})};a.updateAttributes({elements:[...a.elements.filter((t=>{let{elementId:e}=t;return e!==i.elementId})),i]})}}),[a]),d=o().useCallback((e=>{var i,s,n;(null===(i=t.idea)||void 0===i?void 0:i.note)!==e&&(t.idea||e)&&(t.updateAttribute("idea",{...t.idea,note:e}),c(e,null!==(s=null===(n=t.activeChart)||void 0===n?void 0:n.getQuoteRawTicker())&&void 0!==s?s:void 0))}),[t,c]),u=o().useCallback((async function(){let i=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const{tickers:s,containerTypes:n}=et(t);i&&a.updateAttributes({latestRemoteUpdateTimestamp:(0,$.hY)(a.instanceUUID,0)});const r=await e({tickers:s,containerTypes:n,lastChange:a.latestRemoteUpdateTimestamp}),{newLastUpdateTimestamp:o,updatedElementIds:c,newInternalStore:u}=function(t){let{updatedDrawings:e,currentInternalStore:i,lastUpdateTimestamp:s,isRefetchAll:n}=t,a=s;const r=[...i],o=[];return e.forEach((t=>{a=(0,$.nW)(a,t.lastChange);const e=r.findIndex((e=>{let{elementId:i}=e;return t.elementId===i})),i=e>-1?r[e]:null;if(null===i)r.push(t),o.push(t.elementId);else if("note"===i.containerType&&n){const s=at(i),n=at(t);s!==n&&(r[e]={...t,lastChange:(0,$.cS)((0,$.nW)(i.lastChange,t.lastChange),Date.now()),elementAttrs:JSON.stringify({...JSON.parse(t.elementAttrs),text:"".concat(s,"\r\n").concat(n)})}),o.push(t.elementId)}else(0,$.Fp)(r[e].lastChange,t.lastChange)<0&&(r[e]=t,o.push(t.elementId))})),{newLastUpdateTimestamp:a,newInternalStore:r,updatedElementIds:o}}({updatedDrawings:r,currentInternalStore:a.elements,lastUpdateTimestamp:a.latestRemoteUpdateTimestamp,isRefetchAll:i});if(a.updateAttributes({...c.length>0?{elements:u}:{},latestRemoteUpdateTimestamp:o,latestLocalUpdateTimestamp:i&&u.length>0?(0,$.nW)(a.latestLocalUpdateTimestamp,o):a.latestLocalUpdateTimestamp}),c.length>0||i){l(0);const e=t.getAllElements();if(c.forEach((t=>{const i=e.find((e=>e.elementId===t));i&&i.isDrawing()&&!i.hasOngoingInteraction()&&i.destroyCascade()})),a.elements.forEach(h),t.getAllPanes().forEach((t=>{t.normalizeZIndexes()})),t.specificChartFunctionality===P.oK.quotePage){var m,g;const e=null!==(m=null===(g=t.activeChart)||void 0===g?void 0:g.getQuoteRawTicker())&&void 0!==m?m:"";d(rt({ticker:e,elements:u}))}}}),[t,a,h,e,d,l]),m=o().useCallback(((t,e)=>{const i=function(t){let{element:e,changeType:i,currentInternalStore:s,lastUpdateTimestamp:n}=t;const a=e.pane(),r=a.getQuoteRawTicker(),o=tt(a);if(r&&a&&o&&(!e.destroyed||"destroy"===i)){const t=e.instance.toAutosaveConfig(),a={elementId:e.elementId,zIndex:e.zIndex,ticker:r,lastChange:n,changeType:i,containerType:o,elementAttrs:JSON.stringify(t)},l=[...s],h=l.findIndex((t=>t.elementId===a.elementId));let c=!1;if(h>-1){const t=l[h],i=t.zIndex!==a.zIndex,s=t.changeType!==a.changeType,n=t.elementAttrs!==a.elementAttrs,o=s||n||i;!e.instance.isEditInProgress&&t.ticker===r&&o&&"destroy"!==t.changeType&&(l[h]=a,c=!0)}else l.push(a),c=!0;return{newInternalStore:l,shouldSyncAndSave:c,newDrawing:a}}}({element:t,changeType:e,currentInternalStore:a.elements,lastUpdateTimestamp:(0,$.cS)((0,$.nW)(a.latestLocalUpdateTimestamp,a.latestRemoteUpdateTimestamp),Date.now())});if(i){const{shouldSyncAndSave:t,newInternalStore:e,newDrawing:s}=i;t&&(a.updateAttributes({elements:e}),h(s))}}),[h,a]),g=o().useCallback((async()=>{const{tickers:e}=et(t);await s({tickers:e,lastLocalChange:a.latestLocalUpdateTimestamp}),await u()}),[t,s,a,u]),f=o().useCallback(((e,i,s)=>{const n=e.pane();if(!e.isDrawing()||e.instance.isCreator||!n)return;const a=tt(n),r=n.getQuoteRawTicker();if(t.getAllPanes().some((t=>tt(t)===a&&t.getQuoteRawTicker()===r))){const t=(null==s?void 0:s.eventType)===j.H3.Remove;m(e,t?"destroy":"update")}}),[m,t]);return{drawingsInternalStore:a,onElementChange:f,handleIdeaNoteChange:d,deleteAllAutoSavedElements:g,isAutoSaveActive:n,handleAutoSaveNoteChange:c,syncChartLayoutDrawings:h,saveLatestChanges:l,checkDrawingUpdate:u}}function ft(){return ft=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(t[s]=i[s])}return t},ft.apply(this,arguments)}function pt(t){const{onElementChange:e,deleteAllAutoSavedElements:i,checkDrawingUpdate:s,syncChartLayoutDrawings:n,saveLatestChanges:a,isAutoSaveActive:r}=gt(t),l=o().useMemo((()=>t.drawingsInternalStore()),[t]),h=(0,lt.l)(l,{watchProperties:["elements"]}),c=function(t){const e=o().useRef();return o().useEffect((()=>{e.current=t}),[t]),e.current}(r),d=o().useCallback((async()=>{t.getAllElements().forEach((t=>{h.elements.some((e=>e.elementId===t.elementId))||e(t)})),await a(0,(t=>"note"!==t.containerType)),s(!0)}),[s,t,e,h.elements,a]);return o().useEffect((()=>{r&&a()}),[a,h.elements,r]),o().useEffect((()=>{if(!r)return void t.drawingsInternalStore().setAutoSaveState(_.FZ.Off);t.drawingsInternalStore().setAutoSaveState(_.FZ.Saved),!c&&r&&d();let{tickers:i,containerTypes:a}=et(t);const o=()=>{const{tickers:e,containerTypes:n}=et(t);JSON.stringify(i)===JSON.stringify(e)&&JSON.stringify(a)===JSON.stringify(n)||(i=e,a=n,s(!0))};ht.Z.bind("".concat(j.wq.IndicatorsChange," change"),o),Q.Z.bind("change",e),h.elements.forEach(n);const l=setInterval(s,15e3);return()=>{clearInterval(l),ht.Z.unbind("".concat(j.wq.IndicatorsChange," change"),o),Q.Z.unbind("change",e)}}),[t,h,s,e,n,r,c,d]),{deleteAllAutoSavedElements:i,isAutoSaveActive:r}}var yt=i(8723),vt=i(2120),bt=i(7256),xt=i(1541),Ct=i(5251),wt=i(5055),St=i(155);const Mt=!0;function Pt(t){var e;let{isPremium:i,model:s}=t;const{chartTypes:n,getCurrentType:a}=function(t){let{isPremium:e,model:i}=t;const s=(0,Ct.useLocation)(),{b:n,t:a,ta:o,ty:l,p:h="d",r:c}=(0,wt.N)(s.search),d=o?Number.parseInt(o):1,u=i.specificChartFunctionality===P.oK.quotePage,m=r.useCallback((()=>{var t;const i=null!==(t=l&&St.E5[l])&&void 0!==t?t:window.FinvizQuoteTypeCurrent;return e||i!==St.fN.candlestick||0!==d?i:St.fN.candlesticksimple}),[e,d,l]),g=r.useCallback((t=>e||St.$X.includes(t)?"".concat(s.pathname,"?").concat((0,wt.t)({b:n,t:a,r:c,ty:t===St.fN.candlesticksimple?St.hX.candlestick:St.hX[t],ta:t===St.fN.candlestick?"1":"0",p:h})):"/elite.ashx?".concat((0,wt.t)({utm_source:"finviz",utm_medium:"banner",utm_campaign:"quote-chart-type-select"}))),[e,s.pathname,n,a,c,h]);return{getCurrentType:m,chartTypes:r.useMemo((()=>(e||!u?St.Z9:St.Qf).map((t=>({...t,href:g(t.value),reloadDocument:!e})))),[g,e,u])}}({isPremium:i,model:s}),o=a();return r.createElement(l.Select,{"data-testid":"chart-type-select","aria-label":"Chart type",value:o,items:n,className:"w-[7.25rem]",contentClass:"truncate",size:"medium",theme:"chip",leftContent:null===(e=n.find((t=>t.value===o)))||void 0===e?void 0:e.iconName,rightContent:"caretDown",hasPopoverButtonWidthLimit:!1,isNativeMobileSelect:Mt},n.map((t=>r.createElement(l.SelectOption,{as:t.href?Ct.Link:void 0,to:t.href,reloadDocument:t.href?!window.FinvizSettings.hasUserPremium:void 0,"data-testid":"chart-type-select-option-".concat(t.value),key:t.value,leftContent:t.iconName},t.label))))}const kt=["change","update"],Et=[...kt,...Object.values(xt.p)];function Tt(t){let{children:e,changePoints:i,isTiny:s}=t;return r.createElement(l.Paragraph,{size:s?"tiny":"small",className:W()("text-right font-medium leading-none",{"text-green-400":i>0,"text-red-400":i<0})},e)}const It=r.memo((0,a.y)((function(t){var e,i;let{chartIndex:s}=t;const[n]=(0,a.w)({...X.i,isSuspenseMode:!0}),{chartLayoutModel:o}=n.useChartLayoutGlobalModel(),l=(0,lt.l)(null!==(e=null==o?void 0:o.getAllCharts()[s])&&void 0!==e?e:null,{watchProperties:["quote"],listenOnEvents:kt}),h=(0,lt.l)(null!==(i=null==l?void 0:l.quote())&&void 0!==i?i:null,{watchProperties:["lastClose","prevClose","afterClose"],listenOnEvents:Et}),c=h&&(0,G.wN)({data:h}),d=!(null==c||!c.tickerChange)&&yt.ZP.getInstrumentDecimalPlaces({instrument:h.instrument,value:h.lastClose})>=6;return r.createElement("div",{className:"my-auto flex h-8 max-w-40 flex-none flex-col items-stretch justify-around"},(null==c?void 0:c.tickerChange)&&r.createElement(r.Fragment,null,c.tickerAfterChange&&r.createElement(Tt,{changePoints:c.tickerAfterChange.points,isTiny:d},c.tickerAfterChange.string),r.createElement(Tt,{changePoints:c.tickerChange.points,isTiny:d},c.tickerChange.string)))})),((t,e)=>t.chartIndex===e.chartIndex));function At(){return At=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(t[s]=i[s])}return t},At.apply(this,arguments)}const Lt={[P.oK.quotePage]:"quote-draw-button",[P.oK.futuresPage]:"futures-interactive-chart",[P.oK.forexPage]:"forex-interactive-chart",[P.oK.cryptoPage]:"crypto-interactive-chart"},Dt={[P.oK.quotePage]:"quote-toggle-draw-btn",[P.oK.futuresPage]:"futures-interactive",[P.oK.forexPage]:"forex-interactive",[P.oK.cryptoPage]:"crypto-interactive"};function Ot(t){let{active:e,isPremium:i,specificChartFunctionality:s}=t;const n=r.useMemo((()=>i?{onClick:t=>{t.preventDefault();const e=(0,G.Ie)()?"off":"on";fetch("/api/set_cookie.ashx?cookie="+G.G4+"&value="+e).catch((()=>{})).then((t=>{if(null==t||!t.ok){const t=new Date;t.setMonth(t.getMonth()+1),K.ZP.setCookie(G.G4,e,t)}document.location.reload()}))}}:{as:"a",href:"/elite.ashx?".concat((0,wt.t)({utm_source:"finviz",utm_medium:"banner",utm_campaign:Lt[s]}))}),[i,s]);return r.createElement(l.Button,At({theme:"chip",leftContent:"draw",size:"medium",active:e,"data-testid":Dt[s]},n),"Draw")}function Rt(t){switch(t){case 0:case 1:return"1h1v";case 2:return"2h1v";case 3:return"3h1v";case 4:return"2h2v";default:return"3h2v"}}const Ft={[P.oK.quotePage]:"quote-fullscreen-button",[P.oK.futuresPage]:"futures-fullscreen-button",[P.oK.forexPage]:"forex-fullscreen-button",[P.oK.cryptoPage]:"crypto-fullscreen-button"};function Bt(t){let{model:e,isPremium:i,children:s}=t;const n=(0,Ct.useLocation)(),{i:a,p:o="d",r:h}=(0,wt.N)(n.search),c=e.charts().all().map((t=>t.quote().getRawTicker()));return r.createElement(l.Button,{as:"a",size:"medium",leftContent:"fullscreen",theme:"chip",target:i?"_blank":void 0,href:i?"/charts?".concat((0,wt.t)({i:a,t:(d=c,u=c.length,Array.from({length:Math.min(u,6)}).map(((t,e)=>{var i;return null!==(i=d[e])&&void 0!==i?i:d[d.length-1]})).join(",")),p:c.map((()=>o)).join(","),l:Rt(c.length),r:h})):"/elite.ashx?".concat((0,wt.t)({utm_source:"finviz",utm_medium:"banner",utm_campaign:Ft[e.specificChartFunctionality]}))},s);var d,u}function Nt(t){let{ticker:e,instrument:i,onTickerSelected:s,chartIndex:n}=t;const a=(0,l.useDropdownState)({placement:"bottom-end"}),r=o().useMemo((()=>{const t=e.replace("@","");switch(i){case j.Yx.Stock:return"/quote.ashx?t=".concat(t);case j.Yx.Futures:return"/futures_charts.ashx?t=".concat(t);case j.Yx.Forex:return"/forex_charts.ashx?t=".concat(t);case j.Yx.Crypto:return"/crypto_charts.ashx?t=".concat(t)}}),[e,i]);return o().createElement("div",{className:"search flex w-32 flex-none items-center"},o().createElement(l.Search,{chartIndex:n,placeholder:e,size:"medium",inputClass:"pr-7 placeholder:text-gray-900 focus:placeholder:text-gray-500 dark:placeholder:text-white dark:focus:placeholder:text-gray-400",isSearchIcon:!1,isSearchItemLink:!1,isShowAllVisible:!1,onTickerSelected:s,rightContent:o().createElement(l.Dropdown,{state:a,"aria-label":"More options",label:o().createElement(l.Button,{type:"button",size:"none",className:"h-full w-7 text-gray-400 hover:text-gray-500",theme:"transparent",appearance:"square",rightContent:o().createElement(l.Icon,{width:20,name:"more"})})},o().createElement(l.DropdownItem,{as:"a",target:"_blank",href:r},i===j.Yx.Stock?"Open Stock Detail":"Open Detail"),i===j.Yx.Stock&&o().createElement(l.DropdownItem,{as:"a",target:"_blank",href:"/save_to_portfolio.ashx?t=".concat(e)},"Save to Portfolio"),i===j.Yx.Stock&&o().createElement(l.DropdownItem,{as:"a",target:"_blank",href:"/create_alert.ashx?t=".concat(e)},"Create Alert"))}))}function Zt(){return Zt=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(t[s]=i[s])}return t},Zt.apply(this,arguments)}const zt=16,Xt="settings-popover",Ht={[P.oK.quotePage]:"quote-settings-button",[P.oK.futuresPage]:"futures-settings-button",[P.oK.forexPage]:"forex-settings-button",[P.oK.cryptoPage]:"crypto-settings-button"};function Wt(t){let{isPremium:e,model:i,children:s}=t;const n=(0,l.usePopoverState)({placement:"bottom-start"}),{isFullyClosed:r}=(0,l.getExtendedDialogState)(n),[h,{isLoading:c}]=(0,a.w)({...X.i,shouldLoadModule:!r}),d=document.getElementById("chart"),u=document.getElementById(Xt),m=n.unstable_referenceRef.current,g=o().useMemo((()=>{const t={};if(!m||!d)return t;const e=m.getBoundingClientRect(),i=e.top+e.height;if(t.body={maxHeight:window.innerHeight-i-2*zt,position:"sticky",top:-i+zt-window.scrollY},!u)return t;const s=d.clientHeight,n=u.offsetHeight,a=(0,K.yG)();return t.wrapper={height:n<s?s:void 0,...!a&&{transform:"translate(".concat(zt,"px, ").concat(i+zt,"px)")}},t}),[m,d,u]),f=o().useMemo((()=>e?c?{disabled:!i}:{as:l.PopoverTrigger,state:n,active:n.visible}:{as:"a",href:"/elite.ashx?".concat((0,wt.t)({utm_source:"finviz",utm_medium:"banner",utm_campaign:Ht[i.specificChartFunctionality]}))}),[i,e,c,n]);return o().createElement(o().Fragment,null,o().createElement(l.Button,Zt({leftContent:c?o().createElement(l.Delayed,{delayComponent:o().createElement(l.Icon,{name:"settingsWheel"})},o().createElement(l.Spinner,{width:16})):"settingsWheel",theme:"chip",size:"medium","data-testid":"chart-settings-open-btn"},f),s),h&&o().createElement(h.PreventClosingUnsavedChanges,{onHide:n.hide},(t=>{let{checkForUnsavedChangesAndClose:e}=t;return o().createElement(l.Popover,{id:Xt,"aria-label":"Chart Settings",className:"relative z-10 flex max-h-full w-145 max-w-full flex-col",state:n,style:g.body,popoverWrapperStyle:g.wrapper,focusOnHide:!1,hideOnClickOutside:!1,onOverlayClick:e},!r&&o().createElement(h.ChartSettings,{onSubmit:()=>{},onClose:e}))})))}var Ut=i(9197);const Yt=t=>"quoteReq-".concat(t.ticker,"-").concat(t.instrument,"-").concat(t.id);function qt(t){var e,i,s;let{chartModel:a,isInteractive:o}=t;const l=(0,Ct.useLocation)(),h=(0,Ct.useNavigate)(),c=(0,lt.l)(a,{watchProperties:["ticker","timeframe","dateRange"]}),d=(0,lt.l)(null!==(e=null==c?void 0:c.chart_layout())&&void 0!==e?e:null,{watchProperties:["idea"]}),u=function(t){const e=r.useRef(t);return r.useEffect((()=>{e.current=t}),[t]),e}(c),[m,g]=r.useState(!1),f=r.useRef(""),p=!(null==d||null===(i=d.idea)||void 0===i||!i.id),y=r.useCallback((t=>{var e;const i=u.current;if(!i)return;const s=i.chart_layout(),a=i.getQuoteRawTicker()===t.getRawTicker();i.getAllPanes().forEach((t=>{t.getChartOrIndicatorElement()&&t.updateAttribute("scaleRange",null)})),i.updateAttributes({leftOffset:(0,n.rI)({quote:t,chartModel:i}),quote:t,isScrolled:!0}),i.getAllQuotes().filter((e=>!e.eql(t))).forEach((t=>{t.fetchData({fetchType:xt.p.NewerData})}));const r=i.getChartPane(),o=[...i.getAllElements(),...null!==(e=null==r?void 0:r.getAllChartEvents(!1))&&void 0!==e?e:[]];for(const t of o){const e=t.isDrawing();(e||t.isChartEvent())&&(!a||e&&!s.isPreserveDrawingsActive?t.destroyCascade():t.instance.updateScales())}i.setChartEvents(t.chartEvents),null==r||r.updateChartEventsZIndexes()}),[]),v=r.useCallback((async()=>{if(!o||!c||p)return;g(!0);const{ticker:t,instrument:e,timeframe:i}=c,{premarket:s,aftermarket:n}=bt.Z.first(),a=c.getHasPatterns(),r=c.quote();if(r.getRawTicker()!==t||r.timeframe!==i){f.current=Yt(c);const r=(0,Ut.xg)({key:f.current,shouldAbortRunningRequest:!bt.Z.select((e=>e.ticker===t&&e.timeframe===i&&e.isFetching&&c.chart_layout().isIdeaId(e.ideaID)))}),o=await bt.Z.get({ticker:t,instrument:e,timeframe:i,options:{premarket:s,aftermarket:n,patterns:a,cachePredicate:t=>void 0===t.ideaID,fetchNewDataOnCachedQuote:!0},abortController:r});if(o.wasFetchAborted){const t=c.chart_layout().getAllCharts().filter((t=>!c.eql(t))).some((t=>o.eql(t.quote())));return void(-1!==o.fetchedAt||t||o.destroy())}(0,Ut.R$)(f.current),y(o)}g(!1)}),[null==c?void 0:c.id,null==c?void 0:c.ticker,null==c?void 0:c.timeframe,null==c?void 0:c.instrument,p,y,o]);return r.useEffect((()=>{v()}),[v]),r.useEffect((()=>{if(c){const t=(0,wt.N)(l.search),e=c.chart_layout().getAllCharts().map((t=>t.dateRange)),i=e.every((t=>!t))?void 0:e.join(",");t.r!==i&&h({search:"?".concat((0,wt.t)({...t,r:i}))})}}),[null==c?void 0:c.dateRange]),r.useEffect((()=>{const t=u.current,e=null==t?void 0:t.chart_layout(),i=null==t?void 0:t.quote();let s=!1;if((null==e?void 0:e.specificChartFunctionality)===P.oK.chartPage&&!p){const t=null==d?void 0:d.settings,e=3,i=1;if(t){const n=[t.ChartSettings.center.barWidth,t.IndicatorSettings.center.barWidth].every((t=>t===e)),a=[t.ChartSettings.center.barMargin,t.IndicatorSettings.center.barMargin].every((t=>t===i));s=!n||!a,s&&(t.ChartSettings.center.barWidth=e,t.IndicatorSettings.center.barWidth=e,t.ChartSettings.center.barMargin=i,t.IndicatorSettings.center.barMargin=i,d.updateAttributes({settings:t}))}}if(t&&i&&((null==e?void 0:e.specificChartFunctionality)===P.oK.quotePage||s)&&!p){const e=(0,n.rI)({quote:i,chartModel:t});t.updateAttributes({leftOffset:e})}}),[null==c||null===(s=c.quote())||void 0===s?void 0:s.timeframe,p]),{isLoading:m}}var Vt=i(481);function jt(t){var e;let{chartIndex:i,chartModel:s}=t;const n=window.FinvizSettings.hasUserPremium,a=s.chart_layout(),r=(0,lt.l)(s,{watchProperties:["ticker","quote","dateRange"]}),{instrument:h}=(null==r?void 0:r.quote())||{},c=(0,Ct.useNavigate)(),{favoriteTimeframes:d,toggleFavoriteTimeframe:u}=(0,l.useFavoriteTimeframes)(),{isLoading:m}=qt({chartModel:r,isInteractive:!0}),{anchorDate:g,generateChartLayoutRouterPath:f,timeframeGroupsWithHref:p,dateRangeGroupsWithHref:y,isFetching:v,handleCustomDateRangeValidation:b}=(0,Vt.E)({chartModel:r,isPremium:n}),{onDialogSubmit:x,customDateRangeDialogState:C,handleDateRangeSelect:w,getDateRangeTimeframe:S}=(0,l.useCustomDateRangeDialog)({instrument:h,anchorDate:g,pathGenerator:f}),M=y({isPremium:n,customRange:r.dateRange,instrument:h}),k=p(n),E=o().useCallback((t=>{const e=t.toUpperCase();c(f({ticker:e,timeframe:r.timeframe,dateRange:r.dateRange}))}),[r,f,c]);switch(a.specificChartFunctionality){case P.oK.futuresPage:case P.oK.forexPage:case P.oK.cryptoPage:return o().createElement("div",{className:"flex h-12 items-center space-x-2 rounded-t-md border border-b-0 border-gray-100 bg-white px-3.5 font-sans dark:border-gray-600 dark:bg-gray-800"},o().createElement("div",{className:"flex items-center space-x-2 overflow-hidden"},o().createElement(l.Heading,{level:3,className:"my-0 truncate uppercase text-gray-600 dark:text-gray-200"},null!==(e=r.quote().name)&&void 0!==e?e:r.ticker),a.editors.includes(P.fu.tools)&&o().createElement(Ot,{active:a.editable,isPremium:n,specificChartFunctionality:a.specificChartFunctionality})),o().createElement("div",{className:"flex h-full flex-1 items-center justify-center space-x-2 overflow-hidden"},o().createElement("div",null,o().createElement(Pt,{model:a,isPremium:n})),o().createElement(Bt,{model:a,isPremium:n},"Fullscreen"),a.editors.includes(P.fu.settings)&&o().createElement(Wt,{model:a,isPremium:n},"Settings"),o().createElement("div",{className:"grow"})),o().createElement(It,{chartIndex:0}));case P.oK.chartPage:return o().createElement("div",{className:"relative flex h-11 space-x-2 bg-white px-2 dark:bg-gray-800"},r.chart_layout().canChangeTicker&&o().createElement(Nt,{ticker:r.ticker,instrument:r.instrument,onTickerSelected:E,chartIndex:i}),o().createElement(l.TimeframeBar,{size:"medium",chartIndex:i,timeFrameGroups:k,dateRangeGroups:M,selectedTimeframe:r.timeframe,onTimeframeSelect:()=>{},selectedDateRange:r.dateRange,favoriteTimeframes:d,loadingTimeframe:m?r.timeframe:void 0,onDateRangeSelect:w,onFavoriteTimeframeToggle:t=>{let{value:e}=t;u(e)}}),o().createElement(It,{chartIndex:i}),o().createElement(l.CustomDateRange,{dialogState:C,dateRange:r.dateRange,anchorDate:g,onDialogSubmit:async function(t){const e=S(t.dateRange);if(!e)return;await b(e)&&x(e)},isFetching:v}));default:return null}}var _t=i(2481),Qt=i(8191);const Kt=t=>{const e=Qt.S[t.type](t);return o().createElement("span",{dangerouslySetInnerHTML:{__html:e}})};var Gt=i(1213);function Jt(t){let{data:e}=t;return o().createElement("tr",null,e.map(((t,e)=>{let{value:i,className:s}=t;return o().createElement("td",{key:"".concat(e,"-").concat(i),className:W()({"whitespace-nowrap pr-4":0===e,"text-gray-500 dark:text-gray-300 ":!s&&0===e},s)},o().createElement(l.Paragraph,{size:"small"},i))})))}function $t(t){let{badgeType:e,rawData:i,theme:s}=t;const n=o().useMemo((()=>{const t=[[{value:"Ex-date"},{value:(0,Gt.LN)(i.exdate)}]];return i.ordinary>0&&t.push([{value:"Amount"},{value:(0,Gt.m9)({value:i.ordinary})}]),i.special>0&&t.push([{value:"Special"},{value:(0,Gt.m9)({value:i.special})}]),t}),[i]);return o().createElement(o().Fragment,null,o().createElement("div",{className:"mb-3 flex space-x-1.5"},Kt({theme:s,state:Gt.EN.default,width:_t.b,type:e})," ",o().createElement(l.Heading,{className:"my-0 text-base"},P.fG[e])),o().createElement("table",null,o().createElement("tbody",null,n.map(((t,e)=>o().createElement(Jt,{data:t,key:"".concat(e,"-").concat(t[0])}))))))}const te="text-green-500 dark:text-green-400",ee="text-red-500 dark:text-red-400";function ie(t){const e=t.toLowerCase();if(e.includes("q")){const[t,i]=e.split("q");return"".concat(t," Q").concat(i)}if(e.includes("s")){const[t,i]=e.split("s");return"".concat(t," S").concat(i)}return t}function se(t){let{badgeType:e,rawData:i,theme:s}=t;const n=o().useMemo((()=>{const t=[[{value:"Earnings Date"},{value:(0,Gt.LN)(i.earningsDate,!0)}],[{value:"Fiscal Period"},{value:ie(i.fiscalPeriod)}],[{value:"Period Ending"},{value:(0,Gt.LN)(i.fiscalEndDate,!1,{month:"short",day:void 0})}]];if(void 0===i.epsActual&&void 0===i.epsEstimate||t.push([{value:"EPS",className:"font-medium pt-4"}]),void 0!==i.epsActual&&t.push([{value:"Reported"},{value:(0,Gt.m9)({value:i.epsActual})}]),void 0!==i.epsEstimate&&t.push([{value:"Estimate"},{value:(0,Gt.m9)({value:i.epsEstimate})}]),void 0!==i.epsActual&&void 0!==i.epsEstimate){const e=i.epsActual-i.epsEstimate,s=e/i.epsEstimate*100,n=e<0?ee:te;t.push([{value:"Surprise",className:n},{value:"".concat((0,Gt.m9)({value:e})," (").concat((0,Gt.m9)({value:s,maxDecimalPlaces:2}),"%)"),className:n}])}if(void 0!==i.epsReportedActual&&i.epsActual!==i.epsReportedActual&&(t.push([{value:"EPS (GAAP)",className:"font-medium pt-4"}],[{value:"Reported"},{value:(0,Gt.m9)({value:i.epsReportedActual})}]),void 0!==i.epsReportedEstimate)){const e=i.epsReportedActual-i.epsReportedEstimate,s=e/i.epsReportedEstimate*100,n=e<0?ee:te;t.push([{value:"Estimate"},{value:(0,Gt.m9)({value:i.epsReportedEstimate})}],[{value:"Surprise",className:n},{value:"".concat((0,Gt.m9)({value:e})," (").concat((0,Gt.m9)({value:s,maxDecimalPlaces:2}),"%)"),className:n}])}if(void 0===i.salesActual&&void 0===i.salesEstimate||t.push([{value:"Revenue",className:"font-medium pt-4"}]),void 0!==i.salesActual&&t.push([{value:"Reported"},{value:(0,Gt.m9)({value:i.salesActual,bigNumberUnit:yt.O$.Million})}]),void 0!==i.salesEstimate&&t.push([{value:"Estimate"},{value:(0,Gt.m9)({value:i.salesEstimate,bigNumberUnit:yt.O$.Million})}]),void 0!==i.salesActual&&void 0!==i.salesEstimate){const e=i.salesActual-i.salesEstimate,s=e/i.salesEstimate*100,n=e<0?ee:te;t.push([{value:"Surprise",className:n},{value:"".concat((0,Gt.m9)({value:e,bigNumberUnit:yt.O$.Million})," (").concat((0,Gt.m9)({value:s,maxDecimalPlaces:2}),"%)"),className:n}])}return t}),[i]);return o().createElement(o().Fragment,null,o().createElement("div",{className:"mb-3 flex space-x-1.5"},Kt({theme:s,state:Gt.EN.default,width:_t.b,type:e})," ",o().createElement(l.Heading,{className:"my-0 text-base"},P.fG[e])),o().createElement("table",null,o().createElement("tbody",null,n.map(((t,e)=>o().createElement(Jt,{data:t,key:"".concat(e,"-").concat(t[0])}))))))}function ne(t){let{badgeType:e,rawData:i,theme:s}=t;return o().createElement(o().Fragment,null,o().createElement("div",{className:"mb-3 flex space-x-1.5"},Kt({theme:s,state:Gt.EN.default,width:_t.b,type:e})," ",o().createElement(l.Heading,{className:"my-0 text-base"},"".concat(P.fG[e],": ").concat(i.factorFrom,"/").concat(i.factorTo))),o().createElement("table",null,o().createElement("tbody",null,o().createElement("tr",null,o().createElement("td",null,o().createElement(l.Paragraph,{size:"small"},(0,Gt.LN)(i.exdate)))))))}function ae(t){let{id:e,popoverState:i,badgeType:s,data:n,theme:a}=t;return i.visible||i.animating?o().createElement(l.ZIndexContext.Provider,{value:"z-dialog"},o().createElement(l.Popover,{id:e,tabIndex:0,hasBackdrop:!1,"aria-label":"Chart Settings",className:W()("relative z-10 mt-10 flex max-h-full max-w-full flex-col",{"min-h-48":[P.o$.Earnings,P.o$.EarningsNeg,P.o$.EarningsPos].includes(s),"min-h-28":s===P.o$.Dividends,"min-h-20":s===P.o$.Split}),state:i,focusOnHide:!1,focusOnShow:!1,hideOnClickOutside:!1,hasViewportHeightLimit:!0,"data-testid":"chart-event-popover"},o().createElement(l.DialogBody,{className:"select-text"},function(t,e,i){switch(t){case P.o$.Split:return o().createElement(ne,{badgeType:t,rawData:e,theme:i});case P.o$.Dividends:return o().createElement($t,{badgeType:t,rawData:e,theme:i});case P.o$.EarningsPos:case P.o$.EarningsNeg:case P.o$.Earnings:return o().createElement(se,{badgeType:t,rawData:e,theme:i});default:return null}}(s,n,a)))):null}function re(t){var e;let{chartModel:i}=t;const s=o().useMemo((()=>{var t;return null!==(t=i.chart_layout())&&void 0!==t?t:null}),[i]),{activeChartEvent:n,theme:a}=(0,lt.l)(s,{watchProperties:["activeChartEvent"]}),r=(0,l.usePopoverState)({placement:"top"}),{isFullyClosed:h}=(0,l.getExtendedDialogState)(r),[c,d]=o().useState({top:0,left:0}),u=null==n?void 0:n.elementId,m=null==n?void 0:n.pane().chart().eql(i),[g,f]=o().useState(null),p=function(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const i=o().useRef(null),s=o().useRef(t);return o().useLayoutEffect((()=>{s.current=t})),o().useEffect((()=>{if(!e)return;const t=K.ZP.isMobile(),n=t=>{const e=i.current;e&&t.target&&!e.contains(t.target)&&s.current(t)};return document.addEventListener(t?"touchstart":"mousedown",n),()=>{document.removeEventListener(t?"touchstart":"mousedown",n)}}),[t,e]),i}((()=>{var t;!!(null===(t=i.getChartPane())||void 0===t||!t.getAllChartEvents().some((t=>t.instance.isHovered)))&&n&&m&&n.instance.toggleIsOpen(!1)}),!!n&&m);p.current=r.unstable_popoverRef.current;const y=r.show,v=r.hide;return o().useEffect((()=>{var t;if(null==n||!n.instance.isOpen||!m)return h?f(null):v();if(!m)return;const{top:e,left:s}=n.instance,a=null===(t=i.quote().chartEvents)||void 0===t?void 0:t.find((t=>t.elementId===u));(null==a?void 0:a.elementId)!==(null==g?void 0:g.elementId)&&f(a),c.top===e&&c.left===s||(v(),d({top:e,left:s})),r.visible||y()}),[u,h,g,c,y,v,r.visible,n,i,m]),o().createElement(o().Fragment,null,o().createElement(l.PopoverTrigger,{as:"div",state:r,className:"absolute",style:c}),o().createElement(ae,{id:"badge-popover",popoverState:r,badgeType:null!==(e=null==g?void 0:g.eventType)&&void 0!==e?e:P.o$.Split,data:g,theme:a}))}const oe=FLibs.Hammerjs;var le=i.n(oe),he=i(8497),ce=i(8661),de=i(9528),ue=i(8755),me=i(353);const ge="chartLayoutChildChange";var fe=i(1220),pe=i.n(fe),ye=i(2340),ve=i.n(ye);class be extends ve().Model{static initClass(){this.configure("ContextMenu","shown","config","top","left")}}be.initClass();const xe=be.create();xe.save();const Ce=xe;const we=".context-menu";class Se extends o().Component{constructor(){var t,e,i;super(...arguments),i=()=>{this.forceUpdate()},(e="update")in(t=this)?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i}componentDidMount(){Ce.bind("update",this.update)}componentWillUnmount(){Ce.unbind("update",this.update)}render(){var t,e;return Ce.shown?(null===(e=document.querySelector(we))||void 0===e||e.classList.remove("hidden"),o().createElement(o().Fragment,null,o().createElement("div",{className:"overlay select-none",onClick:()=>this.hide(),onContextMenu:t=>t.preventDefault(),"data-testid":"charts-context-menu-overlay"}),o().createElement(l.ContextMenu,{top:Ce.top,left:Ce.left,items:Ce.config,hide:this.hide}))):(null===(t=document.querySelector(we))||void 0===t||t.classList.add("hidden"),null)}hide(){Ce.updateAttribute("shown",!1)}}(0,K.Cd)((()=>{const t=document.querySelector(we);t&&fe.render(o().createElement(Se,null),t)}));const Me={show:(t,e)=>{Ce.updateAttributes({shown:!0,config:e,top:t.clientY+window.pageYOffset,left:t.clientX})}};var Pe=i(6990),ke=i(6805);function Ee(){return Ee=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(t[s]=i[s])}return t},Ee.apply(this,arguments)}var Te=i(7824);function Ie(t){let{chartModel:e}=t;const i=(0,Te.t)(),s=(0,lt.l)(e,{watchProperties:["quote"]}),n=(0,lt.l)(s.quote(),{watchProperties:["isFetching"]}),[a,r]=o().useState(!1);o().useEffect((()=>{s.getRefreshInterval()||s.quote().isPossibleToFetchSequentialData().then((t=>{i()&&r(t)}))}),[]);return a?o().createElement(l.ButtonGroup,{rounding:"full",className:"shadow-modal dark:shadow-modal-dark"},o().createElement(l.Button,{leftContent:null!=n&&n.isFetching?o().createElement(l.Delayed,{delayComponent:o().createElement(l.Icon,{name:"refresh"})},o().createElement(l.Spinner,{width:16})):"refresh",disabled:null==n?void 0:n.isFetching,title:"Load latest data",onClick:async()=>{const t=s.getAllQuotes().map((async t=>t.fetchData({fetchType:xt.p.NewerData})));var e,n;(s.updateAttributes({refreshData:!0}),await Promise.all(t),i())&&(r(!1),null===(e=(n=window).gtag)||void 0===e||e.call(n,"event","load-latest-data",{event_category:"ideas"}))},"data-testid":"load-latest-data-button"},"Load latest data")):null}function Ae(){return Ae=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(t[s]=i[s])}return t},Ae.apply(this,arguments)}const Le="is-active",De="is-in-area",Oe={size:"none",className:"w-7 h-6",contentClass:"flex justify-center"},Re=K.ZP.isMobile(),Fe=t=>(0,n.rI)({quote:t.quote(),chartModel:t,config:{}});function Be(t){var e;let{zoomControlsRef:i,chartModel:s,isVisible:n,onZoomIn:a,onZoomOut:r,onZoomReset:h}=t;const d=(0,lt.l)(s.chart_layout(),{watchProperties:["idea"]}),[u,m]=o().useState(!1),{defaultZoomFactor:g}=d,[f,p]=o().useState(s.zoomFactor!==g),y=o().useCallback((()=>{s.updateAttributes({leftOffset:Fe(s),dateRange:null})}),[s]);return o().useEffect((()=>{const t=c()((()=>{p(s.zoomFactor!==g),m(s.leftOffset!==Fe(s))}),100,{maxWait:333});return s.bind("change",t),()=>{t.cancel(),s.unbind("change",t)}}),[g,s]),o().createElement("div",{ref:i,className:W()("zoom-controls pointer-events-none absolute bottom-[15px] left-[34px] right-[42px] z-10 flex h-[75px] items-end justify-center",{hidden:!n})},!Re&&o().createElement("div",{className:"ease zoom-buttons pointer-events-auto visible relative flex translate-y-3 opacity-75 transition-all duration-150 hover:opacity-100"},f&&o().createElement("div",{className:"jump-to-recent pointer-events-auto visible absolute left-[-36px] opacity-75 hover:opacity-100"},o().createElement(l.ButtonGroup,{rounding:"full",className:"shadow-modal dark:shadow-modal-dark"},o().createElement(l.Button,Ae({},Oe,{"data-testid":"chart-zoom-controls-reset-zoom",title:"Reset zoom",onClick:h,className:"h-6 w-6"}),o().createElement(l.Icon,{name:"restore"})))),o().createElement(l.ButtonGroup,{rounding:"full",className:"shadow-modal dark:shadow-modal-dark"},o().createElement(l.Button,Ae({},Oe,{"data-testid":"chart-zoom-controls-zoom-out",title:"Zoom out",onClick:r}),o().createElement(l.Icon,{name:"remove"})),o().createElement(l.Button,Ae({},Oe,{"data-testid":"chart-zoom-controls-zoom-in",title:"Zoom in",onClick:a}),o().createElement(l.Icon,{name:"add"})))),o().createElement("div",{className:"jump-to-recent pointer-events-auto visible absolute right-8 space-x-2 opacity-75 hover:opacity-100"},!(null===(e=d.idea)||void 0===e||!e.id)&&o().createElement(Ie,{chartModel:s}),u&&o().createElement(l.ButtonGroup,{rounding:"full",className:"shadow-modal dark:shadow-modal-dark"},o().createElement(l.Button,{appearance:"square","data-testid":"chart-zoom-controls-go-to-recent",title:"Jump to the most recent bar",onClick:y},o().createElement(l.Icon,{name:"tabKey"})))))}function Ne(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class Ze extends o().Component{constructor(t){var e;super(t),e=this,Ne(this,"rafId",null),Ne(this,"crossRafId",null),Ne(this,"quoteModel",void 0),Ne(this,"paneRef",o().createRef()),Ne(this,"scalerRef",o().createRef()),Ne(this,"zoomerRef",o().createRef()),Ne(this,"zoomControlsRef",o().createRef()),Ne(this,"canvasWrapperRef",o().createRef()),Ne(this,"canvasRef",o().createRef()),Ne(this,"crossCanvasRef",o().createRef()),Ne(this,"chartLayoutModel",this.props.chartModel.chart_layout()),Ne(this,"paneHammer",void 0),Ne(this,"scalerHammer",void 0),Ne(this,"zoomerHammer",void 0),Ne(this,"canvasWrapperHammer",void 0),Ne(this,"mouseDown",!1),Ne(this,"lastClientX",void 0),Ne(this,"lastClientY",void 0),Ne(this,"currentViewRange",null),Ne(this,"lastX",void 0),Ne(this,"lastY",void 0),Ne(this,"lastActiveTool",void 0),Ne(this,"scalerLastY",null),Ne(this,"isElementHovered",!1),Ne(this,"hoveredElement",null),Ne(this,"isMobile",void 0),Ne(this,"isDisableTouchCrossAvailable",!0),Ne(this,"canvas",null),Ne(this,"canvasCtx",null),Ne(this,"crossCanvas",null),Ne(this,"crossCanvasCtx",null),Ne(this,"isIndicatorPane",!1),Ne(this,"state",{hasSeenCrossNotification:!!window.localStorage.getItem("hasSeenCrossNotification")}),Ne(this,"getIsHammerAllowScrollActive",(()=>this.chartLayoutModel.specificChartFunctionality!==P.oK.chartPage&&!this.chartLayoutModel.isTouchCrossActive&&!this.chartLayoutModel.scrollable)),Ne(this,"onElementCreate",(t=>{t.instance.bind("change",this.renderAll),this.renderAll()})),Ne(this,"onElementReplace",((t,e)=>{e.unbind("change",this.renderAll),t.instance.bind("change",this.renderAll),e!==this.props.model.selection||this.chartLayoutModel.isDrawingModeContinuousActive?this.setSelection(null):this.setSelection(t.instance),this.renderAll()})),Ne(this,"onElementDestroy",(t=>{const{type:e}=t.instance;t.instance.unbind("change",this.renderAll),t.instance===this.props.model.selection&&this.setSelection(null),(e.startsWith("charts/")||e.startsWith("indicators/"))&&this.props.onPaneDestroy(t.pane_id),this.renderAll()})),Ne(this,"onElementSelect",(t=>{this.setSelectedElement(t.instance)})),Ne(this,"onElementClone",((t,e)=>{this.setSelectedElement(e)})),Ne(this,"onModelUpdate",(t=>{let{height:e}=t;this.setCanvasSize({width:this.props.chartModel.width,height:e})})),Ne(this,"onChartUpdate",(t=>{let{width:e}=t;const{model:i,chartModel:s}=this.props;this.setCanvasSize({width:e,height:i.height});const n=s.quote();this.quoteModel.eql(n)||(this.quoteModel.unbind("change",this.recountScale),n&&(this.quoteModel=n,this.quoteModel.bind("change",this.recountScale)))})),Ne(this,"onZoomerMouseMove",(t=>{if(!this.chartLayoutModel.scrollable||this.isMobile&&!this.chartLayoutModel.isTouchCrossActive)return;const e=this.getArea(t);vt.Z.updateAttributes({position:{x:e.x,y:null},pane:this.props.model})})),Ne(this,"onMouseMoveOnScrolling",(t=>{var e;if(this.props.activeChartInteraction)return;let{clientX:i,clientY:s}=t;const{model:n}=this.props;if("undefined"!=typeof TouchEvent&&t instanceof TouchEvent&&(null===(e=t.targetTouches)||void 0===e?void 0:e.length)>0&&(i=t.targetTouches[0].clientX,s=t.targetTouches[0].clientY),!n.selection){if(null!=this.lastClientX){const t=this.lastClientX-i;this.addToLeftOffset(-t)}if(n.scaleRange&&null!=this.lastClientY){var a,r,o,l;let t,{min:e,max:i}=n.scaleRange;if(this.props.chartModel.scale===P.N3.Logarithmic)t=this.lastClientY-s,e=n.scale.y.invert(n.scale.y(e)+t),i=n.scale.y.invert(n.scale.y(i)+t);else t=(this.lastClientY-s)*(n.scale.y.invert(0)-n.scale.y.invert(1)),e-=t,i-=t;n.updateAttribute("scaleRange",{min:e,max:i}),this.recountScale(),this.currentViewRange=null!==(a=null===(r=this.props.model.getChartOrIndicatorElement())||void 0===r||null===(o=r.instance)||void 0===o||null===(l=o.getMinMax)||void 0===l?void 0:l.call(o))&&void 0!==a?a:null}}this.lastClientX=i,this.lastClientY=s})),Ne(this,"onScalerTouchStart",(t=>{this.chartLayoutModel.scrollable&&!this.props.touchEventsDisabled&&this.chartLayoutModel.scrollable&&1===t.targetTouches.length&&this.onScalerMouseDown(t.targetTouches[0])})),Ne(this,"onScalerTouchMove",(t=>{this.chartLayoutModel.scrollable&&1===t.targetTouches.length&&this.onScalerMouseMove(t.targetTouches[0])})),Ne(this,"onScalerTouchEnd",(()=>{this.chartLayoutModel.scrollable&&this.onScalerMouseUp()})),Ne(this,"onScalerMouseEnter",(()=>{vt.Z.updateAttributes({position:null,pane:null})})),Ne(this,"onScalerMouseDown",(t=>{const{activeChartInteraction:e,setActiveChartInteraction:i,model:s}=this.props;if(t instanceof MouseEvent&&t.button||e||!this.chartLayoutModel.scrollable)return;i("scaler"),this.scalerLastY=t.clientY;const[n,a]=s.scale.y.domain();this.currentViewRange={min:a,max:n},document.addEventListener("mousemove",this.onScalerMouseMove),document.addEventListener("mouseup",this.onScalerMouseUp),document.addEventListener("touchmove",this.onScalerTouchMove),document.addEventListener("touchend",this.onScalerTouchEnd)})),Ne(this,"onScalerMouseMove",(t=>{var e,i,s;const{model:n,chartModel:a}=this.props;if(null===n.scaleRange&&null===this.currentViewRange)return;let r,{min:o,max:l}=n.scaleRange||this.currentViewRange;if(this.props.chartModel.scale===P.N3.Logarithmic)r=this.scalerLastY-t.clientY,o=n.scale.y.invert(n.scale.y(o)-r),l=n.scale.y.invert(n.scale.y(l)+r);else r=-(this.scalerLastY-t.clientY)*(n.scale.y.invert(0)-n.scale.y.invert(1)),o-=r,l+=r;this.scalerLastY=t.clientY;const h=null===(e=n.getChartOrIndicatorElement())||void 0===e||null===(i=e.instance)||void 0===i||null===(s=i.getMinMax)||void 0===s?void 0:s.call(i);if(h){const t=Math.abs(l-o),e=Math.abs(h.max-h.min);if(t>1e4*e||t<e/1e4)return}n.updateAttribute("scaleRange",{min:o,max:l}),a.updateAttribute("dateRange",null),this.recountScale()})),Ne(this,"onScalerMouseUp",(()=>{this.scalerLastY=null,document.removeEventListener("mousemove",this.onScalerMouseMove),document.removeEventListener("mouseup",this.onScalerMouseUp),document.removeEventListener("touchmove",this.onScalerTouchMove),document.removeEventListener("touchend",this.onScalerTouchEnd),this.props.setActiveChartInteraction(null)})),Ne(this,"onScalerReset",(()=>{const{model:t,chartModel:e}=this.props;this.chartLayoutModel.scrollable&&(e.updateAttribute("dateRange",null),t.updateAttribute("scaleRange",null),this.recountScale())})),Ne(this,"addToLeftOffset",(t=>{const e=this.props.chartModel.quote(),i=(0,G.zG)({chartLayout:this.chartLayoutModel,zoomFactor:this.props.chartModel.zoomFactor}),s=(0,n.az)({newLeftOffset:this.props.chartModel.leftOffset+t,chartModel:this.props.chartModel,barWidth:i,barIndex:e.barIndex[e.open.length-1]});s>i&&e.fetchOlderData(),this.props.chartModel.updateAttributes({leftOffset:s,dateRange:null})})),Ne(this,"onDoubleClick",(t=>{t.preventDefault();const e=this.getArea(t),i=this.props.model.selection||this.getElement(e);i&&i.type!==P.A.Cot&&(setTimeout((()=>{this.props.openElementStyleDialog(i)}),0),i.trigger("dblclick",t))})),Ne(this,"onPress",(t=>{if("touch"!==t.pointerType)return;t.clientX=t.center.x,t.clientY=t.center.y;const e=this.props.model.selection||this.getElement(this.getArea(t));this.chartLayoutModel.isTouchCrossActive||(e?this.onContextMenu(t,e):this.onCanvasPress(t))})),Ne(this,"onContextMenu",((t,e)=>{t.preventDefault();const i=this.getArea(t),s=this.getElement(i),n=null!=e?e:s;if(!n||n.thumbsAreInArea(i))return;const a=Q.Z.findByAttribute("instance",n);if(!a)return;this.setSelectedElement(n);const r=["indicator","canvas"].some((t=>n.type.startsWith(t)))&&n.type!==P.A.Cot,o=a.isDrawing();return Me.show(t,[r&&{id:"edit",label:"Edit style",onClick:()=>this.props.openElementStyleDialog(n)},!(a.isChart()||null!=a&&a.isIndicator())&&{id:"clone",label:"Clone",onClick:()=>a.makeClone()},...o?[{type:"divider",label:"Visibility"},{id:"visibility-current-and-above",label:"Current interval and above",onClick:()=>a.instance.setVisibilityTo(P.iL.currentAndAbove)},{id:"visibility-current-and-below",label:"Current interval and below",onClick:()=>a.instance.setVisibilityTo(P.iL.currentAndBelow)},{id:"visibility-current-only",label:"Current interval only",onClick:()=>a.instance.setVisibilityTo(P.iL.currentOnly)},{id:"visibility-all-intervals",label:"All intervals",onClick:()=>a.instance.setVisibilityTo(P.iL.all)}]:[],(o||r)&&{type:"divider"},{id:"bring-to-front",label:"Bring to Front",onClick:()=>a.bringToFront()},{id:"send-to-back",label:"Send to Back",onClick:()=>a.sendToBack()},{id:"bring-forward",label:"Bring Forward",onClick:()=>a.bringForward()},{id:"send-backward",label:"Send Backward",onClick:()=>a.sendBackward()},{type:"divider"},{id:"remove",label:"Remove",onClick:()=>{a.isIndicator()?(0,ue.C3)({paneIndex:this.props.paneIndex,chartLayoutModel:this.chartLayoutModel}):(a.destroyCascade({eventType:j.H3.Remove}),this.props.model.normalizeZIndexes())}}].filter(Boolean).map((t=>({...t,gtag:{element_type:n.type}}))))})),Ne(this,"immediateRecountScaleOnChartIndicatorChange",(t=>{(null!=t&&t.isChart()||null!=t&&t.isIndicator())&&this.recountScale()})),Ne(this,"recountScale",((t,e)=>{const{model:i}=this.props,s=i.chart();"destroy"!==e&&s&&s.quote()&&((0,n.qk)({chartModel:s,paneModel:i}),this.canvasCtx&&this.renderAll())})),Ne(this,"onBlur",(()=>{var t,e;null!==(t=this.props.model.selection)&&void 0!==t&&null!==(e=t.getIsCreator)&&void 0!==e&&e.call(t)?this.setSelection(null):this.setSelectedElement(null),this.hoveredElement&&(this.hoveredElement.setIsHovered(!1),this.hoveredElement=null),this.props.model.getAllElements().forEach((t=>{var e,i,s,n;null===(e=(i=t.instance).getIsCreator)||void 0===e||!e.call(i)||null!==(s=(n=t.instance).getIsCreatorDialogOpen)&&void 0!==s&&s.call(n)||t.destroyCascade()}))})),Ne(this,"renderAll",(t=>{"cross"===t&&this.chartLayoutModel.cross?null===this.crossRafId&&(this.crossRafId=window.requestAnimationFrame((()=>{this.renderCross()}))):null==this.rafId&&this.canvasCtx&&(this.rafId=window.requestAnimationFrame((()=>{this._renderAll()})))})),Ne(this,"_renderAll",(()=>{const{model:t}=this.props;if(null===t.chart()||null===this.canvasRef.current||!this.canvasCtx)return;this.getIsUpdatedDesign()&&null===this.crossRafId&&(this.crossRafId=window.requestAnimationFrame(this.renderCross)),this.rafId=void 0,t.chart().instrument===j.Yx.MarketSentiment?this.canvasCtx.clearRect(0,0,this.props.chartModel.width,t.height):(this.canvasCtx.set("fillStyle",this.props.chartModel.getChartLayoutSettings().ChartSettings.general.Colors.canvasFill),this.canvasCtx.fillRect(0,0,this.props.chartModel.width,t.height));const e=t.getAllElements();for(const{instance:t}of e)null!=t.renderGrid&&(this.canvasCtx.save(),t.renderGrid(this.canvasCtx),this.canvasCtx.restore());const i=t.getAllChartEvents(),s=(0,n.Gw)(t);for(const{instance:a}of[...e,...i]){const e=a.getIsDrawing(),i=a.getIsChartEvent();(!e||!this.chartLayoutModel.isHideDrawingsActive&&a.getIsVisible())&&((!e&&!i||a.getIsInChartView(this.props.chartModel))&&(this.canvasCtx.save(),null!=a.renderContent?(this.canvasCtx.save(),(0,n.oq)({canvasCtx:this.canvasCtx,width:this.props.chartModel.width,height:t.height,Settings:s}),this.canvasCtx.translate(t.chart().leftOffset+s.left.width,s.top.height),a.renderContent(this.canvasCtx),this.canvasCtx.restore(),"function"==typeof a.renderLabels&&a.renderLabels(this.canvasCtx)):a.render(this.canvasCtx),this.canvasCtx.restore()))}})),Ne(this,"renderCross",(()=>{const{model:t}=this.props,e=vt.Z.getShouldRenderCrossInPane(t);if(this.crossRafId=null,!this.crossCanvasCtx)return;this.crossCanvasCtx.clearRect(0,0,this.props.chartModel.width,t.height);const i=0!==de.Z.select((t=>!!t.selection&&!t.selection.type.startsWith("indicators/"))).length||this.props.chartModel.getIsDisabled()||!e;for(const{instance:e}of t.getAllElements())(!i&&null!=e.renderCross||i&&null!=e.renderCrossText)&&(this.crossCanvasCtx.save(),i?e.renderCrossText(this.crossCanvasCtx,Number.NaN):e.renderCross(this.crossCanvasCtx),this.crossCanvasCtx.restore())})),Ne(this,"getArea",((t,e)=>{const{model:i}=this.props,s=t.clientX||(null==e?void 0:e.clientX),a=t.clientY||(null==e?void 0:e.clientY),r=(0,n.Gw)(i),o=this.canvas.getBoundingClientRect(),l=s-o.left,h=a-o.top,c=l-i.chart().leftOffset-r.left.width,d=h-r.top.height,u=i.scale,m=o.left+r.left.width,g=o.right-r.right.width;return{...e,x:u.x.invert(c),y:u.y.invert(d),scaled:{x:c,y:d},width:1,height:1,cursorX:l,cursorY:h,isCursorInChartWidthBoundaries:s>m&&s<g}})),Ne(this,"setCanvasSize",(t=>{let{width:e,height:i}=t;const s=K.ZP.getScaleRatio(),n=this.canvasRef.current;this.canvasCtx&&n&&(Math.abs(i*s-n.height)>=1||Math.abs(e*s-n.width)>=1)&&(K.ZP.setSizeOnCanvasElement({canvasElement:n,width:e,height:i}),this.canvasCtx.scale(s,s),this.chartLayoutModel.cross&&this.crossCanvasCtx&&(K.ZP.setSizeOnCanvasElement({canvasElement:this.crossCanvasRef.current,width:e,height:i}),this.crossCanvasCtx.scale(s,s)),setTimeout((()=>{this.recountScale()})))})),Ne(this,"onClick",(t=>{const e=this.getArea(t,{clientX:t.center.x,clientY:t.center.y}),i=this.props.model.selection||this.getElement(e);if(null==i||i.trigger("click",e),this.isDisableTouchCrossAvailable){if(this.chartLayoutModel.isTouchCrossActive)vt.Z.updateAttributes({position:null,pane:null}),this.chartLayoutModel.updateAttributes({scrollable:this.chartLayoutModel.initialScrollable,isTouchCrossActive:!1});else if(this.isMobile&&!this.state.hasSeenCrossNotification&&this.lastActiveTool===Pe.U.Mouse&&this.chartLayoutModel.specificChartFunctionality!==P.oK.smallIndex){const t=this.chartLayoutModel.specificChartFunctionality===P.oK.chartPage;this.setState({hasSeenCrossNotification:!0}),this.props.notificationContext.show(o().createElement(l.Notification,{actions:o().createElement(l.Button,{onClick:()=>{this.props.notificationContext.hide(),window.localStorage.setItem("hasSeenCrossNotification","true")}},"Got it")},o().createElement(l.Paragraph,{className:"max-w-40"},"Long press the chart to show the crosshair.")),{inline:!t})}this.lastActiveTool=this.props.activeTool}else this.isDisableTouchCrossAvailable=!0})),Ne(this,"onPaneMouseLeave",(()=>{setTimeout((()=>{var t;null===(t=this.zoomControlsRef.current)||void 0===t||t.classList.remove(Le,De)})),this.chartLayoutModel.specificChartFunctionality===P.oK.chartPage&&this.renderCross()})),Ne(this,"onPaneMouseMove",(function(t){let i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const{model:s,chartModel:n}=e.props,a=e.zoomControlsRef.current,r=s.height;if(a){const o=e.getArea(t,{mouseDown:!i&&e.mouseDown,clientX:t.clientX,clientY:t.clientY});setTimeout((()=>{const t=s.height-90<=o.cursorY&&r>210;!t||a.classList.contains(De)||n.getIsDisabled()?!t&&a.classList.contains(De)&&a.classList.remove(De):a.classList.add(De),o.mouseDown||s.selection||!t||n.getIsDisabled()?a.classList.contains(Le)&&a.classList.remove(Le):a.classList.contains(Le)||a.classList.add(Le)}))}})),Ne(this,"onMouseLeave",(()=>{this.mouseDown=!1})),Ne(this,"onTouchStart",(t=>{if(!this.props.touchEventsDisabled&&1===t.targetTouches.length){const s=t.targetTouches[0];if(this.chartLayoutModel.scrollable)this.onCanvasInteractionStart(s);else if(this.chartLayoutModel.isTouchCrossActive){var e;if(this.lastClientX=s.clientX,this.lastClientY=s.clientY,null===(e=vt.Z.pane())||void 0===e||!e.eql(this.props.model)){const t=this.getArea(s,{mouseDown:this.mouseDown,clientX:s.clientX,clientY:s.clientY});this.setMousePosition(this.getMousePositionInBoundaries(t)),this.isDisableTouchCrossAvailable=!1}}else{var i;const t=this.getArea(s,{isTouch:!0}),e=this.getElement(t);if(null!=e&&null!==(i=e.getIsChartEvent)&&void 0!==i&&i.call(e)){e.toggleIsOpen()}}this.onPaneMouseMove(s,!0)}})),Ne(this,"onTouchMove",(t=>{this.props.touchEventsDisabled||(this.getIsHammerAllowScrollActive()||t.preventDefault(),this.props.touchEventsDisabled||1!==t.targetTouches.length||this.onCanvasInteractionMove(t.targetTouches[0]))})),Ne(this,"onTouchEnd",(t=>{!this.props.touchEventsDisabled&&this.chartLayoutModel.scrollable&&this.onCanvasInteractionEnd(t)})),Ne(this,"onCanvasPress",(t=>{this.chartLayoutModel.scrollable&&(this.chartLayoutModel.updateAttribute("scrollable",!1),document.removeEventListener("touchmove",this.onMouseMoveOnScrolling)),this.chartLayoutModel.isTouchCrossActive||(this.chartLayoutModel.updateAttribute("isTouchCrossActive",!0),this.onCanvasInteractionMove(t))})),Ne(this,"onCanvasInteractionStart",(t=>{const{activeTool:e,activeChartInteraction:i,chartModel:s,model:n}=this.props,a="undefined"!=typeof Touch&&t instanceof Touch;if(this.lastActiveTool=e,(0,k.aB)(t)&&!i&&!s.getIsDisabled()){var r;const i=this.getArea(t,{isTouch:a}),s=this.getElement(i);if(this.chartLayoutModel.scrollable){var o,l,h,c;if((0,me.s)({elementId:this.chartLayoutModel.getHTMLElementId(),cursor:"grabbing"}),n.scaleRange)this.currentViewRange=null!==(o=null===(l=n.getChartOrIndicatorElement())||void 0===l||null===(h=l.instance)||void 0===h||null===(c=h.getMinMax)||void 0===c?void 0:c.call(h))&&void 0!==o?o:null;document.addEventListener(a?"touchmove":"mousemove",this.onMouseMoveOnScrolling),document.addEventListener(a?"touchend":"mouseup",this.onCanvasInteractionEnd)}if(null!=s&&null!==(r=s.getIsChartEvent)&&void 0!==r&&r.call(s)){s.toggleIsOpen()}else(e===Pe.U.Mouse||n.getAllElements().some((t=>{let{instance:e}=t;return e.isCreator})))&&(null==s||s.trigger("mousedown",i),this.setSelectedElement(s));n.trigger("mousedown",n,i,s),this.mouseDown=!0,this.lastX=i.x,this.lastY=i.y}this.lastClientX=t.clientX,this.lastClientY=t.clientY})),Ne(this,"onCanvasInteractionMove",(t=>{var e;const i=this.getArea(t,{mouseDown:this.mouseDown,clientX:t.clientX,clientY:t.clientY});if(!i.isCursorInChartWidthBoundaries)return void vt.Z.updateAttributes({position:null,pane:null});const{model:s}=this.props,n=this.getElement(i),a=s.selection||n;var r,o;(this.isMobile&&!this.chartLayoutModel.isTouchCrossActive||(this.isDisableTouchCrossAvailable=!0,this.setMousePosition(this.lastClientX&&this.lastClientY&&this.chartLayoutModel.isTouchCrossActive&&vt.Z.position?this.getMousePositionInBoundaries({x:vt.Z.position.x+(s.scale.x.invert(i.clientX)-s.scale.x.invert(this.lastClientX)),y:vt.Z.position.y+(s.scale.y.invert(i.clientY)-s.scale.y.invert(this.lastClientY))}):{x:i.x,y:i.y})),this.chartLayoutModel.scrollable||(this.lastClientX=i.clientX,this.lastClientY=i.clientY),null==a||a.trigger("mousemove",i),s.selection instanceof he.Z&&this.mouseDown&&(null===(e=s.selection)||void 0===e||!e.activeThumb))&&(null!==(r=(o=s.selection).getIsCreator)&&void 0!==r&&r.call(o)||s.selection.moveBy(i.x-this.lastX,i.y-this.lastY),this.lastX=i.x,this.lastY=i.y,this.renderAll());const l=this.props.activeTool===Pe.U.Mouse&&(a&&a===n||n instanceof he.Z);n!==this.hoveredElement&&this.hoveredElement instanceof he.Z&&(this.hoveredElement.setIsHovered(!1),this.hoveredElement=null),l&&n instanceof he.Z&&(n.isHovered||n.isSelected||(n.setIsHovered(!0),this.hoveredElement=n)),l!==this.isElementHovered&&this.canvas&&(null==n?void 0:n.type)!==P.A.Cot&&(this.canvas.className=l?"hover":"",this.chartLayoutModel.cross&&this.crossCanvas&&(this.crossCanvas.className="second".concat(l?" hover":"")),this.isElementHovered=l)})),Ne(this,"onCanvasInteractionEnd",(t=>{vt.Z.position?(0,me.s)({elementId:this.chartLayoutModel.getHTMLElementId(),cursor:"crosshair"}):(0,me.s)({elementId:this.chartLayoutModel.getHTMLElementId(),cursor:"default"});const e="undefined"!=typeof TouchEvent&&t instanceof TouchEvent;this.mouseDown=!1;const i=this.getArea(t),s=this.props.model.selection||this.getElement(i);null==s||s.trigger("mouseup",i),document.removeEventListener(e?"touchmove":"mousemove",this.onMouseMoveOnScrolling),document.removeEventListener(e?"touchend":"mouseup",this.onCanvasInteractionEnd)})),Ne(this,"getMousePositionInBoundaries",(t=>{let{x:e,y:i}=t;const{model:s}=this.props,a=(0,n.Gw)(s),r=this.canvas.getBoundingClientRect(),o=s.scale.x.invert(1-s.chart().leftOffset),l=s.scale.x.invert(r.width-a.right.width-a.left.width-s.chart().leftOffset-1),h=s.scale.y.invert(0),c=s.scale.y.invert(r.height-a.bottom.height-a.top.height);return{x:(0,k.tO)({value:e,min:o,max:l}),y:(0,k.tO)({value:i,min:c,max:h})}})),Ne(this,"setMousePosition",(t=>{var e;let{x:i,y:s}=t;const n=!(null===(e=vt.Z.pane())||void 0===e||!e.eql(this.props.model));vt.Z.updateAttributes({position:{x:i,y:s},...n?{}:{pane:this.props.model}})})),Ne(this,"setSelection",(t=>{t instanceof he.Z&&(null==t||t.setIsSelected(!0)),this.props.model.updateAttribute("selection",t)})),Ne(this,"setSelectedElement",(t=>{const{selection:e}=this.props.model,i=e instanceof he.Z;(t!==e||i&&t&&(null==e||!e.isSelected))&&(i&&(null==e||e.setIsSelected(!1)),i&&null!=e&&e.isCreator?this.setSelection(null):this.setSelection(t))})),Ne(this,"getElement",(t=>{const e=this.props.model.getAllElements(),i=this.props.model.getAllChartEvents();for(let e=i.length-1;e>=0;e--){const s=i[e].instance;if(s.isInArea(t))return s}for(let i=e.length-1;i>=0;i--){const s=e[i].instance;if(s.isInArea(t))return s}return null})),Ne(this,"getCanvasDOMNode",(()=>this.canvasRef.current)),this.quoteModel=this.props.chartModel.quote(),t.model.updateAttribute("instance",this),t.model.bind("update",this.onModelUpdate),t.model.elements().bind("create",this.onElementCreate).bind("destroy",this.onElementDestroy).bind("replace",this.onElementReplace).bind("select",this.onElementSelect).bind("makeClone",this.onElementClone).bind("change",this.immediateRecountScaleOnChartIndicatorChange).bind("change",c()(this.recountScale,50)),t.model.chartEvents().bind("create",this.onElementCreate).bind("change",c()(this.recountScale,50)),this.props.chartModel.bind("update",this.onChartUpdate),this.props.chartModel.bind("change ".concat(j.wq.IndicatorsChange),this.recountScale),this.quoteModel.bind("change",this.recountScale),this.isMobile=!!K.ZP.isMobile(),this.lastActiveTool=t.activeTool,vt.Z.pane()||vt.Z.updateAttribute("pane",t.model),this.isIndicatorPane=t.model.getIsIndicatorPane(),this.recountScale()}componentDidMount(){var t,e;const{model:i}=this.props;this.chartLayoutModel.bind("theme",this.renderAll),this.chartLayoutModel.bind("theme",this.renderCross);const s=null!==(t=it())&&void 0!==t?t:[];[...i.getAllElements(),...i.getAllChartEvents(!1)].forEach((t=>{if(this.onElementCreate(t),t.isDrawing()){var e;if(s.some((e=>{let{elementId:i}=e;return t.elementId===i})))null===(e=t.instance)||void 0===e||e.updateScales();t.instance.cachePointPositionTimestamp()}else if(t.isChartEvent()){var i;null===(i=t.instance)||void 0===i||i.updateScales()}})),null==i||i.updateChartEventsZIndexes(),this.canvas=this.canvasRef.current,this.canvasCtx=(0,ce.h)(this.canvasRef.current),this.crossCanvas=this.crossCanvasRef.current,this.crossCanvasCtx=(0,ce.h)(this.crossCanvasRef.current),this.paneHammer=new(le().Manager)(this.paneRef.current,{touchAction:"none"}),this.paneHammer.add(new(le().Press)({threshold:5,time:500})),this.paneHammer.on("press",this.onPress),this.canvasWrapperHammer=new(le())(this.canvasWrapperRef.current,{touchAction:"none"}),this.canvasWrapperHammer.on("tap",this.onClick),null===(e=this.canvasWrapperRef.current)||void 0===e||e.addEventListener("touchmove",this.onTouchMove,{passive:!1}),!this.chartLayoutModel.scrollable&&this.isMobile||(this.scalerRef.current&&(this.scalerHammer=new(le())(this.scalerRef.current,{touchAction:"none"}),this.scalerHammer.on("doubletap",this.onScalerReset)),this.zoomerRef.current&&(this.zoomerHammer=new(le())(this.zoomerRef.current,{touchAction:"none"}),this.zoomerHammer.on("doubletap",this.props.onZoomerReset)),this.canvasWrapperHammer.on("doubletap",this.onDoubleClick)),this.onChartUpdate({width:this.props.chartModel.width}),this.onModelUpdate({height:i.height}),this.forceUpdate(),this.chartLayoutModel.trigger(ge)}componentWillUnmount(){var t;null===(t=this.canvasWrapperRef.current)||void 0===t||t.removeEventListener("touchmove",this.onTouchMove),(0,G.Bs)(this.canvas),(0,G.Bs)(this.crossCanvas),this.props.chartModel.unbind("update",this.onChartUpdate),this.props.chartModel.unbind("change",this.recountScale),this.quoteModel.unbind("change",this.recountScale)}render(){const{activeTool:t,touchEventsDisabled:e,onPaneClick:i,paneIndex:s,chartIndex:n,model:a}=this.props;if(e){var r,l,h,c;null===(r=this.paneHammer)||void 0===r||r.set({touchAction:"auto"}),null===(l=this.scalerHammer)||void 0===l||l.set({touchAction:"auto"}),null===(h=this.zoomerHammer)||void 0===h||h.set({touchAction:"auto"}),null===(c=this.canvasWrapperHammer)||void 0===c||c.set({touchAction:"auto"})}else{var d,u,m,g;const t=this.getIsHammerAllowScrollActive()?"auto":"none";null===(d=this.scalerHammer)||void 0===d||d.set({touchAction:"none"}),null===(u=this.zoomerHammer)||void 0===u||u.set({touchAction:"none"}),null===(m=this.paneHammer)||void 0===m||m.set({touchAction:t}),null===(g=this.canvasWrapperHammer)||void 0===g||g.set({touchAction:t})}return o().createElement("div",{className:"pane",ref:this.paneRef,onMouseMove:this.onPaneMouseMove,onMouseLeave:this.onPaneMouseLeave,onClick:()=>i(a),onTouchStart:()=>i(a),onContextMenu:this.onContextMenu,"data-testid":"chart-".concat(n,"-pane-").concat(s)},0!==s&&o().createElement("div",{className:"resizer",onMouseDown:t=>this.props.onResizerMouseDown(t,a),"data-testid":"chart-".concat(n,"-pane-").concat(s,"-resizer")}),this.chartLayoutModel.initialScrollable&&o().createElement("div",{className:W()("scaler absolute right-0 z-10 block w-[42px] cursor-[ns-resize] select-none",{"bottom-[10px] top-[10px]":this.isIndicatorPane,"bottom-[30px] top-[20px]":!this.isIndicatorPane}),ref:this.scalerRef,onMouseDown:this.onScalerMouseDown,onMouseEnter:this.onScalerMouseEnter,onTouchStart:this.onScalerTouchStart,onDoubleClick:this.onScalerReset,"data-testid":"chart-".concat(n,"-pane-").concat(s,"-scaler")}),this.chartLayoutModel.initialScrollable&&a.getIsChartPane()&&o().createElement(o().Fragment,null,o().createElement("div",{className:"zoomer",ref:this.zoomerRef,onMouseDown:this.props.onZoomerMouseDown,onMouseMove:this.onZoomerMouseMove,onTouchStart:this.props.onZoomerTouchStart,onDoubleClick:this.props.onZoomerReset,"data-testid":"chart-".concat(n,"-pane-").concat(s,"-zoomer")}),o().createElement(Be,{chartModel:this.props.chartModel,zoomControlsRef:this.zoomControlsRef,isVisible:t===Pe.U.Mouse&&null===a.selection,onZoomIn:()=>{this.props.onAddToZoomFactor({diff:.1,shouldCalculateRightAlign:!0})},onZoomOut:()=>{this.props.onAddToZoomFactor({diff:-.1,shouldCalculateRightAlign:!0})},onZoomReset:this.props.onZoomerReset})),o().createElement("div",{className:"canvas outline-none",ref:this.canvasWrapperRef,tabIndex:0,"data-testid":"chart-".concat(n,"-pane-").concat(s,"-canvas"),onMouseDown:this.isMobile?void 0:this.onCanvasInteractionStart,onMouseMove:this.isMobile?void 0:this.onCanvasInteractionMove,onMouseLeave:this.onMouseLeave,onTouchStart:this.isMobile?this.onTouchStart:void 0,onTouchEnd:this.onTouchEnd,onBlur:this.onBlur},o().createElement("canvas",{ref:this.canvasRef},(0,ke.nD)(this.quoteModel)),this.chartLayoutModel.cross&&o().createElement("canvas",{className:"second",ref:this.crossCanvasRef})))}getIsUpdatedDesign(){const{specificChartFunctionality:t}=this.chartLayoutModel,e=t===P.oK.chartPage,i=(0,K.yG)()&&[P.oK.futuresPage,P.oK.forexPage,P.oK.cryptoPage].includes(t);return e||i}}const ze=(0,l.withNotificationContext)(function(t){return function(e){const i=r.useContext(Z);return r.createElement(t,O({},e,{openElementStyleDialog:i}))}}((Xe=Ze,function(t){const e=(0,lt.l)(t.model,{watchProperties:["selection"]});return o().createElement(Xe,Ee({},t,{model:e}))})));var Xe;i(7987);function He(t){let{shouldDisplay:e,className:i}=t;const[s,n]=o().useState(e);return o().useEffect((()=>{let t;return e||(t=window.setTimeout((()=>{n(!1)}),400)),()=>{clearTimeout(t)}}),[e]),o().createElement(o().Fragment,null,s&&o().createElement("div",{className:W()("absolute left-0 top-0 z-50 flex h-full w-full items-center justify-center overflow-hidden transition-opacity duration-300 ease-linear",{"opacity-100":e,"opacity-0":!e},i),"data-testid":"chart-spinner-overlay"},o().createElement(l.Spinner,null)))}const We="div";function Ue(){return Ue=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(t[s]=i[s])}return t},Ue.apply(this,arguments)}function Ye(){return Ye=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(t[s]=i[s])}return t},Ye.apply(this,arguments)}function qe(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function Ve(t){t.preventDefault()}class je extends o().Component{constructor(t){var e;super(t),e=this,qe(this,"lastWidth",void 0),qe(this,"mouseWheelTimeout",void 0),qe(this,"setStateWithPanesTimeout",void 0),qe(this,"lastHeight",0),qe(this,"lastY",null),qe(this,"lastX",null),qe(this,"resizerPaneIndex",-1),qe(this,"minimalPaneHeight",0),qe(this,"zoomerRightAlign",null),qe(this,"handleSetPanesWrapperRef",(t=>{this.setState({panesWrapperElement:t})})),qe(this,"onMouseWheel",(t=>{const{chartModel:e,layoutModel:i}=this.props,s=e.panes().count()<1;i.isWheelZoomEnabled&&!s&&(this.zoomerRightAlign||this.calcZoomerRightAlign(),clearTimeout(this.mouseWheelTimeout),this.mouseWheelTimeout=window.setTimeout((()=>{this.zoomerRightAlign=null}),250),this.onZoomerMouseMove(t,void 0,!0))})),qe(this,"onClick",(t=>{var e;this.props.layoutModel.activeChart.eql(this.props.chartModel)&&(null!==(e=this.props.layoutModel.activePane)&&void 0!==e&&e.eql(t)||this.props.layoutModel.activePane===t)||this.props.layoutModel.updateAttributes({activeChart:this.props.chartModel,activePane:t})})),qe(this,"onPaneCreate",(()=>{const{chartModel:t}=this.props;this.onModelChange(),this.calculateMinimalPaneHeight(),t.trigger("change",t)})),qe(this,"onPaneDestroy",(t=>{const{chartModel:e}=this.props,i=e.panes().find(t);i&&(i.destroyCascade(),this.onModelChange(),e.trigger("change",e))})),qe(this,"onModelChange",(t=>{const{chartModel:e,config:i}=this.props,s=e.getAllPanes(),a=e.quote();if(0===s.length||!a||void 0===e.leftOffset)return;const{width:r,height:o}=e;let l=s.reduce(((t,e)=>{var i;return t+(null!==(i=e.height)&&void 0!==i?i:0)}),0);if(l!==o){l=s.reduce(((t,e)=>{const i=Math.round(e.height/l*o);return Number.isNaN(i)||e.updateAttribute("height",i),t+i}),0);const t=e.getChartPane();if(t&&l!==o){const e=t.height+o-l;Number.isNaN(e)||t.updateAttribute("height",e)}}const h=(0,n.rI)({quote:a,chartModel:e,config:i}),c=e.leftOffset!==h,d=e.isScrolled;d||this.lastWidth===r?d!==c&&e.updateAttributes({isScrolled:c}):(this.lastWidth=r,e.updateAttribute("leftOffset",h)),this.lastHeight!==o&&(this.lastHeight=o,this.calculateMinimalPaneHeight()),t&&this.handleQuoteChange(t.quote())})),qe(this,"onLayoutModelChange",(t=>{let{activeChart:e,activePane:i}=t;const{chartModel:s}=this.props;if(e)for(const t of s.getAllPanes()){var n;(null==i?void 0:i.id)!==t.id&&!0===(null===(n=t.selection)||void 0===n?void 0:n.isSelected)&&(t.selection.setIsSelected(!1),t.updateAttribute("selection",void 0))}})),qe(this,"onResizerMouseDown",((t,e)=>{0===t.button&&(this.lastY=t.clientY,this.resizerPaneIndex=this.props.chartModel.panes().all().findIndex((t=>t.eql(e))),document.addEventListener("mousemove",this.onResizerMouseMove),document.addEventListener("mouseup",this.onResizerMouseUp))})),qe(this,"onResizerMouseMove",(t=>{this.resizerPaneIndex>0&&null!==this.lastY&&this.resizePanesAccordingly(this.lastY-t.clientY)&&(this.lastY=t.clientY)})),qe(this,"onResizerMouseUp",(t=>{const{chartModel:e}=this.props;this.resizerPaneIndex>0&&null!==this.lastY&&(this.resizePanesAccordingly(this.lastY-t.clientY),this.lastY=null,e.trigger("change",e)),document.removeEventListener("mousemove",this.onResizerMouseMove),document.removeEventListener("mouseup",this.onResizerMouseUp)})),qe(this,"onZoomerTouchStart",(t=>{this.props.layoutModel.scrollable&&1===t.touches.length&&!this.props.touchEventsDisabled&&this.onZoomerMouseDown(t.targetTouches[0])})),qe(this,"onZoomerTouchMove",(t=>{this.props.layoutModel.scrollable&&1===t.touches.length&&this.onZoomerMouseMove(t.targetTouches[0])})),qe(this,"onZoomerTouchEnd",(()=>{this.props.layoutModel.scrollable&&this.onZoomerMouseUp()})),qe(this,"getRawDistance",(t=>{const e={x:t.touches[0].clientX,y:t.touches[0].clientY},i={x:t.touches[1].clientX,y:t.touches[1].clientY};return yt.ZP.distance(e,i)})),qe(this,"onPinchStart",(t=>{const{chartModel:e}=this.props,{activeChartInteraction:i,setActiveChartInteraction:s,touchEventsDisabled:n}=this.props,a=e.panes().count()<1;!this.props.layoutModel.scrollable||2!==t.touches.length||i||a||n||(s("pinch"),this.onZoomerMouseDown({clientX:this.getRawDistance(t)}),document.addEventListener("touchmove",this.onPinchMove),document.addEventListener("touchend",this.onPinchEnd))})),qe(this,"onPinchMove",(t=>{2===t.touches.length&&this.onZoomerMouseMove({clientX:this.getRawDistance(t)})})),qe(this,"onPinchEnd",(t=>{1===t.touches.length&&(this.onZoomerMouseUp(),document.removeEventListener("touchmove",this.onPinchMove),document.removeEventListener("touchend",this.onPinchEnd))})),qe(this,"calcZoomerRightAlign",(()=>{const{chartModel:t}=this.props,{ChartSettings:e}=t.getChartLayoutSettings(),i=t.quote(),s=t.panes().first().scale.x,a=(0,G.zG)({zoomFactor:t.zoomFactor,chartLayout:this.props.layoutModel}),r=(0,n.rI)({quote:i,chartModel:t,config:this.props.config,barWidth:a});if(this.zoomerRightAlign=null,i.isIntraday&&i.instrument===j.Yx.Stock){const e=i.getBarIndex(i.close.length-1);let s=t.leftOffset-(0,n.rI)({quote:i,chartModel:t,config:this.props.config,barWidth:a,barIndex:e,shouldAlignDaysToLeftApplied:!1});const r=~~(s/a);s-=r*a,this.zoomerRightAlign={barIndex:e,index:e-r,offsetDiff:s}}else if(t.leftOffset<=r)this.zoomerRightAlign={index:i.getBarIndex(i.open.length-1),offsetDiff:t.leftOffset-r};else{const r=t.leftOffset;for(let o=0;o<i.open.length;o+=1){const l=s(o);if(!(l+r<0)&&l+r>t.width-e.left.width-e.right.width){const e=i.getBarIndex(o-1);let s=r-(0,n.rI)({quote:i,chartModel:t,config:this.props.config,barWidth:a,barIndex:e});const l=~~(s/a);s-=l*a,this.zoomerRightAlign={barIndex:e,index:e-l,offsetDiff:s};break}}}})),qe(this,"onZoomerMouseDown",(t=>{var e;if((0===t.button||!("button"in t))&&this.props.layoutModel.scrollable){switch(this.props.activeChartInteraction){case"pinch":break;case null:this.props.setActiveChartInteraction("zoomer");break;default:return}this.lastX=null!==(e=t.clientX)&&void 0!==e?e:null,this.calcZoomerRightAlign(),document.addEventListener("mousemove",this.onZoomerMouseMove),document.addEventListener("mouseup",this.onZoomerMouseUp),document.addEventListener("touchmove",this.onZoomerTouchMove),document.addEventListener("touchend",this.onZoomerTouchEnd)}})),qe(this,"normalizeWheelDeltaY",(t=>{const e=Math.abs(t.deltaY);return 0===e?0:Math.log(e)*Math.sign(t.deltaY)*10})),qe(this,"onZoomerMouseMove",(function(t,i){let s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const{chartModel:n,layoutModel:a}=e.props;let r;a.scrollable&&(s||null===e.lastX?r=e.normalizeWheelDeltaY(t)/1e3:(r=(e.lastX-t.clientX)/n.width,e.lastX=t.clientX),e.addToZoomFactor({diff:-r}))})),qe(this,"addToZoomFactor",(t=>{let{diff:e,shouldCalculateRightAlign:i=!1}=t;const{chartModel:s,layoutModel:a}=this.props;i&&this.calcZoomerRightAlign();const r=s.zoomFactor*(6/(0,G.zG)({chartLayout:this.props.layoutModel})),o=function(t){let{chartLayout:e,currentZoomFactor:i,diff:s,minBarWidthInPx:n=1,maxBarWidthInPx:a=66}=t;const r=(0,G.GX)({chartLayout:e,chartVisibleWidth:n,numOfVisibleBars:1}),o=(0,G.GX)({chartLayout:e,chartVisibleWidth:a,numOfVisibleBars:1}),l=s<0,h=i+s,c=Math.min(Math.max(r,h),o);return h>c&&i>c?l?h:i:h<c&&i<c?l?i:h:c}({chartLayout:a,currentZoomFactor:s.zoomFactor,diff:e*r}),l=(0,G.zG)({zoomFactor:o,chartLayout:this.props.layoutModel});let h;if(this.props.config.stretch)h=0;else if((0,n.te)(this.props.layoutModel.specificChartFunctionality))h=l;else{if(!this.zoomerRightAlign)return;h=(0,n.az)({newLeftOffset:(0,n.rI)({quote:s.quote(),chartModel:s,config:this.props.config,barWidth:l,barIndex:this.zoomerRightAlign.index,shouldAlignDaysToLeftApplied:!1})+this.zoomerRightAlign.offsetDiff,chartModel:s,barWidth:l,barIndex:(0,n.uG)(s.quote())})}s.updateAttributes({zoomFactor:o,leftOffset:h,dateRange:null}),i&&(this.zoomerRightAlign=null)})),qe(this,"onZoomerMouseUp",(()=>{this.zoomerRightAlign=null,document.removeEventListener("mousemove",this.onZoomerMouseMove),document.removeEventListener("mouseup",this.onZoomerMouseUp),document.removeEventListener("touchmove",this.onZoomerTouchMove),document.removeEventListener("touchend",this.onZoomerTouchEnd),this.props.setActiveChartInteraction(null)})),qe(this,"onZoomerReset",(()=>{const{chartModel:t,layoutModel:e}=this.props,i=t.chart_layout().defaultZoomFactor,s=(0,G.zG)({zoomFactor:i,chartLayout:e}),a=(0,n.rI)({quote:t.quote(),chartModel:t,config:this.props.config,barWidth:s});t.updateAttributes({zoomFactor:i,leftOffset:a,dateRange:null})})),qe(this,"onOlderDataLoaded",(()=>{throw new Error("onOlderDataLoaded not implemented")})),qe(this,"resetMouseModel",(()=>{this.props.chartModel.panes().count()<1||vt.Z.updateAttributes({position:null,pane:null})})),qe(this,"handleQuoteChange",(t=>{const{chartModel:e}=this.props;if(e.dateRange){if(!t.eql(e.quote())||e.timeframe!==t.timeframe||0===t.date.length)return;(0,n.qu)({chartModel:e,quote:t})}})),qe(this,"onDataLoaded",((t,e)=>{const{chartModel:i}=this.props,s=i.quote();if(null==s||!s.eql(t))return;const a=e===xt.p.Refetch;let r=i.leftOffset;(!1===this.props.layoutModel.scrollable&&!this.props.layoutModel.isTouchCrossActive||!i.isScrolled||a)&&(r=(0,n.rI)({quote:s,chartModel:i,config:this.props.config})),i.setChartEvents(s.chartEvents,!s.events),r!==i.leftOffset&&i.getAllElements().forEach((t=>{t.isDrawing()&&!t.isMouseDown()&&t.instance.updateScales()})),i.updateAttribute("leftOffset",r),this.handleQuoteChange(s)})),this.lastWidth=t.chartModel.width,this.props.layoutModel.bind("change",this.onLayoutModelChange),this.state={panesWrapperElement:null}}componentDidMount(){const{chartModel:t}=this.props;this.lastWidth=this.props.layoutModel.width,t.trigger("change",t),t.bind("createPane",this.onPaneCreate),this.calculateMinimalPaneHeight(),this.handleQuoteChange(t.quote()),this.onModelChange(),t.bind("update",this.onModelChange),t.bind("destroy",(()=>{bt.Z.unbind("olderData",this.onOlderDataLoaded),bt.Z.unbind("".concat(xt.p.Refetch," ").concat(xt.p.NewerData),this.onDataLoaded)})),bt.Z.bind("olderData",this.onOlderDataLoaded),bt.Z.bind("".concat(xt.p.Refetch," ").concat(xt.p.NewerData),this.onDataLoaded)}componentDidUpdate(t,e){var i,s;e.panesWrapperElement===this.state.panesWrapperElement&&t.layoutModel.isWheelZoomEnabled===this.props.layoutModel.isWheelZoomEnabled||(null===(i=e.panesWrapperElement)||void 0===i||i.removeEventListener("wheel",Ve),this.props.layoutModel.isWheelZoomEnabled&&(null===(s=this.state.panesWrapperElement)||void 0===s||s.addEventListener("wheel",Ve,{passive:!1})))}componentWillUnmount(){var t;const{chartModel:e,layoutModel:i}=this.props;this.setStateWithPanesTimeout&&clearTimeout(this.setStateWithPanesTimeout),i.unbind("change",this.onLayoutModelChange),e.unbind("update",this.onModelChange),null===(t=this.state.panesWrapperElement)||void 0===t||t.removeEventListener("wheel",Ve)}render(){const{activeTool:t,chartIndex:e,layoutModel:i,chartModel:s,renderChartToolbar:n}=this.props,a=i.specificChartFunctionality===P.oK.futuresPage?s.getAllValidPanes():s.getAllPanes(),r=i.editors.includes(P.fu.settings);return o().createElement(o().Fragment,null,o().createElement(re,{chartModel:s}),o().createElement("div",{onClick:()=>this.onClick(void 0),"data-testid":"chart-".concat(e,"-settings"),onMouseEnter:this.resetMouseModel},r&&o().createElement(jt,{key:i.layout,chartIndex:e,chartModel:s})),i.editable&&r&&n&&o().createElement("div",{className:"border border-gray-100 dark:border-gray-600"},n()),o().createElement("div",{ref:this.handleSetPanesWrapperRef,onTouchStart:this.onPinchStart,onMouseLeave:K.ZP.isMobile()?void 0:this.resetMouseModel,onWheel:this.onMouseWheel},a.map(((i,n)=>o().createElement(ze,{key:i.id,paneIndex:n,chartIndex:e,model:i,activeTool:t,chartModel:s,onAddToZoomFactor:this.addToZoomFactor,onPaneClick:this.onClick,onPaneDestroy:this.onPaneDestroy,onResizerMouseDown:this.onResizerMouseDown,onZoomerMouseDown:this.onZoomerMouseDown,onZoomerReset:this.onZoomerReset,onZoomerTouchStart:this.onZoomerTouchStart,setActiveChartInteraction:this.props.setActiveChartInteraction,activeChartInteraction:this.props.activeChartInteraction,touchEventsDisabled:this.props.touchEventsDisabled})))))}calculateMinimalPaneHeight(){const{chartModel:t}=this.props,{minHeight:e,total:i}=t.panes().all().reduce(((t,e)=>{let{minHeight:i,total:s}=t;return i>e.height&&(i=e.height),s+=e.getIsChartPane()?3:1,{minHeight:i,total:s}}),{minHeight:t.height,total:0}),s=Math.floor(t.height/i);this.minimalPaneHeight=Math.min(e,s)}resizePanesAccordingly(t){const{chartModel:e}=this.props,i=e.panes().all();let s=this.resizerPaneIndex;if(!t)return!0;if(t>0){let e=s,n=i[e];for(n.height+t>=this.minimalPaneHeight?n.updateAttribute("height",n.height+t):n.updateAttribute("height",this.minimalPaneHeight),--e;e>=0;e--){if(n=i[e],n.height-t>=this.minimalPaneHeight){n.updateAttribute("height",n.height-t);break}n.updateAttribute("height",this.minimalPaneHeight)}}else if(t<0){s=Math.max(0,s-1);let e=s,n=i[e];for(n.height-t>=this.minimalPaneHeight?n.updateAttribute("height",n.height-t):n.updateAttribute("height",this.minimalPaneHeight),++e;e<i.length;e++){if(n=i[e],n.height+t>=this.minimalPaneHeight){n.updateAttribute("height",n.height+t);break}n.updateAttribute("height",this.minimalPaneHeight)}}const n=i.reduce(((t,e)=>t+e.height),0);if(n!==e.height){t=e.height-n;const a=i[s];return a.updateAttribute("height",a.height+t),!1}return!0}}const _e=function(t){return function(e){const{WrapperComp:i=We,gridArea:s}=e,a=o().useRef(!1),r=(0,lt.l)(e.chartModel,{watchProperties:["panes","quote"]}),l=(0,lt.l)(e.layoutModel,{watchProperties:["activeChart"]}),h=r.quote(),c=o().useRef((async()=>{const{chartModel:t,config:i}=e,{premarket:s,hasChartEvents:r,aftermarket:o,ticker:l,instrument:h,timeframe:c,panes:d}=i,u={premarket:s,aftermarket:o,events:r,patterns:d.some((t=>{var e;return null===(e=t.elements)||void 0===e?void 0:e.some((t=>{var e;return null===(e=t.overlays)||void 0===e?void 0:e.some((t=>"overlays/patterns"===t.type))}))}))},m=await bt.Z.get({ticker:l,instrument:h,timeframe:c,options:u}),g=d.filter((t=>{let{elements:e}=t;return e.some((t=>{let{type:e}=t;return"indicators/perf"===e}))}));if(g&&await Promise.allSettled(g.map((t=>(0,G.ow)({paneWithPerfIndicator:t,timeframe:c})))),!a.current){if(i.panes.forEach((e=>{const i=M()({},e);i.chart=t,t.createPaneCascade(i)})),t.setChartEvents(m.chartEvents,!0),t.updateAttributes({quote:m,premarket:u.premarket,aftermarket:u.aftermarket}),e.shouldResize){const t=(0,K.U$)(e.layoutModel.getHTMLElementId());e.layoutModel.updateAttributes(t)}if(null==t.leftOffset){const i=(0,n.rI)({quote:m,chartModel:t,config:e.config});t.updateAttribute("leftOffset",i)}}}));o().useEffect((()=>{const t=()=>{a.current=!0};return r.bind("beforeDestroy",t),c.current(),()=>{r.unbind("beforeDestroy",t)}}),[]);const d=e.layoutModel.specificChartFunctionality===P.oK.quotePage,u=e.layoutModel.specificChartFunctionality===P.oK.chartPage,m=[P.oK.futuresPage,P.oK.forexPage,P.oK.cryptoPage].includes(e.layoutModel.specificChartFunctionality),g=h&&(void 0===h.fetchedAt&&h.close.length>0||h.fetchedAt>0||h),f=!g&&d?{width:r.width?r.width+2:"100%",height:r.height+2}:void 0;return o().createElement(i,Ue({className:W()("chart flex-1 dark:bg-gray-800 relative",{active:d,"overflow-hidden":m&&(0,K.yG)(),"outline outline-1 outline-blue-400":l.activeChart.eql(r)&&e.hasOutline})},i!==We?{gridArea:s}:{},{"data-testid":"chart-".concat(e.chartIndex,"-container"),style:f}),u&&o().createElement(He,{className:W()({"bg-white":d,"bg-gray-50 dark:bg-gray-800":u}),shouldDisplay:!g}),g&&o().createElement(t,e))}}(function(t){return function(e){const i=(0,lt.l)(e.chartModel,{watchProperties:["panes"]});return o().createElement(t,Ye({},e,{model:i}))}}(je));i(9208);var Qe=i(7005),Ke=i.n(Qe),Ge=i(9587);function Je(t){let{ticker:e,instrument:i,period:s,id:n}=t;const a={t:e,p:s,i:n},r=i===j.Yx.Stock,o=/\/quote\b/.test(window.location.pathname),l=o&&r,h=!o||r?window.location.pathname:"/charts.ashx";return"".concat(h,"?").concat(Ge.stringify({...a,...l?{ta:"2"}:{l:"1h1v"}}))}function $e(){const[t,e]=(0,r.useState)(!1),[i,s]=(0,r.useState)(!1),[n,a]=(0,r.useState)(!1),[h,c]=(0,r.useState)([]),{i:d}=(0,wt.N)();(0,r.useEffect)((()=>{!async function(){var t,i;null===(t=(i=window).gtag)||void 0===t||t.call(i,"event","load",{event_category:"ideas"});try{const t=(await(0,J.ZP)({location:"/api/ideas_load.ashx",throwOnStatusCodes:[404]})).ideas.map((t=>({...t,instrument:(0,G.mQ)(t.ticker)})));c(t),s(!0)}catch{e(!0)}}()}),[]);const u=(0,r.useRef)((async t=>{var e,i,s,n,r,o;if(!window.confirm("Do you really want to delete this idea?"))return;const l=[["id",t.id],["ticker",t.ticker],["queryString",document.location.search],["locationPathname",document.location.pathname],["currentIdea",d]].map((t=>t.join("="))).join("&");a(!0);const h=await fetch("/api/idea_delete.ashx",{body:l,headers:{"Content-Type":"application/x-www-form-urlencoded"},method:"post"});if(d===String(t.id))return void(window.location.href=h.url);(null!==(e=null===(i=window.FinvizChartsSettings)||void 0===i||null===(s=i.ideaChart)||void 0===s||null===(n=s.idea)||void 0===n?void 0:n.id)&&void 0!==e?e:null===(r=window.globalChartConfig)||void 0===r||null===(o=r.idea)||void 0===o?void 0:o.id)!==t.id?(c((e=>e.filter((e=>e.id!==t.id)))),a(!1)):window.location.reload()}));return!i||t?o().createElement("div",{className:"flex h-40 items-center justify-center text-sm font-bold"},t?"Unexpected error occured, please refresh the page.":"Loading…"):0===h.length?o().createElement("div",{"data-testid":"charts-notice-ideas-no-ideas",className:"flex h-40 items-center justify-center text-sm font-bold"},"No saved ideas."):o().createElement(o().Fragment,null,h.map((t=>o().createElement("div",{key:t.id,className:"-mx-2 flex cursor-pointer items-center justify-between rounded p-2 hover:bg-gray-100 dark:hover:bg-gray-700",onClick:()=>document.location=Je(t)},o().createElement("div",{className:"flex flex-col overflow-hidden"},o().createElement("h1",{className:"m-0 font-bold"},t.ticker,t.company&&" - "+t.company),o().createElement("span",{className:"text-sm","data-testid":"charts-notice-idea-date"},t.date),""!==t.note?o().createElement("p",{className:"overflow-hidden text-ellipsis whitespace-nowrap text-xs"},t.note):null),o().createElement("div",{className:"flex space-x-2"},o().createElement(l.Button,{"data-testid":"charts-notice-idea-load-btn"},"Load"),o().createElement(l.Button,{"data-testid":"charts-notice-idea-delete-btn",disabled:n,theme:"red",onClick:e=>{e.stopPropagation(),u.current(t)}},"Delete"))))))}function ti(t){return o().createElement(l.Dialog,{state:t.state,"aria-label":"Your ideas","data-testid":"charts-ideas-modal",className:"w-145"},o().createElement(l.DialogHeader,{onCloseClick:()=>t.state.hide()},"Your ideas"),o().createElement(l.DialogBody,{className:"space-y-1"},o().createElement($e,null)),o().createElement(l.DialogFooter,null,o().createElement(l.Button,{onClick:()=>t.state.hide(),"data-testid":"charts-ideas-modal-cancel"},"Close")))}function ei(t){let{model:e,rounding:i,theme:s="headerItem",dropdownButtonClassName:n}=t;const a=(0,l.useTooltipState)({placement:"right-start"}),[o,h]=r.useState(!1),c=r.useRef(null),d=(0,l.useDialogState)(),u=(0,l.useDropdownState)(),m=a.hide;return r.useEffect((()=>{const t=()=>{const t=bt.Z.select((t=>t.isFetching&&-1===t.fetchedAt));h(t.length>0)};return bt.Z.bind("change",t),()=>{bt.Z.unbind("change",t)}}),[]),r.useEffect((()=>{o&&u.visible||m()}),[o,u.visible,m]),r.createElement(r.Fragment,null,r.createElement(l.Dropdown,{ref:c,state:u,"aria-label":"Idea",rounding:i,label:r.createElement(l.Button,{leftContent:"idea",theme:s,className:n,"data-testid":"chart-toolbar-ideas",contentClass:"hidden sm:flex",label:"Ideas"},"Ideas")},r.createElement(l.DropdownItem,{as:o?l.TooltipTrigger:void 0,state:o?a:void 0,leftContent:"ideaSave","data-testid":"charts-layout-save-idea-btn",closeOnClick:!1,className:"cursor-pointer",onClick:()=>{o?a.show():async function(t){var e,i,s;const n=t.activeChart,a=n.quote().toJSON(),{ticker:r,instrument:o,cid:l}=n,h=a.timeframe,{ChartSettings:c}=t.settings,d=t.toObject();d.layout=P.ms["1h1v"],d.barWidth=c.center.barWidth,d.barMargin=c.center.barMargin,d.charts=d.charts.filter((t=>t.chartId===l)).map((t=>({...t,dateRange:null,refreshData:!1}))),delete d.charts[0].chartId;const u=(t=>{let e=[],i="";for(const e of t)for(const t of e.elements)"indicators/perf"===t.type&&(i=t.tickers);return e=i.split(",").filter((t=>t)),e.includes(r)||e.push(r.replace("@","")),e})(d.charts[0].panes),m=bt.Z.select((e=>u.includes(e.ticker)&&e.timeframe===n.timeframe&&t.isIdeaId(e.ideaID))).filter(((t,e,i)=>i.findIndex((e=>e.ticker===t.ticker))===e)),g=JSON.stringify(m.map((t=>Ke()(t.toJSON(),["ideaID","chartUuid"])))),f=JSON.stringify(d),p=(null===(e=t.idea)||void 0===e?void 0:e.note)||rt({ticker:r,elements:t.drawingsInternalStore().elements})||"";null===(i=(s=window).gtag)||void 0===i||i.call(s,"event","save",{event_category:"ideas"}),u.length!==m.length&&(0,k.Tb)(new Error("Idea saved with inconsistent quotes data"),{extra:{tickers:u,quoteTickersTimeframes:m.map((t=>({ticker:t.ticker,timeframe:t.timeframe}))),chartLayout:t.toConfig(["colors","panes"])}});const y=await(0,J.ZP)({location:"/api/idea_save.ashx",method:"POST",body:(0,J.LH)({ticker:r,period:h,chart:f,quotes:g,note:p})}),v=Je({ticker:r,period:h,instrument:o,id:y.id});setTimeout((()=>{window.open(v,"FinvizSavedIdea")}))}(e)}},"Save idea"),r.createElement(l.DropdownItem,{as:l.DialogTrigger,state:d,leftContent:"ideaLoad","data-testid":"charts-layout-load-idea-btn"},"Load idea")),r.createElement(ti,{state:d}),r.createElement(l.Tooltip,{state:a,className:"flex"},r.createElement("div",{className:"mt-1"},r.createElement(l.Spinner,{width:12})),r.createElement("span",{className:W()("ml-2",{"w-40":(0,K.HL)()})},"Some data is still loading. Please wait.")))}function ii(t){let{page:e,rounding:i,theme:s,dropdownButtonClassName:n}=t;const a=(0,l.useTour)(),o=function(t){return[{id:"chart-tour",steps:[{title:"Chart Tour",body:"Discover powerful Chart features in the 2-min tour to master your analysis of trading opportunities."},{title:"Scale the Timeline",body:"Grab the timeline to zoom it in and out. Double-click the timeline to reset the scaling.",target:'[data-testid="chart-0-pane-0-zoomer"]'},{title:"Scale the Price Axis",body:"Grab the Price Axis to zoom it in and out. Move the chart around freely in any direction when Price Axis has custom scale. Double-click the Price Axis to reset the scaling.",target:'[data-testid="chart-0-pane-0-scaler"]'},{title:"Drawing tools & settings",body:"Pick any Drawing Tool to analyze the market. Tailor your drawing experience with additional settings.",target:"#toolbar"},{title:"Fine-tune Drawings",body:"Double-click on a chart drawing to tweak its color and style. Right-click on a drawing to access other options, such as changing its visibility, order, and more.",target:'[data-testid="chart-0-pane-0"]'},{title:"Save your best Ideas",body:"Besides your drawings being autosaved, you can manually save ideas that you wish to revisit later.",target:'[data-testid="chart-toolbar-ideas"]'},...t===P.oK.quotePage?[]:[{title:"Chart Layouts & Charts Sync",body:"Switch between Chart Layouts to view multiple charts on your screen. Synchronize Ticker, Timeframe or Crosshair position across your charts.",target:'[data-testid="chart-layout-layout"]'}],...(0,K.Rp)(document.documentElement)||t!==P.oK.chartPage?[{title:"Fullscreen mode",body:t===P.oK.quotePage?"Open the chart in an expanded view for full-page display and split-screen charts.":"Toggle the window to fill your entire screen.",target:'[data-testid="chart-layout-fullscreen"]'}]:[],{title:"Publish chart",body:"Publish a chart together with your analysis and ideas.",target:'[data-testid="chart-toolbar-publish"]',overlayPadding:t===P.oK.quotePage?3:void 0},...(0,K.yG)()||t===P.oK.chartPage?[{title:"Theme",body:"Switch between the Light and Dark theme.",target:'[data-testid="chart-layout-theme"]'}]:[],{title:"Study Settings",body:"Customize the Chart Type and appearance. Add Overlays, Indicators and toggle Extended Hours.",target:'[data-testid="chart-settings-open-btn"]'}]},t===P.oK.chartPage&&{id:"sidebar-watchlist",steps:[{title:"Explore Your Portfolios",body:"Effortlessly navigate through your portfolio holdings. With just a click, visualize individual stock charts, gain insights, and stay updated on your investments.",target:'[data-testid="sidebar-portfolio-btn"]',placement:"left-start"}]}].filter(Boolean)}(e),[h,c]=r.useState(a.getStepsForUser(o));return r.createElement(l.Button,{theme:null!=s?s:h.hasNewTours?"blue":"headerItem",rounding:i,leftContent:a.isLoading?r.createElement(l.Delayed,{delayComponent:r.createElement(l.Icon,{name:"diamondOutlined",className:"text-white"})},r.createElement(l.Spinner,{width:16})):r.createElement(l.Icon,{name:"diamondOutlined"}),className:W()(n,{"mobile:hidden":!!n,"is-primary !mr-[5px]":h.hasNewTours&&e===P.oK.quotePage}),contentClass:e!==P.oK.quotePage?"hidden lg:flex":"",title:"Explore new features",onClick:async()=>{if(h){const t=await a.startTour(h.tour);null==t||t.once("inactive",(()=>{c(a.getStepsForUser(o))}))}}},"Chart tour")}function si(t){return o().createElement("div",{className:"notice js-notice"},o().createElement("div",{className:"flex items-stretch"},o().createElement(ei,{model:t.layoutModel,rounding:"none",theme:"outline",dropdownButtonClassName:"btn min-h-[30px]"}),window.FinvizSettings.hasUserPremium&&o().createElement("a",{href:"#",className:"tab-link",onClick:e=>{e.preventDefault(),t.handleAddNote()},"data-testid":"charts-notice-ideas-add-note-btn"},"+ Add a note")),o().createElement("div",null,o().createElement(ii,{page:t.layoutModel.specificChartFunctionality,rounding:"none",theme:"outline",dropdownButtonClassName:"btn min-h-[30px]"})))}var ni=i(321),ai=i(6035),ri=i(990);const oi={importFn:()=>i.e(550).then(i.bind(i,551)),cacheKey:"portfolio-watchlist"};function li(){return o().createElement("div",{className:"flex h-full w-full flex-col items-center p-2"},o().createElement("div",null,o().createElement(l.Paragraph,{className:"p-1.5 text-gray-600 dark:text-gray-200"},"The Sidebar Widget didn't load successfully. Please refresh the page."),o().createElement(l.Button,{className:"m-1.5 mt-2.5",onClick:()=>window.location.reload()},"Refresh Page")))}let hi;!function(t){t.portfolio="portfolio"}(hi||(hi={}));const ci=Object.freeze({[hi.portfolio]:{key:hi.portfolio,icon:"briefcase",description:"Portfolio watchlist",content:function(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return function(){const[i,s]=o().useState(!1),[n,{isLoading:r,isError:h}]=(0,a.w)({...t,shouldLoadModule:!0}),c=null==n?void 0:n.default;return h?o().createElement(li,null):o().createElement(o().Fragment,null,(r||!i&&e)&&o().createElement(l.Delayed,null,o().createElement("div",{className:"flex h-full w-full items-center justify-center"},o().createElement(l.Spinner,null))),!!c&&o().createElement(c,{setIsComponentReady:s}))}}(oi,!0),width:{min:200,default:{mobile:275}}}});var di=i(3040);function ui(t){var e,i,s,n,a,r;let{children:l}=t;const{direction:h,onResize:c,close:d,width:u}=(0,ri.S)(),m=null!==(e=null==u?void 0:u.min)&&void 0!==e?e:ni.H.min,g=null!==(i=null==u?void 0:u.max)&&void 0!==i?i:ni.H.max,f=null!==(s=null==u||null===(n=u.default)||void 0===n?void 0:n.mobile)&&void 0!==s?s:m,p=null!==(a=null==u||null===(r=u.default)||void 0===r?void 0:r.desktop)&&void 0!==a?a:g;return o().createElement(o().Fragment,null,h===ni.d.vertical&&o().createElement(di.e,{minWidth:m,maxWidth:g,enable:{left:(null==u?void 0:u.min)!==(null==u?void 0:u.max)||m<g},handleClasses:{left:"!w-1 !-left-0.5 hover:bg-blue-400 active:bg-blue-400"},className:"flex flex-col items-center",onResize:c,defaultSize:{width:K.ZP.isMobile()&&!K.ZP.isIPad()?f:p,height:"auto"}},l),h===ni.d.horizontal&&o().createElement(o().Fragment,null,o().createElement("div",{className:"fixed top-0 z-10 h-[52px] w-full",onClick:d}),o().createElement("div",{className:"fixed bottom-inset-bottom top-[52px] z-10 flex w-full flex-col items-center bg-white [--inset-b:47px] dark:bg-gray-800"},l)))}const mi="toolbar-mobile";function gi(t){let{className:e}=t;const{isOpen:i,direction:s,activeModule:n,selectModule:a}=(0,ri.S)(),r=(0,l.useTooltipState)({placement:"left",unstable_timeout:300});return o().createElement("div",{className:W()("flex shrink-0 border-t border-gray-100 bg-white p-1.5 pb-inset-bottom [--inset-b:0.5rem] dark:border-gray-700 dark:bg-gray-800",{"border-l":i&&s===ni.d.vertical,"flex-col space-y-2 ":s===ni.d.vertical,"flex-row":s===ni.d.horizontal},e)},s===ni.d.horizontal&&o().createElement("div",{id:mi,"data-testid":"".concat(mi,"-btn"),className:"relative ml-0 mr-auto w-20"}),Object.entries(ci).map((t=>{let[e,i]=t;const h=(null==n?void 0:n.key)===e;return o().createElement(o().Fragment,{key:e},o().createElement(l.TooltipTrigger,{state:r,"aria-label":i.description},o().createElement(l.Button,{appearance:"square",size:"medium",active:h,theme:"chipTransparent",onClick:()=>{a(h?void 0:i.key),r.hide()},className:W()({"ml-2":s===ni.d.horizontal}),"data-testid":"sidebar-".concat(e,"-btn")},o().createElement(l.Icon,{name:i.icon,width:24,className:"shrink-0"}))),o().createElement(l.Tooltip,{state:r},o().createElement(l.Paragraph,{size:"small"},i.description)))})))}const fi="sidebar";ai.localStorage.removeValue("sidebarModule");let pi=!1;function yi(t){let{onShouldResize:e,direction:i,tabsClassName:s}=t;const n=(0,Ct.useNavigate)(),[a]=(0,Ct.useSearchParams)(),r=a.get(fi)||null,[l,h]=o().useState(null),c=!!l,d=o().useCallback((t=>{const e=new URLSearchParams(a);t?e.set(fi,t):e.delete(fi),n({search:e.toString()},{replace:!0})}),[a,n]),u=o().useCallback((()=>{d(void 0)}),[d]);o().useEffect((()=>{e()}),[l,e]),o().useEffect((()=>{let t=r&&ci[r];!pi&&(0,K.jQ)()&&(t=null,u()),h(t),pi=!0}),[r,u]);const m=o().useMemo((()=>({direction:i,isOpen:c,isCloseVisible:i===ni.d.horizontal,width:null==l?void 0:l.width,activeModule:l,onResize:e,close:u,selectModule:d})),[i,c,e,l,u,d]);return o().createElement(ri.l.Provider,{value:m},l&&o().createElement(ui,null,o().createElement(l.content,null)),o().createElement(gi,{className:s}))}const vi={importFn:()=>i.e(454).then(i.bind(i,6615)),cacheKey:"drawing-creators"},bi={[Pe.M6.AddNote]:{id:Pe.M6.AddNote,title:"Add note",icon:"note"},[Pe.M6.DeleteDrawings]:{id:Pe.M6.DeleteDrawings,title:"Remove all drawings",icon:"drawingActionDelete"},[Pe.M6.DeleteAutoSavedDrawings]:{id:Pe.M6.DeleteAutoSavedDrawings,title:"Remove all autosaved drawings",icon:"drawingActionDelete"}},xi=t=>{let{isAutoSaveActive:e,isAddNoteAvailable:i=!1,isIdea:s}=t;return[...i?[{defaultItem:bi[Pe.M6.AddNote],isDisabled:s,disabledTooltip:"Add note is not available in ideas"}]:[],{defaultItem:bi[e?Pe.M6.DeleteAutoSavedDrawings:Pe.M6.DeleteDrawings]}]},Ci={[Pe.lu.PreserveDrawings]:{id:Pe.lu.PreserveDrawings,icon:"drawingSettingPreserveDrawings",iconActive:"drawingSettingPreserveDrawingsActive",title:"Preserve drawings: Off",titleActive:"Preserve drawings: On"},[Pe.lu.DrawingModeContinuous]:{id:Pe.lu.DrawingModeContinuous,icon:"drawingSettingDrawingMode",iconActive:"drawingSettingDrawingModeActive",title:"Drawing mode: Single",titleActive:"Drawing mode: Continuous"},[Pe.lu.HideDrawings]:{id:Pe.lu.HideDrawings,icon:"drawingSettingHide",iconActive:"drawingSettingShow",title:"Hide drawings",titleActive:"Show drawings"},[Pe.lu.LockDrawings]:{id:Pe.lu.LockDrawings,icon:"drawingSettingLock",iconActive:"drawingSettingUnlock",title:"Lock drawings",titleActive:"Unlock drawings"}},wi={id:Pe.lu.PreserveDrawings,icon:"drawingSettingAutosaveOff",iconActive:"drawingSettingAutosaveOn",iconAction:"drawingSettingAutosaveSaving",title:"Drawings autosave: Off",titleActive:"Drawings Autosave: On",titleAction:"Drawings Autosave: Saving"},Si=t=>{let{isPreserveDrawingsAndAutosaveAvailable:e,isIdea:i,isAutoSaveInProgress:s}=t;return[{defaultItem:Ci[Pe.lu.DrawingModeContinuous]},...e?[{defaultItem:wi,isDisabled:i,isInAction:s,disabledTooltip:"Autosave is not available in ideas"}]:[],{defaultItem:Ci[Pe.lu.HideDrawings]},{defaultItem:Ci[Pe.lu.LockDrawings]}]},Mi={[Pe.U.Mouse]:{id:Pe.U.Mouse,title:"Mouse",icon:"toolMouse"},[Pe.U.Measure]:{id:Pe.U.Measure,title:"Measure",icon:"toolMeasure"},[Pe.U.ScaledLine]:{id:Pe.U.ScaledLine,title:"Line",icon:"toolLine"},[Pe.U.Arrow]:{id:Pe.U.Arrow,title:"Arrow",icon:"toolArrow"},[Pe.U.VerticalLine]:{id:Pe.U.VerticalLine,title:"Vertical line",icon:"toolMidLineV"},[Pe.U.HorizontalLine]:{id:Pe.U.HorizontalLine,title:"Horizontal line",icon:"toolMidLineH"},[Pe.U.Rectangle]:{id:Pe.U.Rectangle,title:"Rectangle",icon:"toolRect"},[Pe.U.RotatedRectangle]:{id:Pe.U.RotatedRectangle,title:"Rotated rectangle",icon:"toolRectRotated"},[Pe.U.Triangle]:{id:Pe.U.Triangle,title:"Triangle",icon:"toolTriangle"},[Pe.U.Ellipse]:{id:Pe.U.Ellipse,title:"Ellipse",icon:"toolEllipse"},[Pe.U.Curve]:{id:Pe.U.Curve,title:"Curve",icon:"toolCurve"},[Pe.U.Pitchfork]:{id:Pe.U.Pitchfork,title:"Pitchfork",icon:"toolPitchfork"},[Pe.U.Polygon]:{id:Pe.U.Polygon,title:"Polygon",icon:"toolPolygon"},[Pe.U.Xabcd]:{id:Pe.U.Xabcd,title:"XABCD",icon:"toolXABCD"},[Pe.U.ScaledText]:{id:Pe.U.ScaledText,title:"Text",icon:"toolText"},[Pe.U.Brush]:{id:Pe.U.Brush,title:"Brush",icon:"toolBrush"},[Pe.U.ElliottWaves]:{id:Pe.U.ElliottWaves,title:"Elliott waves",icon:"toolElliottWave"},[Pe.U.FibonacciRetracements]:{id:Pe.U.FibonacciRetracements,title:"Fibonacci retracements",icon:"toolFibonacci"},[Pe.U.Position]:{id:Pe.U.Position,title:"Position",icon:"toolPosition"},[Pe.U.Callout]:{id:Pe.U.Callout,title:"Callout",icon:"toolCallout"}},Pi=[{defaultItem:Mi[Pe.U.Mouse]},{defaultItem:Mi[Pe.U.Measure]},{defaultItem:Mi[Pe.U.ScaledLine],toolGroup:[Mi[Pe.U.ScaledLine],Mi[Pe.U.VerticalLine],Mi[Pe.U.HorizontalLine],Mi[Pe.U.Curve]],toolGroupTitle:"Line tools"},{defaultItem:Mi[Pe.U.Arrow]},{defaultItem:Mi[Pe.U.Rectangle]},{defaultItem:Mi[Pe.U.RotatedRectangle]},{defaultItem:Mi[Pe.U.Triangle]},{defaultItem:Mi[Pe.U.Ellipse]},{defaultItem:Mi[Pe.U.Polygon]},{defaultItem:Mi[Pe.U.Xabcd],toolGroup:[Mi[Pe.U.Xabcd],Mi[Pe.U.Pitchfork]],toolGroupTitle:"XABCD tools"},{defaultItem:Mi[Pe.U.ScaledText],toolGroup:[Mi[Pe.U.ScaledText],Mi[Pe.U.Callout]],toolGroupTitle:"Text tools"},{defaultItem:Mi[Pe.U.Brush]},{defaultItem:Mi[Pe.U.ElliottWaves]},{defaultItem:Mi[Pe.U.FibonacciRetracements]},{defaultItem:Mi[Pe.U.Position]}],ki="Disabled due 'lock/hide' drawings active";function Ei(t){var e,i;let{isSidebar:s,isHorizontal:n,isMobileOverlay:r,activeTool:h,chartLayoutModel:c,onActiveToolChange:d,onDrawingActionClick:u,onDrawingSettingClick:m,onDrawingEnd:g,drawingSettings:f,isAlternativeTheme:p,areToolsDisabled:y}=t;const[v,{isLoading:b}]=(0,a.w)({...vi,shouldLoadModule:!0}),{autoSaveState:x}=(0,lt.l)(o().useMemo((()=>c.drawingsInternalStore()),[c]),{watchProperties:["autoSaveState"]}),[C,w]=o().useState(!1),S=o().useContext(Z),M=Si({isPreserveDrawingsAndAutosaveAvailable:[P.oK.chartPage,P.oK.quotePage].includes(c.specificChartFunctionality),isAutoSaveInProgress:x===_.FZ.Saving,isIdea:!(null===(e=c.idea)||void 0===e||!e.id)}),k=xi({isAutoSaveActive:x!==_.FZ.Off,isAddNoteAvailable:c.specificChartFunctionality===P.oK.chartPage,isIdea:!(null===(i=c.idea)||void 0===i||!i.id)});return o().useEffect((()=>{if(!v)return;const t=(t,e)=>{const i=f[Pe.lu.DrawingModeContinuous],s=t.chart().quote().close.length>0,n=f[Pe.lu.HideDrawings],a=Mi[h].id;if(a===Pe.U.Mouse||C||n||!s)return;w(!0);const{drawingToolsTouchCreatorsByType:r,drawingToolsCreatorsByType:o}=v,l=e.isTouch?r[a]:o[a],c=t.elements().create({instance:new l(e,{},t,S,(()=>{i||d(Pe.U.Mouse),w(!1),null==g||g()}))});c.one("destroy",(t=>{let{instance:e}=t;e.getIsCreator()&&(w(!1),null==g||g())})),c.trigger("select",c)};return de.Z.bind("mousedown",t),()=>{de.Z.unbind("mousedown",t)}}),[h,d,S,g,v,f,C]),o().createElement(l.Toolbar,{isMobile:r,direction:!n||s||r?"vertical":"horizontal",theme:p?"alternative":void 0,className:W()({"grid grid-cols-2 gap-1 space-y-0":r})},Pi.map((t=>{var e;const i=h===t.defaultItem.id||(null===(e=t.toolGroup)||void 0===e?void 0:e.some((t=>t.id===h))),s=b&&i;return o().createElement(l.ToolbarItem,{key:t.defaultItem.id,defaultItem:t.defaultItem,isActive:i,isLoading:s,groupItems:t.toolGroup,groupTitle:t.toolGroupTitle,onChange:d,disabled:t.defaultItem.id!==Pe.U.Mouse&&y,disabledTooltip:ki,useNativeSelect:!0!==r&&void 0})})),o().createElement(l.ToolbarDivider,{className:W()({"col-span-2":r})}),M.map((t=>o().createElement(l.ToolbarItem,{key:t.defaultItem.id,defaultItem:t.defaultItem,isActive:f[t.defaultItem.id],isInAction:t.isInAction,disabledTooltip:t.disabledTooltip,disabled:t.isDisabled,onChange:m}))),k.map((t=>o().createElement(l.ToolbarItem,{key:t.defaultItem.id,defaultItem:t.defaultItem,isActive:!1,disabled:t.isDisabled,disabledTooltip:t.disabledTooltip,onChange:u}))))}const Ti=Ei;function Ii(t){let{ticker:e,note:i,onNoteChange:s}=t;return o().createElement(l.Textarea,{"data-testid":"autosave-note-textarea-".concat(e),label:e,inputClass:"w-full",rows:4,value:i,onChange:t=>{s(t.target.value,e)}})}function Ai(t){let{chartLayoutModel:e}=t;const{handleAutoSaveNoteChange:i}=gt(e),[s,n]=o().useState([]),a=o().useMemo((()=>e.drawingsInternalStore()),[e]),r=(0,lt.l)(a,{watchProperties:["elements"]});o().useEffect((()=>{const t=()=>{const{tickers:t}=et(e);n(t)};return ht.Z.bind("change",t),t(),()=>{ht.Z.unbind("change",t)}}),[e]);const l=o().useMemo((()=>{const t={};return r.elements.forEach((e=>{"note"===e.containerType&&s.includes(e.ticker)&&(t[e.ticker]=at(e))})),t}),[r.elements,s]);return o().createElement("div",{className:"space-y-4"},s.map((t=>{var e;return o().createElement(Ii,{key:t,ticker:t,note:null!==(e=l[t])&&void 0!==e?e:"",onNoteChange:i})})))}function Li(t){let{dialogState:e,chartLayoutModel:i}=t;return o().createElement(l.Dialog,{isDraggable:!0,isBackdropDisabled:!0,state:e,"aria-label":"Chart notes",className:"w-96"},o().createElement(l.DialogHeader,{onCloseClick:()=>e.hide()},"Notes"),o().createElement(l.DialogBody,null,(e.visible||e.animating)&&o().createElement(Ai,{chartLayoutModel:i})))}function Di(t){let{onCancel:e,onAction:i,state:s,isAutosaveDialogContent:n=!1,tickers:a}=t;const r=(t=>{let{isAutosaveDialogContent:e,tickers:i}=t;return e?{title:"Remove all autosaved drawings?",message:o().createElement(o().Fragment,null,"Do you really want to remove all ",o().createElement("b",null,"autosaved")," drawings? This action is irreversible and will remove all non-idea drawings for ",o().createElement("b",null,i.join(", ")),".")}:{title:"Remove all drawings?",message:"Do you really want to remove all drawings? This action only affects the current page and visible tickers. This action doesn't remove autosaved drawings or ideas."}})({isAutosaveDialogContent:n,tickers:a});return o().createElement(l.ConfirmationDialog,{state:s,"aria-label":r.title,title:r.title,actions:o().createElement(o().Fragment,null,o().createElement(l.Button,{"data-testid":"confirmation-dialog-cancel",onClick:e},"Cancel"),o().createElement(l.Button,{"data-testid":"confirmation-dialog-delete",onClick:i,theme:"red"},"Remove"))},r.message)}function Oi(t){let{activeTool:e,onClick:i}=t;return o().createElement(l.Button,{appearance:"square",onClick:i,active:!0,theme:"chipTransparent",size:"medium"},o().createElement(l.Icon,{name:Mi[e].icon,width:32,className:"shrink-0"}))}function Ri(){return Ri=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(t[s]=i[s])}return t},Ri.apply(this,arguments)}function Fi(t){let{activeTool:e,onActiveToolChange:i,onDrawingActionClick:s,...n}=t;const[a,r]=o().useState(!1),[h,c]=(0,Ct.useSearchParams)(),[d,u]=o().useState(null);o().useEffect((()=>{u(document.getElementById(mi))}),[]);const m=o().useCallback(((t,e)=>{if(i(t,e),"group"!==e)return r(!1)}),[i]),g=o().useRef(null);o().useEffect((()=>{if(a)return document.addEventListener("mousedown",t),document.addEventListener("touchstart",t),()=>{document.removeEventListener("mousedown",t),document.removeEventListener("touchstart",t)};function t(t){var e;const i=document.querySelector(".finviz-popover[data-enter]");null!==(e=g.current)&&void 0!==e&&e.contains(t.target)||null!=i&&i.contains(t.target)||r(!1)}}),[a]);return d?pe().createPortal(o().createElement(o().Fragment,null,o().createElement("div",{ref:g,className:W()("absolute bottom-0",{"pointer-events-none invisible":!a})},o().createElement(Ei,Ri({isMobileOverlay:!0,activeTool:e,onActiveToolChange:m,onDrawingActionClick:t=>{null==s||s(t),r(!1)}},n))),h.has(fi)||e===Pe.U.Mouse?o().createElement(l.Button,{leftContent:"draw",size:"medium",onClick:()=>{r(!0),c((t=>(t.delete(fi),t)))}},"Draw"):o().createElement(Oi,{activeTool:e,onClick:()=>{r(!0)}})),d):null}function Bi(){return Bi=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(t[s]=i[s])}return t},Bi.apply(this,arguments)}function Ni(t){let{chartLayoutModel:e}=t;const i=o().useMemo((()=>e.drawingsInternalStore()),[e]),{autoSaveState:s}=(0,lt.l)(i,{watchProperties:["autoSaveState"]}),[n,a]=o().useState(!1);return o().useEffect((()=>{if(s===_.FZ.Off)return;let t=null;const e=s!==_.FZ.Saved;t=setTimeout((()=>{a(e)}),e?0:3e3);const i=t=>{if(s===_.FZ.Saved)return;const e="Your latest changes haven't been saved yet. If you leave now, your changes might be lost.";return t.returnValue=e,e};return window.addEventListener("beforeunload",i),()=>{window.removeEventListener("beforeunload",i),t&&clearTimeout(t)}}),[s]),null}function Zi(t){var e,i,s;let{chartLayoutModel:n,ideaNoteRef:a}=t;const r=(0,lt.l)(n,{watchProperties:["idea"]}),{handleIdeaNoteChange:l}=gt(r);return void 0!==(null===(e=r.idea)||void 0===e?void 0:e.note)?o().createElement("div",{className:"mb-4 text-left text-xs"},o().createElement("div",null,"Note:"),o().createElement("textarea",{ref:a,className:"block h-14 border border-gray-300 px-1 py-0.5","data-testid":"idea-note-textarea",style:{width:r.width},value:null!==(i=null===(s=r.idea)||void 0===s?void 0:s.note)&&void 0!==i?i:"",onChange:t=>{l(t.target.value)}})):null}const zi={importFn:()=>i.e(441).then(i.bind(i,954)),cacheKey:"modals-publish"};function Xi(){const t=document.getElementsByClassName("js-publish-chart");return Array.from(t)}function Hi(t){var e;const i=document.getElementById("chart".concat(t));return null!==(e=null==i?void 0:i.src)&&void 0!==e?e:null}function Wi(t){let{isListening:e,layoutModel:i}=t;const s=(0,l.useDialogState)(),{isFullyClosed:n}=(0,l.getExtendedDialogState)(s),[r,h]=o().useState({isCanvas:!0,chartImgUrl:null,timeframe:"",ticker:""}),[c]=(0,a.w)({...zi,shouldLoadModule:!n}),d=null==c?void 0:c.default;return o().useEffect((()=>{const t=Xi(),i=t=>{const{index:e,ticker:i,timeframe:n}=t.target.dataset;if(e&&i&&n){const t=Number.parseInt(e);h({ticker:i,timeframe:n,isCanvas:0===t,chartImgUrl:t>0?Hi(t):null}),s.show()}};return e&&t.forEach((t=>{t.addEventListener("click",i)})),()=>{t.forEach((t=>{t.removeEventListener("click",i)}))}}),[s,e]),d?o().createElement(d,{state:s,config:r,layoutModel:i}):null}var Ui=i(2497);let Yi;function qi(t){let{actionCallback:e,state:i}=t;return o().createElement(l.Dialog,{state:i,"aria-label":"You are leaving your idea, what would you like to do with the drawings from your currently open idea?",className:"w-96",onOverlayClick:()=>e(Yi.Cancel),finalFocusRef:{current:document.body}},o().createElement(l.DialogHeader,{onCloseClick:()=>e(Yi.Cancel)},"You’re About to Leave your Idea"),o().createElement(l.DialogBody,null,o().createElement("div",{className:"space-y-4"},o().createElement(l.Paragraph,null,"What would you like to do with the drawings from your current Idea?"),o().createElement(l.Paragraph,null,o().createElement("strong",null,"Replace Drawings"),o().createElement("br",null),"Your Autosaved Drawings for this ticker will be deleted, and the Idea Drawings will be copied to the live chart."),o().createElement(l.Paragraph,null,o().createElement("strong",null,"Combine Drawings"),o().createElement("br",null),"The Idea Drawings will be copied to the live chart without changing the positions or settings of any Autosaved Drawings. This may cause duplicates if some drawings were also autosaved."),o().createElement(l.Paragraph,null,o().createElement("strong",null,"Do Nothing"),o().createElement("br",null),"Close the idea without changing any Autosaved Drawings."))),o().createElement(l.DialogFooter,null,o().createElement(l.Button,{"data-testid":"confirmation-dialog-override",onClick:()=>e(Yi.Override)},"Replace"),o().createElement(l.Button,{"data-testid":"confirmation-dialog-merge",onClick:()=>e(Yi.Merge)},"Combine"),o().createElement(l.Button,{"data-testid":"confirmation-dialog-nothing",onClick:()=>e(Yi.Nothing)},"Do Nothing")))}!function(t){t[t.Merge=0]="Merge",t[t.Override=1]="Override",t[t.Nothing=2]="Nothing",t[t.Cancel=3]="Cancel"}(Yi||(Yi={}));const Vi=t=>{var e,i,s,n;switch(t){case P.DB.l:return P.nJ.LineChart;case P.DB.hc:return P.nJ.HollowCandleStick;case P.DB.ha:return P.nJ.HeikinAshi;case P.DB.o:return P.nJ.OhlcChart;case P.DB.p:return P.nJ.PerfChart;case P.DB.c:case P.DB.cs:return P.nJ.CandleStick;default:return null!==(e=(0,ke.T8)(null!==(i=null===(s=window.FinvizSettings)||void 0===s||null===(n=s.TA)||void 0===n?void 0:n.style)&&void 0!==i?i:null))&&void 0!==e?e:P.nJ.CandleStick}},ji=t=>{var e;!function(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];const e=(0,Ct.useLocation)(),i=o().useRef(t);o().useEffect((()=>{i.current&&window.gtag("event","page_view",{page_path:"".concat(e.pathname).concat(e.search)}),i.current=!0}),[e.pathname,e.search])}(!1);const i=(0,Ct.useLocation)(),s=(0,Ct.useNavigate)(),{deleteAllDrawings:n}=mt(),a=(0,l.useDialogState)(),r=(null==t?void 0:t.specificChartFunctionality)===P.oK.quotePage,h=(null==t?void 0:t.specificChartFunctionality)===P.oK.chartPage,c=[P.oK.futuresPage,P.oK.forexPage,P.oK.cryptoPage].includes(null==t?void 0:t.specificChartFunctionality);o().useEffect((()=>{h&&K.ZP.setCookie("chartsUrl","?".concat((0,wt.t)({...(0,wt.N)(i.search),i:void 0,settings:void 0})),Ui.add(new Date,{months:1}))}),[h,i.search]),o().useEffect((()=>{var e;const s=(0,wt.N)(i.search);!t||!s.i||null!==(e=t.idea)&&void 0!==e&&e.id||window.location.reload()}),[i.search,null==t||null===(e=t.idea)||void 0===e?void 0:e.id]);const d=o().useCallback((()=>{var e;if(!t)return;const s=(0,wt.N)(i.search),n=null!==(e=s.ty)&&void 0!==e?e:null;(0,G.PU)({type:Vi(n),chartLayoutModel:t}),h&&t.layout!==s.l&&t.updateAttributes({layout:s.l}),t.getAllCharts().forEach(((e,i)=>{var n,a,r,o,l;const h=null!==(n=s.t.split(",")[i])&&void 0!==n?n:null,c=null!==(a=null===(r=s.p)||void 0===r?void 0:r.split(",")[i])&&void 0!==a?a:null,d=null!==(o=null===(l=s.r)||void 0===l?void 0:l.split(",")[i])&&void 0!==o?o:null,u=null==h?void 0:h.toUpperCase();let m=(0,G.mQ)(u);t.specificChartFunctionality!==P.oK.chartPage&&(m=e.instrument);const g={instrument:m,ticker:(0,ue.kB)(m,u),timeframe:c,dateRange:d};Object.entries(g).some((t=>{let[i,s]=t;return e[i]!==s}))&&e.updateAttributesAndSync(g)}))}),[t,i.search,h]);o().useEffect((()=>{var e,n;const o=(0,wt.N)(i.search);if(t&&o.p&&o.t&&(r||h||c)){if(null!==(e=t.idea)&&void 0!==e&&e.id&&a.visible&&a.hide(),!o.i&&null!==(n=t.idea)&&void 0!==n&&n.id){const e=o.t.split(","),i=t.getAllCharts().every(((t,i)=>t.getQuoteRawTicker()===e[i]));if(i&&window.FinvizSettings.hasUserPremium&&t.isPreserveDrawingsActive)return void a.show();t.isPreserveDrawingsActive&&i||st({chartLayoutModel:t,elementMethod:"destroyCascade"}),t.exitIdea()}d()}else{var l;!o.p&&r&&s({search:"?".concat((0,wt.t)({...o,p:null!==(l=window.FinvizSettings.defaultPeriod)&&void 0!==l?l:P.ih.d,r:window.FinvizSettings.defaultDateRange}))},{replace:!0})}}),[i.search,a.show,s,t,r,h,c,d]);const u=o().useCallback((async e=>{if(t)if(e!==Yi.Cancel){switch(e){case Yi.Merge:st({chartLayoutModel:t,elementMethod:"refreshElementId"});break;case Yi.Override:{const{tickers:e}=et(t);await n({tickers:e,lastLocalChange:(0,$.hY)((0,k.pB)(),Date.now())});break}case Yi.Nothing:st({chartLayoutModel:t,elementMethod:"destroyCascade"})}t.exitIdea(),d(),a.hide()}else s(-1)}),[a,t,d,n,s]);return{dialog:a,handleIdeaLeave:u}};var _i=i(9966),Qi=i(3428),Ki=i(5622);function Gi(){return Gi=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(t[s]=i[s])}return t},Gi.apply(this,arguments)}function Ji(t){const e=window.innerWidth;return e>=P.QX||t.specificChartFunctionality!==P.oK.chartPage?1:(0,G.GX)({chartLayout:t,numOfVisibleBars:P.Vd,chartVisibleWidth:e})}function $i(t){let{chartLayoutModel:e,config:i,onRegisterChartLayoutModel:s,parentElement:n}=t;const[a,r]=o().useState(!1);return o().useEffect((()=>{if(s&&e&&!a){const t=()=>{const{charts:t}=e.toConfig(),a=t.length===i.charts.length&&t.every(((t,e)=>t.panes.length===i.charts[e].panes.length&&t.panes.every(((t,s)=>t.elements.length===i.charts[e].panes[s].elements.length&&t.elements.every(((t,n)=>{var a,r;return(null===(a=t.overlays)||void 0===a?void 0:a.length)===(null===(r=i.charts[e].panes[s].elements[n].overlays)||void 0===r?void 0:r.length)}))))));a&&(r(!0),e.updateAttributes({isInit:!0}),s(e),n&&(n.style.minHeight="unset"))};return e.bind(ge,t),t(),()=>{e.unbind(ge,t)}}}),[e,i,a,s,n]),null}function ts(){return ts=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(t[s]=i[s])}return t},ts.apply(this,arguments)}i(90);function es(){return es=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(t[s]=i[s])}return t},es.apply(this,arguments)}function is(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class ss extends o().Component{constructor(t){super(t),is(this,"model",void 0),is(this,"isMobile",Boolean(K.ZP.isMobile(!0))),is(this,"charts",void 0),is(this,"orientationChangeTimeout",void 0),is(this,"ideaNoteRef",o().createRef()),is(this,"preserveDrawingAbortController",new AbortController),is(this,"handleInitialPreserveDrawingsState",(()=>{let t=!1;var e;window.FinvizSettings.hasUserPremium&&[P.oK.chartPage,P.oK.quotePage].includes(this.model.specificChartFunctionality)&&(void 0!==(null===(e=window.FinvizSettings.toolsState)||void 0===e?void 0:e[Pe.lu.PreserveDrawings])?t=window.FinvizSettings.toolsState[Pe.lu.PreserveDrawings]:this.handlePreserveDrawingsSettings());return this.model.updateAttribute("isPreserveDrawingsActive",t),t})),is(this,"handlePreserveDrawingsSettings",(async t=>{const e=t=>{this.model.updateAttribute("isPreserveDrawingsActive",t),this.setState((e=>({drawingSettings:{...e.drawingSettings,[Pe.lu.PreserveDrawings]:t}})))};try{this.preserveDrawingAbortController.abort(),this.preserveDrawingAbortController=new AbortController;const i=await(0,J.ZP)({location:"/api/tools_state.ashx",method:void 0!==t?"POST":"GET",body:void 0!==t?new URLSearchParams({tools_state:JSON.stringify({[Pe.lu.PreserveDrawings]:t})}):void 0,throwOnStatusCodes:[404],abortController:this.preserveDrawingAbortController});void 0===t&&void 0!==(null==i?void 0:i[Pe.lu.PreserveDrawings])&&e(i[Pe.lu.PreserveDrawings])}catch{void 0!==t&&e(!t)}})),is(this,"handleOrientationChange",(()=>{this.orientationChangeTimeout=window.setTimeout((()=>{this.setToolbarPosition(),this.props.shouldResize&&this.handleResize()}))})),is(this,"onWindowResize",(()=>{this.setToolbarPosition(),this.props.shouldResize&&this.throttledResize()})),is(this,"handleResize",(()=>{const t=(0,K.U$)(this.model.getHTMLElementId());this.model.updateAttributes(t)})),is(this,"throttledResize",V()(this.handleResize,200)),is(this,"checkTouchEventsDisabled",(()=>{var t,e;!/\bcharts\b/.test(window.location.pathname)||(0,K.al)()||1===this.getVisualViewportScale()?(null===(t=this.state)||void 0===t?void 0:t.touchEventsDisabled)&&this.setState({touchEventsDisabled:!1}):(null===(e=this.state)||void 0===e||!e.touchEventsDisabled)&&this.setState({touchEventsDisabled:!0})})),is(this,"getVisualViewportScale",(()=>window.visualViewport&&this.isMobile?window.visualViewport.scale:1)),is(this,"handleActiveToolChange",(t=>{this.model.isLockDrawingsActive||this.setState({activeTool:t})})),is(this,"handleDrawingAction",(t=>{switch(t){case Pe.M6.AddNote:this.props.noteDialogState.toggle();break;case Pe.M6.DeleteDrawings:case Pe.M6.DeleteAutoSavedDrawings:this.props.confirmationDialogState.show();break;default:return}})),is(this,"handleConfirmationDialogCloseBtn",(()=>{this.props.confirmationDialogState.hide()})),is(this,"handleConfirmationDialogDeleteBtn",(()=>{this.model.drawingsInternalStore().autoSaveState!==_.FZ.Off&&this.props.deleteAllAutoSavedElements(),this.model.getAllElements().forEach((t=>t.isDrawing()&&t.destroyCascade())),this.handleConfirmationDialogCloseBtn()})),is(this,"handleDrawingsSetting",(t=>{var e,i;const s={...this.state.drawingSettings,[t]:!this.state.drawingSettings[t]};switch(t){case Pe.lu.HideDrawings:this.handleActiveToolChange(Pe.U.Mouse),this.toggleHideDrawings(s[Pe.lu.HideDrawings]),this.handleLockDrawings(s);break;case Pe.lu.PreserveDrawings:this.handlePreserveDrawingsSettings(s[Pe.lu.PreserveDrawings]),this.model.updateAttribute("isPreserveDrawingsActive",s[Pe.lu.PreserveDrawings]);break;case Pe.lu.LockDrawings:this.handleActiveToolChange(Pe.U.Mouse),this.handleLockDrawings(s);break;case Pe.lu.DrawingModeContinuous:this.model.updateAttribute("isDrawingModeContinuousActive",s[Pe.lu.DrawingModeContinuous]),!1===s[Pe.lu.DrawingModeContinuous]&&this.handleActiveToolChange(Pe.U.Mouse)}this.setState({drawingSettings:s}),null===(e=(i=window).gtag)||void 0===e||e.call(i,"event","drawings_settings_toggle",{event_category:s[t]?"enable":"disable",event_label:t})})),is(this,"handleLockDrawings",(t=>{this.model.updateAttribute("isLockDrawingsActive",!(!t[Pe.lu.HideDrawings]&&!t[Pe.lu.LockDrawings]))})),is(this,"handleFocusNoteElement",(()=>{var t,e,i,s;null===(t=this.ideaNoteRef)||void 0===t||null===(e=t.current)||void 0===e||e.scrollIntoView({behavior:"smooth",block:"center",inline:"center"}),null===(i=this.ideaNoteRef)||void 0===i||null===(s=i.current)||void 0===s||s.focus({preventScroll:!0})})),is(this,"handleAddNoteClick",(()=>{this.props.idea?this.handleFocusNoteElement():this.model.updateAttribute("idea",{note:""})})),is(this,"setActiveChartInteraction",(t=>{this.setState({activeChartInteraction:t})})),is(this,"onChartDestroy",(t=>{var e;this.updateLayout(),null!==(e=this.model.activeChart)&&void 0!==e&&e.eql(t)&&this.model.updateAttribute("activeChart",this.model.charts().last())})),is(this,"onModelChange",((t,e)=>{"refresh"!==e&&(this.updateLayout(),t&&"update"===e&&this.setState({editable:t.editable,editors:t.editors,layout:t.layout}))})),this.model=t.chartLayoutModel;const e=t.config;this.charts=[];for(const t of e.charts){const e=M()({},t);e.chart_layout=this.model,delete e.panes,null==e.zoomFactor&&(e.zoomFactor=this.model.defaultZoomFactor),null==e.refreshData&&(e.refreshData=!0),e.dateRange||(e.dateRange=null),e.isHideDrawingsActive=this.model.isHideDrawingsActive,e.isScrolled=!1;const i=this.model.charts().create(e);this.charts.push({model:i,config:t})}this.model.updateAttribute("activeChart",this.model.charts().first()),this.state={editable:this.model.editable,editors:this.model.editors,layout:this.model.layout,activeChartInteraction:null,activeTool:Pe.U.Mouse,touchEventsDisabled:!1,isToolbarHorizontal:!0,drawingSettings:{[Pe.lu.DrawingModeContinuous]:!1,[Pe.lu.PreserveDrawings]:this.handleInitialPreserveDrawingsState(),[Pe.lu.HideDrawings]:!1,[Pe.lu.LockDrawings]:!1}}}componentDidMount(){if(this.state.editable){const t=46;window.addEventListener("keyup",(e=>{const i=this.model.getPaneWithSelection();if(e.keyCode===t&&i){const t=Q.Z.findByAttribute("instance",i.selection);if(t){const e=t.pane();t.destroyCascade({eventType:j.H3.Remove}),e.normalizeZIndexes()}}}))}this.isMobile&&(this.model.settings.ThumbSettings.size=this.model.settings.ThumbSettings.touchSize),this.onModelChange(),this.model.bind("change",this.onModelChange),this.model.charts().bind("destroy",this.onChartDestroy),this.setToolbarPosition(),window.addEventListener("resize",this.onWindowResize),window.addEventListener("orientationchange",this.handleOrientationChange),this.isMobile&&(this.checkTouchEventsDisabled(),window.addEventListener("touchend",this.checkTouchEventsDisabled))}componentDidUpdate(t){this.model.specificChartFunctionality===P.oK.chartPage&&t.idea&&!this.props.idea&&this.onWindowResize(),t.idea||!this.props.idea||this.props.idea.note||this.handleFocusNoteElement(),this.setToolbarPosition()}componentWillUnmount(){this.preserveDrawingAbortController.abort(),this.model.unbind("change",this.onModelChange),window.removeEventListener("resize",this.onWindowResize),window.removeEventListener("orientationchange",this.handleOrientationChange),this.isMobile&&window.removeEventListener("touchend",this.checkTouchEventsDisabled),clearTimeout(this.orientationChangeTimeout),this.throttledResize.cancel(),this.model.destroyCascade()}setToolbarPosition(){const t=this.model.width+210>window.innerWidth||window.innerWidth<1e3;t!==this.state.isToolbarHorizontal&&this.setState({isToolbarHorizontal:t})}toggleHideDrawings(t){this.model.updateAttribute("isHideDrawingsActive",t),this.model.getAllCharts().forEach((e=>e.updateAttribute("isHideDrawingsActive",t)))}renderToolbar(t){const{activeTool:e,drawingSettings:i}=this.state;return t.isOverlayToolbar?o().createElement(Fi,{chartLayoutModel:this.model,activeTool:e,onActiveToolChange:this.handleActiveToolChange,onDrawingActionClick:this.handleDrawingAction,onDrawingSettingClick:this.handleDrawingsSetting,drawingSettings:i,areToolsDisabled:i[Pe.lu.HideDrawings]||i[Pe.lu.LockDrawings]}):o().createElement(Ti,es({chartLayoutModel:this.model,activeTool:e,onActiveToolChange:this.handleActiveToolChange,onDrawingActionClick:this.handleDrawingAction,onDrawingSettingClick:this.handleDrawingsSetting,drawingSettings:i,areToolsDisabled:i[Pe.lu.HideDrawings]||i[Pe.lu.LockDrawings]},t))}render(){var t;const{newCharts:e,useGrid:i}=this.props.config,{activeTool:s,editable:n,editors:a,isToolbarHorizontal:r}=this.state,h=a.includes(P.fu.publish)&&Xi().length>0,c=P.Cs[this.model.layout],d=(0,K.jQ)(this.isMobile),{tickers:u}=et(this.model);if(e){var m;const t=(0,G.Ym)(P.oK.chartPage);return o().createElement(o().Fragment,null,o().createElement("div",{className:"flex grow overflow-hidden"},!d&&this.renderToolbar({isSidebar:!0,isHorizontal:!1}),o().createElement(Di,{state:this.props.confirmationDialogState,onAction:this.handleConfirmationDialogDeleteBtn,onCancel:this.handleConfirmationDialogCloseBtn,isAutosaveDialogContent:this.props.isAutoSaveActive,tickers:u}),o().createElement(Li,{dialogState:this.props.noteDialogState,chartLayoutModel:this.model}),o().createElement(l.ChartGrid,{border:!0,id:this.model.getHTMLElementId(),"data-testid":"charts-container",columns:c.columns,rows:c.rows},this.charts.map(((t,e)=>{var i;let{model:n,config:a}=t;return o().createElement(_e,{key:n.id,hasOutline:!0,chartIndex:e,chartModel:n,config:a,layoutModel:this.model,WrapperComp:l.ChartGridCell,gridArea:null===(i=c.gridAreas)||void 0===i?void 0:i[e],setActiveChartInteraction:this.setActiveChartInteraction,activeTool:s,activeChartInteraction:this.state.activeChartInteraction,touchEventsDisabled:this.state.touchEventsDisabled,shouldResize:this.props.shouldResize})}))),o().createElement(Ni,{chartLayoutModel:this.model})),d&&t&&o().createElement(yi,{onShouldResize:this.throttledResize,direction:ni.d.horizontal}),d&&this.renderToolbar({isSidebar:!1,isHorizontal:!0,isOverlayToolbar:t}),(null===(m=this.props.idea)||void 0===m?void 0:m.note)&&o().createElement("div",{className:"shrink-0 border-t border-gray-300 p-4 dark:border-gray-700"},o().createElement("div",{className:"border bg-gray-100 p-3 text-xs dark:border-gray-600 dark:bg-gray-700"},this.props.idea.note)))}const g=(0,K.yG)(),f=n&&a.includes(P.fu.ideas),p=n&&a.includes(P.fu.tools);return o().createElement(o().Fragment,null,(null===(t=this.props.idea)||void 0===t?void 0:t.date)&&this.model.specificChartFunctionality===P.oK.quotePage&&o().createElement("h3",{className:"chart-idea-title mt-0"},"Your idea from ".concat(this.props.idea.date)),o().createElement(Wi,{isListening:!!h,layoutModel:this.model}),f&&o().createElement(si,{layoutModel:this.model,handleAddNote:this.handleAddNoteClick}),p&&!(a.includes(P.fu.settings)&&r)&&o().createElement("div",{id:"charts-drawing-tools","data-ishorizontal":r?1:0,className:W()({"border border-gray-50":r,"absolute left-[-85px] w-20":!r&&!g,"absolute left-[-5.5rem] w-20":!r&&g}),"data-testid":"charts-drawing-tools"},this.renderToolbar({isHorizontal:r,isAlternativeTheme:!0})),o().createElement(Di,{state:this.props.confirmationDialogState,onAction:this.handleConfirmationDialogDeleteBtn,onCancel:this.handleConfirmationDialogCloseBtn,isAutosaveDialogContent:this.props.isAutoSaveActive,tickers:u}),o().createElement(l.ChartGrid,{id:this.model.getHTMLElementId(),"data-testid":"charts-container",columns:c.columns,rows:c.rows,border:i,className:W()({"starts-with-pane":!f&&!p})},this.charts.map(((t,e)=>{let{model:n,config:a}=t;return o().createElement(_e,{key:n.id,chartIndex:e,chartModel:n,config:a,activeTool:s,layoutModel:this.model,hasOutline:i,setActiveChartInteraction:this.setActiveChartInteraction,activeChartInteraction:this.state.activeChartInteraction,touchEventsDisabled:this.state.touchEventsDisabled,renderChartToolbar:r?()=>this.renderToolbar({isHorizontal:!0,isAlternativeTheme:!0}):void 0})}))),o().createElement("div",{className:"clear"}),o().createElement("div",{className:"left"}),o().createElement("div",{style:{clear:"both"}}),this.model.specificChartFunctionality===P.oK.quotePage&&o().createElement(Zi,{chartLayoutModel:this.model,ideaNoteRef:this.ideaNoteRef}),o().createElement(Ni,{chartLayoutModel:this.model}))}updateLayout(){const t=P.Cs[this.model.layout],e=this.model.charts().all();0!==e.length&&(e.length>t.count?this.removeCharts(t.count):e.length<t.count&&this.addCharts(t.count-e.length),this.model.charts().all().forEach(((e,i)=>{var s;const[n,a,r,o]=(null===(s=t.gridAreas)||void 0===s?void 0:s[i].replace(/ /g,"").split("/").map((t=>Number.parseInt(t))))||[],l=[r,n].every((t=>void 0!==t))?r-n:1,h=[a,o].every((t=>void 0!==t))?o-a:1,c=l/t.rows,d=h/t.columns,u=~~(this.model.width*d),m=this.model.specificChartFunctionality===P.oK.chartPage;let g=~~((m?this.model.height:this.model.charts().first().height||this.model.height)*c);this.model.editors.includes(P.fu.settings)&&m&&(g-=this.model.settings.ChartSettings.general.settingsHeight),(e.width!==u||e.height!==g)&&u>0&&g>0&&e.updateAttributes({width:u,height:g})})))}addCharts(t){const e=this.model.charts().last().quote();if(!e)return;const i={...this.model.charts().last().toObject(),leftOffset:null,chart_layout:this.model,aftermarket:e.aftermarket,premarket:e.premarket};for(let e=0;e<t;e++){const t=this.model.charts().create(i);this.charts.push({model:t,config:i})}}removeCharts(t){for(;this.model.charts().count()>t;){this.model.charts().last().destroyCascade(),this.charts.pop()}}}const ns=Y()((t=>e=>(o().useEffect((()=>{const t=c()((()=>{const t=bt.Z.all(),e=ht.Z.all().flatMap((t=>t.getAllQuotes()));t.forEach((t=>{!e.some((e=>e.eql(t)))&&!t.isFetching&&t.fetchedAt>-1&&t.fetchedAt<Date.now()-3e5&&t.destroy()}))}),500);return bt.Z.bind("change",t),()=>{t.cancel(),bt.Z.unbind("change",t)}}),[]),o().createElement(t,e))),(t=>e=>{const i=(0,l.useDialogState)(),s=(0,l.useDialogState)({modal:!1});return o().createElement(t,Bi({confirmationDialogState:i,noteDialogState:s},e))}),(t=>e=>{const i=o().useMemo((()=>{var t,i,s,n,a,r,o,l,h,c,d;const u=M()({},e.config,{editable:null===(t=e.config.editable)||void 0===t||t,canChangeTicker:null===(i=e.config.canChangeTicker)||void 0===i||i,scrollable:null===(s=e.config.scrollable)||void 0===s||s,cross:null===(n=e.config.cross)||void 0===n||n,theme:e.config.theme&&[j.Q2.light,j.Q2.dark].includes(e.config.theme)?e.config.theme:j.Q2.light,editors:null!==(a=e.config.editors)&&void 0!==a?a:[P.fu.publish,P.fu.tools,P.fu.ideas],ideas:null===(r=e.config.ideas)||void 0===r||r,specificChartFunctionality:null!==(o=e.config.specificChartFunctionality)&&void 0!==o?o:P.oK.default,initialStoreDrawings:[]});u.ideas||(u.editors=u.editors.filter((t=>"ideas"!==t)));const m=null!==(l=null===(h=it())||void 0===h?void 0:h.filter((t=>{let{changeType:e}=t;return"destroy"!==e})))&&void 0!==l?l:[],g=u.specificChartFunctionality===P.oK.quotePage,f=g&&"on"!==K.ZP.getCookie("charts-draw");if(0===m.length||f)return u;const p=m.find((t=>{let{containerType:i,ticker:s}=t;return"note"===i&&e.config.charts.some((t=>t.ticker===s))})),y=p&&(null===(c=JSON.parse(p.elementAttrs))||void 0===c?void 0:c.text),v=g&&y?{note:y}:void 0;return{...u,initialStoreDrawings:m,idea:null!==(d=u.idea)&&void 0!==d?d:v,charts:u.charts.map((t=>{const{ticker:e,panes:i}=t;return{...t,panes:i.map((t=>{const i=function(t){const e=t.elements.find((t=>t.type.startsWith("indicators/")));return e?e.type:t.elements.find((t=>t.type.startsWith("charts/")))?"chart":null}(t),s=m.filter((s=>s.containerType===i&&s.ticker===e&&!t.elements.some((t=>t.elementId===s.elementId)))).map((t=>{let{elementId:e,zIndex:i,elementAttrs:s}=t;return{elementId:e,zIndex:i,...JSON.parse(s)}}));return{...t,elements:[...t.elements,...s]}}))}}))}}),[]),s=o().useMemo((()=>{var t;const e=(0,Ki.getSettings)({...i,theme:i.theme}),s=_i.Z.create({layout:i.layout,width:i.width,height:i.height,editable:i.editable,canChangeTicker:i.canChangeTicker,scrollable:i.scrollable,initialScrollable:i.scrollable,cross:i.cross,editors:i.editors,theme:i.theme,idea:i.idea,settings:e,isWheelZoomEnabled:i.specificChartFunctionality===P.oK.chartPage,specificChartFunctionality:i.specificChartFunctionality,isHideDrawingsActive:!1,isPreserveDrawingsActive:!!(window.FinvizSettings.hasUserPremium&&[P.oK.chartPage,P.oK.quotePage].includes(i.specificChartFunctionality)&&null!==(t=window.FinvizSettings.toolsState)&&void 0!==t&&t[Pe.lu.PreserveDrawings]),isLockDrawingsActive:!1,uuid:i.uuid,drawingsInternalStore:Qi.Z.create({elements:i.initialStoreDrawings})});return s.updateAttributes({defaultZoomFactor:Ji(s)}),s}),[]);return s?o().createElement(o().Fragment,null,o().createElement($i,{config:i,chartLayoutModel:s,onRegisterChartLayoutModel:e.onRegisterChartLayoutModel,parentElement:null==e?void 0:e.parentElement}),o().createElement(t,Gi({chartLayoutModel:s},e,{config:i}))):null}),(function(t){return function(e){const{updateChartsTitle:i}=function(){const t=r.useRef(document.title),{current:e}=r.useRef((e=>{const i=e.getAllCharts().reduce(((t,e)=>t.some((t=>{let{ticker:i}=t;return i===e.ticker}))?t:[...t,{ticker:e.ticker,timeframe:e.timeframe,instrument:e.instrument}]),[]).map((t=>{const{ticker:i,timeframe:s,instrument:n}=t,a=bt.Z.select((t=>t.ticker===i.replace("@","")&&t.timeframe===s&&t.instrument===n&&e.isIdeaId(t.ideaID)));if(a.length>0){const{lastClose:t,instrument:e,afterClose:s,prevClose:n,name:r}=a[0];let o;return t?(null!==n&&(o=100*(t/n-1)),null!==s&&s!==t&&(o=100*(s/t-1)),"".concat(r||i," ").concat(yt.ZP.round({value:t,lastClose:t,instrument:e,overridePlaces:void 0})," ").concat(o>0?"+":"-").concat(yt.ZP.round({value:Math.abs(o),overridePlaces:2}),"%")):null}return null})).filter((t=>null!==t));if(i&&i.length>0){const t=i.join(" | ");document.title!==t&&(document.title=t)}else document.title!==t.current&&(document.title=t.current)}));return{updateChartsTitle:e}}(),s=r.useCallback((()=>{i(e.chartLayoutModel)}),[e.chartLayoutModel,i]);return r.useEffect((()=>{if(e.chartLayoutModel.specificChartFunctionality===P.oK.chartPage)return e.chartLayoutModel.charts().bind("change",s),s(),()=>{e.chartLayoutModel.charts().unbind("change",s)}}),[e.chartLayoutModel,s]),r.createElement(t,e)}}),(function(t){const e=function(t){return function(e){const{dialog:i,handleIdeaLeave:s}=ji(e.chartLayoutModel);return o().createElement(o().Fragment,null,o().createElement(qi,{state:i,actionCallback:s}),o().createElement(t,e))}}(t);return function(i){const{ty:s}=(0,wt.N)(),n=i.chartLayoutModel.specificChartFunctionality===P.oK.chartPage,a=i.chartLayoutModel.specificChartFunctionality===P.oK.quotePage,r=[P.oK.futuresPage,P.oK.forexPage,P.oK.cryptoPage].includes(i.chartLayoutModel.specificChartFunctionality);return n||a&&"p"!==s||r?o().createElement(e,i):o().createElement(t,i)}}),(function(t){return function(e){const i=(0,lt.l)(e.chartLayoutModel,{watchProperties:["idea"]});return o().createElement(t,ts({},e,{idea:null==i?void 0:i.idea}))}}),(t=>e=>{const[i,s]=o().useState({}),n=o().useCallback((()=>{const t={};e.chartLayoutModel.getAllCharts().forEach((e=>{const i=e.getRefreshInterval();var s;i&&(t[i]=null!==(s=t[i])&&void 0!==s?s:[],t[i].push(e.id))})),JSON.stringify(t)!==JSON.stringify(i)&&s(t)}),[e.chartLayoutModel,i]),a=o().useRef([]);return o().useEffect((()=>{const t=c()(n),e=window.setInterval(t,1e3*P.rv);return ht.Z.bind("change",t),de.Z.bind("change",t),()=>{t.cancel(),ht.Z.unbind("change",t),de.Z.unbind("change",t),window.clearInterval(e)}}),[n]),o().useEffect((()=>{const t=Object.keys(i).map(Number),s=e.chartLayoutModel.getAllCharts(),n=Math.min(...t);return t.forEach((t=>{const e=window.setInterval((()=>{const e=i[t];s.filter((t=>e.includes(t.id))).flatMap((t=>t.getAllQuotes())).filter(((t,e,i)=>!t.isFetching&&e===i.findIndex((e=>t.eql(e))))).forEach((t=>{t.fetchData({fetchType:xt.p.NewerData})})),t===n&&document.dispatchEvent(new Event(P.p$))}),t);a.current.push(e)})),()=>{a.current.length>0&&(a.current.forEach((t=>{window.clearInterval(t)})),a.current=[])}}),[e.chartLayoutModel,i]),o().createElement(t,e)}),(t=>e=>{const{deleteAllAutoSavedElements:i,isAutoSaveActive:s}=pt(e.chartLayoutModel);return o().createElement(t,ft({},e,{deleteAllAutoSavedElements:i,isAutoSaveActive:s}))}))(ss);function as(t){let{config:e,shouldResize:i,isWithNotifications:s=!0}=t;const n=s?l.NotificationWrapper:o().Fragment;return o().createElement(n,null,o().createElement(z,null,o().createElement(ns,{config:e,shouldResize:i})))}const rs=(0,a.y)((function(t){let{config:e,shouldResize:i,parentElement:s}=t;const[n]=(0,a.w)({...X.i,isSuspenseMode:!0}),{setChartLayoutModel:r,getChartLayoutModelConfig:l,lastGlobalRerender:h}=n.useChartLayoutGlobalModel();return o().createElement(z,null,e&&o().createElement(ns,{key:h,config:l({fallback:e}),shouldResize:i,onRegisterChartLayoutModel:r,parentElement:s}))})),os=K.ZP.isIPad(),ls="is-ipad-fullscreen";function hs(){const[t,e]=r.useState((0,K.al)()),i=(0,K.Rp)(document.documentElement),s=(0,K.mq)(),n=r.useRef((()=>{(0,K.al)()?s.call(document):i.call(document.documentElement)}));return r.useEffect((()=>{const t=()=>{os&&((0,K.al)()?document.body.classList.add(ls):document.body.classList.remove(ls)),e((0,K.al)())};return document.addEventListener("webkitfullscreenchange",t),document.addEventListener("fullscreenchange",t),()=>{document.removeEventListener("webkitfullscreenchange",t),document.removeEventListener("fullscreenchange",t)}}),[]),i?r.createElement(l.Button,{theme:"headerItem","data-testid":"chart-layout-fullscreen",leftContent:t?"exitFullscreen":"fullscreen",contentClass:"hidden lg:flex",title:t?"Exit Full screen":"Full screen",onClick:n.current},t?"Exit Full screen":"Full screen"):null}var cs=i(4088),ds=i(5867);const us=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return t.sort(((t,i)=>e.reduce(((e,s)=>{const{sortBy:n,sortDirection:a=P.B8.ASC}=s,r=a===P.B8.ASC?1:-1;return 0===e?(t[n]-i[n])*r:e}),0)))}(Object.entries(P.Cs).map((t=>{let[e,i]=t;return{...i,key:e}})),[{sortBy:"columns"},{sortBy:"count"}]).map((t=>{let{key:e}=t;return e}));function ms(t){let{model:e}=t;const i=(0,Ct.useLocation)(),s=(0,Ct.useNavigate)(),n=(0,wt.N)(i.search),a=(0,lt.l)(e,{watchProperties:["layout","syncChartParts"]}),{getChartsToPath:o}=(0,ds.b)({chartLayoutModel:a}),h=(0,l.useDropdownState)({placement:"bottom",orientation:"horizontal"});return r.createElement(l.Dropdown,{state:h,"aria-label":"Layout",label:r.createElement(l.Button,{theme:"headerItem","data-testid":"chart-layout-layout",leftContent:"layout".concat(n.l),contentClass:"hidden lg:flex",title:"Change layout"},"Layout")},r.createElement("div",null,r.createElement("div",{className:"flex"},us.map((t=>r.createElement(l.DropdownItem,{key:t,appearance:"square","data-testid":"chart-layout-".concat(t),onClick:()=>{s(o({layout:t}))}},r.createElement(l.Icon,{name:"layout".concat(t),className:"text-gray-500 dark:text-white"}))))),r.createElement(l.DropdownSeparator,null),r.createElement("div",{className:"flex space-x-1"},r.createElement("div",{className:"flex items-center justify-center pl-1"},r.createElement(l.Paragraph,{size:"small"},"Sync:")),cs.lL.map((t=>{let{value:e,label:i}=t;const s=a.getIsChartPartInSync(e);return r.createElement(l.Button,{key:e,theme:"chip",size:"regular",active:s,"data-testid":"chart-syncable-".concat(e),onClick:()=>{var t,i;a.setSyncChartParts(e,!s),s||null===(t=(i=window).gtag)||void 0===t||t.call(i,"event","sync",{event_label:e})}},i)})))))}function gs(){return gs=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(t[s]=i[s])}return t},gs.apply(this,arguments)}function fs(t){let{model:e}=t;const i=(0,l.useDialogState)(),[s,{isLoading:n}]=(0,a.w)({...zi,shouldLoadModule:i.visible,errorSeverity:"medium",onError:()=>i.hide()}),o=null==s?void 0:s.default,h=r.createElement(l.Icon,{name:"publish",className:"text-white"}),c=n?{leftContent:r.createElement(l.Delayed,{delayComponent:h},r.createElement(l.Spinner,{width:16}))}:{as:l.DialogTrigger,state:i,leftContent:"publish"};return r.createElement(r.Fragment,null,r.createElement(l.Button,gs({},c,{theme:"headerItem","data-testid":"chart-toolbar-publish",contentClass:"hidden lg:flex",title:"Publish chart"}),"Publish"),o&&r.createElement(o,{state:i,layoutModel:e}))}function ps(t){let{model:e}=t;const i=(0,lt.l)(e,{watchProperties:["theme"]}),s="dark"===e.theme;return i?r.createElement(l.Button,{theme:"headerItem",appearance:"square","data-testid":"chart-layout-theme",title:s?"Toggle light mode":"Toggle dark mode",onClick:()=>{const t=s?"light":"dark";i.updateAttributes({theme:t,settings:(0,Ki.updateSettings)(i,t)}),i.trigger("theme",i),fetch("/api/set_cookie.ashx?cookie=chartsTheme&value=".concat(t)).catch((()=>{})),s?document.documentElement.classList.remove("dark"):document.documentElement.classList.add("dark")},leftContent:s?"lightMode":"darkMode"}):null}const ys=[{minWidth:-1/0,marketBadgeText:!1,timeFormat:"timeOnly"},{minWidth:550,marketBadgeText:!1,timeFormat:"short"},{minWidth:700,marketBadgeText:!1,timeFormat:"long"},{minWidth:768,marketBadgeText:!0,timeFormat:"long"}];function vs(t){var e;let{model:i,onSettingsOpen:s=(()=>{}),hasPublish:n}=t;const a=(0,lt.l)(i,{watchProperties:["idea"]});return r.createElement(r.Fragment,null,r.createElement("div",{className:"flex grow items-center space-x-2"},r.createElement(ei,{model:a})),r.createElement("div",{className:"flex grow items-center justify-end space-x-2"},r.createElement(ii,{page:i.specificChartFunctionality}),r.createElement(ms,{model:a}),r.createElement(hs,null),n&&r.createElement(fs,{model:a}),r.createElement(ps,{model:a}),r.createElement(l.Button,{appearance:"square",leftContent:"settingsWheel",theme:"headerItem","data-testid":"chart-settings-open-btn",title:"Settings",className:"settings-button",onClick:s,disabled:null===(e=a.idea)||void 0===e?void 0:e.id}),r.createElement(l.Time,{id:"time",breakpointMode:"window",className:"text-[11px] font-medium text-gray-50 lg:text-2xs",breakpoints:ys})))}const bs=r.memo(vs,((t,e)=>t.model===e.model&&t.onSettingsOpen===e.onSettingsOpen&&t.hasPublish===e.hasPublish));const xs=(0,a.y)((function(t){let{className:e="!m-0",isDateRangeAvailable:i,isPremium:s,isLoadingOverride:n,isScrollIntoViewEnabled:r=!1,onTimeframeSelect:h=(()=>{}),onDateRangeSelect:c=(()=>{})}=t;const[d]=(0,a.w)({...X.i,isSuspenseMode:!0}),{chartLayoutModel:u}=d.useChartLayoutGlobalModel(),m=o().useMemo((()=>{var t;return null!==(t=null==u?void 0:u.getAllCharts()[0])&&void 0!==t?t:null}),[u]),{favoriteTimeframes:g,toggleFavoriteTimeframe:f}=(0,l.useFavoriteTimeframes)(s),p=(0,lt.l)(m,{watchProperties:["timeframe","dateRange"]}),{instrument:y=j.Yx.Stock}=(null==p?void 0:p.quote())||{},{isLoading:v}=qt({chartModel:p,isInteractive:i}),{anchorDate:b,generateChartLayoutRouterPath:x,timeframeGroupsWithHref:C,dateRangeGroupsWithHref:w,isFetching:S,handleCustomDateRangeValidation:M}=(0,Vt.E)({chartModel:p,isPremium:s}),{onDialogSubmit:P,customDateRangeDialogState:k,handleDateRangeSelect:E,getDateRangeTimeframe:T}=(0,l.useCustomDateRangeDialog)({instrument:y,anchorDate:b,pathGenerator:x}),I=w({isPremium:s,customRange:null==p?void 0:p.dateRange,instrument:y}),A=C(s);return o().createElement(o().Fragment,null,o().createElement(l.TimeframeBar,{isPremium:s,size:"regular",chartIndex:0,rounding:(0,K.yG)()?"regular":"none",timeFrameGroups:A,dateRangeGroups:I,selectedTimeframe:null==p?void 0:p.timeframe,selectedDateRange:null==p?void 0:p.dateRange,favoriteTimeframes:g,loadingTimeframe:(null!=n?n:v)?null==p?void 0:p.timeframe:void 0,onDateRangeSelect:t=>{E(t),null==c||c(t)},onTimeframeSelect:h,onFavoriteTimeframeToggle:t=>{let{value:e}=t;f(e)},isDateRangeAvailable:i,containerElement:document.body,className:e,isFavoritesEnabled:s,isScrollIntoViewEnabled:r}),p&&o().createElement(l.CustomDateRange,{dialogState:k,dateRange:null==p?void 0:p.dateRange,anchorDate:b,onDialogSubmit:async function(t){const e=T(t.dateRange);if(!e)return;await M(e)&&P(e)},isFetching:S}))}));function Cs(t,e,i){if("cot"===e.name){var s;const e=null!==(s=null==i?void 0:i.COTs)&&void 0!==s?s:[];0===e.length&&e.push(""),e.forEach((function(e){(function(t,e){return t.some((t=>{let{elements:i}=t;return i.some((t=>t.type===P.A.Cot&&t.code===e))}))})(t,e)||t.push({height:P.kU.indicator,elements:[{type:P.A.Cot,code:e}]})}))}else t.push({height:P.kU.indicator,elements:[{type:"indicators/"+e.name,period:e.parameters}]})}function ws(t){return{candlestick:P.nJ.CandleStick,heikinashi:P.nJ.HeikinAshi,hollowcandlestick:P.nJ.HollowCandleStick,line:P.nJ.LineChart,ohlc:P.nJ.OhlcChart}[t]}const Ss=function(t,e,i){const s=t.charts[0].panes,n=t.charts[0];var a,r;n.scale=(a=e.scale,null!==(r={linear:P.N3.Linear,percentage:P.N3.Percentage,logarithmic:P.N3.Logarithmic}[a])&&void 0!==r?r:P.N3.Linear),e.indicators.filter((t=>t.position===j.Ly.Above)).forEach((t=>{Cs(s,t,i)}));const o=e.overlays.map((function(t){var e,i;return{type:"overlays/"+t.name,period:null!==(e=t.parameters)&&void 0!==e?e:"",color:null!==(i=t.color)&&void 0!==i?i:""}}));s.push({height:P.kU.chart,elements:[{type:ws(e.style),overlays:o}]}),e.indicators.filter((t=>t.position===j.Ly.Below)).forEach((t=>{Cs(s,t,i)})),t.height=n.height=P.kU.chart+(s.length-1)*P.kU.indicator},Ms=function(t){const e={},i=[];t.indicators.filter((t=>t.position===j.Ly.Above)).forEach((t=>{Cs(i,t,e)}));const s=t.overlays.map((function(t){var e,i;return{type:"overlays/"+t.name,period:null!==(e=t.parameters)&&void 0!==e?e:"",color:null!==(i=t.color)&&void 0!==i?i:""}}));return i.push({height:P.kU.chart,elements:[{type:ws(t.style),overlays:s}]}),t.indicators.filter((t=>t.position===j.Ly.Below)).forEach((t=>{Cs(i,t,e)})),i}},7176:t=>{function e(t){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}e.keys=()=>[],e.resolve=e,e.id=7176,t.exports=e},7218:t=>{const e=window.FLibs.components;t.exports=e},5327:t=>{t.exports={white:"#fff",black:"#000",inherit:"inherit",transparent:"transparent",current:"currentColor",finviz:{"blue-gray":"#262931",blue:"#4fa4f4"},gray:{50:"#f3f3f5",100:"#dedfe5",200:"#c3c6d0",300:"#a3a8b9",400:"#868ea5",500:"#676f85",600:"#4c5263",700:"#353945",750:"#2c303b",800:"#22262f",900:"#14161d"},red:{50:"#fef0f0",100:"#fcd6d6",200:"#fbb4b4",300:"#fd8487",400:"#fb5057",500:"#d91e2b",600:"#9f1f2a",700:"#691f24",800:"#45171a",900:"#280e0f"},orange:{50:"#fef2eb",100:"#fdd9c5",200:"#fab889",300:"#ef9323",400:"#ca7b14",500:"#a0600e",600:"#79460a",700:"#583006",800:"#3d1e03",900:"#261101"},amber:{50:"#fef2e7",100:"#fedab5",200:"#fbba56",300:"#de9c1a",400:"#bb830f",500:"#956600",600:"#704b00",700:"#4f3400",800:"#372200",900:"#211300"},yellow:{50:"#fdf2df",100:"#fcdc86",200:"#f3c736",300:"#cda30b",400:"#b08900",500:"#8b6a00",600:"#664e21",700:"#46371e",800:"#2f2516",900:"#1b150d"},brightYellow:{50:"#fff699",100:"#fff200"},lime:{50:"#ebfad6",100:"#caec90",200:"#aad547",300:"#8db61e",400:"#769913",500:"#5b7800",600:"#435900",700:"#2e3e00",800:"#1e2a00",900:"#111900"},green:{50:"#e7f7e8",100:"#beeac1",200:"#86d895",300:"#34c062",400:"#00a449",500:"#19803d",600:"#265d35",700:"#1e4027",800:"#162b1b",900:"#0d1810"},emerald:{50:"#ddfaee",100:"#a2f0d2",200:"#4dddaf",300:"#25be93",400:"#1d9f7b",500:"#157e60",600:"#035d47",700:"#004139",800:"#002c22",900:"#001a13"},teal:{50:"#e0f8fc",100:"#9beef7",200:"#4fd8e5",300:"#27b9c4",400:"#109ba5",500:"#007c83",600:"#005b62",700:"#004045",800:"#002b2e",900:"#00191b"},blue:{50:"#ebf4fe",100:"#cae2fc",200:"#9bcbfa",300:"#57aefb",400:"#2f91ef",500:"#306dca",600:"#2f5091",700:"#263766",800:"#1b2542",900:"#101527"},violet:{50:"#f4f2fe",100:"#e1dbfd",200:"#c9befc",300:"#ad9bfb",400:"#9978f9",500:"#7c51e7",600:"#5e36b8",700:"#402979",800:"#2a1e4e",900:"#18122c"},purple:{50:"#f9f1fe",100:"#eed8fd",200:"#e1b6fc",300:"#d38bfb",400:"#c85bf9",500:"#ae27e0",600:"#8514ac",700:"#60077e",800:"#44005a",900:"#2a003a"},pink:{50:"#fef1f4",100:"#fdd6e1",200:"#fcb2c7",300:"#f984aa",400:"#f25090",500:"#cd2a74",600:"#9d1658",700:"#700c42",800:"#4e052b",900:"#32011a"}}},6035:t=>{const e=window.FLibs;t.exports=e},41:(t,e,i)=>{var s=i(1022),n=i(6648);void 0===n.FLibs&&(n.FLibs={}),void 0===n.FLibs.Charts&&(n.FLibs.Charts=s),t.exports=s},9326:(t,e,i)=>{"use strict";i.d(e,{Z:()=>c});var s=i(3888),n=i(9007),a=i(8723),r=i(8497),o=i(2444);function l(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class h extends r.Z{constructor(t,e){super(t,e),l(this,"name","Arrow"),l(this,"getBoundingPointKeys",(()=>({x:["x1","x2"],y:["y1","y2"]}))),this.renderContent=this.renderContent.bind(this),this.resize=this.resize.bind(this),this._thumbs=[new o.Z("l",(()=>this.attrs.x1),(()=>this.attrs.y1),this.resize,this.model),new o.Z("r",(()=>this.attrs.x2),(()=>this.attrs.y2),this.resize,this.model)],this.scale(this.getBoundingPointKeys())}getDefaults(){return{border:{width:3,color:this.getChartLayoutSettings().ElementSettings.Colors.line}}}renderContent(t){const{x1:e,x2:i,y1:s,y2:a}=this.scaled,r=(0,n.Lx)({x1:e,x2:i,y1:s,y2:a}),o=(0,n.RJ)({lineWidth:this.attrs.border.width,...r});t.translate(o.x,o.y),t.beginPath(),t.set("lineCap","round"),t.set("lineWidth",this.attrs.border.width),t.set("strokeStyle",this.attrs.border.color);const l=Math.PI/8;t.beginPath(),t.moveTo(r.x1,r.y1),t.lineTo(r.x2,r.y2),t.stroke();const h=Math.atan2(r.y2-r.y1,r.x2-r.x1),c=Math.abs(20/Math.cos(l)),d=h+l,u=r.x1+Math.cos(d)*c,m=r.y1+Math.sin(d)*c,g=h-l,f=r.x1+Math.cos(g)*c,p=r.y1+Math.sin(g)*c;t.beginPath(),t.moveTo(u,m),t.lineTo(r.x1,r.y1),t.lineTo(f,p),t.stroke(),t.translate(-1*o.x,-1*o.y),this.getShouldRenderThumbs()&&this.renderThumbs(t)}moveBy(t,e){this.attrs.x1+=t,this.attrs.x2+=t,this.attrs.y1+=e,this.attrs.y2+=e}resize(t){let{type:e,difX:i,difY:s}=t;"l"===e?(this.attrs.x1+=i,this.attrs.y1+=s):(this.attrs.x2+=i,this.attrs.y2+=s)}isInArea(t){return!super.isDrawingElementLockedOrInvisible()&&(a.ZP.distanceToSegment(t.scaled,this.scaled)<=10||super.isInArea(t))}}l(h,"type",s.LX.arrow),h.prototype.modalConfig={inputs:[{type:"line",name:"border"}]};const c=h},6946:(t,e,i)=>{"use strict";i.d(e,{Z:()=>c});i(8322);var s=i(3888),n=i(8723),a=i(8661),r=i(8497),o=i(2444);function l(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class h extends r.Z{constructor(t,e){super(t,e),l(this,"untranslatedContext",null),l(this,"name","Brush"),l(this,"brushPath",null),l(this,"cachedFill",{previousFill:"",shouldRenderFill:!1}),l(this,"moveByThumb",(t=>{let{difX:e,difY:i}=t;this.moveBy(e,i)})),l(this,"cachePointPositionTimestamp",(()=>{var t,e;const i=null===(t=this.model)||void 0===t||null===(e=t.chart())||void 0===e?void 0:e.quote();if(i){const t=this.attrs.points.map((t=>{let[e,s]=t;return[i.getTimestampFomPositionX(e),s]}));this.set({positionPointsTimestamps:t})}})),l(this,"roundToFixed",((t,e)=>Number.parseFloat(n.ZP.round({value:t,overridePlaces:e})))),l(this,"roundY",((t,e)=>{if(e<1){const i=Math.abs(Math.floor(Math.log10(Math.abs(e))+1));return i>0?this.roundToFixed(t,i+4):this.roundToFixed(t,i+3)}return e<10?this.roundToFixed(t,3):this.roundToFixed(t,2)})),this.untranslatedContext=(0,a.h)(document.createElement("canvas")),this.setFillCache()}getDefaults(){const{ElementSettings:t}=this.getChartLayoutSettings();return{fill:t.defaultTransparentFill,border:{width:3,color:t.Colors.border},isPolyLineClosed:!1}}setFillCache(){this.cachedFill.previousFill=this.attrs.fill,9===this.attrs.fill.length?this.cachedFill.shouldRenderFill="00"!==this.attrs.fill.slice(7):this.cachedFill.shouldRenderFill=!0}getShouldRenderFill(){return this.attrs.fill!==this.cachedFill.previousFill&&this.setFillCache(),this.cachedFill.shouldRenderFill}renderContent(t){var e,i;null!=this.attrs.border&&t.set("strokeStyle",this.attrs.border.color),t.set("lineCap","round"),t.set("lineJoin","round");const s=new Path2D,{points:n}=this.attrs;let a;if(t.beginPath(),s.moveTo(this.fx(n[0][0]),this.fy(n[0][1])),n.length>3){for(a=0;a<n.length-2;a++){const t=(this.fx(n[a][0])+this.fx(n[a+1][0]))/2,e=(this.fy(n[a][1])+this.fy(n[a+1][1]))/2;s.quadraticCurveTo(this.fx(n[a][0]),this.fy(n[a][1]),t,e)}s.quadraticCurveTo(this.fx(n[a][0]),this.fy(n[a][1]),this.fx(n[a+1][0]),this.fy(n[a+1][1]))}else for(const t of n)s.lineTo(this.fx(t[0]),this.fy(t[1]));this.attrs.isPolyLineClosed&&s.closePath(),this.brushPath=s,this.attrs.fill&&this.getShouldRenderFill()&&(t.set("fillStyle",this.attrs.fill),t.fill(s)),null!==(e=this.attrs)&&void 0!==e&&null!==(i=e.border)&&void 0!==i&&i.width&&(t.set("lineWidth",this.attrs.border.width),t.stroke(s)),this.getShouldRenderThumbs()&&this.renderThumbs(t)}getThumbs(){const[t,e]=this.attrs.points[0],[i,s]=this.attrs.points[this.attrs.points.length-1];return[new o.Z("first",(()=>t),(()=>e),this.moveByThumb,this.model),new o.Z("last",(()=>i),(()=>s),this.moveByThumb,this.model)]}moveBy(t,e){if(!this.getIsCreator())for(const i of this.attrs.points)i[0]+=t,i[1]+=e}onMouseUp(){const[t,e]=this.model.scale.y.domain();for(const i of this.attrs.points)i[0]=this.roundToFixed(i[0],2),i[1]=this.roundY(i[1],t-e);super.onMouseUp()}isInArea(t){var e;if(super.isDrawingElementLockedOrInvisible())return!1;const{points:i}=this.attrs;if((this.getShouldRenderFill()||this.attrs.isPolyLineClosed)&&this.brushPath&&null!==(e=this.untranslatedContext)&&void 0!==e&&e.isPointInPath(this.brushPath,t.scaled.x,t.scaled.y))return!0;if(i.length>1)for(let e=0;e<i.length-1;e++)if(n.ZP.distanceToSegment(t.scaled,{x1:this.fx(i[e][0]),y1:this.fy(i[e][1]),x2:this.fx(i[e+1][0]),y2:this.fy(i[e+1][1])})<=10)return!0;return super.isInArea(t)}updateScales(){const t=this.model.chart().quote(),{positionPointsTimestamps:e}=this.attrs;if(!t||!e)return;const i=e.map((e=>{let[i,s]=e;return[t.getPositionXFromTimestamp(i),s]}));this.set({points:i})}getAutosaveOmittedProperties(){return["points"]}}l(h,"type",s.LX.brushV1),h.prototype.modalConfig={inputs:[{type:"background",name:"fill"},{type:"border",name:"border",min:1,max:20,default:{}},{type:"checkbox",name:"isPolyLineClosed",label:"Close line"}]};const c=h},1906:(t,e,i)=>{"use strict";i.d(e,{Z:()=>m});i(7012);var s=i(1045),n=i.n(s),a=i(3888),r=i(8723),o=i(2740),l=i(2444);let h;!function(t){t[t.noTail=0]="noTail",t[t.topLeftCorner=1]="topLeftCorner",t[t.topRightCorner=2]="topRightCorner",t[t.bottomLeftCorner=3]="bottomLeftCorner",t[t.bottomRightCorner=4]="bottomRightCorner",t[t.topSide=5]="topSide",t[t.rightSide=6]="rightSide",t[t.bottomSide=7]="bottomSide",t[t.leftSide=8]="leftSide"}(h||(h={}));const c=(t,e,i)=>{const s=r.ZP.distance(e,i);return s<2*t?s/2:t};function d(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class u extends o.Z{constructor(t,e){super(t,e),d(this,"name","Callout"),d(this,"getBoundingPointKeys",(()=>({x:["x1","x2"],y:["y1","y2"]}))),this.resize=this.resize.bind(this),this._thumbs=[new l.Z("tail",(()=>this.attrs.x1),(()=>this.attrs.y1),this.resize,this.model)],this.scale(this.getBoundingPointKeys())}getModalConfigBase(){return{inputs:[{type:"multiline_string",name:"text",required:!0},{type:"font",name:"font"},{type:"background",name:"fillStyle",label:"Color",default:this.getChartLayoutSettings().ElementSettings.Colors.textWithoutBackground},{type:"background",name:"background",label:"Background",default:"rgba(0,0,0,0)"},{type:"border",name:"border",min:0}]}}getDefaults(){const{ElementSettings:t}=this.getChartLayoutSettings();return{text:"",font:{size:15,family:"Arial",style:"normal",weight:"normal"},fillStyle:t.Colors.textWithoutBackground,lineHeight:15,textAlign:"left",textBaseline:"alphabetic",padding:{top:0,right:0,bottom:0,left:0},background:t.defaultFill,border:{color:t.Colors.line,width:1}}}setupContext(t){this.context=t,t.set("font",this.font),t.set("fillStyle",this.attrs.fillStyle),t.set("textAlign",this.attrs.textAlign),t.set("textBaseline",this.attrs.textBaseline),this.setupTextMetricsCache()}setupTextMetricsCache(){var t,e;this.attrs.text===(null===(t=this.lastAttrs)||void 0===t?void 0:t.text)&&JSON.stringify(this.attrs.font)===JSON.stringify(null===(e=this.lastAttrs)||void 0===e?void 0:e.font)||(this.lastAttrs=n()({},this.attrs),this.lines=this.getLines().map((t=>({text:t,metrics:this.context.measureText(t)}))),this.measuredHeight=this.lines.reduce(((t,e,i)=>t+(e.metrics.actualBoundingBoxAscent+e.metrics.actualBoundingBoxDescent+(i!==this.lines.length-1?a.tr.S:0))),0))}renderContent(t){this.render(t),this.getShouldRenderThumbs()&&this.renderThumbs(t)}renderText(){let t=this.scaled.y2+this.attrs.padding.top,e=0;this.lines.forEach(((i,s)=>{t+=0===s?0:i.metrics.actualBoundingBoxAscent+e+a.tr.S,this.context.fillText(i.text,this.scaled.x2+this.attrs.padding.left,t),e=i.metrics.actualBoundingBoxDescent}))}renderBackground(){if(!this.attrs.background)return;const t=""===this.attrs.text?2*this.attrs.font.size:this.width,e=.5*this.attrs.font.size,i=this.attrs.border.width/2+.5*this.attrs.font.size,s=t<e?t/2:e;this.requiredTailHalfWidth=e,this.measuredHeight<e&&(this.measuredHeight=2*s);const n=this.scaled.y2-(this.lines[0].metrics.actualBoundingBoxAscent?this.lines[0].metrics.actualBoundingBoxAscent:this.measuredHeight);this.rectangleSides=(t=>{let{padding:e,radius:i,x2:s,y2:n,textWidth:a,measuredHeight:r}=t;return{topLeft:{x:s-e+i,y:n-e},topRight:{x:s+a+e-i,y:n-e},rightTop:{x:s+a+e,y:n-e+i},rightBottom:{x:s+a+e,y:n+e+r-i},bottomRight:{x:s+a+e-i,y:n+e+r},bottomLeft:{x:s-e+i,y:n+e+r},leftBottom:{x:s-e,y:n+e+r-i},leftTop:{x:s-e,y:n-e+i}}})({padding:i,radius:s,x2:this.scaled.x2,y2:n,textWidth:t,measuredHeight:this.measuredHeight}),this.tail=(t=>{let{rectangleSides:e,x1:i,y1:s}=t;return{tailRoot:{x:e.topLeft.x+(e.topRight.x-e.topLeft.x)/2,y:e.leftTop.y+(e.leftBottom.y-e.leftTop.y)/2},tailTip:{x:i,y:s}}})({rectangleSides:this.rectangleSides,x1:this.scaled.x1,y1:this.scaled.y1}),this.tailDirection=(t=>{let{tail:e,rectangleSides:i}=t;const{topLeft:s,topRight:n,rightTop:a,rightBottom:o,bottomRight:l,bottomLeft:c,leftBottom:d,leftTop:u}=i,{tailTip:m,tailRoot:g}=e;return r.ZP.twoSegmentLinesIntersection(m,g,s,u)?h.topLeftCorner:r.ZP.twoSegmentLinesIntersection(m,g,n,a)?h.topRightCorner:r.ZP.twoSegmentLinesIntersection(m,g,c,d)?h.bottomLeftCorner:r.ZP.twoSegmentLinesIntersection(m,g,l,o)?h.bottomRightCorner:r.ZP.twoSegmentLinesIntersection(m,g,s,n)?h.topSide:r.ZP.twoSegmentLinesIntersection(m,g,a,o)?h.rightSide:r.ZP.twoSegmentLinesIntersection(m,g,c,l)?h.bottomSide:r.ZP.twoSegmentLinesIntersection(m,g,u,d)?h.leftSide:h.noTail})({tail:this.tail,rectangleSides:this.rectangleSides}),this.context.beginPath(),this.context.set("fillStyle",this.attrs.background),this.context.lineJoin="round",(t=>{let{context:e,radius:i,requiredTailHalfWidth:s,tail:n,rectangleSides:a,tailDirection:o}=t;const{topLeft:l,topRight:d,rightTop:u,rightBottom:m,bottomRight:g,bottomLeft:f,leftBottom:p,leftTop:y}=a,{tailTip:v,tailRoot:b}=n;if(o===h.topLeftCorner?(e.moveTo(y.x,y.y),e.lineTo(v.x,v.y),e.lineTo(l.x,l.y)):(e.moveTo(y.x,y.y),e.arcTo(y.x,l.y,l.x,l.y,i)),o===h.topSide){const t=r.ZP.twoSegmentLinesIntersection(v,b,l,d);if(!t)return void e.lineTo(d.x,d.y);const i=c(s,l,d);t.x-i<l.x?(e.lineTo(v.x,v.y),e.lineTo(l.x+2*i,t.y)):t.x+i>d.x?(e.lineTo(d.x-2*i,t.y),e.lineTo(v.x,v.y),e.lineTo(d.x,t.y)):(e.lineTo(t.x-i,t.y),e.lineTo(v.x,v.y),e.lineTo(t.x+i,t.y),e.lineTo(d.x,d.y))}else e.lineTo(d.x,d.y);if(o===h.topRightCorner?(e.lineTo(d.x,d.y),e.lineTo(v.x,v.y),e.lineTo(u.x,u.y)):e.arcTo(u.x,d.y,u.x,u.y,i),o===h.rightSide){const t=r.ZP.twoSegmentLinesIntersection(v,b,u,m);if(!t)return void e.lineTo(m.x,m.y);const i=c(s,u,m);t.y-i<u.y?(e.lineTo(v.x,v.y),e.lineTo(u.x,u.y+2*i)):t.y+i>m.y?(e.lineTo(m.x,m.y-2*i),e.lineTo(v.x,v.y),e.lineTo(m.x,m.y)):(e.lineTo(t.x,t.y-i),e.lineTo(v.x,v.y),e.lineTo(t.x,t.y+i),e.lineTo(m.x,m.y))}else e.lineTo(m.x,m.y);if(o===h.bottomRightCorner?(e.lineTo(m.x,m.y),e.lineTo(v.x,v.y),e.lineTo(g.x,g.y)):e.arcTo(m.x,g.y,g.x,g.y,i),o===h.bottomSide){const t=r.ZP.twoSegmentLinesIntersection(v,b,f,g);if(!t)return void e.lineTo(f.x,f.y);const i=c(s,f,g);t.x+i>g.x?(e.lineTo(v.x,v.y),e.lineTo(g.x-2*i,t.y)):t.x-i<f.x?(e.lineTo(f.x+2*i,t.y),e.lineTo(v.x,v.y),e.lineTo(f.x,t.y)):(e.lineTo(t.x+i,t.y),e.lineTo(v.x,v.y),e.lineTo(t.x-i,t.y),e.lineTo(f.x,f.y))}else e.lineTo(f.x,f.y);if(o===h.bottomLeftCorner?(e.lineTo(f.x,f.y),e.lineTo(v.x,v.y),e.lineTo(p.x,p.y)):e.arcTo(p.x,f.y,p.x,p.y,i),o===h.leftSide){const t=r.ZP.twoSegmentLinesIntersection(v,b,y,p);if(!t)return void e.lineTo(y.x,y.y);const i=c(s,y,p);t.y+i>p.y?(e.lineTo(v.x,v.y),e.lineTo(p.x,p.y-2*i)):t.y-i<y.y?(e.lineTo(y.x,y.y+2*i),e.lineTo(v.x,v.y),e.lineTo(y.x,y.y)):(e.lineTo(t.x,t.y+i),e.lineTo(v.x,v.y),e.lineTo(t.x,t.y-i),e.lineTo(y.x,y.y))}else e.lineTo(y.x,y.y)})({context:this.context,radius:s,requiredTailHalfWidth:this.requiredTailHalfWidth,tail:this.tail,rectangleSides:this.rectangleSides,tailDirection:this.tailDirection}),this.context.closePath(),this.context.fill(),this.context.set("fillStyle",this.attrs.fillStyle),this.renderBorder()}isInArea(t){if(super.isDrawingElementLockedOrInvisible())return!1;if(this.lines&&this.rectangleSides&&this.rectangleSides.leftTop.x<t.scaled.x&&this.rectangleSides.topLeft.y<t.scaled.y&&this.rectangleSides.rightBottom.x>t.scaled.x&&this.rectangleSides.bottomRight.y>t.scaled.y)return!0;if(this.tail){const e=r.ZP.perpendicularPointToLine({distance:this.requiredTailHalfWidth,line:{x1:this.tail.tailTip.x,y1:this.tail.tailTip.y,x2:this.tail.tailRoot.x,y2:this.tail.tailRoot.y}}),i=e.x-this.tail.tailRoot.x,s=e.y-this.tail.tailRoot.y,n={x:this.tail.tailRoot.x+-1*i,y:this.tail.tailRoot.y+-1*s},a=[this.tail.tailTip,e,n];if(r.ZP.pointInPolygon(t.scaled,a))return!0}return super.isInArea(t)}moveBy(t,e){this.attrs.x2+=t,this.attrs.y2+=e}resize(t){let{type:e,difX:i,difY:s}=t;"tail"===e&&(this.attrs.x1+=i,this.attrs.y1+=s)}}d(u,"type",a.LX.calloutV1);const m=u},4567:(t,e,i)=>{"use strict";i.d(e,{Z:()=>h});var s=i(1675),n=i(3888),a=i(8497),r=i(2444);function o(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class l extends a.Z{constructor(t,e){super(t,e),o(this,"name","Curve"),o(this,"getBoundingPointKeys",(()=>({x:["x1","x2","x3"],y:["y1","y2","y3"]}))),this.render=this.render.bind(this),this.resize=this.resize.bind(this),this._thumbs=[new r.Z("a",(()=>this.attrs.x1),(()=>this.attrs.y1),this.resize,this.model),new r.Z("b",(()=>this.attrs.x2),(()=>this.attrs.y2),this.resize,this.model),new r.Z("c",(()=>this.attrs.x3||this.attrs.x2),(()=>this.attrs.y3||this.attrs.y2),this.resize,this.model)],this.scale(this.getBoundingPointKeys())}getDefaults(){return{border:{width:1,color:this.getChartLayoutSettings().ElementSettings.Colors.line}}}drawQuadraticCurve(t,e){const{points:i}=e;t.beginPath(),t.moveTo(i[0].x,i[0].y),t.quadraticCurveTo(i[1].x,i[1].y,i[2].x,i[2].y),t.stroke()}renderContent(t){const{x1:e,x2:i,x3:n,y1:a,y2:r,y3:o}=this.scaled;t.translate(.5,.5),t.set("lineWidth",this.attrs.border.width),t.set("strokeStyle",this.attrs.border.color),n&&o?(this.curve=s.D.quadraticFromPoints({x:e,y:a},{x:i,y:r},{x:n,y:o},.5),this.drawQuadraticCurve(t,this.curve)):(t.beginPath(),t.moveTo(e,a),t.lineTo(i,r),t.lineTo(n,o),t.stroke()),t.translate(-.5,-.5),this.getShouldRenderThumbs()&&this.renderThumbs(t)}moveBy(t,e){this.attrs.x1+=t,this.attrs.x2+=t,this.attrs.x3+=t,this.attrs.cp1x+=t,this.attrs.cp2x+=t,this.attrs.y1+=e,this.attrs.y2+=e,this.attrs.y3+=e,this.attrs.cp1y+=e,this.attrs.cp2y+=e}resize(t){let{type:e,difX:i,difY:s}=t;switch(e){case"a":this.attrs.x1+=i,this.attrs.y1+=s;break;case"b":this.attrs.x2+=i,this.attrs.y2+=s;break;case"c":this.attrs.x3+=i,this.attrs.y3+=s}}isInArea(t){return!super.isDrawingElementLockedOrInvisible()&&(!!(this.curve&&this.curve.project(t.scaled).d<=10)||this.thumbsAreInArea(t))}}o(l,"type",n.LX.curve),l.prototype.modalConfig={inputs:[{type:"line",name:"border"}]};const h=l},7418:(t,e,i)=>{"use strict";i.d(e,{v:()=>N});var s=i(3888),n=i(9326),a=i(6946),r=i(1906),o=i(4567),l=i(8497),h=i(7453),c=(i(8322),i(2444));function d(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class u extends l.Z{constructor(t,e){super(t,e),d(this,"name","Ellipse"),d(this,"getBoundingPointKeys",(()=>({x:["x1","x2"],y:["y1","y2"]}))),this.resize=this.resize.bind(this),this._thumbs=[new c.Z("x1",(()=>this.attrs.x1),(()=>this.attrs.y1),this.resize,this.model),new c.Z("x2",(()=>this.attrs.x2),(()=>this.attrs.y2),this.resize,this.model),new c.Z("lw",(()=>this.model.scale.x.invert(this.getCoordinates().centerLeftX)),(()=>this.model.scale.y.invert(this.getCoordinates().centerLeftY)),this.resize,this.model),new c.Z("rw",(()=>this.model.scale.x.invert(this.getCoordinates().centerRightX)),(()=>this.model.scale.y.invert(this.getCoordinates().centerRightY)),this.resize,this.model)];const i=this.getBoundingPointKeys();this.scale({x:[...i.x,"width"],y:i.y})}getDefaults(){const{ElementSettings:t}=this.getChartLayoutSettings();return{fill:t.defaultFill,border:{width:1,color:t.Colors.line}}}renderContent(t){const e=this.getCoordinates();t.set("fillStyle",this.attrs.fill),t.beginPath(),t.moveTo(e.bottomCenterX,e.bottomCenterY),t.bezierCurveTo(e.bottomRightX,e.bottomRightY,e.topRightX,e.topRightY,e.topCenterX,e.topCenterY),t.bezierCurveTo(e.topLeftX,e.topLeftY,e.bottomLeftX,e.bottomLeftY,e.bottomCenterX,e.bottomCenterY),t.closePath(),t.fill(),t.set("lineWidth",this.attrs.border.width),t.set("strokeStyle",this.attrs.border.color),0!==(null!=this.attrs.border?this.attrs.border.width:void 0)&&t.stroke(),this.getShouldRenderThumbs()&&this.renderThumbs(t)}moveBy(t,e){this.attrs.x1+=t,this.attrs.y1+=e,this.attrs.x2+=t,this.attrs.y2+=e}resize(t){let{type:e,difX:i,difY:s}=t;switch(e){case"x1":this.attrs.x1+=i,this.attrs.y1+=s;break;case"x2":this.attrs.x2+=i,this.attrs.y2+=s;break;case"lw":this.attrs.width+=i;break;case"rw":this.attrs.width-=i}}getCoordinates(){const t=Math.PI+Math.atan(-1/((this.scaled.y2-this.scaled.y1)/(this.scaled.x2-this.scaled.x1))),e=this.scaled.y1>this.scaled.y2?1:-1,i=this.scaled.width/2;let s=e*Math.abs(this.scaled.y1-this.scaled.y2)/Math.cos(t)/2;this.scaled.y1===this.scaled.y2&&(s=Math.abs(this.scaled.x1-this.scaled.x2)/2);const n=4*i/3,a=Math.sin(t)*s,r=Math.cos(t)*s,o=Math.cos(t)*n,l=Math.sin(t)*n,h=this.scaled.x1+a,c=this.scaled.y1-r,d=h-a,u=c+r,m=h+a,g=c-r;return{topCenterX:d,topCenterY:u,topRightX:d+o,topRightY:u+l,topLeftX:d-o,topLeftY:u-l,centerLeftX:h-o,centerLeftY:c-l,centerRightX:h+o,centerRightY:c+l,bottomCenterX:m,bottomCenterY:g,bottomLeftX:m-o,bottomLeftY:g-l,bottomRightX:m+o,bottomRightY:g+l}}isInArea(t){if(super.isDrawingElementLockedOrInvisible())return!1;const e=this.getCoordinates(),i=Math.min(this.scaled.x1,this.scaled.x2,e.centerRightX),s=Math.max(this.scaled.x1,this.scaled.x2,e.centerLeftX),n=Math.min(this.scaled.y1,this.scaled.y2,e.centerRightY),a=Math.max(this.scaled.y1,this.scaled.y2,e.centerLeftY);return i<t.scaled.x&&t.scaled.x<s&&n<t.scaled.y&&t.scaled.y<a||super.isInArea(t)}}d(u,"type",s.LX.ellipse),u.prototype.modalConfig={inputs:[{type:"background",name:"fill"},{type:"border",name:"border",min:1,default:{}}]};const m=u;var g=i(8054),f=i(9996),p=i(3878),y=i(3104),v=i(1100),b=i(6179),x=i(4692),C=i(1680),w=i(903),S=i(8723);function M(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class P extends l.Z{constructor(t,e){super(t,e),M(this,"name","Rotated rectangle"),M(this,"getBoundingPointKeys",(()=>({x:["x1","x2"],y:["y1","y2"]}))),this.resize=this.resize.bind(this);const i=this.model.scale.x.invert,s=this.model.scale.y.invert;this._thumbs=[new c.Z("ml",(()=>this.attrs.x1),(()=>this.attrs.y1),this.resize,this.model),new c.Z("mr",(()=>this.attrs.x2),(()=>this.attrs.y2),this.resize,this.model),new c.Z("tl",(()=>i(this.getRectCoordinates()[0][0])),(()=>s(this.getRectCoordinates()[0][1])),this.resize,this.model),new c.Z("tr",(()=>i(this.getRectCoordinates()[1][0])),(()=>s(this.getRectCoordinates()[1][1])),this.resize,this.model),new c.Z("bl",(()=>i(this.getRectCoordinates()[2][0])),(()=>s(this.getRectCoordinates()[2][1])),this.resize,this.model),new c.Z("br",(()=>i(this.getRectCoordinates()[3][0])),(()=>s(this.getRectCoordinates()[3][1])),this.resize,this.model)];const n=this.getBoundingPointKeys();this.scale({x:[...n.x,"height"],y:n.y})}getDefaults(){const{ElementSettings:t}=this.getChartLayoutSettings();return{fill:t.defaultFill,border:{width:1,color:t.Colors.border}}}renderContent(t){t.set("fillStyle",this.attrs.fill),t.beginPath();const e=this.getRectCoordinates();for(const i of e)t.lineTo(i[0],i[1]);t.lineTo(e[0][0],e[0][1]),t.fill(),t.set("lineWidth",this.attrs.border.width),t.set("strokeStyle",this.attrs.border.color),0!==(null!=this.attrs.border?this.attrs.border.width:void 0)&&t.stroke(),this.getShouldRenderThumbs()&&this.renderThumbs(t)}getRectCoordinates(){const t=this.scaled.x1,e=this.scaled.x2,i=this.scaled.y1,s=this.scaled.y2,{height:n}=this.scaled,a=-1/((s-i)/(e-t)),r=(i>s?1:-1)*Math.sqrt(n*n/(1+a*a))/2,o=a*r;let l=t-r,h=i-o,c=e-r,d=s-o,u=e+r,m=s+o,g=t+r,f=i+o;return i===s&&(l=t,h=i-n/2,c=e,d=s-n/2,u=e,m=s+n/2,g=t,f=i+n/2),[[l,h],[c,d],[u,m],[g,f]]}moveBy(t,e){this.attrs.x1+=t,this.attrs.y1+=e,this.attrs.x2+=t,this.attrs.y2+=e}resize(t){let{type:e,difX:i,difY:s}=t;switch(e){case"ml":this.attrs.x1+=i,this.attrs.y1+=s;break;case"mr":this.attrs.x2+=i,this.attrs.y2+=s;break;case"tl":case"tr":this.attrs.height+=s;break;case"bl":case"br":this.attrs.height-=s;break;default:return}}isInArea(t){if(super.isDrawingElementLockedOrInvisible())return!1;const e=this.getRectCoordinates().map((t=>({x:t[0],y:t[1]})));return!!S.ZP.pointInPolygon(t.scaled,e)||super.isInArea(t)}}M(P,"type",s.LX.rotatedRectangle),P.prototype.modalConfig={inputs:[{type:"background",name:"fill"},{type:"border",name:"border",min:1,default:{}}]};const k=P;var E=i(4385),T=i(1894),I=i(404);function A(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class L extends l.Z{constructor(t,e){super(t,e),A(this,"name","Symbol"),A(this,"getBoundingPointKeys",(()=>({x:["x1"],y:["y1"]}))),this.resize=this.resize.bind(this);const i=t=>this.getRotatedCoordinates(this.scaled.x1+t*(this.textWidth/2)*this.attrs.scaleX,this.scaled.y1),s=t=>this.getRotatedCoordinates(this.scaled.x1,this.scaled.y1+t*(this.textHeight/2)*this.attrs.scaleY);this._thumbs=[new c.Z("xr",(()=>this.model.scale.x.invert(i(1).x)),(()=>this.model.scale.y.invert(i(1).y)),this.resize,this.model),new c.Z("xl",(()=>this.model.scale.x.invert(i(-1).x)),(()=>this.model.scale.y.invert(i(-1).y)),this.resize,this.model),new c.Z("yt",(()=>this.model.scale.x.invert(s(1).x)),(()=>this.model.scale.y.invert(s(1).y)),this.resize,this.model),new c.Z("yb",(()=>this.model.scale.x.invert(s(-1).x)),(()=>this.model.scale.y.invert(s(-1).y)),this.resize,this.model),new c.Z("c",(()=>this.attrs.x1),(()=>this.attrs.y1),this.resize,this.model)],this.scale(this.getBoundingPointKeys()),this.attrs.angle=this.attrs.angle||0}renderContent(t){t.set("font","36px FontAwesome"),t.set("fillStyle",this.attrs.fill),t.set("textAlign","left"),t.set("textBaseline","top"),this.textWidth=t.measureText(this.attrs.symbol).width,this.textHeight=36;const e=this.attrs.scaleX,i=this.attrs.scaleY,s=this.textWidth/-2,n=this.textHeight/-2;t.save(),t.translate(this.scaled.x1,this.scaled.y1),t.rotate(this.attrs.angle),t.scale(e,i),t.fillText(this.attrs.symbol,s,n),t.restore(),this.getShouldRenderThumbs()&&this.renderThumbs(t)}getRotatedCoordinates(t,e){const i=this.scaled.x1,s=this.scaled.y1,n=t-i,a=e-s;return{x:i+(n*Math.cos(this.attrs.angle)-a*Math.sin(this.attrs.angle)),y:s+(a*Math.cos(this.attrs.angle)+n*Math.sin(this.attrs.angle))}}moveBy(t,e){return this.attrs.x1+=t,this.attrs.y1+=e}resize(t){let{type:e,difX:i,difY:s}=t;switch(e){case"xl":this.attrs.scaleX-=i;break;case"xr":this.attrs.scaleX+=i;break;case"yt":this.attrs.scaleY-=s;break;case"yb":this.attrs.scaleY+=s;break;case"c":this.attrs.angle+=i/5}}isInArea(t){if(super.isDrawingElementLockedOrInvisible())return!1;const e=this.textWidth/2*this.attrs.scaleX,i=this.textHeight/2*this.attrs.scaleY,s=Math.min(this.scaled.x1-e,this.scaled.x1+e),n=Math.max(this.scaled.x1-e,this.scaled.x1+e),a=Math.min(this.scaled.y1-i,this.scaled.y1+i),r=Math.max(this.scaled.y1-i,this.scaled.y1+i);return s<t.scaled.x&&t.scaled.x<n&&a<t.scaled.y&&t.scaled.y<r||super.isInArea(t)}}A(L,"type",s.LX.symbol),L.prototype.defaults={fill:"rgba(0,0,0,1)"},L.prototype.modalConfig={inputs:[{type:"background",name:"fill",label:"Fill"}]};const D=L;var O=i(2740),R=i(8136),F=i(521),B=i(1913);const N=Object.freeze({[s.LX.element]:l.Z,[s.LX.arrow]:n.Z,[s.LX.brushV1]:a.Z,[s.LX.calloutV1]:r.Z,[s.LX.curve]:o.Z,[s.LX.elliottWaves]:h.Z,[s.LX.ellipse]:m,[s.LX.ellipseV1]:g.Z,[s.LX.fibonacciRetracements]:f.Z,[s.LX.horizontalLine]:p.Z,[s.LX.line]:y.Z,[s.LX.measure]:v.Z,[s.LX.pitchforkV1]:b.Z,[s.LX.polygon]:x.Z,[s.LX.position]:C.Z,[s.LX.rectangle]:w.Z,[s.LX.rotatedRectangle]:k,[s.LX.rotatedRectangleV1]:E.Z,[s.LX.scaledLine]:T.Z,[s.LX.scaledText]:I.Z,[s.LX.symbol]:D,[s.LX.text]:O.Z,[s.LX.triangle]:R.Z,[s.LX.verticalLine]:F.Z,[s.LX.xabcd]:B.Z})},8497:(t,e,i)=>{"use strict";i.d(e,{Z:()=>p});i(7012),i(8322),i(9841),i(5422);var s=i(2340),n=i.n(s),a=i(1045),r=i.n(a),o=i(9754),l=i.n(o),h=i(7005),c=i.n(h),d=i(3888),u=i(5622),m=i(5200);function g(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class f extends n().Module{static fromObject(t,e){return new this(t,e)}static getNumOfBarsBuffer(t){return 0}constructor(t,e){super(t,e),g(this,"isCreator",!1),g(this,"isCreatorDialogOpen",!1),g(this,"attrs",{}),g(this,"model",void 0),g(this,"_thumbs",void 0),g(this,"activeThumb",null),g(this,"isMouseDown",!1),g(this,"isSelected",!1),g(this,"isHovered",!1),g(this,"isEditInProgress",!1),g(this,"getBoundingPointKeys",(()=>{})),g(this,"fx",(t=>this.model.scale.x(t))),g(this,"fy",(t=>this.model.scale.y(t))),g(this,"cachePointPositionTimestamp",(()=>{var t;const e=null===(t=this.model)||void 0===t?void 0:t.chart().quote();if(e){const{x:t}=this.getBoundingPointKeys(),i=t.reduce(((t,i)=>{const s=this.attrs[i];return{...t,[i]:s&&e.getTimestampFomPositionX(s)}}),{});this.set({positionTimestamps:i})}})),this.model=e,this.getDefaults?this.set(this.getDefaults()||{}):this.set(this.defaults||{}),this.set(t),this._thumbs=[],this.onMouseDown=this.onMouseDown.bind(this),this.onMouseMove=this.onMouseMove.bind(this),this.onMouseUp=this.onMouseUp.bind(this),this.bind("mousedown",this.onMouseDown),this.bind("mousemove",this.onMouseMove),this.bind("mouseup",this.onMouseUp),this.bind("change",(()=>{var t,e,i,s,n,a;const r=this.getIsChartEvent()?null===(t=(e=this.model).chartEvents)||void 0===t||null===(i=t.call(e))||void 0===i?void 0:i.findByAttribute("instance",this):null===(s=(n=this.model).elements)||void 0===s||null===(a=s.call(n))||void 0===a?void 0:a.findByAttribute("instance",this);null==r||r.trigger("change",r)}))}get type(){return this.constructor.type}getThumbs(){return this._thumbs}moveBy(t,e){}setIsSelected(t){this.isSelected=t,this.trigger("change")}setIsHovered(t){this.isHovered=t,this.trigger("change")}getShouldRenderThumbs(){return this.isSelected||this.isHovered}getIsPaneSelection(){var t;const e=null===(t=this.model.elements().findByAttribute("instance",this))||void 0===t?void 0:t.pane();return(null==e?void 0:e.selection)===this}set(t){const e=Object.keys(t).reduce(((t,e)=>({...t,[e]:this.attrs[e]})),{});if(JSON.stringify(t)!==JSON.stringify(e)){const e=(t,e,i)=>{if(this.getIsDrawing()&&"visibility"===i)return null!=e?e:{}};l()(this.attrs,t,e),this.getIsPaneSelection()&&!this.getIsCreator()&&this.cachePointPositionTimestamp(),this.trigger("change",this)}return this}get(t){return this.attrs[t]}scale(t){let{x:e,y:i}=t;this.scaled={},e.forEach((t=>{Object.defineProperty(this.scaled,t,{get:()=>this.fx(this.attrs[t])})})),i.forEach((t=>{Object.defineProperty(this.scaled,t,{get:()=>this.fy(this.attrs[t])})}))}render(t){}renderThumbs(t){this.isHovered&&!this.isSelected&&(t.globalAlpha=.5),this.getThumbs().map((e=>e.render(t))),t.globalAlpha=1}onMouseDown(t){this.isMouseDown=!0,this.isEditInProgress=!0;for(const e of this.getThumbs())if(e.isInArea(t))return this.activeThumb=e,void this.activeThumb.startEditing(t)}onMouseMove(t){t.mouseDown&&null!=this.activeThumb&&(this.activeThumb.moveTo(t),this.trigger("change"))}onMouseUp(t){this.isMouseDown=!1,this.isEditInProgress=!1,this.activeThumb=null,this.getIsCreator()||this.cachePointPositionTimestamp(),this.trigger("change",this)}updateScales(){const t=this.model.chart().quote(),{positionTimestamps:e}=this.attrs;if(!t||!e)return;const i=Object.entries(e).reduce(((e,i)=>{let[s,n]=i;return{...e,[s]:n&&t.getPositionXFromTimestamp(n)}}),{});this.set(i)}thumbsAreInArea(t){for(const e of this.getThumbs())if(e.isInArea(t))return!0;return!1}isInArea(t){return this.thumbsAreInArea(t)}isDrawingElementLockedOrInvisible(){return this.model.chart().chart_layout().isLockDrawingsActive||!this.getIsVisible()}getModalConfig(){let t;t=this.getModalConfigBase?r()({},this.getModalConfigBase()):r()({},this.modalConfig),this.getIsDrawing()&&t.inputs.push({type:"visibility",name:"visibility",label:"Visibility"}),null==t.title&&(t.title=this.name);for(const e of t.inputs)null!=e.default&&(e.value=e.default),null!=this.attrs[e.name]&&(e.value=this.attrs[e.name]);return t}toObject(){return r()({},this.attrs,{type:this.type})}toConfig(){return this.toObject()}getAutosaveOmittedProperties(){return this.attrs.positionTimestamps?Object.keys(this.attrs.positionTimestamps):[]}toAutosaveConfig(){return c()(this.toConfig(),this.getAutosaveOmittedProperties())}replaceMyself(t){setTimeout((()=>{t.cachePointPositionTimestamp();const e=this.model.elements().findByAttribute("instance",this);var i;e?e.replace(t):null===(i=window.Sentry)||void 0===i||i.captureMessage("element.ts replaceMyself",{extra:{oldElement:{type:null==this?void 0:this.type,isCreator:null==this?void 0:this.isCreator,isMouseDown:null==this?void 0:this.isMouseDown,isSelected:null==this?void 0:this.isSelected,isHovered:null==this?void 0:this.isHovered,isEditInProgress:null==this?void 0:this.isEditInProgress},newElement:{type:null==t?void 0:t.type,isCreator:null==t?void 0:t.isCreator,isMouseDown:null==t?void 0:t.isMouseDown,isSelected:null==t?void 0:t.isSelected,isHovered:null==t?void 0:t.isHovered,isEditInProgress:null==t?void 0:t.isEditInProgress}}})}))}toString(){return this.name}getIsCreator(){return this.isCreator}getIsCreatorDialogOpen(){return this.isCreatorDialogOpen}release(){this.cachePointPositionTimestamp(),this.unbind()}getChartLayoutSettings(){return(0,u.getChartLayoutSettings)(this.model.chart().chart_layout())}getIsDrawing(){return!!this.type.startsWith("canvas/")}getIsChartEvent(){return!(null==this||!this.type.startsWith("chartEvent/"))}getIsVisible(){var t;const{micro:e,macro:i}=d.bI[this.model.chart().quote().timeframe],s=null===(t=this.attrs.visibility)||void 0===t?void 0:t[i];return void 0===s||0!==Object.keys(s).length&&(0,m.mh)({value:e,min:s.from,max:s.to})}setVisibilityTo(t){const{macro:e,micro:i}=d.bI[this.model.chart().quote().timeframe],s=Object.keys(d.iR).indexOf(e);let n=[],a={};switch(t){case d.iL.currentAndAbove:n=Object.keys(d.iR).filter(((t,e)=>e<s)),a={from:i};break;case d.iL.currentAndBelow:n=Object.keys(d.iR).filter(((t,e)=>e>s)),a={to:i};break;case d.iL.currentOnly:n=Object.keys(d.iR).filter(((t,e)=>e!==s)),a={from:i,to:i};break;case d.iL.all:default:return void this.set({visibility:{}})}this.set({visibility:Object.assign({},...n.map((t=>({[t]:{}}))),{[e]:a})})}getIsInChartView(t){return!0}}g(f,"type",d.LX.element);const p=f},7453:(t,e,i)=>{"use strict";i.d(e,{Z:()=>d});i(8322);var s=i(3888),n=i(9007),a=i(8723),r=i(8497),o=i(2740),l=i(2444);function h(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class c extends r.Z{constructor(t,e){super(t,e),h(this,"name","Elliott Wave"),h(this,"waves",["","I","II","III","IV","V"]),h(this,"cachePointPositionTimestamp",(()=>{var t;const e=null===(t=this.model)||void 0===t?void 0:t.chart().quote();if(e){const t=this.attrs.waves.map((t=>({...t,x:e.getTimestampFomPositionX(t.x)})));this.set({positionWavesTimestamps:t})}})),this.resize=this.resize.bind(this)}getDefaults(){return{border:{width:2,color:this.getChartLayoutSettings().ElementSettings.Colors.line}}}renderContent(t){const e=(0,n.CH)(this.attrs.border.width);t.set("lineWidth",this.attrs.border.width),t.set("strokeStyle",this.attrs.border.color),t.translate(e,e),t.beginPath(),t.moveTo(Math.round(this.fx(this.attrs.waves[0].x)),Math.round(this.fy(this.attrs.waves[0].y)));for(const e of this.attrs.waves.slice(1))t.lineTo(Math.round(this.fx(e.x)),Math.round(this.fy(e.y)));t.stroke(),t.translate(-1*e,-1*e);const i=new o.Z({font:{size:8,style:"bold"},textBaseline:s.EQ.middle,textAlign:s.PH.center,fillStyle:this.getChartLayoutSettings().ElementSettings.Colors.textWithoutBackground},this.model);for(let e=0;e<this.attrs.waves.length;e++){let s;const n=this.attrs.waves[e];s=e>0&&this.attrs.waves[e-1].y>n.y?this.fy(n.y)+8:this.fy(n.y)-8,i.set({text:this.waves[e],x:this.fx(n.x),y:s}),i.render(t)}this.getShouldRenderThumbs()&&this.renderThumbs(t)}getThumbs(){return this.attrs.waves.map(((t,e)=>new l.Z("".concat(e),(()=>t.x),(()=>t.y),this.resize,this.model)))}updateScales(){const t=this.model.chart().quote(),{positionWavesTimestamps:e}=this.attrs;if(!t||!e)return;const i=e.map((e=>({...e,x:t.getPositionXFromTimestamp(e.x)})));this.set({waves:i})}moveBy(t,e){for(const i of this.attrs.waves)i.x+=t,i.y+=e}resize(t){let{type:e,difX:i,difY:s}=t;this.attrs.waves[+e].x+=i,this.attrs.waves[+e].y+=s}isInArea(t){if(super.isDrawingElementLockedOrInvisible())return!1;const e=this.attrs.waves;for(let i=0;i<e.length-1;i++)if(a.ZP.distanceToSegment(t.scaled,{x1:this.fx(e[i].x),y1:this.fy(e[i].y),x2:this.fx(e[i+1].x),y2:this.fy(e[i+1].y)})<=10)return!0;return super.isInArea(t)}getAutosaveOmittedProperties(){return["waves"]}}h(c,"type",s.LX.elliottWaves),c.prototype.modalConfig={inputs:[{type:"line",name:"border"}]};const d=c},8054:(t,e,i)=>{"use strict";i.d(e,{Z:()=>c});var s=i(3888),n=i(8723),a=i(8661),r=i(8497),o=i(2444);function l(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class h extends r.Z{constructor(t,e){super(t,e),l(this,"name","Ellipse"),l(this,"untranslatedContext",null),l(this,"getBoundingPointKeys",(()=>({x:["x1","x2","cursorTargetX"],y:["y1","y2","cursorTargetY"]}))),l(this,"getRotatedPointCoordinates",(t=>{let{rotationAxisPoint:e,pointToRotate:i,oldLinePoint:s,newLinePoint:a}=t;const r=n.ZP.sharedPointLinesAngle({sharedPoint:e,oldLinePoint:s,newLinePoint:a}),o=n.ZP.rotatedPointCoordinates({rotationAxisPoint:e,angle:r,pointToRotate:i});return{x:this.model.scale.x.invert(o.x),y:this.model.scale.y.invert(o.y)}})),this.resize=this.resize.bind(this),this.untranslatedContext=(0,a.h)(document.createElement("canvas")),this._thumbs=[new o.Z("left",(()=>this.attrs.x1),(()=>this.attrs.y1),this.resize,this.model),new o.Z("right",(()=>this.attrs.x2),(()=>this.attrs.y2),this.resize,this.model),new o.Z("top",(()=>this.getEllipsePoints(!0).P2.x||this.attrs.x1),(()=>this.getEllipsePoints(!0).P2.y||this.attrs.y1),this.resize,this.model),new o.Z("bottom",(()=>this.getEllipsePoints(!0).P4.x||this.attrs.x2),(()=>this.getEllipsePoints(!0).P4.y||this.attrs.y2),this.resize,this.model)],this.scale(this.getBoundingPointKeys())}getDefaults(){const{ElementSettings:t}=this.getChartLayoutSettings();return{fill:t.defaultFill,border:{width:1,color:t.Colors.border}}}renderContent(t){const e=this.getEllipsePoints(),i=new Path2D;t.set("fillStyle",this.attrs.fill),t.beginPath(),e.P2.x===e.P3.x||e.P2.y===e.P3.y?(i.lineTo(e.P1.x,e.P1.y),i.lineTo(e.P2.x,e.P2.y)):(i.moveTo(e.P4.x,e.P4.y),i.bezierCurveTo(e.CP4.x,e.CP4.y,e.CP1.x,e.CP1.y,e.P2.x,e.P2.y),i.bezierCurveTo(e.CP2.x,e.CP2.y,e.CP3.x,e.CP3.y,e.P4.x,e.P4.y),i.closePath(),this.ellipsePath=i,t.fill(i)),t.set("lineWidth",this.attrs.border.width),t.set("strokeStyle",this.attrs.border.color),t.stroke(i),this.getShouldRenderThumbs()&&this.renderThumbs(t)}getEllipsePoints(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const{x1:e,x2:i,y1:s,y2:a,cursorTargetX:r,cursorTargetY:o}=this.scaled,l={x:i,y:a},h={x:e,y:s};let c;if(isNaN(r)||isNaN(o))return{P1:h,P2:l,P3:l,P4:h};{const t={x:r,y:o},l={x1:e,y1:s,x2:i,y2:a},h=n.ZP.distanceToLine(t,l);c=n.ZP.perpendicularPointToLine({distance:h,line:l})}const d=(l.x+h.x)/2,u=(l.y+h.y)/2,m=c.x-l.x,g=c.y-l.y,f={x:d+m,y:u+g},p={x:d+-1*m,y:u+-1*g},y=this.model.scale.x.invert,v=this.model.scale.y.invert;if(t)return{P2:{x:y(f.x),y:v(f.y)},P4:{x:y(p.x),y:v(p.y)}};const b=(c.x-f.x)/.75-(c.x-f.x),x=(c.y-f.y)/.75-(c.y-f.y),C=l.x+b,w=l.y+x,S=h.x-b,M=h.y-x,P={x:c.x+b,y:c.y+x},k=P.x-C,E=P.y-w;return{P1:l,P2:f,P3:h,P4:p,CP1:P,CP2:{x:S+k,y:M+E},CP3:{x:S+-1*k,y:M+-1*E},CP4:{x:C+-1*k,y:w+-1*E}}}moveBy(t,e){this.attrs.x1+=t,this.attrs.y1+=e,this.attrs.x2+=t,this.attrs.y2+=e,this.attrs.cursorTargetX+=t,this.attrs.cursorTargetY+=e}resize(t){let{type:e,difX:i,difY:s,area:n}=t;switch(e){case"left":const t={x:this.attrs.x1+i,y:this.attrs.y1+s},e=this.getRotatedPointCoordinates({rotationAxisPoint:{x:this.scaled.x2,y:this.scaled.y2},pointToRotate:{x:this.scaled.cursorTargetX,y:this.scaled.cursorTargetY},oldLinePoint:{x:this.scaled.x1,y:this.scaled.y1},newLinePoint:{x:this.model.scale.x(t.x),y:this.model.scale.y(t.y)}});this.attrs={...this.attrs,x1:t.x,y1:t.y,cursorTargetX:e.x,cursorTargetY:e.y};break;case"right":const a={x:this.attrs.x2+i,y:this.attrs.y2+s},r=this.getRotatedPointCoordinates({rotationAxisPoint:{x:this.scaled.x1,y:this.scaled.y1},pointToRotate:{x:this.scaled.cursorTargetX,y:this.scaled.cursorTargetY},oldLinePoint:{x:this.scaled.x2,y:this.scaled.y2},newLinePoint:{x:this.model.scale.x(a.x),y:this.model.scale.y(a.y)}});this.attrs={...this.attrs,x2:a.x,y2:a.y,cursorTargetX:r.x,cursorTargetY:r.y};break;case"top":case"bottom":this.attrs={...this.attrs,cursorTargetX:n.x,cursorTargetY:n.y}}}isInArea(t){var e;return!super.isDrawingElementLockedOrInvisible()&&(!(!this.ellipsePath||null===(e=this.untranslatedContext)||void 0===e||!e.isPointInPath(this.ellipsePath,t.scaled.x,t.scaled.y))||super.isInArea(t))}}l(h,"type",s.LX.ellipseV1),h.prototype.modalConfig={inputs:[{type:"background",name:"fill"},{type:"border",name:"border",min:1,default:{}}]};const c=h},9996:(t,e,i)=>{"use strict";i.d(e,{Z:()=>c});i(9841),i(8322);var s=i(3888),n=i(9007),a=i(8497),r=i(2740),o=i(2444);function l(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class h extends a.Z{constructor(t,e){super(t,e),l(this,"name","Fibonacci Retracements"),l(this,"getBoundingPointKeys",(()=>({x:["x1","x2"],y:["y1","y2"]}))),this.resize=this.resize.bind(this),this._thumbs=[new o.Z("oneCoefficient_1",(()=>this.attrs.x1),(()=>this.attrs.y1),this.resize,this.model),new o.Z("oneCoefficient_2",(()=>this.attrs.x2),(()=>this.attrs.y1),this.resize,this.model),new o.Z("zeroCoefficient_1",(()=>this.attrs.x1),(()=>this.attrs.y2),this.resize,this.model),new o.Z("zeroCoefficient_2",(()=>this.attrs.x2),(()=>this.attrs.y2),this.resize,this.model)],this.parseCoefficients(this.attrs.coefficients),this.scale(this.getBoundingPointKeys())}getDefaults(){return{border:{width:1,color:this.getChartLayoutSettings().ElementSettings.Colors.line},coefficients:[0,.236,.382,.5,.618,1].toString()}}parseCoefficients(t){if(!this.coefficients||t!==this.coefficients.default){const e=t.split(",").map((t=>parseFloat(t.trim())));this.coefficients={default:t,parsed:e,max:Math.max(...e)}}}getMaxCoefficientUnscaledY(){return this.model.scale.y.invert(this.scaled.y2-this.coefficients.max*(this.scaled.y2-this.scaled.y1))}renderContent(t){const{x1:e,x2:i,y1:a,y2:o}=this.scaled,l=(0,n.Lx)({x1:e,x2:i,y1:a,y2:o}),h=(0,n.RJ)({lineWidth:this.attrs.border.width,...l,y2:l.y1});t.set("lineWidth",this.attrs.border.width),t.set("strokeStyle",this.attrs.border.color),this.parseCoefficients(this.attrs.coefficients);const c=this.attrs.y2-this.attrs.y1,d=l.y2-l.y1;t.translate(h.x,h.y),t.beginPath();for(const e of this.coefficients.parsed)t.moveTo(l.x1,Math.round(o-e*d)),t.lineTo(l.x2,Math.round(o-e*d));t.stroke(),t.translate(-1*h.x,-1*h.y);const u=new r.Z({x:l.x1,font:{size:8,style:"bold"},textBaseline:s.EQ.bottom,fillStyle:this.attrs.border.color,textAlign:s.PH.left},this.model);l.x1>l.x2&&u.set({textAlign:s.PH.right});for(const e of this.coefficients.parsed){const i=this.attrs.y2-e*c;u.set({text:(100*e).toFixed(1)+"%: "+i.toFixed(2),y:Math.round(this.fy(i)-this.attrs.border.width/2)}),u.render(t)}this.getShouldRenderThumbs()&&this.renderThumbs(t)}getThumbs(){return this.coefficients.max>1&&this._thumbs.length<6&&(this._thumbs=[...this._thumbs,new o.Z("maxCoefficient_1",(()=>this.attrs.x1),(()=>this.getMaxCoefficientUnscaledY()),this.resize,this.model),new o.Z("maxCoefficient_2",(()=>this.attrs.x2),(()=>this.getMaxCoefficientUnscaledY()),this.resize,this.model)]),this.coefficients.max<=1&&this._thumbs.length>4&&this._thumbs.splice(4),this._thumbs}moveBy(t,e){this.attrs.x1+=t,this.attrs.x2+=t,this.attrs.y1+=e,this.attrs.y2+=e}resize(t){let{type:e,difX:i,difY:s}=t;switch(e){case"oneCoefficient_1":this.attrs.x1+=i,this.attrs.y1+=s;break;case"oneCoefficient_2":this.attrs.x2+=i,this.attrs.y1+=s;break;case"zeroCoefficient_1":this.attrs.x1+=i,this.attrs.y2+=s;break;case"zeroCoefficient_2":this.attrs.x2+=i,this.attrs.y2+=s;break;case"maxCoefficient_1":this.attrs.x1+=i,this.attrs.y1+=s/this.coefficients.max;break;case"maxCoefficient_2":this.attrs.x2+=i,this.attrs.y1+=s/this.coefficients.max}}isInArea(t){if(super.isDrawingElementLockedOrInvisible())return!1;const e=this.coefficients.max>1&&this.getMaxCoefficientUnscaledY(),i=Math.min(this.attrs.x1,this.attrs.x2),s=Math.max(this.attrs.x1,this.attrs.x2),n=e?Math.min(this.attrs.y1,this.attrs.y2,e):Math.min(this.attrs.y1,this.attrs.y2),a=e?Math.max(this.attrs.y1,this.attrs.y2,e):Math.max(this.attrs.y1,this.attrs.y2);return i<t.x&&t.x<s&&n<t.y&&t.y<a||super.isInArea(t)}}l(h,"type",s.LX.fibonacciRetracements),h.prototype.modalConfig={inputs:[{type:"line",name:"border"},{type:"string",name:"coefficients",label:"Coefficients"}]};const c=h},3878:(t,e,i)=>{"use strict";i.d(e,{Z:()=>h});var s=i(3888),n=i(8723),a=i(1894),r=i(2740);function o(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class l extends a.Z{constructor(t,e){if(super(t,e),o(this,"name","Horizontal line"),o(this,"decimalPlaces",2),o(this,"getBoundingPointKeys",(()=>({x:["x1","x2"],y:["y1","y2"]}))),this.updateDecimalPlaces(),this.attrs.y1&&(this.attrs.y1=Number(n.ZP.round({value:this.attrs.y1,overridePlaces:this.decimalPlaces}))),this.modalConfig){const t="0.".concat("0".repeat(this.decimalPlaces-1),"1");this.modalConfig.inputs[1]={...this.modalConfig.inputs[1],step:t,min:Number(t)}}this.renderContent=this.renderContent.bind(this),this._thumbs=[]}updateDecimalPlaces(){const t=this.model.chart().quote();this.decimalPlaces=t?n.ZP.getInstrumentDecimalPlaces({instrument:t.instrument,value:t.lastClose}):2}renderContent(t){const{ChartSettings:e}=this.getChartLayoutSettings();this.attrs.y2=this.attrs.y1,this.attrs.x1=-1*e.left.width,this.attrs.x2=this.model.chart().quote().getBarIndex(this.model.chart().quote().close.length-1)+this.model.chart().width,super.renderContent(t)}renderLabels(t){if(this.attrs.y1){this.updateDecimalPlaces();const{ChartSettings:e,IndicatorSettings:i}=this.getChartLayoutSettings(),n=this.model.elements().all().some((t=>t.isIndicator()))?i:e;t.translate(this.model.chart().width-n.right.width,n.top.height),new r.Z({x:6,y:this.scaled.y1,font:{size:8,style:"bold"},lineHeight:8,padding:{top:2,right:2,bottom:2,left:2},fillStyle:"#fff",background:"#000",textBaseline:s.EQ.middle,text:this.attrs.y1.toFixed(this.decimalPlaces).toString()},this.model).render(t)}}moveBy(t,e){this.attrs.y1+=e}resize(t){let{difY:e}=t;this.moveBy(0,e)}}o(l,"type",s.LX.horizontalLine),l.prototype.modalConfig={inputs:[{type:"line",name:"border"},{type:"number",name:"y1",label:"Price",allowDecimal:!0}]};const h=l},3104:(t,e,i)=>{"use strict";i.d(e,{Z:()=>c});var s=i(3888),n=i(9007),a=i(8723),r=i(8497),o=i(2444);function l(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class h extends r.Z{constructor(t,e){super(t,e),l(this,"getBoundingPointKeys",(()=>({x:["x1","x2"],y:["y1","y2"]}))),this.render=this.render.bind(this),this.resize=this.resize.bind(this),this._thumbs=[new o.Z("l",(()=>this.attrs.x1),(()=>this.attrs.y1),this.resize,this.model),new o.Z("r",(()=>this.attrs.x2),(()=>this.attrs.y2),this.resize,this.model)]}getDefaults(){return{lineWidth:1,strokeStyle:this.getChartLayoutSettings().ElementSettings.Colors.line}}render(t){const{x1:e,y1:i,x2:s,y2:a,lineWidth:r}=this.attrs,o=(0,n.Lx)({x1:e,y1:i,x2:s,y2:a}),l=(0,n.RJ)({lineWidth:r,...o});t.translate(l.x,l.y),t.beginPath(),t.set("lineWidth",this.attrs.lineWidth),t.set("strokeStyle",this.attrs.strokeStyle),t.moveTo(o.x1,o.y1),this.attrs.dashLength&&t.setLineDash([this.attrs.dashLength]),t.lineTo(o.x2,o.y2),t.stroke(),this.attrs.dashLength&&t.setLineDash([]),t.translate(-1*l.x,-1*l.y),this.getShouldRenderThumbs()&&this.renderThumbs(t)}moveBy(t,e){this.attrs.x1+=t,this.attrs.x2+=t,this.attrs.y1+=e,this.attrs.y2+=e}resize(t){let{type:e,difX:i,difY:s}=t;"l"===e?(this.attrs.x1+=i,this.attrs.y1+=s):(this.attrs.x2+=i,this.attrs.y2+=s)}isInArea(t){return!super.isDrawingElementLockedOrInvisible()&&(a.ZP.distanceToSegment(t,this.attrs)<=10||super.isInArea(t))}}l(h,"type",s.LX.line);const c=h},1100:(t,e,i)=>{"use strict";i.d(e,{Z:()=>u});var s=i(3888),n=i(9007),a=i(9431),r=i(5200),o=i(8497),l=i(2740),h=i(2444);function c(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class d extends o.Z{constructor(t,e){super(t,e),c(this,"name","Measure"),c(this,"x1Dif",void 0),c(this,"x2Dif",void 0),c(this,"startingX1",void 0),c(this,"startingX2",void 0),c(this,"getBoundingPointKeys",(()=>({x:["x1","x2"],y:["y1","y2"]}))),c(this,"getVolumeSumString",(()=>{const{volume:t,barIndex:e}=this.model.chart().quote(),i=Math.round(Math.min(this.attrs.x1,this.attrs.x2)),s=Math.round(Math.max(this.attrs.x1,this.attrs.x2));let n=0;for(let a=i;a<=s;a++){const i=e.indexOf(a);i>=0&&(n+=t[i])}return"Vol ".concat((0,a.t$)(n))})),this.resize=this.resize.bind(this),this._thumbs=[new h.Z("tl",(()=>this.attrs.x1),(()=>this.attrs.y1),this.resize,this.model),new h.Z("br",(()=>this.attrs.x2),(()=>this.attrs.y2),this.resize,this.model)],this.scale(this.getBoundingPointKeys()),this.x1Dif=this.x2Dif=0,this.startingX1=this.attrs.x1,this.startingX2=this.attrs.x2}renderContent(t){t.set("fillStyle",this.attrs.fill);const{x1:e,x2:i,y1:a,y2:o}=this.scaled,h=(0,n.Lx)({x1:e,x2:i,y1:a,y2:o}),c=h.x2-h.x1,d=h.y2-h.y1;t.fillRect(e,h.y1,c,d);const u=this.attrs.y2-this.attrs.y1,m=100/this.attrs.y1*u,g="".concat(u.toFixed(2)," (").concat(m.toFixed(2),"%)"),f=new l.Z({text:"".concat((0,r.E8)({number:Math.abs(this.attrs.x2-this.attrs.x1),numOfDecimalPlaces:2})," bars"),fillStyle:"#333",font:{size:10,family:"Arial",weight:"bold"},textBaseline:s.EQ.middle},this.model),p=e+c/2,y=h.y1+d/2;let v=f.measure(t);f.set({x:p-v/2,y:y-f.getHeight()}),f.render(t),f.set({text:g}),v=f.measure(t),f.set({x:p-v/2,y}),f.render(t),f.set({text:this.getVolumeSumString()}),v=f.measure(t),f.set({x:p-v/2,y:y+f.getHeight()}),f.render(t),this.getShouldRenderThumbs()&&this.renderThumbs(t)}addToCoordinates(t){this.attrs.y1+=t.y1||0,this.attrs.y2+=t.y2||0,this.x1Dif+=t.x1||0,this.x2Dif+=t.x2||0;const e=~~(this.startingX1+this.x1Dif)+(this.x1Dif<0?1:0);~~this.attrs.x1-e!=0&&(this.attrs.x1=e);const i=~~(this.startingX2+this.x2Dif)+(this.x2Dif<0?1:0);~~this.attrs.x2-i!=0&&(this.attrs.x2=i)}moveBy(t,e){return this.addToCoordinates({x1:t,y1:e,x2:t,y2:e})}resize(t){let{type:e,difX:i,difY:s}=t;"tl"===e?this.addToCoordinates({x1:i,y1:s}):this.addToCoordinates({x2:i,y2:s})}isInArea(t){if(super.isDrawingElementLockedOrInvisible())return!1;const e=Math.round(this.attrs.x1),i=Math.round(this.attrs.x2),s=Math.min(e,i),n=Math.max(e,i),a=Math.min(this.attrs.y1,this.attrs.y2),r=Math.max(this.attrs.y1,this.attrs.y2);return s<t.x&&t.x<n&&a<t.y&&t.y<r||super.isInArea(t)}onMouseDown(t){super.onMouseDown(t),this.startingX1=this.attrs.x1,this.startingX2=this.attrs.x2}onMouseUp(t){super.onMouseUp(t),this.x1Dif=this.x2Dif=0}}c(d,"type",s.LX.measure),d.prototype.defaults={fill:"rgba(180,220,255,0.8)"},d.prototype.modalConfig={inputs:[{type:"background",name:"fill"}]};const u=d},6179:(t,e,i)=>{"use strict";i.d(e,{Z:()=>f});var s=i(3888),n=i(9007),a=i(8723),r=i(5965),o=i(8497),l=i(2444),h=i(5200);const c=t=>{let{sides:e,rayOrigin:i,rayDirection:s}=t;if(i.x===s.x&&i.y===s.y)return s;let n=s,r=0;for(let t=0;t<e.length;t++){const o=a.ZP.getRayToLineSegmentIntersection(i,s,e[t][0],e[t][1]);if(o){const t=a.ZP.distance(o,i);t>r&&(0,h.mh)({value:t})&&(r=t,n={x:o.x,y:o.y})}}return n},d=t=>{let{paneModel:e,rayOrigin:i,rayDirectionControlPoint1:s,rayDirectionControlPoint2:r,trend1:o,trend2:l}=t;const h=(t=>{const{left:e,right:i,top:s,bottom:n}=t.getChartLayoutSettings().ChartSettings,{leftOffset:a,width:r}=t.chart(),o=Math.abs(a),l=o+r-e.width-i.width,h=t.height-s.height-n.height,c={x:o,y:0},d={x:l,y:0},u={x:o,y:h},m={x:l,y:h};return[[c,d],[d,m],[u,m],[c,u]]})(e),d={medianRay:{P1:i,P2:s},trend1Ray1:void 0,trend2Ray1:void 0,trend1Ray2:void 0,trend2Ray2:void 0};if(!r)return d.medianRay={P1:(0,n.Lx)(i),P2:(0,n.Lx)(c({sides:h,rayOrigin:i,rayDirection:s}))},d;const m=a.ZP.getMiddlePointOnLineSegment(s,r),g={x:m.x-i.x,y:m.y-i.y},f={x:s.x-r.x,y:s.y-r.y},p=a.ZP.normalizeVector(f),y=a.ZP.distance(m,s);if(d.medianRay={P1:(0,n.Lx)(i),P2:(0,n.Lx)(c({sides:h,rayOrigin:i,rayDirection:m}))},o.active){const t=u({trend:o.trend,medianToControlPointDistance:y,normalizedControlToControlPointVector:p,rayOriginToRayDirectionVector:g,medianRayDirectionPoint:m,sides:h});d.trend1Ray1=t.trendRay1,d.trend1Ray2=t.trendRay2}if(l.active){const t=u({trend:l.trend,medianToControlPointDistance:y,normalizedControlToControlPointVector:p,rayOriginToRayDirectionVector:g,medianRayDirectionPoint:m,sides:h});d.trend2Ray1=t.trendRay1,d.trend2Ray2=t.trendRay2}return d},u=t=>{let{trend:e,medianToControlPointDistance:i,normalizedControlToControlPointVector:s,rayOriginToRayDirectionVector:r,medianRayDirectionPoint:o,sides:l}=t;const h=i*e,d=a.ZP.addPoints(o,a.ZP.multiplyVectorByScalar(s,h)),u=a.ZP.subtractPoints(o,a.ZP.multiplyVectorByScalar(s,h)),m={x:d.x+r.x,y:d.y+r.y},g={x:u.x+r.x,y:u.y+r.y};return{trendRay1:{P1:(0,n.Lx)(d),P2:(0,n.Lx)(c({sides:l,rayOrigin:d,rayDirection:m}))},trendRay2:{P1:(0,n.Lx)(u),P2:(0,n.Lx)(c({sides:l,rayOrigin:u,rayDirection:g}))}}};function m(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class g extends o.Z{constructor(t,e){super(t,e),m(this,"name","Pitchfork"),m(this,"getBoundingPointKeys",(()=>({x:["x1","x2","x3"],y:["y1","y2","y3"]}))),this.resize=this.resize.bind(this),this._thumbs=[new l.Z("medianRayOrigin",(()=>this.attrs.x1),(()=>this.attrs.y1),this.resize,this.model),new l.Z("rayDirectionControlPoint1",(()=>this.attrs.x2),(()=>this.attrs.y2),this.resize,this.model),new l.Z("rayDirectionControlPoint2",(()=>this.attrs.x3),(()=>this.attrs.y3),this.resize,this.model)],this.scale(this.getBoundingPointKeys())}getDefaults(){return{median:{color:"#e72f2f",width:1},trend1:{color:"#004ad31c",active:!0,trend:1},trend2:{color:"#00ca4e1f",active:!0,trend:.5}}}renderContent(t){var e;const{x1:i,x2:s,x3:a,y1:o,y2:l,y3:h}=this.scaled,c=(0,n.CH)(this.attrs.median.width);t.translate(c,c);const{medianRay:u,trend1Ray1:m,trend1Ray2:g,trend2Ray1:f,trend2Ray2:p}=d({paneModel:this.model,rayOrigin:{x:i,y:o},rayDirectionControlPoint1:{x:s,y:l},rayDirectionControlPoint2:Number.isNaN(a)||Number.isNaN(h)?void 0:{x:a,y:h},trend1:this.attrs.trend1,trend2:this.attrs.trend2});t.set("lineWidth",this.attrs.median.width);const y=[{trend:this.attrs.trend1,line1:m,line2:g},{trend:this.attrs.trend2,line1:f,line2:p}].sort(((t,e)=>Math.abs(t.trend.trend)>Math.abs(e.trend.trend)?-1:Math.abs(t.trend.trend)<Math.abs(e.trend.trend)?1:0));y.forEach(((e,i)=>{if(e.line1&&e.line2){const{line1:s,line2:n}=e,a=(0,r.Qm)(e.trend.color),o=y[i+1];t.beginPath(),t.moveTo(s.P1.x,s.P1.y),t.lineTo(s.P2.x,s.P2.y),i!==y.length-1&&o.line1&&o.line2&&(t.lineTo(o.line1.P2.x,o.line1.P2.y),t.lineTo(o.line1.P1.x,o.line1.P1.y),t.moveTo(o.line2.P1.x,o.line2.P1.y),t.lineTo(o.line2.P2.x,o.line2.P2.y)),t.lineTo(n.P2.x,n.P2.y),t.lineTo(n.P1.x,n.P1.y),t.closePath(),t.set("fillStyle",e.trend.color),t.fill(),t.beginPath(),t.moveTo(s.P1.x,s.P1.y),t.lineTo(s.P2.x,s.P2.y),t.moveTo(n.P1.x,n.P1.y),t.lineTo(n.P2.x,n.P2.y),t.set("strokeStyle",a),t.stroke()}})),t.beginPath(),t.moveTo(u.P1.x,u.P1.y),t.lineTo(u.P2.x,u.P2.y);const v=null!==(e=y.filter((t=>t.line1&&t.line2&&t.trend.active&&Math.abs(t.trend.trend)>=1))[0])&&void 0!==e?e:{};v.line1&&v.line2?(t.moveTo(v.line1.P1.x,v.line1.P1.y),t.lineTo(v.line2.P1.x,v.line2.P1.y)):Number.isNaN(a)||Number.isNaN(h)||(t.moveTo(s,l),t.lineTo(a,h)),t.set("strokeStyle",this.attrs.median.color),t.stroke(),t.translate(-1*c,-1*c),this.getShouldRenderThumbs()&&this.renderThumbs(t)}moveBy(t,e){this.attrs.x1+=t,this.attrs.y1+=e,this.attrs.x2+=t,this.attrs.y2+=e,this.attrs.x3+=t,this.attrs.y3+=e}resize(t){let{type:e,difX:i,difY:s}=t;switch(e){case"medianRayOrigin":this.attrs.x1+=i,this.attrs.y1+=s;break;case"rayDirectionControlPoint1":this.attrs.x2+=i,this.attrs.y2+=s;break;case"rayDirectionControlPoint2":this.attrs.x3+=i,this.attrs.y3+=s}}isInArea(t){if(super.isDrawingElementLockedOrInvisible())return!1;const{x1:e,x2:i,x3:s,y1:n,y2:r,y3:o}=this.scaled,{medianRay:l,trend1Ray1:h,trend1Ray2:c,trend2Ray1:u,trend2Ray2:m}=d({paneModel:this.model,rayOrigin:{x:e,y:n},rayDirectionControlPoint1:{x:i,y:r},rayDirectionControlPoint2:Number.isNaN(s)||Number.isNaN(o)?void 0:{x:s,y:o},trend1:this.attrs.trend1,trend2:this.attrs.trend2}),g=Math.abs(this.attrs.trend1.trend)>Math.abs(this.attrs.trend2.trend)?{line1:h,line2:c}:{line1:u,line2:m};return a.ZP.distanceToSegment(t.scaled,{x1:l.P1.x,y1:l.P1.y,x2:l.P2.x,y2:l.P2.y})<=10||(!Number.isNaN(s)&&!Number.isNaN(o)&&a.ZP.distanceToSegment(t.scaled,{x1:i,y1:r,x2:s,y2:o})<=10||(!!(g.line1&&g.line2&&a.ZP.pointInPolygon(t.scaled,[g.line1.P1,g.line1.P2,g.line2.P2,g.line2.P1]))||super.isInArea(t)))}}m(g,"type",s.LX.pitchforkV1),g.prototype.modalConfig={inputs:[{type:"line",name:"median"},{type:"trend",name:"trend1"},{type:"trend",name:"trend2"}]};const f=g},4692:(t,e,i)=>{"use strict";i.d(e,{Z:()=>c});i(8322);var s=i(3888),n=i(9007),a=i(8723),r=i(8497),o=i(2444);function l(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class h extends r.Z{constructor(t,e){super(t,e),l(this,"name","Polygon"),l(this,"cachePointPositionTimestamp",(()=>{var t,e;const i=null===(t=this.model)||void 0===t||null===(e=t.chart())||void 0===e?void 0:e.quote();if(i){const t=this.attrs.points.map((t=>({...t,x:i.getTimestampFomPositionX(t.x)})));this.set({positionPointsTimestamps:t})}})),this.resize=this.resize.bind(this),this.attrs.fill=this.attrs.fill||"rgba(50, 60, 70, 0.8)"}getDefaults(){const{ElementSettings:t}=this.getChartLayoutSettings();return{fill:t.defaultFill,border:{width:1,color:t.Colors.border}}}renderContent(t){t.set("fillStyle",this.attrs.fill),t.set("lineWidth",this.attrs.border.width),t.set("strokeStyle",this.attrs.border.color);const e=(0,n.CH)(this.attrs.border.width);t.translate(e,e);const{points:i}=this.attrs;t.beginPath(),t.moveTo(this.fx(i[0].x),this.fy(i[0].y));for(const e of i.slice(1))t.lineTo(this.fx(e.x),this.fy(e.y));this.isPolygon()&&(t.closePath(),t.fill()),t.translate(-1*e,-1*e),0!==(null!=this.attrs.border?this.attrs.border.width:void 0)&&t.stroke(),this.getShouldRenderThumbs()&&this.renderThumbs(t)}getThumbs(){return this.attrs.points.map(((t,e)=>new o.Z("".concat(e),(()=>t.x),(()=>t.y),this.resize,this.model)))}updateScales(){const t=this.model.chart().quote(),{positionPointsTimestamps:e}=this.attrs;if(!t||!e)return;const i=e.map((e=>({...e,x:t.getPositionXFromTimestamp(e.x)})));this.set({points:i})}moveBy(t,e){for(const i of this.attrs.points)i.x+=t,i.y+=e}resize(t){let{type:e,difX:i,difY:s}=t;const n=this.attrs.points.length-1;!this.isPolygon()||0!=+e&&+e!==n?(this.attrs.points[+e].x+=i,this.attrs.points[+e].y+=s):(this.attrs.points[0].x+=i,this.attrs.points[0].y+=s,this.attrs.points[n].x+=i,this.attrs.points[n].y+=s)}isPolygon(){var t,e;return this.attrs.points[0].x===(null===(t=this.attrs.points.last())||void 0===t?void 0:t.x)&&this.attrs.points[0].y===(null===(e=this.attrs.points.last())||void 0===e?void 0:e.y)}isInArea(t){if(super.isDrawingElementLockedOrInvisible())return!1;const e=this.attrs.points.map((t=>({x:this.fx(t.x),y:this.fy(t.y)})));if(this.isPolygon()){if(a.ZP.pointInPolygon(t.scaled,e))return!0}else for(let i=0;i<e.length-1;i++)if(a.ZP.distanceToSegment(t.scaled,{x1:e[i].x,y1:e[i].y,x2:e[i+1].x,y2:e[i+1].y})<=10)return!0;return super.isInArea(t)}getAutosaveOmittedProperties(){return["points"]}}l(h,"type",s.LX.polygon),h.prototype.modalConfig={inputs:[{type:"background",name:"fill"},{type:"border",name:"border",min:1,default:{}}]};const c=h},1680:(t,e,i)=>{"use strict";i.d(e,{Z:()=>c});i(8322),i(9841);var s=i(3888),n=i(9007),a=i(8497),r=i(2740),o=i(2444);function l(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class h extends a.Z{constructor(t,e){super(t,e),l(this,"name","Position"),l(this,"x1Dif",void 0),l(this,"x2Dif",void 0),l(this,"getBoundingPointKeys",(()=>({x:["x1","x2"],y:["targetY","centerY","stopY"]}))),this.resize=this.resize.bind(this),this._thumbs=[new o.Z("t1",(()=>this.attrs.x1),(()=>this.attrs.targetY),this.resize,this.model),new o.Z("t2",(()=>this.attrs.x2),(()=>this.attrs.targetY),this.resize,this.model),new o.Z("s1",(()=>this.attrs.x1),(()=>this.attrs.stopY),this.resize,this.model),new o.Z("s2",(()=>this.attrs.x2),(()=>this.attrs.stopY),this.resize,this.model),new o.Z("c1",(()=>this.attrs.x1),(()=>this.attrs.centerY),this.resize,this.model),new o.Z("c2",(()=>this.attrs.x2),(()=>this.attrs.centerY),this.resize,this.model)],this.scale(this.getBoundingPointKeys()),this.x1Dif=this.x2Dif=0}renderContent(t){const{x1:e,x2:i,targetY:a,centerY:o,stopY:l}=this.scaled,h=(0,n.Lx)({x1:e,x2:i,targetY:a,centerY:o,stopY:l});let c,d,u;const m=h.x2-h.x1;t.set("fillStyle",this.attrs.targetColor),t.fillRect(h.x1,h.targetY,m,h.centerY-h.targetY),t.set("fillStyle",this.attrs.stopColor),t.fillRect(h.x1,h.centerY,m,h.stopY-h.centerY);const g=Math.abs(this.attrs.targetY-this.attrs.centerY),f=100/this.attrs.centerY*g,p="Target: ".concat(g.toFixed(2)," (").concat(f.toFixed(2),"%)"),y=Math.abs(this.attrs.stopY-this.attrs.centerY),v=100/this.attrs.centerY*y,b="Stop: ".concat(y.toFixed(2)," (").concat(v.toFixed(2),"%)");this.attrs.targetY>this.attrs.centerY?(c=1,u=s.EQ.bottom,d=s.EQ.top):(c=-1,u=s.EQ.top,d=s.EQ.bottom);const x=new r.Z({text:p,fillStyle:this.getChartLayoutSettings().ElementSettings.Colors.textWithoutBackground,font:{size:10,family:"Arial",weight:"bold"},y:h.targetY-4*c,textBaseline:u},this.model);let C=x.measure(t);x.set({x:h.x1+m/2-C/2}),x.render(t),x.set({text:b,y:h.stopY+4*c,textBaseline:d}),C=x.measure(t),x.set({x:h.x1+m/2-C/2}),x.render(t),this.getShouldRenderThumbs()&&this.renderThumbs(t)}addToCoordinates(t){let e,i,s;t.targetY&&(s=this.attrs.targetY+t.targetY,(this.attrs.targetY>this.attrs.centerY&&s<this.attrs.centerY||this.attrs.targetY<this.attrs.centerY&&s>this.attrs.centerY)&&(this.attrs.stopY=this.attrs.centerY-(this.attrs.stopY-this.attrs.centerY)),this.attrs.targetY=s),t.stopY&&(s=this.attrs.stopY+t.stopY,(this.attrs.stopY>this.attrs.centerY&&s<this.attrs.centerY||this.attrs.stopY<this.attrs.centerY&&s>this.attrs.centerY)&&(this.attrs.targetY=this.attrs.centerY-(this.attrs.targetY-this.attrs.centerY)),this.attrs.stopY=s),t.centerY&&(this.attrs.stopY<(e=this.attrs.centerY+t.centerY)&&e<this.attrs.targetY||this.attrs.stopY>(i=this.attrs.centerY+t.centerY)&&i>this.attrs.targetY)&&(this.attrs.centerY+=t.centerY),this.x1Dif+=t.x1||0,this.x2Dif+=t.x2||0;const n=~~this.x1Dif||~~this.x2Dif;0!==n&&(null!=t.x1&&(this.attrs.x1+=n),null!=t.x2&&(this.attrs.x2+=n),this.x1Dif=this.x2Dif=0)}moveBy(t,e){return this.addToCoordinates({x1:t,x2:t,targetY:e,centerY:e,stopY:e})}resize(t){let{type:e,difX:i,difY:s}=t;const[n,a]=e.split(""),r={["x".concat(a)]:i,[{t:"targetY",c:"centerY",s:"stopY"}[n]]:s};return this.addToCoordinates(r)}isInArea(t){if(super.isDrawingElementLockedOrInvisible())return!1;const e=Math.round(this.attrs.x1),i=Math.round(this.attrs.x2),s=Math.min(e,i),n=Math.max(e,i),a=Math.min(this.attrs.targetY,this.attrs.stopY),r=Math.max(this.attrs.targetY,this.attrs.stopY);return s<t.x&&t.x<n&&a<t.y&&t.y<r||super.isInArea(t)}}l(h,"type",s.LX.position),h.prototype.defaults={targetColor:"rgba(0,200,0,0.3)",stopColor:"rgba(200,0,0,0.3)"},h.prototype.modalConfig={inputs:[{type:"background",name:"targetColor"},{type:"background",name:"stopColor"}]};const c=h},903:(t,e,i)=>{"use strict";i.d(e,{Z:()=>h});var s=i(3888),n=i(9007),a=i(8497),r=i(2444);function o(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class l extends a.Z{constructor(t,e){super(t,e),o(this,"name","Rectangle"),o(this,"getBoundingPointKeys",(()=>({x:["x1","x2"],y:["y1","y2"]}))),this.resize=this.resize.bind(this),this._thumbs=[new r.Z("br",(()=>this.attrs.x2),(()=>this.attrs.y2),this.resize,this.model),new r.Z("tl",(()=>this.attrs.x1),(()=>this.attrs.y1),this.resize,this.model)],this.scale(this.getBoundingPointKeys())}getDefaults(){const{ElementSettings:t}=this.getChartLayoutSettings();return{fill:t.defaultFill,border:{width:1,color:t.Colors.border}}}renderContent(t){const{x1:e,x2:i,y1:s,y2:a}=this.scaled,r=(0,n.Lx)({x1:e,x2:i,y1:s,y2:a}),o=r.x2-r.x1,l=r.y2-r.y1;if(t.set("fillStyle",this.attrs.fill),t.fillRect(r.x1,r.y1,o,l),0!==(null!=this.attrs.border?this.attrs.border.width:void 0)){t.set("lineWidth",this.attrs.border.width),t.set("strokeStyle",this.attrs.border.color);const e=(0,n.CH)(this.attrs.border.width);t.strokeRect(r.x1+e,r.y1+e,o,l)}this.getShouldRenderThumbs()&&this.renderThumbs(t)}moveBy(t,e){this.attrs.x1+=t,this.attrs.x2+=t,this.attrs.y1+=e,this.attrs.y2+=e}resize(t){let{type:e,difX:i,difY:s}=t;if("tl"===e)return this.attrs.x1+=i,this.attrs.y1+=s;this.attrs.x2+=i,this.attrs.y2+=s}isInArea(t){if(super.isDrawingElementLockedOrInvisible())return!1;const e=Math.min(this.attrs.x1,this.attrs.x2),i=Math.max(this.attrs.x1,this.attrs.x2),s=Math.min(this.attrs.y1,this.attrs.y2),n=Math.max(this.attrs.y1,this.attrs.y2);return e<t.x&&t.x<i&&s<t.y&&t.y<n||super.isInArea(t)}}o(l,"type",s.LX.rectangle),l.prototype.modalConfig={inputs:[{type:"background",name:"fill"},{type:"border",name:"border",min:1,default:{}}]};const h=l},4385:(t,e,i)=>{"use strict";i.d(e,{Z:()=>c});var s=i(3888),n=i(9007),a=i(8723),r=i(8497),o=i(2444);function l(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class h extends r.Z{constructor(t,e){super(t,e),l(this,"name","New Rotated Rectangle"),l(this,"getBoundingPointKeys",(()=>({x:["x1","x2","cursorTargetX"],y:["y1","y2","cursorTargetY"]}))),l(this,"getRotatedPointCoordinates",(t=>{let{rotationAxisPoint:e,pointToRotate:i,oldLinePoint:s,newLinePoint:n}=t;const r=a.ZP.sharedPointLinesAngle({sharedPoint:e,oldLinePoint:s,newLinePoint:n}),o=a.ZP.rotatedPointCoordinates({rotationAxisPoint:e,angle:r,pointToRotate:i});return{x:this.model.scale.x.invert(o.x),y:this.model.scale.y.invert(o.y)}})),this.resize=this.resize.bind(this),this._thumbs=[new o.Z("middleLeft",(()=>this.attrs.x1),(()=>this.attrs.y1),this.resize,this.model),new o.Z("middleRight",(()=>this.attrs.x2),(()=>this.attrs.y2),this.resize,this.model),new o.Z("topRight",(()=>this.getRectCoordinates(!0).P1.x||this.attrs.x2),(()=>this.getRectCoordinates(!0).P1.y||this.attrs.y2),this.resize,this.model),new o.Z("topLeft",(()=>this.getRectCoordinates(!0).P2.x||this.attrs.x2),(()=>this.getRectCoordinates(!0).P2.y||this.attrs.y2),this.resize,this.model),new o.Z("bottomLeft",(()=>this.getRectCoordinates(!0).P3.x||this.attrs.x1),(()=>this.getRectCoordinates(!0).P3.y||this.attrs.y1),this.resize,this.model),new o.Z("bottomRight",(()=>this.getRectCoordinates(!0).P4.x||this.attrs.x1),(()=>this.getRectCoordinates(!0).P4.y||this.attrs.y1),this.resize,this.model)],this.scale(this.getBoundingPointKeys())}getDefaults(){const{ElementSettings:t}=this.getChartLayoutSettings();return{fill:t.defaultFill,border:{width:1,color:t.Colors.border}}}renderContent(t){const{P1:e,P2:i,P3:s,P4:a}=this.getRectCoordinates(),r={P1:(0,n.Lx)(e),P2:(0,n.Lx)(i),P3:(0,n.Lx)(s),P4:(0,n.Lx)(a)},o=(0,n.CH)(this.attrs.border.width);t.set("fillStyle",this.attrs.fill),t.translate(o,o),t.beginPath(),r.P1.x===r.P4.x&&r.P1.y===r.P4.y?(t.lineTo(r.P1.x,r.P1.y),t.lineTo(r.P2.x,r.P2.y)):(t.lineTo(r.P1.x,r.P1.y),t.lineTo(r.P2.x,r.P2.y),t.lineTo(r.P3.x,r.P3.y),t.lineTo(r.P4.x,r.P4.y),t.closePath(),t.fill()),t.translate(-1*o,-1*o),t.set("lineWidth",this.attrs.border.width),t.set("strokeStyle",this.attrs.border.color),t.stroke(),this.getShouldRenderThumbs()&&this.renderThumbs(t)}getRectCoordinates(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const{x1:e,x2:i,y1:s,y2:n,cursorTargetX:r,cursorTargetY:o}=this.scaled;let l;if(isNaN(r)||isNaN(o))return{P1:{x:i,y:n},P2:{x:e,y:s},P3:{x:e,y:s},P4:{x:i,y:n}};{const t={x:r,y:o},h={x1:e,y1:s,x2:i,y2:n},c=a.ZP.distanceToLine(t,h);l=a.ZP.perpendicularPointToLine({distance:c,line:h})}const h=l.x-i,c=l.y-n,d={x:i+h,y:n+c},u={x:e+h,y:s+c},m={x:e+-1*h,y:s+-1*c},g={x:i+-1*h,y:n+-1*c},f=this.model.scale.x.invert,p=this.model.scale.y.invert;return t?{P1:{x:f(d.x),y:p(d.y)},P2:{x:f(u.x),y:p(u.y)},P3:{x:f(m.x),y:p(m.y)},P4:{x:f(g.x),y:p(g.y)}}:{P1:d,P2:u,P3:m,P4:g}}moveBy(t,e){this.attrs.x1+=t,this.attrs.y1+=e,this.attrs.x2+=t,this.attrs.y2+=e,this.attrs.cursorTargetX+=t,this.attrs.cursorTargetY+=e}resize(t){let{type:e,difX:i,difY:s,area:n}=t;switch(e){case"middleLeft":const t={x:this.attrs.x1+i,y:this.attrs.y1+s},e=this.getRotatedPointCoordinates({rotationAxisPoint:{x:this.scaled.x2,y:this.scaled.y2},pointToRotate:{x:this.scaled.cursorTargetX,y:this.scaled.cursorTargetY},oldLinePoint:{x:this.scaled.x1,y:this.scaled.y1},newLinePoint:{x:this.model.scale.x(t.x),y:this.model.scale.y(t.y)}});this.attrs={...this.attrs,x1:t.x,y1:t.y,cursorTargetX:e.x,cursorTargetY:e.y};break;case"middleRight":const a={x:this.attrs.x2+i,y:this.attrs.y2+s},r=this.getRotatedPointCoordinates({rotationAxisPoint:{x:this.scaled.x1,y:this.scaled.y1},pointToRotate:{x:this.scaled.cursorTargetX,y:this.scaled.cursorTargetY},oldLinePoint:{x:this.scaled.x2,y:this.scaled.y2},newLinePoint:{x:this.model.scale.x(a.x),y:this.model.scale.y(a.y)}});this.attrs={...this.attrs,x2:a.x,y2:a.y,cursorTargetX:r.x,cursorTargetY:r.y};break;case"topRight":case"topLeft":case"bottomLeft":case"bottomRight":this.attrs={...this.attrs,cursorTargetX:n.x,cursorTargetY:n.y}}}isInArea(t){if(super.isDrawingElementLockedOrInvisible())return!1;const e=this.getRectCoordinates(),i=Object.keys(e).map((t=>({x:e[t].x,y:e[t].y})));return!!a.ZP.pointInPolygon(t.scaled,i)||super.isInArea(t)}}l(h,"type",s.LX.rotatedRectangleV1),h.prototype.modalConfig={inputs:[{type:"background",name:"fill"},{type:"border",name:"border",min:1,default:{}}]};const c=h},1894:(t,e,i)=>{"use strict";i.d(e,{Z:()=>h});var s=i(3888),n=i(9007),a=i(8723),r=i(3104);function o(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class l extends r.Z{constructor(t,e){super(t,e),o(this,"name","Line"),o(this,"getBoundingPointKeys",(()=>({x:["x1","x2"],y:["y1","y2"]}))),this.renderContent=this.renderContent.bind(this),this.scale(this.getBoundingPointKeys())}getDefaults(){return{border:{width:1,color:this.getChartLayoutSettings().ElementSettings.Colors.border}}}renderContent(t){const{x1:e,x2:i,y1:s,y2:a}=this.scaled,r=(0,n.Lx)({x1:e,x2:i,y1:s,y2:a}),o=(0,n.RJ)({lineWidth:this.attrs.border.width,...r});t.translate(o.x,o.y),t.beginPath(),t.set("lineWidth",this.attrs.border.width),t.set("strokeStyle",this.attrs.border.color),t.moveTo(r.x1,r.y1),this.attrs.dashLength&&t.setLineDash([this.attrs.dashLength]),t.lineTo(r.x2,r.y2),t.stroke(),t.translate(-1*o.x,-1*o.y),this.getShouldRenderThumbs()&&this.renderThumbs(t)}isInArea(t){return!super.isDrawingElementLockedOrInvisible()&&(a.ZP.distanceToSegment(t.scaled,this.scaled)<=10||this.thumbsAreInArea(t))}}o(l,"type",s.LX.scaledLine),l.prototype.modalConfig={inputs:[{type:"line",name:"border"}]};const h=l},404:(t,e,i)=>{"use strict";i.d(e,{Z:()=>h});i(7012);var s=i(1045),n=i.n(s),a=i(3888),r=i(2740);function o(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class l extends r.Z{constructor(t,e){super(t,e),o(this,"name","Text"),o(this,"getBoundingPointKeys",(()=>({x:["x"],y:["y"]}))),this.scale({x:["x"],y:["y"]})}renderContent(t){this.render(t)}setupTextMetricsCache(){var t,e;this.attrs.text===(null===(t=this.lastAttrs)||void 0===t?void 0:t.text)&&JSON.stringify(this.attrs.font)===JSON.stringify(null===(e=this.lastAttrs)||void 0===e?void 0:e.font)||(this.lastAttrs=n()({},this.attrs),this.lines=this.getLines().map((t=>({text:t,metrics:this.context.measureText(t)}))),this.measuredHeight=this.lines.reduce(((t,e,i)=>t+(e.metrics.actualBoundingBoxAscent+e.metrics.actualBoundingBoxDescent+(i!==this.lines.length-1?a.tr.XXXS:0))),0))}setupContext(t){this.context=t,t.set("font",this.font),t.set("fillStyle",this.attrs.fillStyle),t.set("textAlign",this.attrs.textAlign),t.set("textBaseline",this.attrs.textBaseline),this.setupTextMetricsCache()}renderText(){let t=this.scaled.y+this.attrs.padding.top,e=0;for(let i=0;i<this.lines.length;i++)t+=0===i?0:this.lines[i].metrics.actualBoundingBoxAscent+e+a.tr.XXXS,this.context.fillText(this.lines[i].text,this.scaled.x+this.attrs.padding.left,t),e=this.lines[i].metrics.actualBoundingBoxDescent}renderBackground(){if(!this.attrs.background)return;const t=this.attrs.border.width/2+a.tr.XXS;this.context.beginPath(),this.context.rect(this.scaled.x-t,this.scaled.y-this.lines[0].metrics.actualBoundingBoxAscent-t,this.width+2*t,this.measuredHeight+2*t),this.context.set("fillStyle",this.attrs.background),this.context.fill(),this.context.set("fillStyle",this.attrs.fillStyle),this.renderBorder(),this.context.closePath()}isInArea(t){return!super.isDrawingElementLockedOrInvisible()&&(!!(this.lines&&this.scaled.x<t.scaled.x&&t.scaled.x<this.scaled.x+this.width&&this.scaled.y-this.lines[0].metrics.actualBoundingBoxAscent<t.scaled.y&&t.scaled.y<this.scaled.y-this.lines[0].metrics.actualBoundingBoxAscent+this.measuredHeight)||this.thumbsAreInArea(t))}moveBy(t,e){this.attrs.x+=t,this.attrs.y+=e}}o(l,"type",a.LX.scaledText);const h=l},2740:(t,e,i)=>{"use strict";i.d(e,{Z:()=>l});i(8322),i(7012),i(9841);var s=i(3888),n=i(8497);function a(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}const r={text:"",font:{size:20,family:"Arial",style:"normal",weight:"normal"},lineHeight:20,textAlign:s.PH.left,textBaseline:s.EQ.alphabetic,padding:{top:0,right:0,bottom:0,left:0}};class o extends n.Z{constructor(){super(...arguments),a(this,"name","Anchored text"),a(this,"getBoundingPointKeys",(()=>({x:["x"],y:["y"]})))}static getMergedPropsWithDefaults(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return{...r[t],...Object.entries(e).reduce(((t,e)=>{let[i,s]=e;return s?{...t,[i]:s}:t}),{})}}static initClass(){Object.defineProperty(this.prototype,"width",{get(){return this.context&&this.setupContext(this.context),this.measure()+this.attrs.padding.left+this.attrs.padding.right}}),Object.defineProperty(this.prototype,"height",{get(){const t=this.getLines().length;return this.attrs.lineHeight*t+this.attrs.padding.top+this.attrs.padding.bottom}}),Object.defineProperty(this.prototype,"font",{get(){const t=this.attrs.font;return"".concat(t.style," ").concat(t.weight," ").concat(t.size,"pt ").concat(t.family)}})}getModalConfigBase(){return{inputs:[{type:"multiline_string",name:"text",required:!0},{type:"font",name:"font"},{type:"background",name:"fillStyle",label:"Color",default:this.getChartLayoutSettings().ElementSettings.Colors.textWithoutBackground},{type:"background",name:"background",label:"Background",default:"rgba(0,0,0,0)"},{type:"border",name:"border",min:0,default:{color:"rgba(0,0,0)",width:0}}]}}getDefaults(){return{...r,fillStyle:this.getChartLayoutSettings().ElementSettings.Colors.textWithoutBackground}}set(t){var e;return super.set(t),null!==(e=t.font)&&void 0!==e&&e.size&&!t.lineHeight&&(this.attrs.lineHeight=Math.max(t.font.size,this.attrs.lineHeight)),this}render(t){this.setupContext(t),this.attrs.angle?(this.context.save(),this.context.translate(this.attrs.x,this.attrs.y),this.context.rotate(this.attrs.angle*Math.PI/180),this.context.fillText(this.attrs.text,0,0),this.context.restore()):(this.renderBackground(),this.renderText())}measure(t){t&&this.setupContext(t);const e=this.getLines();let i=0;for(const t of e)i=Math.max(this.context.measureText(t).width,i);return~~i}isInArea(t){const e=this.convertArea(t);return this.attrs.x<e.x&&e.x<this.attrs.x+this.width&&this.attrs.y-this.attrs.font.size<e.y&&e.y<this.attrs.y-this.attrs.font.size+this.height||super.isInArea(t)}setupContext(t){this.context=t,t.set("font",this.font),t.set("fillStyle",this.attrs.fillStyle),t.set("textAlign",this.attrs.textAlign),t.set("textBaseline",this.attrs.textBaseline)}getLines(){return this.attrs.text.toString().split("\n")}renderText(){let{y:t}=this.attrs;for(const e of this.getLines())this.context.fillText(e,this.attrs.x+this.attrs.padding.left,t),t+=this.attrs.lineHeight}renderBackground(){if(!this.attrs.background)return;const{width:t}=this,{height:e}=this,i=e-this.attrs.padding.top-this.attrs.padding.bottom,{x:s}=this.attrs;let n=this.attrs.y-e;"middle"===this.attrs.textBaseline?n=this.attrs.y-i/2-this.attrs.padding.top-1:"alphabetic"===this.attrs.textBaseline&&(n=this.attrs.y-this.attrs.lineHeight),this.context.beginPath(),this.context.set("fillStyle",this.attrs.background),this.context.rect(s,n,t,e),this.context.fill(),this.context.set("fillStyle",this.attrs.fillStyle),this.renderBorder(),this.context.closePath()}renderBorder(){var t;const{lineWidth:e=0,strokeStyle:i,border:s}=this.attrs,n=null!==(t=null==s?void 0:s.width)&&void 0!==t?t:0;var a;(e||this.attrs.strokeStyle||n>0)&&(this.context.set("strokeStyle",null!==(a=null!=i?i:null==s?void 0:s.color)&&void 0!==a?a:""),this.context.set("lineWidth",Math.max(e,n)),this.context.stroke())}convertArea(t){const{ChartSettings:e}=this.getChartLayoutSettings();return{x:this.model.scale.x(t.x)+this.model.chart().leftOffset+e.left.width,y:this.model.scale.y(t.y)+e.top.height}}moveBy(t,e){this.attrs.x+=this.model.scale.x(t)+1,this.attrs.y+=this.model.scale.y(e)-this.model.scale.y(0)}getHeight(){return this.height}}a(o,"type",s.LX.text),o.initClass();const l=o},2444:(t,e,i)=>{"use strict";i.d(e,{Z:()=>a});var s=i(9007);function n(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}const a=class{constructor(t,e,i,s,a){n(this,"type",void 0),n(this,"lastX",0),n(this,"lastY",0),n(this,"fx",void 0),n(this,"fy",void 0),n(this,"resize",void 0),n(this,"model",void 0),this.type=t,this.fx=e,this.fy=i,this.resize=s,this.model=a}render(t){const{ThumbSettings:e}=this.model.getChartLayoutSettings();t.set("fillStyle",e.color),t.set("strokeStyle",e.borderColor),t.set("lineWidth",e.borderWidth);const i=~~this.x(),n=~~this.y(),a=this.getThumbWidth(),r=(0,s.CH)(e.borderWidth);t.beginPath(),t.rect(i+r,n+r,a,a),t.fill(),t.stroke()}startEditing(t){return this.lastX=t.x,this.lastY=t.y}moveTo(t){const e=t.x-this.lastX,i=t.y-this.lastY;this.resize({type:this.type,difX:e,difY:i,area:t}),this.lastX=t.x,this.lastY=t.y}isInArea(t){const e=this.model.scale.x.invert(this.getThumbWidth()),i=this.model.scale.y.invert(0)-this.model.scale.y.invert(this.getThumbWidth());return this.fx()+e/2>=t.x&&this.fx()-e/2<=t.x&&this.fy()+i/2>t.y&&this.fy()-i/2<t.y}getThumbWidth(){const{ThumbSettings:t}=this.model.getChartLayoutSettings();return t.size+2*t.borderWidth}x(){const{ThumbSettings:t}=this.model.getChartLayoutSettings();return this.model.scale.x(this.fx())-t.size/2}y(){const{ThumbSettings:t}=this.model.getChartLayoutSettings();return this.model.scale.y(this.fy())-t.size/2}}},8136:(t,e,i)=>{"use strict";i.d(e,{Z:()=>c});var s=i(3888),n=i(9007),a=i(8723),r=i(8497),o=i(2444);function l(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class h extends r.Z{constructor(t,e){super(t,e),l(this,"name","Triangle"),l(this,"getBoundingPointKeys",(()=>({x:["x1","x2","x3"],y:["y1","y2","y3"]}))),this.resize=this.resize.bind(this),this._thumbs=[new o.Z("a",(()=>this.attrs.x1),(()=>this.attrs.y1),this.resize,this.model),new o.Z("b",(()=>this.attrs.x2),(()=>this.attrs.y2),this.resize,this.model),new o.Z("c",(()=>this.attrs.x3),(()=>this.attrs.y3),this.resize,this.model)],this.scale(this.getBoundingPointKeys())}getDefaults(){const{ElementSettings:t}=this.getChartLayoutSettings();return{fill:t.defaultFill,border:t.Colors.border}}renderContent(t){const{x1:e,x2:i,x3:s,y1:a,y2:r,y3:o}=this.scaled,l=(0,n.Lx)({x1:e,x2:i,x3:s,y1:a,y2:r,y3:o});t.set("fillStyle",this.attrs.fill);const h=this.getShouldRenderThumbs()?(0,n.CH)(1):0;t.translate(h,h),t.beginPath(),t.moveTo(l.x1,l.y1),t.lineTo(l.x2,l.y2),t.lineTo(l.x3,l.y3),t.lineTo(l.x1,l.y1),t.fill(),t.translate(-1*h,-1*h),this.getShouldRenderThumbs()&&(t.set("strokeStyle",this.attrs.border),t.stroke(),this.renderThumbs(t))}moveBy(t,e){this.attrs.x1+=t,this.attrs.y1+=e,this.attrs.x2+=t,this.attrs.y2+=e,this.attrs.x3+=t,this.attrs.y3+=e}resize(t){let{type:e,difX:i,difY:s}=t;switch(e){case"a":this.attrs.x1+=i,this.attrs.y1+=s;break;case"b":this.attrs.x2+=i,this.attrs.y2+=s;break;case"c":this.attrs.x3+=i,this.attrs.y3+=s}}isInArea(t){if(super.isDrawingElementLockedOrInvisible())return!1;const e=[1,2,3].map((t=>({x:this.scaled["x".concat(t)],y:this.scaled["y".concat(t)]})));return!!a.ZP.pointInPolygon(t.scaled,e)||super.isInArea(t)}}l(h,"type",s.LX.triangle),h.prototype.modalConfig={inputs:[{type:"background",name:"fill"}]};const c=h},521:(t,e,i)=>{"use strict";i.d(e,{Z:()=>o});var s=i(3888),n=i(1894);function a(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class r extends n.Z{constructor(t,e){super(t,e),a(this,"name","Vertical line"),a(this,"getBoundingPointKeys",(()=>({x:["x1","x2"],y:["y1","y2"]}))),this.renderContent=this.renderContent.bind(this),this.attrs.x2=this.attrs.x1,this._thumbs=[this._thumbs[0]]}renderContent(t){const e=this.model.scale.y.domain();this.attrs.y1=e[0],this.attrs.y2=e[1],this._thumbs[0].fy=()=>(this.attrs.y1+this.attrs.y2)/2,super.renderContent(t)}moveBy(t){return this.attrs.x1=this.attrs.x2+=t}resize(t){let{difX:e}=t;return this.moveBy(e)}}a(r,"type",s.LX.verticalLine);const o=r},1913:(t,e,i)=>{"use strict";i.d(e,{Z:()=>d});i(8322);var s=i(3888),n=i(9007),a=i(8723),r=i(8497),o=i(2740),l=i(2444);function h(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class c extends r.Z{constructor(t,e){super(t,e),h(this,"name","XABCD pattern"),h(this,"getBoundingPointKeys",(()=>({x:["xx","ax","bx","cx","dx"],y:["xy","ay","by","cy","dy"]}))),this.resize=this.resize.bind(this),this._thumbs=[new l.Z("x",(()=>this.attrs.xx),(()=>this.attrs.xy),this.resize,this.model),new l.Z("a",(()=>this.attrs.ax),(()=>this.attrs.ay),this.resize,this.model),new l.Z("b",(()=>this.attrs.bx),(()=>this.attrs.by),this.resize,this.model),new l.Z("c",(()=>this.attrs.cx),(()=>this.attrs.cy),this.resize,this.model),new l.Z("d",(()=>this.attrs.dx),(()=>this.attrs.dy),this.resize,this.model)],null==this.attrs.lineWidth&&(this.attrs.lineWidth=1),this.scale(this.getBoundingPointKeys())}getDefaults(){const{ElementSettings:t}=this.getChartLayoutSettings();return{fill:t.defaultFill,border:{width:1,color:t.Colors.border}}}renderContent(t){const{xx:e,xy:i,ax:a,ay:r,bx:l,by:h,cx:c,cy:d,dx:u,dy:m}=this.scaled,g=(0,n.Lx)({xx:e,xy:i,ax:a,ay:r,bx:l,by:h,cx:c,cy:d,dx:u,dy:m});t.set("fillStyle",this.attrs.fill),t.set("lineWidth",this.attrs.border.width),t.set("strokeStyle",this.attrs.border.color);const f=(0,n.CH)(this.attrs.border.width);t.translate(f,f),t.beginPath(),t.moveTo(g.xx,g.xy),t.lineTo(g.ax,g.ay),t.lineTo(g.bx,g.by),t.lineTo(g.xx,g.xy),t.fill(),0!==(null!=this.attrs.border?this.attrs.border.width:void 0)&&t.stroke(),t.beginPath(),t.moveTo(g.bx,g.by),t.lineTo(g.cx,g.cy),t.lineTo(g.dx,g.dy),t.lineTo(g.bx,g.by),t.fill(),0!==(null!=this.attrs.border?this.attrs.border.width:void 0)&&t.stroke(),t.beginPath(),t.moveTo(g.ax,g.ay),t.lineTo(g.cx,g.cy),t.moveTo(g.xx,g.xy),t.lineTo(g.dx,g.dy),t.stroke();const p=new o.Z({font:{size:8,style:"bold"},lineHeight:8,padding:{top:2,right:2,bottom:2,left:2},textBaseline:s.EQ.middle,textAlign:"middle",fillStyle:"#ffffff",background:this.attrs.fill||"#000000"},this.model);for(const e of Array.from("xabcd"))p.set({text:e.toUpperCase(),x:g[e+"x"]-6,y:g[e+"y"]+12}).render(t);const y=(e,i,s)=>{const n=Math.abs(this.attrs[e+"y"]-this.attrs[i+"y"]),a=Math.abs(this.attrs[s+"y"]-this.attrs[i+"y"])/n,r=(g[e+"x"]+g[s+"x"])/2,o=(g[e+"y"]+g[s+"y"])/2;return p.set({text:a.toFixed(3),x:r,y:o}).render(t)};y("x","a","b"),y("a","b","c"),y("b","c","d"),y("x","a","d"),this.getShouldRenderThumbs()&&this.renderThumbs(t),t.translate(-1*f,-1*f)}moveBy(t,e){for(const i of Array.from("xabcd"))this.attrs[i+"x"]+=t,this.attrs[i+"y"]+=e}resize(t){let{type:e,difX:i,difY:s}=t;return this.attrs[e+"x"]+=i,this.attrs[e+"y"]+=s}isInArea(t){if(super.isDrawingElementLockedOrInvisible())return!1;let e;const i=(()=>{const t=[];for(e of Array.from("xab"))t.push({x:this.scaled[e+"x"],y:this.scaled[e+"y"]});return t})(),s=(()=>{const t=[];for(e of Array.from("bcd"))t.push({x:this.scaled[e+"x"],y:this.scaled[e+"y"]});return t})();return!(!a.ZP.pointInPolygon(t.scaled,i)&&!a.ZP.pointInPolygon(t.scaled,s))||super.isInArea(t)}}h(c,"type",s.LX.xabcd),c.prototype.modalConfig={inputs:[{type:"background",name:"fill"},{type:"border",name:"border",min:1}]};const d=c},3102:(t,e,i)=>{"use strict";i.d(e,{M:()=>ut});var s=i(3888),n=i(9007),a=i(9431),r=i(5495),o=i(1185),l=i(5200),h=(i(8322),i(6539),i(9841),i(5422),i(90),i(264)),c=i(1045),d=i.n(c),u=i(2127),m=i(8661);const g=class{constructor(){this.canvas=(0,l.EJ)()?null:document.createElement("canvas")}set(t,e,i){this.callback=t,this.width=e,this.height=i,this.rendered=!1}render(t,e,i){if(null==e&&(e=0),null==i&&(i=0),this.rendered||this.refresh(),!(this.width<1||this.height<1))try{this.ratio>=1&&this.canvas?t.drawImage(this.canvas,0,0,~~(this.width*this.ratio),~~(this.height*this.ratio),e,i,this.width,this.height):(t.save(),t.translate(e,i),this.callback(t),t.restore())}catch(t){(0,l.Tb)(t,this.canvas?{extra:{width:this.width,height:this.height,ratio:this.ratio,cWidth:this.canvas.width,cHeight:this.canvas.height,sWidth:window.screen.width,sHeight:window.screen.height}}:{})}}refresh(){(0,l.EJ)()||(this.canvas.width=this.width,this.canvas.height=this.height,this.context=(0,m.h)(this.canvas),this.ratio=a.ZP.getScaleRatio(),a.ZP.setSizeOnCanvasElement({canvasElement:this.canvas,width:this.width,height:this.height}),this.context.scale(this.ratio,this.ratio),this.callback(this.context),this.rendered=!0)}};var f=i(8497),p=i(3104),y=i(2740),v=i(5327),b=i.n(v),x=i(18),C=i(5978),w=i(221),S=i(2120),M=i(5622),P=i(6364),k=i(5965),E=i(353);let T;function I(t){return{isXs:t>=T.xs,isS:t>=T.s,isM:t>=T.m,isL:t>=T.l}}function A(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}!function(t){t[t.xs=0]="xs",t[t.s=480]="s",t[t.m=768]="m",t[t.l=1024]="l"}(T||(T={}));const L=t=>{let{date:e,timeframe:i}=t,n="";const a=e.getMonth(),r=e.getFullYear(),o=e.getDate();switch(i){case s.ih.i1:case s.ih.i2:case s.ih.i3:case s.ih.i5:case s.ih.i10:case s.ih.i15:case s.ih.i30:case s.ih.h:case s.ih.h2:case s.ih.h4:const t=((e.getHours()+11)%12+1).toString().padLeft("00")+":"+e.getMinutes().toString().padLeft("00")+(e.getHours()<12?"AM":"PM");n="".concat(s.gg[a]," ").concat(o," ").concat(t);break;case s.ih.d:case s.ih.w:n="".concat(s.gg[a]," ").concat(o);break;case s.ih.m:n="".concat(s.gg[a]," ").concat(r)}return n},D=b().gray[300];class O extends f.Z{static initClass(){Object.defineProperty(this.prototype,"width",{get(){const{ChartSettings:t}=this.getChartLayoutSettings();return this.model.width-t.left.width-t.right.width}}),Object.defineProperty(this.prototype,"height",{get(){const{ChartSettings:t}=this.getChartLayoutSettings();return this.paneModel.height-t.top.height-t.bottom.height}})}static getNumOfBarsBuffer(t){let{overlays:e}=t;return Math.max(0,...e.map((t=>P.V[t.type].getNumOfBarsBuffer(t))))}constructor(t,e){super(t,e),A(this,"paneModel",void 0),A(this,"model",void 0),A(this,"data",void 0),A(this,"specificChartFunctionality",void 0),A(this,"tickerWidth",0),A(this,"changeWidth",0),A(this,"lastOhlc",[]),A(this,"overlays",[]),A(this,"isLargeChart",void 0),A(this,"shouldRenderVolume",!0),A(this,"afterChange",null),A(this,"fx",(t=>this.paneModel.scale.x(this.data.barIndex[t]))),A(this,"fy",(t=>this.paneModel.scale.y(t))),this.paneModel=e,this.model=this.paneModel.chart(),this.data=this.model.quote();const i=this.model.chart_layout();if(this.specificChartFunctionality=i.specificChartFunctionality,this.isLargeChart=i.isLargeChart,this.isMobile=a.ZP.isMobile(!0),this.overlays=[],t.overlays){for(const e of t.overlays){const t=P.V[e.type].fromObject({...e,color:!e.color||e.color.includes("|")?"":(0,k.Fx)(e.color)},this.paneModel);this.addOverlay(t)}delete t.overlays}this.renderYAxis=this.renderYAxis.bind(this),this.renderText=this.renderText.bind(this),this.renderCrossText=this.renderCrossText.bind(this),this.setupCache=this.setupCache.bind(this),this.renderOverlaysLabels=this.renderOverlaysLabels.bind(this),this.paneModel.bind("update",this.setupCache),this.paneModel.bind("change",this.trigger.bind(this,"change")),this.model=this.paneModel.chart(),this.model.bind("change",this.setupCache),this.model.bind("change",this.trigger.bind(this,"change")),this.model.bind(u.wq.IndicatorsChange,this.handleIndicatorsChange.bind(this));const s=this.trigger.bind(this,"change","cross");this.model.bind("destroy",(()=>{this.model.unbind("change",this.setupCache),this.model.unbind(u.wq.IndicatorsChange,this.handleIndicatorsChange.bind(this)),S.Z.unbind("change",s),(0,r.Bs)(this.baseCache.canvas)})),S.Z.bind("change",s),this.model.chart_layout().bind("theme",this.setupCache),this.model.chart_layout().bind("update",this.updateShouldRenderVolume.bind(this)),this.setupCache()}renderChart(){throw Error("Implement renderChart")}render(t){if(this.data=this.model.quote(),this.leftOffset=this.model.leftOffset,this.context=t,0===this.data.close.length)return this.renderChartNotAvailable(),void(this.getIsRedesignedChart()||this.renderTicker(t));this.context.save(),this.clip(),this.renderVolume(),this.renderChart(),this.renderOverlays(),this.renderPrevClose(),this.renderFadeExtendedHours(),this.context.restore(),this.getIsRedesignedChart()||this.renderTicker(t)}renderGrid(t){this.data=this.model.quote(),this.leftOffset=this.model.leftOffset,this.context=t,this.renderXAxis(),this.baseCache.render(t)}renderTicker(t){if(this.tickerText){const{ChartSettings:e}=this.getChartLayoutSettings();if(t.translate(e.left.width,0),this.tickerText.render(t),(0,n.te)(this.specificChartFunctionality)&&"RUSSELL 2000"===this.data.ticker){const{Colors:i}=e.general;new y.Z({text:"ETF",x:e.top.ticker.margin.left,y:e.top.ticker.margin.top+s.Kt.XXS+3,font:{size:s.Kt.XXS},fillStyle:i.text,textBaseline:e.top.baseline},this.paneModel).render(t)}t.translate(-e.left.width,0)}}renderTimeframe(t){var e;const{ChartSettings:i}=this.getChartLayoutSettings(),{Colors:n}=i.general,a=this.model.quote(),r=(this.height-this.volumeFY.range()[1]-4)/2;return new y.Z({text:a.instrument===u.Yx.Group?"YEAR PERFORMANCE %":(0,s.IG)(a.timeframe),x:i.left.timeframe.margin.left,y:i.top.height+r+(null!==(e=i.left.timeframe.margin.top)&&void 0!==e?e:0),angle:-90,font:y.Z.getMergedPropsWithDefaults("font",i.left.timeframe.font),fillStyle:n.textSecondary,textAlign:s.PH.center,textBaseline:s.EQ.alphabetic},this.paneModel).render(t)}renderText(t){const{ChartSettings:e}=this.getChartLayoutSettings(),{Colors:i}=e.general;t.save(),t.translate(e.left.width,0),(0,n.te)(this.specificChartFunctionality)?this.tickerText=new y.Z({text:this.data.name||this.data.ticker,x:e.top.ticker.margin.left,y:e.top.ticker.margin.top,font:{size:s.Kt.L,style:"bold"},fillStyle:i.text},this.paneModel):this.tickerText=new y.Z({text:this.data.name||this.data.ticker,x:e.top.ticker.margin.left,y:e.top.ticker.margin.top,font:y.Z.getMergedPropsWithDefaults("font",e.top.ticker.font),textBaseline:e.top.baseline,fillStyle:i.text},this.paneModel),this.tickerWidth=this.tickerText.measure(t),this.specificChartFunctionality===s.oK.offScreen&&new y.Z({text:"© finviz.com",x:this.width+e.right.width-2,y:1,font:{size:s.Kt.XS},textAlign:s.PH.right,textBaseline:s.EQ.top,fillStyle:"rgb(136, 193, 233)"},this.paneModel).render(t),this.getIsRedesignedChart()||(this.renderChange({context:t}),this.lastOhlc[0]||this.getOHLC({context:t,directRender:!1}),this.getOHLC({context:t})),t.restore(),this.getIsRedesignedChart()||(0,n.te)(this.specificChartFunctionality)||this.renderTimeframe(t)}getOHLC(t){let{context:e,directRender:i=!0,data:r,date:o,dateString:l=null,changePercentage:h=null}=t;if(!this.data.lastDate)return;const c="".concat(s.gg[~~(this.data.lastDate/100)%100-1]," ").concat(this.data.lastDate%100);(0,n.te)(this.specificChartFunctionality)?this.renderOHLC({context:e,date:c,isSmallIndexChart:!0,isNewestOHLC:!0,directRender:i}):r&&o?this.renderOHLC({context:e,date:L({date:o,timeframe:this.data.timeframe}),open:r.open,high:r.high,low:r.low,close:r.close,volume:(0,a.t$)(Number(r.volume)),directRender:i,changePercentage:h}):null!==l?this.renderOHLC({context:e,date:l,open:null,high:null,low:null,close:null,volume:null,directRender:i}):this.renderOHLC({context:e,date:c,afterHour:"number"==typeof this.data.afterClose?this.roundOhlc(this.data.afterClose):void 0,volume:(0,a.t$)(this.data.lastVolume),isNewestOHLC:!0,time:a.ZP.dateFromUnixTimestamp(this.data.date.last()).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"}),directRender:i,...this.getRoundedLastData()})}getRoundedLastData(){return{open:this.roundOhlc(this.data.lastOpen),high:this.roundOhlc(this.data.lastHigh),low:this.roundOhlc(this.data.lastLow),close:this.roundOhlc(this.data.lastClose)}}renderOverlaysLabels(t){this.getIsRedesignedChart()?0!==this.data.close.length&&this.renderOverlaysLabelsChartsPage(t):this.renderOverlaysLabelsQuotePage(t)}renderOverlaysLabelsQuotePage(t){const{ChartSettings:e}=this.getChartLayoutSettings(),i=new y.Z({x:e.left.overlayLabel.margin.left,y:e.top.height+e.left.overlayLabel.margin.top,font:y.Z.getMergedPropsWithDefaults("font",e.left.overlayLabel.font),textBaseline:s.EQ.top},this.paneModel);for(const s of this.overlays)s.isRenderedOverlaysLabel()&&i.set({text:s.toString(),y:i.get("y")+e.left.overlayLabel.labelSpacing,fillStyle:s.getLabelColor()}).render(t)}getYAxisLeftMargin(){return this.data.instrument===u.Yx.Crypto&&this.data.lastClose<=.001?3:8}getYAxisLastCloseLabel(t){let{lastClose:e,firstVisibleClose:i}=t;return"number"==typeof i&&this.model.scale===s.N3.Percentage?"".concat(this.round((0,n.G$)({number:e,base:i}),2),"%"):this.round(e)}renderYAxis(t){let{lastClose:e}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.data,i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const{ChartSettings:a}=this.getChartLayoutSettings(),{Colors:r}=a.general,o=this.paneModel.height-a.top.height-a.bottom.height;let l,c,d,u;const m=(0,n.R6)({context:t,xOffset:a.left.width,yOffset:a.top.height});m.do();const g=Math.floor(this.paneModel.height/35),f=this.getMinMax(),{firstVisibleClose:p}=f;let v,b=0;switch(this.model.scale){case s.N3.Percentage:{if(!p)return;const t=this.paneModel.scaleRange,{min:i,max:s}=t||f;this.model.updateAttribute("firstBarClose",p);const a=(0,n.G$)({number:i,base:p}),r=(0,n.G$)({number:s,base:p});d=h.scaleLinear().range([0,o]).domain([r,a]).nice(10).ticks(Math.min(g,9)),c=d.map((t=>(0,n.Lm)({number:t,base:p}))),u=this.getYAxisLastCloseLabel({lastClose:e,firstVisibleClose:p});break}case s.N3.Logarithmic:{if(!p)return;const t=this.paneModel.scaleRange,{min:i,max:s}=t||f;c=[Math.floor(i)];const n=30,a=[];if(i<0){let t=Math.min(0,s);for(;this.paneModel.scale.y(t)+n<this.paneModel.scale.y(i);){const e=this.paneModel.scale.y.invert(this.paneModel.scale.y(t)+n),i=h.nice(-t,-e,2);t=-i[i.length-1],a.unshift(t)}}const r=[];for(s>0&&r.push(Math.max(this.paneModel.scale.y.invert(this.paneModel.scale.y(i)+n),0));this.paneModel.scale.y(r[r.length-1])-n>0;){const t=this.paneModel.scale.y.invert(this.paneModel.scale.y(r[r.length-1])-n),e=h.nice(r[r.length-1],t,2);r.push(e[e.length-1])}c=[...a,...r],d=c,u=this.getYAxisLastCloseLabel({lastClose:e});break}default:c=this.paneModel.scale.y.ticks(Math.min(g,9)),d=c,u=this.getYAxisLastCloseLabel({lastClose:e})}d.length>=2&&(b=Math.abs(d[1]-d[0])),(b>10||(0,n.te)(this.specificChartFunctionality))&&(v=0);const x=(t,e)=>this.model.scale===s.N3.Percentage?"".concat(t,"%"):this.round(t,e),C=new y.Z({x:this.width+this.getYAxisLeftMargin()+a.right.axis.margin.left,font:y.Z.getMergedPropsWithDefaults("font",a.right.axis.font),fillStyle:r.text,textBaseline:s.EQ.middle},this.paneModel);let w=this.getYLine();const S=()=>{C.set({font:y.Z.getMergedPropsWithDefaults("font",a.right.axis.font),fillStyle:r.text,textBaseline:s.EQ.middle}),w=this.getYLine()};for(let e=0;e<c.length;e++)l=Math.round(this.fy(c[e])),l<0||l>o||(w.set({y1:l,y2:l}),C.set({text:x(d[e],v),y:l}),this.model.scale===s.N3.Percentage&&0===d[e]?(w.set({strokeStyle:r.text}),C.set({font:{weight:"bold",size:C.attrs.font.size},fillStyle:r.percentageZeroLineText}),w.render(t),C.render(t),S()):(w.render(t),C.render(t)));m.undo(),i&&this.renderYAxisLabel({context:t,yCoordinate:Math.round(this.fy(e)),label:u})}getSecondaryLabelBackgroundColor(){return(0,k._r)({...(0,k.Qc)(this.getChartLayoutSettings().ChartSettings.general.Colors.currentBackground),s:.3},"hex")}getYAxisSecondaryLabelYCoordinate(t){var e,i;let{mainLabelValue:n,secondaryLabelValue:a}=t;const{ChartSettings:r}=this.getChartLayoutSettings(),{lineHeight:o}=r.right.axis.font,l=y.Z.getMergedPropsWithDefaults("padding",r.right.axis.font.padding),h=Math.sign(n-a)||1,c=(null!=o?o:s.Ac.S)+(null!==(e=l.top)&&void 0!==e?e:s.tr.XXS)+(null!==(i=l.bottom)&&void 0!==i?i:s.tr.XXS),d=Math.round(this.fy(n)),u=Math.round(this.fy(a)),m=d+c*h;return Math.abs(u-d)>c?u:m}renderYAxisLabel(t){let{context:e,yCoordinate:i,label:a,background:r}=t;const{ChartSettings:o}=this.getChartLayoutSettings(),l=(0,n.R6)({context:e,xOffset:o.left.width,yOffset:o.top.height}),{Colors:h}=o.general,{size:c,lineHeight:d}=o.right.axis.font,u=y.Z.getMergedPropsWithDefaults("padding",o.right.axis.font.padding);l.do(),new y.Z({text:a,x:this.width+this.getYAxisLeftMargin()-u.left+o.right.axis.margin.left,y:i,font:y.Z.getMergedPropsWithDefaults("font",{size:c,style:"bold"}),lineHeight:d,padding:u,textBaseline:s.EQ.middle,fillStyle:this.specificChartFunctionality===s.oK.offScreen?"black":h.currentText,background:r||h.currentBackground},this.paneModel).render(e),l.undo()}renderXAxis(){const{ChartSettings:t}=this.getChartLayoutSettings(),{Colors:e}=t.general;this.context.save(),1===this.data.getDrawDays()||(0,n.te)(this.specificChartFunctionality)||this.data.instrument===u.Yx.MarketSentiment||this.clip(!0),this.context.translate(t.left.width,t.top.height);const i=new y.Z({y:this.height+t.bottom.axis.margin.top,font:y.Z.getMergedPropsWithDefaults("font",{size:t.bottom.axis.font.size}),fillStyle:e.text,textBaseline:s.EQ.top,textAlign:s.PH.center},this.paneModel);switch(this.data.timeframe){case s.ih.i1:case s.ih.i2:case s.ih.i3:case s.ih.i5:this.data.instrument===u.Yx.Stock?this.type===s.nJ.LineChart&&this.specificChartFunctionality===s.oK.offScreen&&"i5"===this.data.timeframe?this.render15MinXAxis(i):this.renderIntradayXAxis(i):this.renderIntradayXAxisFutures(i);break;case s.ih.i10:(0,n.te)(this.specificChartFunctionality)?this.renderIntradayXAxis(i):this.render15MinXAxis(i);break;case s.ih.i15:case s.ih.i30:case s.ih.h:case s.ih.h2:case s.ih.h4:this.render15MinXAxis(i);break;case s.ih.d:this.renderDailyXAxis(i);break;case s.ih.w:this.renderWeeklyXAxis(i);break;case s.ih.m:this.renderMonthlyXAxis(i)}this.context.restore()}isXPointVisible(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return t>=0-e&&t<=this.width+e}renderXAxisLabels(t){let{labels:e,textRenderer:i,allowedOverflow:n=0}=t;const a=[],r=[];e.reverse().forEach((t=>{i.set({text:t.text});const e=Math.floor(i.measure(this.context)),s={...t,textWidth:e};t.hasPriority?a.unshift(s):a.push(s)})),a.forEach((t=>{let{x:e,text:a,textWidth:o}=t;if(!this.isXPointVisible(e,n))return;const l=o/2,h=e-l+n,c=this.width+s.ew.XXS-(e+l)+n;let d=e;h<0?d=Math.round(e-h):c<0&&(d=Math.round(e+c)),(t=>{let{x:e,textWidth:i,renderedLabelRanges:s}=t;return s.some((t=>{let{from:s,to:n}=t;const a=e-i/2,r=e+i/2;return s<r&&r<n||s<a&&a<n}))})({x:d,textWidth:o,renderedLabelRanges:r})||(r.push({from:d-l-s.ew.M,to:d+l+s.ew.M}),i.set({text:a,x:d}),i.render(this.context))}))}renderIntradayXAxis(t){const e=s.pq[this.data.timeframe],i=~~(this.data.marketStartMinutes/60);let o=15+Math.ceil(this.data.aftermarketLengthMinutes/60);const l=[];(0,n.te)(this.specificChartFunctionality)&&(o=16);const h=this.getXLine(),c=(0,r.zG)({zoomFactor:this.model.zoomFactor,chartLayout:this.model.chart_layout()}),d=this.data.getDayToOffset(),u=(0,n.te)(this.specificChartFunctionality),m=u?15:0;for(const t in d){const n=d[t],r=(0,a.$8)(t);for(let t=i;t<=o;t++){let a=(60*t-this.data.marketStartMinutes)/e*c+n*(this.data.drawMinutesPerDay/e)*c+this.leftOffset;if(!this.isXPointVisible(a,m))continue;let o=Math.round(a);if(t===i){if(u){o=Math.round(a-3+30/e*c),h.set({x1:o,x2:o}).render(this.context);continue}0===this.data.premarketLengthMinutes&&(a+=30/e*c),o=Math.round(a),h.set({x1:o,x2:o}).render(this.context),l.push({hasPriority:!0,text:s.gg[r.getMonth()]+" "+r.getDate().toString().padLeft("00"),x:o})}else h.set({x1:o,x2:o}).render(this.context),l.push({text:(t+11)%12+1+(t<12?"AM":"PM"),x:o})}}this.renderXAxisLabels({labels:l,textRenderer:t,allowedOverflow:m})}renderIntradayXAxisFutures(t){let e="",i=NaN;const n=[],r=this.getXLine();for(let t=0;t<this.data.date.length;t++){const o=a.ZP.dateFromUnixTimestamp(this.data.date[t]),l=o.getDate()+"-"+o.getMonth(),h=o.getHours(),c=Math.round(this.fx(t)+this.leftOffset);if(l!==e){if(e=l,i=h,!this.isXPointVisible(c))continue;r.set({x1:c,x2:c}).render(this.context),n.push({x:c,text:s.gg[o.getMonth()]+" "+o.getDate().toString().padLeft("00")})}else if(h%2==0&&h!==i){if(i=h,!this.isXPointVisible(c))continue;r.set({x1:c,x2:c}).render(this.context),n.push({x:c,text:(h+11)%12+1+(h<12?"AM":"PM")})}}this.renderXAxisLabels({labels:n,textRenderer:t})}render15MinXAxis(t){let e="",i=0;const n=[],o=this.getXLine();for(let t=0;t<this.data.date.length;t++){const r=a.ZP.dateFromUnixTimestamp(this.data.date[t]),l=r.getDate()+"-"+r.getMonth();if(l!==e){if(e=l,this.data.instrument===u.Yx.Stock){const e=(r.getMinutes()+60*r.getHours()-this.data.marketStartMinutes)/this.data.interval;i=Math.round(this.paneModel.scale.x(this.data.barIndex[t]-e)+this.leftOffset)}else i=Math.round(this.fx(t)+this.leftOffset);if(!this.isXPointVisible(i))continue;o.set({x1:i,x2:i}).render(this.context),n.push({text:s.gg[r.getMonth()]+" "+r.getDate().toString().padLeft("00"),x:i})}}if(this.specificChartFunctionality===s.oK.offScreen){const t="".concat(s.gg[~~(this.data.lastDate/100)%100-1]," ").concat((this.data.lastDate%100).toString().padLeft("00"));if(n.length>0&&n[n.length-1].text!==t){i+=this.data.getBarsInDay()*(0,r.zG)({zoomFactor:this.model.zoomFactor,chartLayout:this.model.chart_layout()}),n.push({text:t,x:i}),o.set({x1:i,x2:i}).render(this.context)}}this.renderXAxisLabels({labels:n,textRenderer:t})}renderDailyXAxis(t){let e="";const i=[],n=this.getXLine();for(let t=0;t<this.data.date.length;t++){const a=new Date(1e3*this.data.date[t]),r=a.getMonth()+"-"+a.getFullYear();if(r!==e){e=r;const o=Math.round(this.fx(t)+this.leftOffset);if(!this.isXPointVisible(o))continue;n.set({x1:o,x2:o}).render(this.context),i.push({hasPriority:0===a.getMonth(),text:0===a.getMonth()?a.getFullYear().toString():s.gg[a.getMonth()],x:o})}}this.renderXAxisLabels({labels:i,textRenderer:t})}renderWeeklyXAxis(t){let e="";const i=[],n=this.getXLine(),{Colors:a}=this.getChartLayoutSettings().ChartSettings.general;for(let t=0;t<this.data.date.length;t++){const r=new Date(1e3*this.data.date[t]),o=r.getMonth()+"-"+r.getFullYear();if(o!==e){e=o;const l=Math.round(this.fx(t)+this.leftOffset);if(!this.isXPointVisible(l))continue;r.getMonth()%3==0?n.set({x1:l,x2:l}).render(this.context):new p.Z({x1:l,x2:l,y1:0,y2:this.height,strokeStyle:a.gridSecondary,dashLength:3},this.paneModel).render(this.context);const h=0===r.getMonth();i.push({text:h?r.getFullYear().toString().substring(2):s.gg[r.getMonth()][0],hasPriority:h,x:l})}}this.renderXAxisLabels({labels:i,textRenderer:t})}renderMonthlyXAxis(t){let e=null;const i=[],s=this.getXLine();for(let t=0;t<this.data.date.length;t++){const n=new Date(1e3*this.data.date[t]),a=n.getFullYear(),r=0===n.getMonth();if(a!==e&&(0!==i.length||r)){e=a;const r=Math.round(this.fx(t)+this.leftOffset);if(!this.isXPointVisible(r))continue;s.set({x1:r,x2:r}).render(this.context),i.push({text:n.getFullYear().toString(),x:r})}}this.renderXAxisLabels({labels:i,textRenderer:t})}handleIndicatorsChange(){this.updateShouldRenderVolume(),this.setupCache(),this.trigger("change")}updateShouldRenderVolume(){this.shouldRenderVolume=!this.model.chart_layout().getIsIndicatorPresent(s.A.Vol)}getVolumeTicks(t,e,i){t>5&&(t=5);const s=this.volumeFY.ticks(t).filter((t=>0!==t));return t<=1?[s[s.length-1]]:s.length*i+3*(s.length-1)>e?this.getVolumeTicks(t-1,e,i):s}renderVolumeAxis(t){const{ChartSettings:e}=this.getChartLayoutSettings(),{Colors:i}=e.general;if((0,n.te)(this.specificChartFunctionality)){t.save();const n=Math.max(0,Math.min(2,this.data.relativeVolume)),a=20,r=t=>e.top.height+this.height-this.height*(.5*t),o=this.height*(.5*n),l=new y.Z({x:15,font:{size:8},fillStyle:i.text,textBaseline:s.EQ.middle,textAlign:s.PH.right},this.paneModel);for(let e=.5;e<=2;e+=.5){const i=Math.round(r(e));l.set({text:e.toFixed(1),y:i}).render(t),t.set("strokeStyle","rgb(130, 130, 130)"),t.beginPath(),t.setLineDash([2,3]),t.translate(0,.5),t.moveTo(a,i),t.lineTo(a+7,i),t.translate(0,-.5),t.stroke()}return t.set("fillStyle","rgba(0, 135, 255, 0.58)"),t.set("lineWidth",1),t.set("strokeStyle",i.grid),t.setLineDash([]),t.fillRect(a,Math.round(e.top.height+this.height-o),7,Math.round(o)),t.translate(.5,.5),t.strokeRect(a,e.top.height,7,this.height),t.translate(-.5,-.5),new y.Z({text:"RELATIVE\nVOLUME",x:33,y:e.top.height+this.height+6,font:{size:s.Kt.XXS},lineHeight:s.Ac.XS,fillStyle:i.text,textBaseline:s.EQ.top,textAlign:s.PH.right},this.paneModel).render(t),void t.restore()}const a=this.volumeFY.range()[1],r=e.left.volumeAxis.font.size,o=Math.floor(a/r),l=this.getVolumeTicks(o,a,r),h=this.volumeFY.tickFormat(4,"s"),c=new y.Z({x:e.left.volumeAxis.margin.left,font:y.Z.getMergedPropsWithDefaults("font",{size:e.left.volumeAxis.font.size}),fillStyle:i.text,textBaseline:s.EQ.middle,textAlign:s.PH.right},this.paneModel);l.forEach((i=>c.set({text:h(i).replace(/G/,"B"),y:e.top.height+this.height-this.volumeFY(i)}).render(t)))}renderVolume(){if(!this.shouldRenderVolume)return;const{ChartSettings:t}=this.getChartLayoutSettings(),{Colors:e}=t.general,[i,s]=this.volumeFY.domain();if(this.setupAxisTimeFrame!==this.data.timeframe||i===s)return;const a=(0,n.R6)({context:this.context,xOffset:this.leftOffset+t.left.width,yOffset:t.top.height+this.height-59});a.do();const r=this.getHalfBarWidth(),l=this.getBarWithoutMarginWidth();(0,o.E9)({quote:this.data,scale:this.paneModel.scale,leftOffset:this.leftOffset,width:this.width,drawBarCallback:(t,i)=>{if(this.data.volume[t]<=0)return;this.context.fillStyle=this.data.close[t]<this.data.open[t]?e.volumeTrendDown:e.volumeTrendUp;const s=Math.round(this.volumeFY(this.data.volume[t]));this.context.fillRect(i-r,60,l,-s)}}),a.undo()}renderOverlays(){const{ChartSettings:t}=this.getChartLayoutSettings(),e=(0,n.R6)({context:this.context,xOffset:this.leftOffset+t.left.width,yOffset:t.top.height});e.do();for(const t of this.overlays)t.renderContent(this.context);e.undo()}renderCross(t){const e=(0,r.rf)({context:t,mouseModel:S.Z,paneModel:this.paneModel,contentWidth:this.width,contentHeight:this.height,quote:this.data,getRoundDecimalPlaces:t=>this.getPlacesLastClose(t),onRenderCrossText:this.getIsRedesignedChart()?void 0:this.renderCrossText});this.getIsRedesignedChart()&&this.renderCrossText(t,S.Z.getCrossIndexForPane(this.paneModel)),void 0!==e&&(0,E.s)({elementId:this.model.chart_layout().getHTMLElementId(),cursor:e?"crosshair":"default",conditionalCursor:"grabbing"})}getDataByCrossIndex(t,e){let i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const s=this.data.getDataByBarIndex(e,t);if(null!==s)return i?this.roundOhlc(s):"".concat(s)}getCrossIndexChange(t){var e,i;const s=this.data.getDataIndexByBarIndex(t),n=null!==(e=this.data.close[s])&&void 0!==e?e:null,a=null!==(i=this.data.close[s-1])&&void 0!==i?i:null;return null!==n&&null!==a?(0,r.EI)({data:this.data,anchorClose:n,prevClose:a}):null}renderCrossText(t,e){const{ChartSettings:i}=this.getChartLayoutSettings();if(t.save(),t.translate(i.left.width,0),this.getIsRedesignedChart()&&(this.renderOverlaysLabels(t),Number.isNaN(e)))return this.getOHLC({context:t}),void t.restore();const s=this.data.getDataByBarIndex("date",e),n=s?a.ZP.dateFromUnixTimestamp(s):null;if(null===n){const i=this.data.date.length>0?(0,r.dd)({dateStart:this.data.date[0],dateEnd:this.data.date[this.data.date.length-1],quote:this.data}):[];return this.getOHLC({context:t,dateString:i[e]?L({date:a.ZP.dateFromUnixTimestamp(i[e]),timeframe:this.data.timeframe}):null}),void t.restore()}this.getOHLC({context:t,date:n,data:{open:this.getDataByCrossIndex(e,"open"),high:this.getDataByCrossIndex(e,"high"),low:this.getDataByCrossIndex(e,"low"),close:this.getDataByCrossIndex(e,"close"),volume:this.getDataByCrossIndex(e,"volume",!1)},changePercentage:this.getCrossIndexChange(e)}),t.restore()}renderChange(t){let{context:e}=t;const{ChartSettings:i}=this.getChartLayoutSettings(),{ticker:a,change:o,ohlc:l}=i.top,{tickerChange:h,tickerAfterChange:c}=(0,r.wN)({data:this.data});if(!h)return;const d=this.specificChartFunctionality===s.oK.offScreen,m=this.data.instrument===u.Yx.Group,g=new y.Z({text:d&&m?h.percentString:h.string,x:(0,n.te)(this.specificChartFunctionality)?this.width:this.width-i.top.change.margin.right,y:i.top.change.margin.top,font:y.Z.getMergedPropsWithDefaults("font",i.top.change.font),textAlign:s.PH.right,textBaseline:i.top.baseline,fillStyle:(0,r.HQ)({change:h.points,ChartSettings:i})},this.paneModel);if(this.changeWidth=g.measure(e),g.render(e),(!d||this.isLargeChart&&!m)&&c){const t=new y.Z({text:null==c?void 0:c.string,font:y.Z.getMergedPropsWithDefaults("font",i.top.change.font),textAlign:s.PH.right,textBaseline:i.top.baseline,fillStyle:(0,r.HQ)({change:c.points,ChartSettings:i})},this.paneModel),n=t.measure(e),h=this.changeWidth+10+n;i.left.width+this.tickerWidth+a.margin.left+s.ew.S<i.left.width+this.width-h-o.margin.right?(t.set({x:this.width-i.top.change.margin.right-this.changeWidth-10,y:i.top.change.margin.top}).render(e),this.afterChange=null,this.changeWidth=h):this.lastOhlc[0]&&i.left.width+this.tickerWidth+a.margin.left+this.lastOhlc[0].width+l.margin.left+l.margin.right<i.left.width+this.width-n-o.margin.right&&(t.set({x:this.width-i.top.change.margin.right,y:i.top.change.margin.top-i.top.change.font.size-s.ew.S}).render(e),this.changeWidth=Math.max(this.changeWidth,n),this.afterChange={x:this.width-i.top.change.margin.right,y:i.top.change.margin.top-i.top.change.font.size-s.ew.S,width:n})}}renderOHLC(t){this.getIsRedesignedChart()?this.renderOHLCChartsPage(t):this.renderOHLCQuotePage(t)}renderOHLCChartsPage(t){let{context:e,date:i,open:n,high:a,low:r,close:o,volume:l,changePercentage:h}=t;const c=I(this.width),{ChartSettings:d}=this.getChartLayoutSettings(),{Colors:u}=d.general,m=new y.Z({font:{size:s.Kt.S},lineHeight:18,fillStyle:u.text,textAlign:s.PH.left,textBaseline:s.EQ.middle,background:(0,k.Qm)(u.canvasFill,.8)},this.paneModel),g=i?[{text:i,color:D}]:[],f=(null!=n?n:0)>(null!=o?o:0)?b().red[400]:b().green[400],p=n?[{text:"O",color:D},{text:n,color:f}]:[],v=a?[{text:"H",color:D},{text:a,color:f}]:[],x=r?[{text:"L",color:D},{text:r,color:f}]:[],C=o?[{text:"C",color:D},{text:o,color:f}]:[],w=l?[{text:"Vol",color:D},{text:l,color:f}]:[],S=null!=h?[{text:h.string,color:f}]:[],M=[],P=t=>t.flatMap(((t,e)=>e>0?[...t.length>0?["space"]:[],...t]:t));c.isM?M.push(P([g,p,v,x,C,w,S])):c.isS?(M.push(P([g,S])),M.push(P([p,v,x,C,w]))):(M.push(P([g,w,S])),M.push(P([p,v,x,C])));const E=s.ew.M-d.left.width;let T=E,A=s.ew.M+m.attrs.lineHeight/2;M.forEach((t=>{T=E,t.forEach(((t,i,s)=>{const n={left:1,right:1,top:0,bottom:0},{text:a="",color:r}="space"===t?{}:t;0===i?n.left=5:i===s.length-1?n.right=5:"space"===t&&(n.left=7,n.right=7,c.isS||(n.left=5,n.right=5)),m.set({text:a,fillStyle:r,x:T,y:A,padding:n}),m.render(e),T+=m.width})),A+=m.attrs.lineHeight}))}renderOverlaysLabelsChartsPage(t){const{ChartSettings:e}=this.getChartLayoutSettings(),i=I(this.width),n=new y.Z({font:{size:s.Kt.S},lineHeight:18,textAlign:s.PH.left,textBaseline:s.EQ.middle,background:(0,k.Qm)(e.general.Colors.canvasFill,.8),x:s.ew.M-e.left.width,padding:{left:5,right:5,top:0,bottom:0}},this.paneModel);let a=2;i.isM?a=1:i.isS&&(a=2);const{lineHeight:r}=n.attrs;let o=r*a+r/2+s.ew.M;for(const e of this.overlays)e.isRenderedOverlaysLabel()&&(n.set({text:e.toString(),y:o,fillStyle:e.getLabelColor()}).render(t),o+=r)}renderOHLCQuotePage(t){let{context:e,date:i,open:n,high:a,low:o,close:l,volume:h,afterHour:c,isSmallIndexChart:d=!1,isNewestOHLC:m=!1,time:g,directRender:f=!1,changePercentage:p}=t;const{ChartSettings:v}=this.getChartLayoutSettings(),{Colors:b}=v.general,{ohlc:x}=v.top,w=this.specificChartFunctionality===s.oK.offScreen,S=this.data.instrument===u.Yx.Group;w&&S?x.type=C.l.dateOnly:w&&this.data.instrument!==u.Yx.Stock&&g&&(x.type=C.l.timeOnly);const M=x.type?x.margin.top:x.margin.top-v.top.ticker.font.size,P=x.font.size,k=this.tickerWidth+v.top.ticker.margin.left+(this.width-(this.tickerWidth+v.top.ticker.margin.left+this.changeWidth+(d?0:v.top.change.margin.right)))/2,E=this.tickerWidth+v.top.ticker.margin.left+x.margin.left,T=![n,a,o,l,h].some((t=>!t))?{date:[null!=i?i:""],singleLine:["".concat(i,"      O:").concat(n,"  H:").concat(a,"  L:").concat(o,"  C:").concat(l).concat(c?"  AH:".concat(c):"","      Vol:").concat(h,"      "),p?p.string:void 0].filter((t=>void 0!==t)),multiLine:["O:".concat(n,"  H:").concat(a,"  L:").concat(o,"  C:").concat(l).concat(c?"  AH:".concat(c):"","      Vol:").concat(h),"".concat(i)]}:{date:[null!=i?i:""],singleLine:["".concat(null!=i?i:"")],multiLine:["","".concat(null!=i?i:"")]},I=new y.Z({font:{size:P}},this.paneModel),A=()=>{const t=this.width-this.tickerWidth-v.top.ticker.margin.left-x.margin.left-x.margin.right;if(!d){if(I.set({text:T.singleLine[0]}).measure(e)<t-this.changeWidth)return C.l.singleLine;if(I.set({text:T.multiLine[0]}).measure(e)<t+v.right.width&&I.set({text:T.multiLine[1]}).measure(e)<t-this.changeWidth)return C.l.multiLine}return C.l.dateOnly};m?this.lastOhlc=[]:(e.fillStyle=b.canvasFill,this.lastOhlc.forEach((t=>{const i=t.textAlign===s.PH.left?t.x:t.x-t.width/2,n=t.textBaseline===s.EQ.top?t.y:t.y-P;e.fillRect(i-s.tr.XXS,n-s.tr.XXS,s.tr.XXS+t.width+s.tr.XXS,s.tr.XXS+P+s.tr.XXS)})),this.afterChange&&e.fillRect(this.afterChange.x-this.afterChange.width-s.tr.XXS,this.afterChange.y-v.top.change.font.size-s.tr.XXS,s.tr.XXS+this.afterChange.width+s.tr.XXS,s.tr.XXS+v.top.change.font.size+s.tr.XS));const L=(()=>{switch(x.type||A()){case C.l.singleLine:return{text:T.singleLine,x:[E,E],y:[x.margin.top],textAlign:s.PH.left,textBaseline:[s.EQ.alphabetic]};case C.l.multiLine:return{text:T.multiLine,x:[E,E],y:[M,x.margin.top],textAlign:s.PH.left,textBaseline:[s.EQ.top,s.EQ.alphabetic]};case C.l.dateOnly:if(w&&S){const t="".concat(T.date,"                   Volume: ").concat(h),i=I.set({text:t}).measure(e);return{text:[t],x:[this.width-v.top.change.margin.right-this.changeWidth-i-s.oG.XXL],y:[x.margin.top],textAlign:s.PH.center,textBaseline:[s.EQ.alphabetic]}}if(d)return{text:T.date,x:[k],y:[x.margin.top],textAlign:s.PH.center,textBaseline:[s.EQ.alphabetic]};{const t=!(this.width-(this.tickerWidth+v.top.ticker.margin.left+x.margin.left+x.margin.right+this.changeWidth+v.top.change.margin.right)>I.set({text:T.date[0]}).measure(e))||x.font.baseline===s.EQ.top;return{text:T.date,x:[E],y:t?[M]:[x.margin.top],textAlign:s.PH.left,textBaseline:t?[s.EQ.top]:[s.EQ.alphabetic]}}case C.l.timeOnly:return{text:[g],x:[k-I.set({text:g}).measure(e)/2],y:[M],textAlign:s.PH.center,textBaseline:[x.font.baseline]};default:return}})(),D=t=>{let{ohlcSet:i,render:s=!0}=t;const n=(x.type||A())===C.l.singleLine&&p;null==i||i.text.forEach(((t,a)=>{let o=a,l=0,h=b.text,c=t;a>0&&n&&(o-=1,l=I.measure(e),c=t,h=(0,r.HQ)({change:p.points,ChartSettings:v}));const d={text:c,x:i.x[o]+l,y:i.y[o],textBaseline:x.font.baseline?x.font.baseline:i.textBaseline[o],textAlign:x.font.textAlign?x.font.textAlign:i.textAlign,fillStyle:h};I.set(d),m&&(this.lastOhlc[o]={width:I.measure(e),...d}),s&&I.render(e)}))};return D({ohlcSet:L,render:f}),{ohlcSettings:L,renderOHLCToCanvas:D}}renderFadeExtendedHours(){const{ChartSettings:t}=this.getChartLayoutSettings(),{Colors:e}=t.general,i=this.model.quote().timeframe;if(this.data.instrument!==u.Yx.Stock)return;if(![s.ih.i1,s.ih.i2,s.ih.i3,s.ih.i5].includes(i))return;const a=parseInt(i.substring(1),10),r=this.data.getDayToOffset(),o=(0,n.R6)({context:this.context,xOffset:this.leftOffset+t.left.width,yOffset:t.top.height});o.do();const l=this.getHalfBarWidth();for(const t in r){const i=r[t];let s=this.data.drawMinutesPerDay/a*i,n=this.data.premarketLengthMinutes/a+s,o=this.paneModel.scale.x(s)-l,h=this.paneModel.scale.x(n)-this.paneModel.scale.x(s);this.context.set("fillStyle",e.premarketFade),this.context.fillRect(o,0,h,this.height+1),this.data.aftermarketLengthMinutes>0&&(s=this.data.drawMinutesPerDay/a*i+(this.data.drawMinutesPerDay-this.data.aftermarketLengthMinutes)/a,n=this.data.aftermarketLengthMinutes/a+s,o=this.paneModel.scale.x(s)-l,h=this.paneModel.scale.x(n)-this.paneModel.scale.x(s),this.context.set("fillStyle",e.aftermarketFade),this.context.fillRect(o,0,h,this.height+1))}o.undo()}shouldShowPrevClose(){const t=this.model.quote(),e=t.instrument===u.Yx.Stock,i=s.Mm.includes(t.timeframe),n=this.specificChartFunctionality===s.oK.smallIndex;return e&&(i||n)}renderPrevClose(){const{ChartSettings:t}=this.getChartLayoutSettings(),{Colors:e}=t.general;if(!this.shouldShowPrevClose())return;const i=(0,n.R6)({context:this.context,xOffset:t.left.width,yOffset:t.top.height});i.do();const s=Math.round(this.fy(this.model.quote().prevClose));new p.Z({x1:0,x2:this.width,y1:s,y2:s,strokeStyle:e.prevClose,dashLength:3},this.paneModel).render(this.context),i.undo()}renderChartNotAvailable(){const{ChartSettings:t}=this.getChartLayoutSettings(),{Colors:e}=t.general,i=~~((t.left.width+t.right.width+this.width)/2),n=~~((t.top.height+t.bottom.height+this.height)/2);new y.Z({text:"Chart not available",x:i,y:n,font:{size:s.Kt.M,style:"bold"},fillStyle:e.text,textAlign:s.PH.center,textBaseline:s.EQ.middle},this.paneModel).render(this.context)}setupCache(){const{ChartSettings:t}=this.getChartLayoutSettings();this.baseCache=this.baseCache||new g,this.baseCache.set((t=>{0!==this.data.close.length?(this.renderYAxis(t),this.renderText(t),!this.getIsMobileChartPage()&&this.shouldRenderVolume&&this.renderVolumeAxis(t),this.getIsRedesignedChart()||this.renderOverlaysLabels(t)):this.renderText(t)}),this.width+t.left.width+t.right.width,this.height+t.top.height+t.bottom.height)}setupAxis(t){var e;this.data=this.model.quote();const{volumeHeight:i}=this.getChartLayoutSettings().ChartSettings.center;if("function"!=typeof t)return;const s=this.getHalfBarWidth(),n=[];for(let e=0;e<this.data.volume.length;e++){const i=t(this.data.barIndex[e])-s;i+this.model.leftOffset<0||i+this.model.leftOffset>this.width||n.push(this.data.volume[e])}const r=null!==(e=a.ZP.max(n))&&void 0!==e?e:0,o=i||60;this.volumeFY=h.scaleLinear().range([0,o]).domain([0,r]).nice(4),this.setupAxisTimeFrame=this.data.timeframe}clip(t){const{ChartSettings:e}=this.getChartLayoutSettings();null==t&&(t=!1),this.context.beginPath();let i=0;t&&(i=e.bottom.height),this.context.rect(e.left.width,e.top.height,this.width+3,this.height+i+1),this.context.clip()}addOverlay(t){return t.chart=this,this.overlays.push(t),this.trigger("change")}setOverlays(t){return this.overlays=t,this.trigger("change")}removeOverlay(t){for(let e=0;e<this.overlays.length;e++){if(this.overlays[e]===t){this.attrs.overlays.splice(e,1),this.overlays.splice(e,1),this.trigger("change");break}}}getMinMax(){let t=Number.MAX_VALUE,e=Number.MIN_VALUE,i=null;const n=this.data=this.model.quote();for(let s=0;s<n.open.length;s++){const a=this.fx(s);a+this.model.leftOffset<0||a+this.model.leftOffset>this.width||(null===i&&(i=n.close[s]),t=Math.min(t,n.low[s]),e=Math.max(e,n.high[s]))}if(t===Number.MAX_VALUE&&e===Number.MIN_VALUE)for(let i=Math.max(n.open.length-10,0),s=i,a=n.open.length,r=i<=a;r?s<a:s>a;r?s++:s--)t=Math.min(t,n.low[s]),e=Math.max(e,n.high[s]);return this.shouldShowPrevClose()&&null!==n.prevClose&&(t=Math.min(t,n.prevClose),e=Math.max(e,n.prevClose)),this.specificChartFunctionality!==s.oK.offScreen||this.model.dateRange||(t=Math.min(t,n.lastClose),e=Math.max(e,n.lastClose)),{min:t,max:e,firstVisibleClose:i}}moveBy(){}isInArea(){return!1}round(t,e){return(0,r.NM)({data:this.data,num:t,overridePlaces:null!=e?e:this.getPlacesLastClose()})}roundOhlc(t){const e=this.getPlacesLastClose();return(0,r.NM)({data:this.data,num:t,overridePlaces:e?Math.max(e,2):void 0})}toObject(){const t=this.overlays.map((t=>t.toObject()));return d()({},this.attrs,{type:this.type,overlays:t})}toConfig(){const t=this.overlays.map((t=>t.toConfig()));return d()({},this.attrs,{type:this.type,overlays:t})}getBarWithoutMarginWidth(){const{barFillWidth:t,barBorderWidth:e}=(0,r.ee)({chartLayout:this.model.chart_layout(),zoomFactor:this.model.zoomFactor});return t+2*e}getHalfBarWidth(){return~~Math.max(1,this.getBarWithoutMarginWidth()/2)}getPlacesLastClose(t){const{lastClose:e,instrument:i}=this.data,s=t&&Math.abs(t);return e>=1e5?0:e>=1e4?1:i===u.Yx.Stock&&(null!=s?s:e)<1?4:void 0===e?2:void 0}hasOverlay(t){return this.overlays.some((e=>e.type==="overlays/"+t))}getXLine(){return new p.Z({y1:0,y2:this.height,strokeStyle:this.getChartLayoutSettings().ChartSettings.general.Colors.grid,dashLength:3},this.paneModel)}getYLine(){return new p.Z({x1:0,x2:this.width,strokeStyle:this.getChartLayoutSettings().ChartSettings.general.Colors.grid,dashLength:3},this.paneModel)}getChartLayoutSettings(){return(0,M.getChartLayoutSettings)(this.model.chart_layout())}getIsMobileChartPage(){return this.isMobile&&this.model.chart_layout().specificChartFunctionality===s.oK.chartPage}getCandleLikeChartsRenderingColors(){const{ChartSettings:t}=this.getChartLayoutSettings(),{Colors:e}=t.general,{theme:i,specificChartFunctionality:n}=this.model.chart_layout();let a=e;const o=(0,x.xF)({colors:a,theme:i}),l=Object.keys(o),h=["borderUp","wickUp","borderDown","wickDown","trendUp","trendDown"].some((t=>l.includes(t)));i===u.Q2.light&&(0,r.v8)({specificChartFunctionality:n,totalBarWidth:t.center.barWidth+2*t.center.border})&&!h&&(a={...a,...w.Qw});return n===s.oK.offScreen&&0===t.center.border&&!h&&(a={...a,...w.Cc,...o}),a}getIsRedesignedChart(){return this.specificChartFunctionality===s.oK.chartPage||(0,a.yG)()&&[s.oK.futuresPage,s.oK.forexPage,s.oK.cryptoPage].includes(this.specificChartFunctionality)}}A(O,"label","Chart"),A(O,"iconName",""),O.initClass();const R=O;function F(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class B extends R{getRenderChartBarProps(t){let{index:e,chartSettingsColors:i,hasFillAndBorder:s}=t;const{trendDown:n,trendUp:a,borderDown:r,borderUp:o,wickDown:l,wickUp:h}=i,c=this.data.open[e],d=this.data.close[e],u=d<c?n:a,m=d<c?l:h;return{open:c,close:d,high:this.data.high[e],low:this.data.low[e],barFillColor:u,borderColor:d<c?r:o,wickColor:s?m:u}}renderChart(){if(this.setupAxisTimeFrame!==this.data.timeframe)return;const{ChartSettings:t}=this.getChartLayoutSettings(),e=this.getCandleLikeChartsRenderingColors(),{barFillWidth:i,barBorderWidth:h}=(0,r.ee)({chartLayout:this.model.chart_layout(),zoomFactor:this.model.zoomFactor}),c=i+2*h>=2&&!(this.type===s.nJ.HollowCandleStick&&0===h),d=(0,n.R6)({context:this.context,xOffset:this.leftOffset+t.left.width,yOffset:t.top.height}),u=(0,n.R6)({context:this.context,xOffset:.5,yOffset:0});d.do(),(0,o.E9)({quote:this.data,scale:this.paneModel.scale,leftOffset:this.leftOffset,width:this.width,drawBarCallback:(t,s)=>{const{open:n,close:r,high:o,low:d,wickColor:m,borderColor:g,barFillColor:f}=this.getRenderChartBarProps({index:t,chartSettingsColors:e,hasFillAndBorder:c}),p=Math.round(this.fy(a.ZP.max(n,r))),y=Math.round(this.fy(a.ZP.min(n,r))),v=Math.round(this.fy(o)),b=Math.round(this.fy(d)),x=y-p,C=s-Math.floor(h+i/2),w=h/2;if((0,l.EJ)()&&C+this.leftOffset<0)return;const S=x>=2*h,M=!c&&b-v<1;if(u.do(),this.context.set("strokeStyle",m),this.context.beginPath(),this.context.moveTo(s,v),c&&(this.context.lineTo(s,p),this.context.moveTo(s,p+(S?x:1))),this.context.lineTo(s,M?v+1:b),this.context.stroke(),u.undo(),c){const t=h>0;t&&(this.context.set("strokeStyle",g),S?(this.context.set("lineWidth",h),this.context.strokeRect(C+w,p+w,i+2*w,x-2*w),this.context.set("lineWidth",1)):(this.context.beginPath(),this.context.moveTo(C,p+.5),this.context.lineTo(C+i+2*h,p+.5),this.context.stroke()));const e=x-2*h,s=e>0;!s&&t||(this.context.set("fillStyle",s?f:g),this.context.fillRect(C+h,p+h,i,s?e:1))}}}),d.undo()}toString(){return"Candle stick ".concat(this.data.ticker)}}F(B,"type",s.nJ.CandleStick),F(B,"label","Candle"),F(B,"iconName","candleBarBasic");const N=B;function Z(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class z extends N{static getNumOfBarsBuffer(t){return Math.max(1,super.getNumOfBarsBuffer(t))}getRenderChartBarProps(t){let{index:e,chartSettingsColors:i}=t;const s=this.data.open[e],n=this.data.close[e],a=n>s,r=n>this.data.close[e-1]?i.ohlcTrendUp:i.ohlcTrendDown,o=0===e?i.zeroChange:r;return{open:s,close:n,high:this.data.high[e],low:this.data.low[e],barFillColor:a?"rgba(0, 0, 0, 0)":o,borderColor:o,wickColor:o}}toString(){return"Hollow Candle stick ".concat(this.data.ticker)}}Z(z,"type",s.nJ.HollowCandleStick),Z(z,"label","Hollow Candle"),Z(z,"iconName","candleBarHollow");const X=z;function H(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class W extends N{constructor(){super(...arguments),H(this,"getRenderChartBarProps",(t=>{let{index:e,chartSettingsColors:i,hasFillAndBorder:s}=t;const n=this.data.getHeikinAshiData(),a=n.open[e],r=n.close[e],o=r<a?i.trendDown:i.trendUp,l=r<a?i.wickDown:i.wickUp;return{open:a,close:r,high:Math.max(this.data.high[e],a,r),low:Math.min(a,r,this.data.low[e]),barFillColor:o,borderColor:r<a?i.borderDown:i.borderUp,wickColor:s?l:o}})),H(this,"getLastValues",(()=>{const t=this.getCandleLikeChartsRenderingColors(),{open:e,close:i,high:s,low:n}=this.getRenderChartBarProps({index:this.data.date.length-1,chartSettingsColors:t});return{lastOpen:e,lastClose:i,lastHigh:s,lastLow:n}})),H(this,"renderYAxis",(t=>{const{lastClose:e}=this.getLastValues();super.renderYAxis(t,{lastClose:e},!1);const{firstVisibleClose:i}=this.getMinMax();if(this.model.scale===s.N3.Percentage&&!i)return;const n=this.data.close[this.data.close.length-1],a=this.getYAxisLastCloseLabel({lastClose:e,firstVisibleClose:i}),r=this.getYAxisLastCloseLabel({lastClose:n,firstVisibleClose:i});this.renderYAxisLabel({context:t,yCoordinate:Math.round(this.fy(e)),label:a}),a!==r&&this.renderYAxisLabel({context:t,yCoordinate:this.getYAxisSecondaryLabelYCoordinate({mainLabelValue:e,secondaryLabelValue:n}),label:r,background:this.getSecondaryLabelBackgroundColor()})}))}static getNumOfBarsBuffer(t){return Math.max(1,super.getNumOfBarsBuffer(t))}getRoundedLastData(){const t=this.getLastValues();return{open:this.roundOhlc(t.lastOpen),high:this.roundOhlc(t.lastHigh),low:this.roundOhlc(t.lastLow),close:this.roundOhlc(t.lastClose)}}getDataByCrossIndex(t,e){let i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const s=this.getCandleLikeChartsRenderingColors(),n=this.data.getDataIndexByBarIndex(t);if(n>-1){let a=null;if(["high","low","open","close"].includes(e)){a=this.getRenderChartBarProps({index:n,chartSettingsColors:s})[e]}if(a=null===a?this.data.getDataByBarIndex(e,t):a,null!==a)return i?this.roundOhlc(a):"".concat(a)}}getCrossIndexChange(t){var e,i;const s=this.data.getDataIndexByBarIndex(t),n=this.data.getHeikinAshiData(),a=null!==(e=n.close[s])&&void 0!==e?e:null,o=null!==(i=n.close[s-1])&&void 0!==i?i:null;return null!==a&&null!==o?(0,r.EI)({data:this.data,anchorClose:a,prevClose:o}):null}toString(){return"HA Candle stick ".concat(this.data.ticker)}}H(W,"type",s.nJ.HeikinAshi),H(W,"label","Heikin Ashi"),H(W,"iconName","candleBarHeikinAshi");const U=W;function Y(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class q extends R{renderChart(){const{ChartSettings:t}=this.getChartLayoutSettings(),{Colors:e}=t.general;let i,s;const a=(0,n.R6)({context:this.context,xOffset:this.leftOffset+t.left.width+.5,yOffset:t.top.height+.5});a.do(),this.context.beginPath(),this.context.set("lineWidth",1),this.context.set("strokeStyle",e.line),(0,o.E9)({quote:this.data,scale:this.paneModel.scale,leftOffset:this.leftOffset,width:this.width,drawBarCallback:(t,e)=>{const n=Math.round(this.fy(this.data.close[t]));this.context.lineTo(e,n),s=e,void 0===i&&(i=e)}}),void 0!==i&&void 0!==s&&(this.context.stroke(),this.context.set("fillStyle",e.background),this.context.lineTo(s,this.height),this.context.lineTo(i,this.height),this.context.fill()),a.undo()}toString(){return"Line chart ".concat(this.data.ticker)}}Y(q,"type",s.nJ.LineChart),Y(q,"label","Line"),Y(q,"iconName","lineChartType");const V=q;const j="rgb(120, 0, 0)",_="rgb(0, 100, 0)";class Q extends R{static initClass(){Object.defineProperty(this.prototype,"width",{get(){const{MarketSentimentSettings:t}=this.getChartLayoutSettings();return this.model.width-t.left.width-t.right.width}}),Object.defineProperty(this.prototype,"height",{get(){const{MarketSentimentSettings:t}=this.getChartLayoutSettings();return this.paneModel.height-t.top.height-t.bottom.height}})}constructor(t,e){super(t,e),this.renderText=this.renderText.bind(this),this.renderOverlaysLabels=this.renderOverlaysLabels.bind(this),this.renderYAxis=this.renderYAxis.bind(this),this.setupCache=this.setupCache.bind(this)}setupCache(){if(super.setupCache(),!this.data)return;const t=[];this.data.close.forEach(((e,i)=>{t[i]=e/this.data.volume[i]})),this._data=t;let e=null;for(let t=this.data.volume.length-1;t>=0;t--)if(0!==this.data.volume[t]){e=t;break}this._dataLastIndex=null===e?null:Math.min(e,Math.round((this.data.drawMinutesPerDay-this.data.marketStartMinutes)/3))}renderChart(){const{MarketSentimentSettings:t}=this.getChartLayoutSettings(),e=(0,n.R6)({context:this.context,xOffset:this.leftOffset+t.left.width+.5,yOffset:t.top.height+.5});e.do(),this.renderLineBullBear(this.context,this._data,0,0,0),e.undo()}renderLineBullBear(t,e,i,s,n){if(null===this._dataLastIndex)return;const r=(0,a.yG)(),{ChartSettings:o}=this.getChartLayoutSettings(),{Colors:l}=o.general,h=[1,-1];t.save(),t.beginPath(),t.rect(-this.leftOffset,this.fy(h[1]),this.fx(this._dataLastIndex),Math.round(this.fy(s)-this.fy(h[1]))-.5),t.clip(),t.set("fillStyle","rgba(200, 0, 0, 0.392)"),t.set("strokeStyle",r?l.marketDown:j),t.beginPath(),t.moveTo(this.fx(0),Math.round(this.fy(h[0])));for(let s=i;s<this.data.close.length;s++)t.lineTo(this.fx(s),Math.round(this.fy(e[s])));t.lineTo(this.fx(this.data.close.length-1),Math.round(this.fy(h[0]))),t.fill(),t.stroke(),t.restore(),t.save(),t.beginPath(),t.rect(-this.leftOffset,this.fy(h[0]),this.fx(this._dataLastIndex),Math.round(this.fy(n))-.5),t.clip(),t.set("fillStyle","rgba(0, 180, 0, 0.392)"),t.set("strokeStyle",r?l.marketUp:_),t.beginPath(),t.moveTo(this.fx(0),Math.round(this.fy(h[1])));for(let s=i;s<this.data.close.length;s++)t.lineTo(this.fx(s),Math.round(this.fy(e[s])));t.lineTo(this.fx(this.data.close.length-1),Math.round(this.fy(h[1]))),t.fill(),t.stroke(),t.restore()}renderXAxis(){const{MarketSentimentSettings:t}=this.getChartLayoutSettings(),{Colors:e}=t.general,i=(0,n.R6)({context:this.context,xOffset:this.leftOffset+t.left.width,yOffset:t.top.height});i.do();const a=this.getXLine(),r=new y.Z({y:this.height+12,font:{size:7},fillStyle:e.text,textBaseline:s.EQ.bottom,textAlign:s.PH.center},this.paneModel);let o;o=this.fx(0),a.set({x1:o,x2:o}).render(this.context),o=this.fx(10)+2,r.set({text:"10AM",x:o}).render(this.context),a.set({x1:o,x2:o}).render(this.context),o=this.fx(30),a.set({x1:o,x2:o}).render(this.context),o=this.fx(50),r.set({text:"12PM",x:o}).render(this.context),a.set({x1:o,x2:o}).render(this.context),o=this.fx(70),a.set({x1:o,x2:o}).render(this.context),o=this.fx(90),r.set({text:"2PM",x:o}).render(this.context),a.set({x1:o,x2:o}).render(this.context),o=this.fx(110),a.set({x1:o,x2:o}).render(this.context),o=this.fx(129),r.set({text:"4PM",x:o}).render(this.context),a.set({x1:o,x2:o}).render(this.context),i.undo()}renderText(){}renderCrossText(){}renderOverlaysLabels(){}_compute(){return{min:-1,max:1}}computeVisibleMinMax(){return this._compute()}renderYAxis(t){const{MarketSentimentSettings:e,ChartSettings:i}=this.getChartLayoutSettings(),{Colors:r}=i.general,o=(0,a.yG)(),l=(0,n.R6)({context:this.context,xOffset:e.left.width,yOffset:e.top.height});l.do();const h=this.getYLine();for(const e of[-1,0,1]){const i=Math.round(this.fy(e));h.set({y1:i,y2:i}).render(t)}const c=new y.Z({x:this.width+27,font:{size:8},textBaseline:s.EQ.middle,textAlign:s.PH.right},this.paneModel),d=o?r.marketUp:_,u=o?r.marketDown:j,m=this._data[this._dataLastIndex],g=null!==this._dataLastIndex?Math.floor(50*m+50):50;c.set({y:this.fy(0)-5,fillStyle:d,text:"".concat(g,"%")}).render(t),c.set({y:this.fy(0)+7,fillStyle:u,text:"".concat(100-g,"%")}).render(t),l.undo()}clip(){const{MarketSentimentSettings:t}=this.getChartLayoutSettings();this.context.beginPath(),this.context.rect(t.left.width,t.top.height,this.width+3,this.height+1),this.context.clip()}getMinMax(){return this._compute()}renderVolumeAxis(){}renderVolume(){}toString(){return"Market sentiment chart"}}var K,G,J;K=Q,G="type",J=s.nJ.MarketSentiment,G in K?Object.defineProperty(K,G,{value:J,enumerable:!0,configurable:!0,writable:!0}):K[G]=J,Q.initClass();const $=Q;var tt=i(7256);function et(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}const it=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];class st extends R{constructor(t,e){super(t,e),et(this,"tickersDimensions",[]),this.renderText=this.renderText.bind(this)}renderChart(){const{ChartSettings:t,ColorsSettings:e}=this.getChartLayoutSettings(),i=(0,n.R6)({context:this.context,xOffset:this.leftOffset+t.left.width+.5,yOffset:t.top.height+.5});i.do(),this.context.set("lineWidth",1);const s={};for(const t of this.getQuotes())s[t.ticker]=t;for(let t=this.attrs.tickers.length-1;t>=0;t--){const i=s[this.attrs.tickers[t]];this.context.set("strokeStyle",e[t%e.length]),this.context.beginPath();for(let t=0,e=i.close.length,s=e>=0;s?t<e:t>e;s?t++:t--){const e=this.fx(t);if(e+this.leftOffset<-10||e+this.leftOffset>this.model.width+10)continue;const s=Math.round(this.fy(i.close[t]));this.context.lineTo(e,s)}this.context.stroke()}i.undo()}renderText(t){const{ChartSettings:e}=this.getChartLayoutSettings(),{Colors:i}=e.general,n=this.attrs.label||"",a=(this.height-4)/2;return new y.Z({text:n,x:28,y:e.top.height+a,angle:-90,font:{size:10,weight:"900",family:"Lato, sans-serif"},fillStyle:i.textSecondary,textAlign:s.PH.center,textBaseline:s.EQ.alphabetic},this.paneModel).render(t),this.renderCrossText(t,this.data.close.length-1)}renderCrossText(t,e){var i;const{ChartSettings:n,ColorsSettings:r}=this.getChartLayoutSettings(),{Colors:o}=n.general,l=a.ZP.max(this.attrs.tickers.map((t=>t.length))),h=a.ZP.dateFromUnixTimestamp(null!==(i=this.data.getDataByBarIndex("date",e))&&void 0!==i?i:0),c=h.getMonth(),d=h.getFullYear(),u=h.getDate(),m=e===this.data.close.length-1;new y.Z({text:"".concat(it[c]," ").concat(u," ").concat(d,"             "),x:n.left.width+(l>15?200:132),y:30,font:{size:8},fillStyle:o.text,background:o.canvasFill},this.paneModel).render(t);const g={};for(const t of this.getQuotes())g[t.ticker]=t;for(let i=0;i<this.attrs.tickers.length;i++){const a=s.tr.S+(s.tr.S+s.Ac.M)*i;this.tickersDimensions[i]&&(t.fillStyle=o.canvasFill,t.fillRect(n.left.width-s.tr.XXXS,a-s.tr.XXXS,s.tr.XXXS+this.tickersDimensions[i]+s.tr.XXXS,s.tr.XXXS+s.Kt.M+s.tr.XXXS));const l=this.attrs.tickers[i],h=g[l].close[e],c=new y.Z({text:"".concat(l," ").concat("number"==typeof h?h.toFixed(2):NaN,"  "),x:n.left.width,y:a,font:{size:s.Kt.M,style:"bold"},lineHeight:s.Ac.M,fillStyle:r[i%r.length],textAlign:s.PH.left,textBaseline:s.EQ.top},this.paneModel);m&&(this.tickersDimensions[i]=c.measure(t)),c.render(t)}}computeVisibleMinMax(){let t=Number.MAX_VALUE,e=Number.MIN_VALUE;const{leftOffset:i}=this.model;for(var s=arguments.length,n=new Array(s),a=0;a<s;a++)n[a]=arguments[a];for(const s of n)for(let n=0,a=s.length,r=a>=0;r?n<a:n>a;r?n++:n--){const a=this.fx(n);a+i<0||a+i>this.width||(t>s[n]&&(t=s[n]),e<s[n]&&(e=s[n]))}return{min:t,max:e}}getMinMax(){const t=this.getQuotes();let{min:e,max:i}=this.computeVisibleMinMax(...t.map((t=>t.close)));return void 0!==this.attrs.min&&(e=this.attrs.min),void 0!==this.attrs.max&&(i=this.attrs.max),{min:e,max:i}}renderVolumeAxis(){}renderVolume(){}getQuotes(){return tt.Z.select((t=>{var e;return this.attrs.tickers.includes(t.ticker)&&t.timeframe===(null===(e=this.data)||void 0===e?void 0:e.timeframe)&&this.model.chart_layout().isIdeaId(t.ideaID)}))}toString(){return"Line chart ".concat(this.data.ticker)}}et(st,"type",s.nJ.MultiLineChart);const nt=st;function at(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class rt extends R{renderChart(){const{ChartSettings:t}=this.getChartLayoutSettings(),{Colors:e}=t.general,i=(0,n.R6)({context:this.context,xOffset:this.leftOffset+t.left.width,yOffset:t.top.height});i.do();const s=this.getBarWithoutMarginWidth();let a=1;s>=40?a=4:s>=30?a=3:s>=15&&(a=2);const r=a/2,l=Math.round(s/2-r),h=a%2==0?0:.5;this.context.set("lineWidth",a),(0,o.E9)({quote:this.data,scale:this.paneModel.scale,leftOffset:this.leftOffset,width:this.width,drawBarCallback:(t,i)=>{const s=~~(i+1)+h;if(this.context.beginPath(),this.context.set("strokeStyle",this.data.close[t]<this.data.open[t]?e.ohlcTrendDown:e.ohlcTrendUp),this.context.moveTo(s,Math.round(this.fy(this.data.high[t]))),this.context.lineTo(s,Math.round(this.fy(this.data.low[t]))),l>=1){const e=Math.round(this.fy(this.data.open[t]));this.context.moveTo(s+r,e+h),this.context.lineTo(s-r-l,e+h);const i=Math.round(this.fy(this.data.close[t]));this.context.moveTo(s-r,i+h),this.context.lineTo(s+r+l,i+h)}this.context.stroke()}}),i.undo()}toString(){return"OHLC ".concat(this.data.ticker)}}at(rt,"type",s.nJ.OhlcChart),at(rt,"label","OHLC"),at(rt,"iconName","ohlcChartType");const ot=rt;function lt(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}const ht=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];class ct extends R{constructor(t,e){super(t,e),lt(this,"overlayLabelWidth",void 0),lt(this,"perf",{}),this.renderText=this.renderText.bind(this),this.renderOverlaysLabels=this.renderOverlaysLabels.bind(this),this.renderYAxis=this.renderYAxis.bind(this),this.overlayLabelWidth={}}renderChart(){const{ChartSettings:t,ColorsSettings:e}=this.getChartLayoutSettings(),i=(0,n.R6)({context:this.context,xOffset:this.leftOffset+t.left.width+.5,yOffset:t.top.height+.5});i.do(),this.context.beginPath(),this.context.set("lineWidth",1);for(let t=0;t<this.attrs.tickers.length;t++){const i=this.attrs.tickers[t];if((null!=this.perf[i]?this.perf[i].length:0)>0){this.context.set("strokeStyle",e[t%e.length]),this.context.beginPath();for(let t=0,e=this.data.close.length,s=e>=0;s?t<e:t>e;s?t++:t--)this.context.lineTo(this.fx(t),Math.round(this.fy(this.perf[i][t])));this.context.stroke()}}i.undo()}renderText(t){const{ChartSettings:e}=this.getChartLayoutSettings(),{Colors:i}=e.general,n=(()=>{switch(this.model.quote().timeframe){case"d":return"DAILY";case"w":return"WEEKLY";case"m":return"MONTHLY";default:return}})(),a=(this.height-4)/2;new y.Z({text:n,x:28,y:e.top.height+a,angle:-90,font:{size:10,weight:"900",family:"Lato, sans-serif"},fillStyle:i.textSecondary,textAlign:s.PH.center,textBaseline:s.EQ.alphabetic},this.paneModel).render(t)}renderCrossText(t,e){var i;const{ChartSettings:n,ColorsSettings:r}=this.getChartLayoutSettings(),{Colors:o}=n.general,l=a.ZP.dateFromUnixTimestamp(null!==(i=this.data.getDataByBarIndex("date",e))&&void 0!==i?i:0);let h="";const c=l.getMonth(),d=l.getFullYear(),u=l.getDate();switch(this.data.timeframe){case"d":case"w":h="".concat(ht[c]," ").concat(u);break;case"m":h="".concat(ht[c]," ").concat(d);break;default:return}let m=!1;for(let i=0;i<this.attrs.tickers.length;i++){const a=this.attrs.tickers[i],l=this.perf[a];if(null!=l&&l.length){t.fillStyle=o.canvasFill,t.fillRect(n.left.width-s.tr.XXXS,s.ew.M+(s.Kt.M+s.aX.XS)*i-s.tr.XXXS,s.tr.XXXS+this.overlayLabelWidth[a]+s.tr.XXXS,s.tr.XXXS+s.Kt.M+s.tr.XXXS);const h=Number.isFinite(l[e]),c=h?"".concat(l[e].toFixed(2),"%"):"";m=m||h,new y.Z({text:"".concat(a," ").concat(c),x:n.left.width,y:s.ew.M+(s.Kt.M+s.aX.XS)*i,font:{size:s.Kt.M,style:"bold"},fillStyle:r[i%r.length],textAlign:s.PH.left,textBaseline:s.EQ.top},this.paneModel).render(t)}}m&&new y.Z({text:"".concat(h,"             "),x:n.left.width+132,y:30,font:{size:8},fillStyle:o.text,background:o.canvasFill},this.paneModel).render(t)}renderOverlaysLabels(t){super.renderOverlaysLabels(t);const{ChartSettings:e,ColorsSettings:i}=this.getChartLayoutSettings();for(let n=0;n<this.attrs.tickers.length;n++){const a=this.attrs.tickers[n],r=this.perf[a];if(null!=r&&r.length){const o=this.perf[a].length-1,l=Number.isFinite(r[o])?"".concat(r[o].toFixed(2),"%"):"",h=new y.Z({text:"".concat(a," ").concat(l),x:e.left.width,y:s.ew.M+(s.Kt.M+s.aX.XS)*n,font:{size:s.Kt.M,style:"bold"},fillStyle:i[n%i.length],textAlign:s.PH.left,textBaseline:s.EQ.top},this.paneModel);this.overlayLabelWidth={...this.overlayLabelWidth,[a]:h.measure(t)},h.render(t)}}}_compute(){var t;this.perf={};const e=this.getQuotes(),i=new Date(this.attrs.fromDate+" 00:00"),s=new Date(this.attrs.toDate+" 23:59"),n=[];for(const t of e){const e=[];for(let n=0,r=t.close.length,o=r>=0;o?n<r:n>r;o?n++:n--){const r=a.ZP.dateFromUnixTimestamp(t.date[n]);i<=r&&r<=s&&e.push(t.close[n])}n.push({ticker:t.ticker,close:e})}const r=null!==(t=h.max(n,(t=>t.close.length)))&&void 0!==t?t:0;for(const t of n){this.perf[t.ticker]=[];const e=t.close[0];let i=0;if(r>t.close.length){i=r-t.close.length;for(let e=0,s=i,n=s>=0;n?e<s:e>s;n?e++:e--)this.perf[t.ticker][e]=NaN}for(let s=0,n=t.close.length,a=n>=0;a?s<n:s>n;a?s++:s--)this.perf[t.ticker][i+s]=100*t.close[s]/e-100}const{min:o,max:l}=this.computeVisibleMinMax(...Object.keys(this.perf).map((t=>this.perf[t])));return{min:o,max:l}}computeVisibleMinMax(){let t=Number.MAX_VALUE,e=Number.MIN_VALUE;const{leftOffset:i}=this.model;for(var s=arguments.length,n=new Array(s),a=0;a<s;a++)n[a]=arguments[a];for(const s of n)for(let n=0,a=s.length,r=a>=0;r?n<a:n>a;r?n++:n--){const a=this.fx(n);a+i<0||a+i>this.width||(t>s[n]&&(t=s[n]),e<s[n]&&(e=s[n]))}return{min:t,max:e}}renderYAxis(t){const{ChartSettings:e}=this.getChartLayoutSettings(),{Colors:i}=e.general,a=(0,n.R6)({context:t,xOffset:e.left.width,yOffset:e.top.height});a.do();const r=this.paneModel.scale.y.ticks(10),o=this.getYLine(),l=new y.Z({x:this.width+8,font:{size:8},fillStyle:i.text,textBaseline:s.EQ.middle},this.paneModel);for(const e of r){const i=Math.round(this.fy(e));o.set({y1:i,y2:i}).render(t),l.set({text:e.toFixed(2),y:i}).render(t)}a.undo()}renderXAxis(){const{ChartSettings:t}=this.getChartLayoutSettings(),{Colors:e}=t.general,i=(0,n.R6)({context:this.context,xOffset:this.leftOffset+t.left.width,yOffset:t.top.height});i.do();const a=new y.Z({y:this.height+18,font:{size:8},fillStyle:e.text,textBaseline:s.EQ.bottom,textAlign:s.PH.center},this.paneModel),r=a.set({text:"2020"}).measure(this.context);let o=new Date(1e3*this.data.date[0]),l=o.getMonth()+"-"+o.getFullYear(),h=0;this.data.date.forEach(((t,e)=>{if(e<1)return;const i=new Date(1e3*t),s=i.getMonth()+"-"+i.getFullYear();s!==l&&h++,l=s}));const c=~~(this.width/r),d=h/c;let u;u=d<=1?()=>!0:d<=2?t=>t%2==0:d<=3?t=>t%3==0:d<=4?t=>t%4==0:d<=6?t=>t%6==0:t=>0===t,o=new Date(1e3*this.data.date[0]),l=o.getMonth()+"-"+o.getFullYear();const m=this.getXLine();for(let t=0;t<this.data.date.length;t++){o=new Date(1e3*this.data.date[t]);const e=o.getMonth()+"-"+o.getFullYear();if(e!==l){l=e;const i=this.fx(t);if(i+this.leftOffset<-15||i+this.leftOffset>this.width+15)continue;if(m.set({x1:i,x2:i}).render(this.context),!u(o.getMonth()))continue;a.set({text:0===o.getMonth()?o.getFullYear().toString():ht[o.getMonth()],x:i}).render(this.context)}}i.undo()}getMinMax(){return this._compute()}renderVolumeAxis(){}renderVolume(){}getQuotes(){return tt.Z.select((t=>{var e;return this.attrs.tickers.includes(t.ticker)&&t.timeframe===(null===(e=this.data)||void 0===e?void 0:e.timeframe)&&this.model.chart_layout().isIdeaId(t.ideaID)}))}toString(){return"Perf chart ".concat(this.data.ticker)}}lt(ct,"type",s.nJ.PerfChart);const dt=ct,ut=Object.freeze({[s.nJ.CandleStick]:N,[s.nJ.HeikinAshi]:U,[s.nJ.HollowCandleStick]:X,[s.nJ.LineChart]:V,[s.nJ.MarketSentiment]:$,[s.nJ.MultiLineChart]:nt,[s.nJ.OhlcChart]:ot,[s.nJ.PerfChart]:dt})},3888:(t,e,i)=>{"use strict";i.d(e,{A:()=>f,Ac:()=>n,B8:()=>x,Cs:()=>b,DB:()=>X,EQ:()=>I,Gj:()=>l,IG:()=>z,J2:()=>P,Kt:()=>s,LI:()=>k,LX:()=>m,M$:()=>L,Mm:()=>w,N3:()=>A,NU:()=>M,PH:()=>T,Pw:()=>U,QX:()=>N,VG:()=>O,Vd:()=>B,aX:()=>r,bI:()=>W,et:()=>F,ew:()=>h,fG:()=>v,fu:()=>d,gg:()=>c,iL:()=>Y,iR:()=>H,ih:()=>C,j2:()=>p,kU:()=>R,mj:()=>Z,ms:()=>u,nJ:()=>g,o$:()=>y,oG:()=>o,oK:()=>E,p$:()=>q,pq:()=>S,rv:()=>D,tr:()=>a});i(7012),i(8322);const s={XXS:5,XS:7,S:8,M:10,L:11,XXL:18,XXXL:23},n={XS:7,S:8,M:10},a={XXXS:1,XXS:2,XS:3,S:5},r={XS:4},o={S:15,M:30,L:35,XL:38,XXL:48},l=44,h={XXS:2,XS:4,S:6,M:8,XXL:20},c=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];let d,u,m,g,f,p,y;!function(t){t.publish="publish",t.tools="tools",t.ideas="ideas",t.settings="settings"}(d||(d={})),function(t){t["1h1v"]="1h1v",t["1h2v"]="1h2v",t["1h3v"]="1h3v",t["2h1v"]="2h1v",t["2h2v"]="2h2v",t["3h1v"]="3h1v",t["3h2v"]="3h2v",t["1l2r"]="1l2r",t["1t2b"]="1t2b"}(u||(u={})),function(t){t.element="canvas/element",t.arrow="canvas/arrow",t.brushV1="canvas/brush/brush_v1",t.curve="canvas/curve",t.ellipse="canvas/ellipse",t.fibonacciRetracements="canvas/fibonacci_retracements",t.horizontalLine="canvas/horizontal_line",t.line="canvas/line",t.measure="canvas/measure",t.pitchforkV1="canvas/pitchfork/pitchfork_v1",t.polygon="canvas/polygon",t.position="canvas/position",t.rectangle="canvas/rectangle",t.rotatedRectangle="canvas/rotated_rectangle",t.scaledLine="canvas/scaled_line",t.scaledText="canvas/scaled_text",t.symbol="canvas/symbol",t.text="canvas/text",t.triangle="canvas/triangle",t.verticalLine="canvas/vertical_line",t.xabcd="canvas/xabcd",t.calloutV1="canvas/callout/callout_v1",t.elliottWaves="canvas/elliott_waves/elliott_waves",t.ellipseV1="canvas/ellipse/ellipse_v1",t.rotatedRectangleV1="canvas/rotated_rectangle/rotated_rectangle_v1"}(m||(m={})),function(t){t.CandleStick="charts/candle_stick",t.HeikinAshi="charts/heikin_ashi",t.HollowCandleStick="charts/candle_stick_hollow",t.LineChart="charts/line_chart",t.OhlcChart="charts/ohlc_chart",t.MarketSentiment="charts/market_sentiment",t.MultiLineChart="charts/multi_line_chart",t.PerfChart="charts/perf_chart"}(g||(g={})),function(t){t.Indicator="indicators/indicator",t.None="indicators/none",t.Adx="indicators/adx",t.Aro="indicators/aro",t.Aroosc="indicators/aroosc",t.Atr="indicators/atr",t.Cci="indicators/cci",t.Cot="indicators/cot",t.Fi="indicators/fi",t.Macd="indicators/macd",t.Mfi="indicators/mfi",t.Obv="indicators/obv",t.Perf="indicators/perf",t.Rmi="indicators/rmi",t.Roc="indicators/roc",t.Rsi="indicators/rsi",t.Rwi="indicators/rwi",t.Stofa="indicators/stofa",t.Stofu="indicators/stofu",t.Stosl="indicators/stosl",t.Trix="indicators/trix",t.Ult="indicators/ult",t.Vol="indicators/vol",t.Wr="indicators/wr"}(f||(f={})),function(t){t.Overlay="overlays/overlay",t.None="overlays/none",t.Bb="overlays/bb",t.Dch="overlays/dch",t.Ema="overlays/ema",t.Ema2="overlays/ema2",t.Hilo="overlays/hilo",t.Hline="overlays/hline",t.Ic="overlays/ic",t.Icf="overlays/icf",t.Kch="overlays/kch",t.Patterns="overlays/patterns",t.Sar="overlays/sar",t.Sma="overlays/sma",t.Sma2="overlays/sma2",t.Str="overlays/str",t.Vp="overlays/vp",t.Vwap="overlays/vwap"}(p||(p={})),function(t){t.ChartEvent="chartEvent/chartEvent",t.Dividends="chartEvent/dividends",t.Split="chartEvent/split",t.EarningsPos="chartEvent/earningsPos",t.EarningsNeg="chartEvent/earningsNeg",t.Earnings="chartEvent/earnings"}(y||(y={}));const v={[y.Dividends]:"Dividends",[y.Split]:"Split",[y.EarningsPos]:"Earnings & Revenue",[y.EarningsNeg]:"Earnings & Revenue",[y.Earnings]:"Earnings & Revenue"},b={"1h1v":{columns:1,rows:1,count:1},"1h2v":{columns:1,rows:2,count:2},"1h3v":{columns:1,rows:3,count:3},"2h1v":{columns:2,rows:1,count:2},"2h2v":{columns:2,rows:2,count:4},"3h1v":{columns:3,rows:1,count:3},"3h2v":{columns:3,rows:2,count:6},"1l2r":{columns:2,rows:2,count:3,gridAreas:["1 / 1 / 3 / 2","1 / 2 / 2 / 3","2 / 2 / 3 / 3"]},"1t2b":{columns:2,rows:2,count:3,gridAreas:["1 / 1 / 2 / 3","2 / 1 / 3 / 2","2 / 2 / 3 / 3"]}},x={ASC:"ASC",DESC:"DESC"};let C;!function(t){t.i1="i1",t.i2="i2",t.i3="i3",t.i5="i5",t.i10="i10",t.i15="i15",t.i30="i30",t.h="h",t.h2="h2",t.h4="h4",t.d="d",t.w="w",t.m="m"}(C||(C={}));const w=[C.i1,C.i2,C.i3,C.i5],S={[C.i1]:1,[C.i2]:2,[C.i3]:3,[C.i5]:5,[C.i10]:10,[C.i15]:15,[C.i30]:30,[C.h]:60,[C.h2]:120,[C.h4]:240};let M;!function(t){t.d1="d1",t.d5="d5",t.m1="m1",t.m3="m3",t.m6="m6",t.ytd="ytd",t.y1="y1",t.y2="y2",t.y5="y5",t.max="max"}(M||(M={}));const P={[C.i1]:60,[C.i2]:120,[C.i3]:180,[C.i5]:300,[C.i10]:600,[C.i15]:900,[C.i30]:1800,[C.h]:3600,[C.h2]:7200,[C.h4]:14400,[C.d]:86400,[C.w]:604800,[C.m]:2592e3},k={BTCUSD:"BTCUSD",LTCUSD:"LTCUSD",ETHUSD:"ETHUSD",XRPUSD:"XRPUSD",BCHUSD:"BCHUSD",BTCEUR:"BTCEUR",LTCEUR:"LTCEUR",ETHEUR:"ETHEUR",XRPEUR:"XRPEUR",BCHEUR:"BCHEUR",LTCBTC:"LTCBTC",ETHBTC:"ETHBTC",XRPBTC:"XRPBTC",BCHBTC:"BCHBTC"};let E,T,I,A,L;!function(t){t.default="default",t.quotePage="quotePage",t.chartPage="chartPage",t.smallIndex="smallIndex",t.offScreen="offScreen",t.forexPage="forexPage",t.futuresPage="futuresPage",t.cryptoPage="cryptoPage"}(E||(E={})),function(t){t.left="left",t.right="right",t.center="center",t.start="start",t.end="end"}(T||(T={})),function(t){t.top="top",t.hanging_dont_use="hanging",t.middle="middle",t.alphabetic="alphabetic",t.ideographic_dont_use="ideographic",t.bottom="bottom"}(I||(I={})),function(t){t.Linear="linear",t.Percentage="percentage",t.Logarithmic="logarithmic"}(A||(A={})),function(t){t[t.Default=3e3]="Default",t[t.Free=18e4]="Free",t[t.Elite=3e3]="Elite",t[t.EliteStocksReduced=6e4]="EliteStocksReduced"}(L||(L={}));const D=30,O={[A.Linear]:"Linear",[A.Percentage]:"Percentage",[A.Logarithmic]:"Logarithmic"},R={chart:400,indicator:120},F=24,B=150,N=768,Z=["m1","m3","m6","ytd","y1","y2","y5","max"],z=t=>{switch(t){case C.i1:return"1 MIN";case C.i2:return"2 MIN";case C.i3:return"3 MIN";case C.i5:return"5 MIN";case C.i10:return"10 MIN";case C.i15:return"15 MIN";case C.i30:return"30 MIN";case C.h:return"1 HR";case C.h2:return"2 HR";case C.h4:return"4 HR";case C.d:return"DAILY";case C.w:return"WEEKLY";case C.m:return"MONTHLY";default:return""}};let X,H;!function(t){t.l="l",t.c="c",t.cs="cs",t.hc="hc",t.ha="ha",t.o="o",t.p="p"}(X||(X={})),function(t){t.minutes="minutes",t.hours="hours",t.days="days",t.weeks="weeks",t.months="months"}(H||(H={}));const W={[C.i1]:{micro:1,macro:H.minutes},[C.i2]:{micro:2,macro:H.minutes},[C.i3]:{micro:3,macro:H.minutes},[C.i5]:{micro:5,macro:H.minutes},[C.i10]:{micro:10,macro:H.minutes},[C.i15]:{micro:15,macro:H.minutes},[C.i30]:{micro:30,macro:H.minutes},[C.h]:{micro:1,macro:H.hours},[C.h2]:{micro:2,macro:H.hours},[C.h4]:{micro:4,macro:H.hours},[C.d]:{micro:1,macro:H.days},[C.w]:{micro:1,macro:H.weeks},[C.m]:{micro:1,macro:H.months}},U=Object.keys(W).reduce(((t,e)=>({...t,[W[e].macro]:t[W[e].macro]?[...t[W[e].macro],W[e].micro]:[W[e].micro]})),{});let Y;!function(t){t[t.currentAndAbove=0]="currentAndAbove",t[t.currentAndBelow=1]="currentAndBelow",t[t.currentOnly=2]="currentOnly",t[t.all=3]="all"}(Y||(Y={}));const q="quoteFetchEvent"},481:(t,e,i)=>{"use strict";i.d(e,{E:()=>m});i(8322);var s=i(560),n=i.n(s),a=i(5251),r=i(7218),o=i(3888),l=i(7256),h=i(9431),c=i(9007),d=i(5867),u=i(155);function m(t){var e,i;let{chartModel:s,isPremium:m}=t;const g=(0,r.useNotification)(),f=(0,a.useLocation)(),[p,y]=n().useState(!1),v=(null==s?void 0:s.chart_layout())||null,b=null!==(e=null==v?void 0:v.getAllCharts().findIndex((t=>s.eql(t))))&&void 0!==e?e:-1,{getChartsToPath:x}=(0,d.b)({chartLayoutModel:v,chartIndex:b}),C=null!==(i=null==v?void 0:v.specificChartFunctionality)&&void 0!==i?i:o.oK.default,w=n().useMemo((()=>{if(!s)return new Date;const t=s.quote();return(0,h.X2)(t.date[t.date.length-1])}),[s]),S=n().useCallback((t=>{let{ticker:e,timeframe:i,dateRange:s}=t;return C===o.oK.chartPage?x({ticker:e,timeframe:i,dateRange:s}):(0,r.generatePathForTimeframeDateRange)({isPremium:m,pathname:f.pathname,timeframe:i,dateRange:s,utmCampaign:r.timeframeUtm[C]})}),[x,m,C,f.pathname]);return{anchorDate:w,generateChartLayoutRouterPath:S,timeframeGroupsWithHref:t=>(0,u.U3)({isPremium:t,generatePath:t=>S({timeframe:t.value,dateRange:null})}),dateRangeGroupsWithHref:t=>{let{isPremium:e,customRange:i,instrument:s}=t;return(0,r.getDateRangeGroupsWithHref)({isPremium:e,customRange:i,instrument:s,generatePath:t=>S({timeframe:t.timeframe,dateRange:t.value})})},isFetching:p,handleCustomDateRangeValidation:async t=>{if(null!==t.value){const{timeframe:e,ticker:i,instrument:a,premarket:o,aftermarket:h}=(null==s?void 0:s.quote())||{},d=(null==s?void 0:s.getHasPatterns())||!1;if(!(w&&a&&i&&e&&t.value))return!1;y(!0);const u=await l.Z.get({ticker:i,instrument:a,timeframe:t.timeframe,options:{premarket:o,aftermarket:h,patterns:d,cachePredicate:t=>void 0===t.ideaID,fetchNewDataOnCachedQuote:!0}});y(!1);const{numOfVisibleBars:m}=(0,c.pb)({...(0,c.J9)({dateRange:t.value,quote:u}),quote:u,dateRange:t.value});if(0===m)return g.show(n().createElement(r.Notification,{actions:[],timeoutInMs:6e3},n().createElement(r.Paragraph,{className:"max-w-[17rem]"},"There are no data for the selected date range. Try selecting different dates."))),!1}return!0}}}},5867:(t,e,i)=>{"use strict";i.d(e,{b:()=>c});i(9841);var s=i(560),n=i(5251),a=i(3888),r=i(4613),o=i(4088),l=i(9431),h=i(5055);function c(t){let{chartLayoutModel:e,chartIndex:i=-1}=t;const c=(0,n.useLocation)(),d=(0,r.l)(e,{watchProperties:["syncChartParts"]}),u=s.useMemo((()=>!(null==d||!d.getIsChartPartInSync(o.pr.Timeframe))),[null==d?void 0:d.syncChartParts]),m=s.useMemo((()=>!(null==d||!d.getIsChartPartInSync(o.pr.Ticker))),[null==d?void 0:d.syncChartParts]);return{getChartsToPath:s.useCallback((t=>{var e,s,n,r,o;let{ticker:g,timeframe:f,dateRange:p,layout:y}=t;if(!d)return{pathname:c.pathname,search:""};const v=(0,h.N)(c.search),{count:b}=a.Cs[null!=y?y:d.layout],x=null!==(e=null===(s=v.t)||void 0===s?void 0:s.split(","))&&void 0!==e?e:[],C=null!==(n=null===(r=v.p)||void 0===r?void 0:r.split(","))&&void 0!==n?n:[],w=null===(o=v.r)||void 0===o?void 0:o.split(","),S=Array.from({length:b}),M=S.map(((t,e)=>{var s;const n=null!==(s=x[e])&&void 0!==s?s:x[x.length-1];return(i===e||m)&&g?g:n})).join(","),P=S.map(((t,e)=>{var s;const n=null!==(s=C[e])&&void 0!==s?s:C[C.length-1];return(i===e||u)&&f?f:n})).join(","),k=S.map(((t,e)=>{var s;const n=w?null!==(s=w[e])&&void 0!==s?s:w[w.length-1]:void 0;return i!==e&&!u||void 0===p?n:p})).join(",");return{pathname:c.pathname,search:"?".concat((0,h.t)({t:M,p:P,r:k.split(",").some(Boolean)?k:void 0,l:null!=y?y:d.layout,sidebar:(0,l.jQ)()?void 0:v.sidebar}))}}),[d,i,c,m,u])}}},155:(t,e,i)=>{"use strict";i.d(e,{$X:()=>d,E5:()=>o,Qf:()=>c,U3:()=>n,Z9:()=>h,fN:()=>a,hX:()=>l});i(8322);var s=i(7218);function n(t){let{isPremium:e,generatePath:i}=t;return(0,s.getTimeframeGroups)(e).map((t=>({label:t.label,timeframes:t.timeframes.map((t=>({...t,href:i(t)})))})))}let a,r;!function(t){t.candlesticksimple="candlesticksimple",t.candlestick="candlestick",t.line="line",t.ohlc="ohlc",t.heikinashi="heikinashi",t.hollowcandlestick="hollowcandlestick"}(a||(a={})),function(t){t.cs="cs",t.c="c",t.l="l",t.o="o",t.ha="ha",t.hc="hc"}(r||(r={}));const o={[r.cs]:a.candlesticksimple,[r.c]:a.candlestick,[r.l]:a.line,[r.o]:a.ohlc,[r.ha]:a.heikinashi,[r.hc]:a.hollowcandlestick},l={[a.candlesticksimple]:r.cs,[a.candlestick]:r.c,[a.line]:r.l,[a.ohlc]:r.o,[a.heikinashi]:r.ha,[a.hollowcandlestick]:r.hc},h=[{iconName:"candleBarBasic",value:a.candlestick,label:"Candle"},{iconName:"lineChartType",value:a.line,label:"Line"},{iconName:"ohlcChartType",value:a.ohlc,label:"OHLC"},{iconName:"candleBarHollow",value:a.hollowcandlestick,label:"Hollow Candle"},{iconName:"candleBarHeikinAshi",value:a.heikinashi,label:"Heikin Ashi"}],c=[{iconName:"candleBarBasic",value:"candlesticksimple",label:"Candle - simple"},{iconName:"candleBarBasic",value:a.candlestick,label:"Candle - advanced"},...h.filter((t=>t.value!==a.candlestick))],d=["candlesticksimple","candlestick","line"]},2481:(t,e,i)=>{"use strict";i.d(e,{Z:()=>c,b:()=>l});var s=i(2127),n=i(3888),a=i(1213),r=i(8191);const o={},l=24;function h(t){return"".concat(t.type,"-").concat(t.theme,"-").concat(t.state)}function c(t){const e=h(t);return o[e]}"undefined"!=typeof window&&Object.values(a.EN).forEach((t=>{Object.values(n.o$).forEach((e=>{e!==n.o$.ChartEvent&&Object.values(s.Q2).forEach((i=>{!async function(t){const e=h(t),i=r.S[t.type]({...t,width:l}),s=new Image;s.src="data:image/svg+xml,".concat(encodeURIComponent(i)),o[e]=s}({type:e,state:t,theme:i})}))}))}))},8191:(t,e,i)=>{"use strict";i.d(e,{S:()=>m});var s=i(3888),n=i(2127),a=i(5327),r=i.n(a),o=i(1213);const l={light:{outerStroke:r().white,innerStroke:r().blue[400],innerFill:{default:r().blue[50],hover:r().blue[100],selected:r().blue[400]},textFill:{default:r().blue[500],hover:r().blue[600],selected:r().white}},dark:{outerStroke:r().gray[900],innerStroke:r().blue[400],innerFill:{default:r().blue[800],hover:r().blue[600],selected:r().blue[400]},textFill:{default:r().white,hover:r().white,selected:r().white}}};const h={light:{outerStroke:r().white,innerStroke:r().gray[400],innerFill:{default:r().gray[50],hover:r().gray[100],selected:r().gray[400]},textFill:{default:r().gray[500],hover:r().gray[600],selected:r().white}},dark:{outerStroke:r().gray[900],innerStroke:r().gray[400],innerFill:{default:r().gray[800],hover:r().gray[600],selected:r().gray[400]},textFill:{default:r().white,hover:r().white,selected:r().white}}};const c={light:{outerStroke:r().white,innerStroke:r().red[400],innerFill:{default:r().red[50],hover:r().red[100],selected:r().red[400]},textFill:{default:r().red[500],hover:r().red[600],selected:r().white}},dark:{outerStroke:r().gray[900],innerStroke:r().red[400],innerFill:{default:r().red[800],hover:r().red[600],selected:r().red[400]},textFill:{default:r().white,hover:r().white,selected:r().white}}};const d={light:{outerStroke:r().white,innerStroke:r().green[400],innerFill:{default:r().green[50],hover:r().green[100],selected:r().green[400]},textFill:{default:r().green[500],hover:r().green[600],selected:r().white}},dark:{outerStroke:r().gray[900],innerStroke:r().green[400],innerFill:{default:r().green[800],hover:r().green[600],selected:r().green[400]},textFill:{default:r().white,hover:r().white,selected:r().white}}};const u={light:{outerStroke:r().white,innerStroke:r().violet[400],innerFill:{default:r().violet[50],hover:r().violet[100],selected:r().violet[400]},textFill:{default:r().violet[500],hover:r().violet[600],selected:r().white}},dark:{outerStroke:r().gray[900],innerStroke:r().violet[400],innerFill:{default:r().violet[800],hover:r().violet[600],selected:r().violet[400]},textFill:{default:r().white,hover:r().white,selected:r().white}}};const m=Object.freeze({[s.o$.Split]:function(t){let{theme:e=n.Q2.light,state:i=o.EN.default,width:s}=t;const{outerStroke:a,innerStroke:r,innerFill:l,textFill:h}=(0,o.tC)({theme:e,state:i,colors:u});return'\n    <svg\n      xmlns="http://www.w3.org/2000/svg"\n      classname=\'pointer-events-none block\'\n      width="'.concat(s,'"\n      height="').concat(s,'"\n      viewBox="0 0 24 24"\n    >\n      <rect x="1.5" y="1.5" width="21" height="21" rx="10.5" stroke="').concat(a,'" fill="').concat(a,'" />\n      <rect x="3" y="3" width="18" height="18" rx="9" fill="').concat(l,'" />\n      <rect x="3" y="3" width="18" height="18" rx="9" stroke="').concat(r,'" fill="transparent" stroke-width="2" />\n\n      <path\n        d="M13.72 9.57c-.05-.4-.23-.72-.56-.94a2.16 2.16 0 0 0-1.25-.34c-.36 0-.67.06-.93.17-.26.11-.46.27-.6.46-.15.2-.22.42-.22.66 0 .21.05.39.15.54.1.15.22.28.38.38.17.1.34.18.52.25.19.07.37.12.54.16l.85.22c.28.07.56.16.85.28.3.12.57.27.82.46a2.05 2.05 0 0 1 .84 1.72c0 .5-.13.93-.39 1.31-.25.39-.62.7-1.1.91-.48.22-1.06.33-1.74.33-.66 0-1.22-.1-1.7-.3-.48-.21-.85-.5-1.12-.89a2.56 2.56 0 0 1-.45-1.36h1.32c.03.31.13.58.31.79.18.2.41.36.7.46.28.1.6.15.93.15.37 0 .7-.06 1-.17.28-.12.51-.29.68-.5.17-.21.25-.46.25-.74a.92.92 0 0 0-.22-.64c-.14-.16-.34-.3-.59-.4a5.8 5.8 0 0 0-.84-.3l-1.03-.28a4.02 4.02 0 0 1-1.66-.84c-.4-.36-.61-.85-.61-1.46 0-.5.13-.94.4-1.32.28-.37.65-.66 1.12-.87.46-.21.99-.32 1.57-.32.6 0 1.11.1 1.57.31.45.21.8.5 1.07.86.26.36.4.78.4 1.25h-1.26Z"\n        fill="').concat(h,'"\n      />\n    </svg>\n  ')},[s.o$.Dividends]:function(t){let{theme:e=n.Q2.light,state:i=o.EN.default,width:s}=t;const{outerStroke:a,innerStroke:r,innerFill:h,textFill:c}=(0,o.tC)({theme:e,state:i,colors:l});return'\n    <svg\n      xmlns="http://www.w3.org/2000/svg"\n      classname=\'pointer-events-none block\'\n      width="'.concat(s,'"\n      height="').concat(s,'"\n      viewBox="0 0 24 24"\n    >\n      <rect x="1.5" y="1.5" width="21" height="21" rx="10.5" stroke="').concat(a,'" fill="').concat(a,'" />\n      <rect x="3" y="3" width="18" height="18" rx="9" fill="').concat(h,'" />\n      <rect x="3" y="3" width="18" height="18" rx="9" stroke="').concat(r,'" fill="transparent" stroke-width="2" />\n\n      <path\n        d="M11.78 16H8.96V7.27h2.91c.86 0 1.6.18 2.2.53.62.34 1.1.84 1.42 1.5.33.64.5 1.42.5 2.32 0 .91-.17 1.7-.5 2.35a3.5 3.5 0 0 1-1.44 1.5c-.62.36-1.38.53-2.27.53Zm-1.5-1.15h1.43c.67 0 1.22-.13 1.66-.38.44-.25.77-.61.99-1.1.22-.47.33-1.06.33-1.75 0-.68-.11-1.26-.33-1.74a2.32 2.32 0 0 0-.97-1.09 3.16 3.16 0 0 0-1.6-.37h-1.51v6.43Z"\n        fill="').concat(c,'"\n      />\n    </svg>\n  ')},[s.o$.EarningsPos]:function(t){let{theme:e=n.Q2.light,state:i=o.EN.default,width:s}=t;const{outerStroke:a,innerStroke:r,innerFill:l,textFill:h}=(0,o.tC)({theme:e,state:i,colors:d});return'\n    <svg\n      xmlns="http://www.w3.org/2000/svg"\n      className=\'pointer-events-none block\'\n      width="'.concat(s,'"\n      height="').concat(s,'"\n      viewBox="0 0 24 24"\n    >\n      <path\n        d="M21.5 19V5.44a2.5 2.5 0 0 0-1.7-2.37l-7-2.33a2.5 2.5 0 0 0-1.6 0l-7 2.33a2.5 2.5 0 0 0-1.7 2.37V19A2.5 2.5 0 0 0 5 21.5h14a2.5 2.5 0 0 0 2.5-2.5Z"\n        stroke="').concat(a,'"\n        fill="').concat(a,'"\n      />\n      <path\n        d="M20 5.44V19a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1V5.44a1 1 0 0 1 .68-.95l7-2.33a1 1 0 0 1 .64 0l7 2.33a1 1 0 0 1 .68.95Z"\n        stroke-width="2"\n        fill="').concat(l,'"\n        stroke="').concat(r,'"\n      />\n      <path d="M8.96 16V7.27h5.47v1.14h-4.15v2.66h3.86v1.12h-3.86v2.68h4.2V16H8.96Z" fill="').concat(h,'" />\n    </svg>\n  ')},[s.o$.EarningsNeg]:function(t){let{theme:e=n.Q2.light,state:i=o.EN.default,width:s}=t;const{outerStroke:a,innerStroke:r,innerFill:l,textFill:h}=(0,o.tC)({theme:e,state:i,colors:c});return'\n    <svg\n      xmlns="http://www.w3.org/2000/svg"\n      classname=\'pointer-events-none block\'\n      width="'.concat(s,'"\n      height="').concat(s,'"\n      viewBox="0 0 24 24"\n    >\n      <path\n        d="M2.5 5v13.56a2.5 2.5 0 0 0 1.7 2.37l7 2.33a2.5 2.5 0 0 0 1.6 0l7-2.33a2.5 2.5 0 0 0 1.7-2.37V5A2.5 2.5 0 0 0 19 2.5H5A2.5 2.5 0 0 0 2.5 5Z"\n        stroke="').concat(a,'"\n        fill="').concat(a,'"\n      />\n      <path\n        d="M4 18.56V5a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1v13.56a1 1 0 0 1-.68.95l-7 2.33a1 1 0 0 1-.64 0l-7-2.33a1 1 0 0 1-.68-.95Z"\n        stroke-width="2"\n        fill="').concat(l,'"\n        stroke="').concat(r,'"\n      />\n      <path d="M8.96 16V7.27h5.47v1.14h-4.15v2.66h3.86v1.12h-3.86v2.68h4.2V16H8.96Z" fill="').concat(h,'" />\n    </svg>\n  ')},[s.o$.Earnings]:function(t){let{theme:e=n.Q2.light,state:i=o.EN.default,width:s}=t;const{outerStroke:a,innerStroke:r,innerFill:l,textFill:c}=(0,o.tC)({theme:e,state:i,colors:h});return'\n    <svg\n      xmlns="http://www.w3.org/2000/svg"\n      classname=\'pointer-events-none block\'\n      width="'.concat(s,'"\n      height="').concat(s,'"\n      viewBox="0 0 24 24"\n    >\n      <rect x="1.5" y="1.5" width="21" height="21" rx="3" stroke="').concat(a,'" fill="').concat(a,'" />\n      <rect x="3" y="3" width="18" height="18" rx="2" fill="').concat(l,'" />\n      <rect x="3" y="3" width="18" height="18" rx="2" stroke="').concat(r,'" fill="transparent" stroke-width="2" />\n      <path d="M8.96 16V7.27h5.47v1.14h-4.15v2.66h3.86v1.12h-3.86v2.68h4.2V16H8.96Z" fill="').concat(c,'" />\n    </svg>\n  ')}})},1213:(t,e,i)=>{"use strict";i.d(e,{EN:()=>r,LN:()=>l,m9:()=>h,tC:()=>o});i(8322),i(9841);var s=i(8723),n=i(9431),a=i(5200);let r;function o(t){let{theme:e,state:i,colors:s}=t;return{outerStroke:s[e].outerStroke,innerStroke:s[e].innerStroke,innerFill:s[e].innerFill[i],textFill:s[e].textFill[i]}}function l(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{month:"short"};const s=n.ZP.dateFromUnixTimestamp(t),r=s.getHours(),o=(0,a.Eg)(s,i);if(e){let t="";return r<=9?t="BMO":r>=16&&(t="AMC"),"".concat(o," ").concat(t)}return o}function h(t){let{value:e,bigNumberUnit:i,maxDecimalPlaces:n=3}=t,a="";const r=isNaN(e)?0:e;a=void 0===i?s.ZP.round({value:r,overridePlaces:3}):s.ZP.formatBigNumber(r*s.wQ[i],3,s.O$.Million);const[o,l]=a.split(".");if(void 0===l)return o;let h=l;return 2!==n&&"0"!==l[l.length-1]||(h=l.slice(0,-1)),[o,h].join(".")}!function(t){t.default="default",t.hover="hover",t.selected="selected"}(r||(r={}))},8434:(t,e,i)=>{"use strict";i.d(e,{i:()=>s});i(8322);const s={importFn:()=>Promise.all([i.e(327),i.e(882)]).then(i.bind(i,4964)),cacheKey:"chart-settings"}},9007:(t,e,i)=>{"use strict";i.d(e,{oq:()=>S,uG:()=>x,J9:()=>g,IA:()=>y,fS:()=>v,te:()=>C,rI:()=>b,az:()=>f,CH:()=>k,G$:()=>A,Lx:()=>T,Gw:()=>M,R6:()=>I,Lm:()=>L,pb:()=>u,RJ:()=>E,qk:()=>P,qu:()=>D});i(6539),i(8322);var s=i(264),n=i(2497),a=i(2127),r=i(3888),o=i(9431),l=i(5495);i(9841),i(5422);let h;!function(t){t.Range="range",t.Prev="prev"}(h||(h={}));const c="_";function d(t){return t.split(c)}const u=t=>{let{start:e,end:i,quote:s,dateRange:n}=t;const o=e?e.getTime()/1e3:0,l=i.getTime()/1e3,h=s.date.length-1;let c=h,d=0;if([r.NU.d1,r.NU.d5].includes(n)&&s.instrument===a.Yx.Stock)d=s.drawMinutesPerDay;else{let t=-1;if(c=-1,s.date.forEach(((e,i)=>{(t=>t>=o&&t<=l)(e)&&(-1===t&&(t=i),c=i)})),d=c-t+1,-1===t&&-1===c)return{numOfVisibleBars:0,numOfBarsOffset:0}}return{numOfVisibleBars:d,numOfBarsOffset:h-c}},m=t=>{let{chartVisibleWidth:e,start:i,end:s,quote:n,chartModel:a,numOfBarsToRender:r}=t;const{numOfVisibleBars:o,numOfBarsOffset:h}=u({start:i,end:s,quote:n,dateRange:a.dateRange});if(0===o)return{zoomFactor:a.zoomFactor,leftOffset:a.leftOffset};const c=a.chart_layout(),d=(0,l.GX)({chartLayout:c,chartVisibleWidth:e,numOfVisibleBars:null!=r?r:o}),m=(0,l.zG)({chartLayout:c,zoomFactor:d});return{zoomFactor:d,leftOffset:b({quote:n,chartModel:a,config:{},barWidth:m,numberOfBarsToDraw:r})+h*m}},g=t=>{let{dateRange:e,quote:i}=t;const s=i.getDaysInQuote(),a=(0,o.X2)(i.date[i.date.length-1]);if(e.includes(c)){const t=function(t){let{dateRange:e,anchorDate:i}=t;const[s,a]=d(e);if(s===h.Range){const[t,e]=a.replace(/-/g,"/").split("x"),i=t?new Date(t):null,s=e?new Date(e):null;return{start:i&&!Number.isNaN(i.getTime())?i:null,end:s&&!Number.isNaN(s.getTime())?n.endOfDay(s):null}}if(s===h.Prev){const[t,e,s]=a.split("-").map(Number);return[t,e,s].some(Number.isNaN)?{start:null,end:null}:{start:n.startOfDay(n.sub(i,{years:t,months:e,days:s-1})),end:i}}return{start:null,end:i}}({dateRange:e,anchorDate:a}),i=(0,o.Hn)(t.end&&t.end.getTime()<=a.getTime()?t.end:a,!1);return{start:t.start&&(0,o.Hn)(t.start,!1),end:i}}let l;switch(e){case r.NU.d1:a.setHours(23,59,59,999),l=0===s.length?a:s[s.length-1];break;case r.NU.d5:a.setHours(23,59,59,999);const t=0===s.length?-1:Math.max(s.length-5,0);l=-1===t?a:s[t];break;case r.NU.m1:l=n.subMonths(a,1);break;case r.NU.m3:l=n.subMonths(a,3);break;case r.NU.m6:l=n.subMonths(a,6);break;case r.NU.ytd:l=n.startOfYear(a);break;case r.NU.y1:l=n.subYears(a,1);break;case r.NU.y2:l=n.subYears(a,2);break;case r.NU.y5:l=n.subYears(a,5);break;case r.NU.max:default:l=null}return{start:l&&(0,o.Hn)(l,!1),end:(0,o.Hn)(a,!1)}},f=t=>{let{newLeftOffset:e,chartModel:i,barWidth:s=(0,l.zG)({zoomFactor:i.zoomFactor,chartLayout:i.chart_layout()}),barIndex:n}=t;const{ChartSettings:a}=i.getChartLayoutSettings(),r=i.width-a.left.width-a.right.width,h=Math.floor(r/s);return~~o.ZP.min(s/2,o.ZP.max(e,r-(c=n+h,c*s)));var c},p=2.5;function y(t){let{hasAftermarket:e,hasPremarket:i,timeframeMinutes:s,barWidthWithMargin:n}=t;const a=60*(6.5+(i?p:0)+(e?p:0));return r.oG.L+r.oG.XXL+a/s*n}function v(t){let{timeframeMinutes:e,barWidthWithMargin:i,hasPremarket:s,hasAftermarket:n,maxWidth:a}=t;const r=y({hasPremarket:s,hasAftermarket:n,barWidthWithMargin:i,timeframeMinutes:e}),o=60*p/e*i,l=n&&s&&a>=r-o&&a<r;return{fullChartWidth:r,offsetInPx:l?o:0,chartWidthWithOffset:l?r-o:r,offsetChartAfter:16}}const b=t=>{let{quote:e,chartModel:i,config:s,barWidth:n=(0,l.zG)({zoomFactor:i.zoomFactor,chartLayout:i.chart_layout()}),barIndex:a=x(e),numberOfBarsToDraw:h,shouldAlignDaysToLeftApplied:c=!0}=t;const{ChartSettings:d}=i.getChartLayoutSettings(),u=i.width-d.left.width-d.right.width,m=i.chart_layout().specificChartFunctionality;if(null!=s&&s.stretch)return 0;if(C(m))return n;const g=t=>t*n;let p=u-g(a)-Math.round(n/2);if(p=Math.round(o.ZP.min(n/2,o.ZP.max(p,u-g(a+45)))),c&&w({quote:e,numberOfBarsToDraw:h,specificChartFunctionality:m,dateRange:i.dateRange})){let t=1;h?t=Math.ceil(h/e.getBarsInDay()):[10,15].includes(e.interval)||i.dateRange===r.NU.d5?t=5:e.interval>=30&&(t=e.interval/30*10);const{offsetInPx:s,offsetChartAfter:a}=v({hasAftermarket:!!e.aftermarket,barWidthWithMargin:n,timeframeMinutes:e.interval,hasPremarket:!!e.premarket,maxWidth:i.width});if(t*e.getBarsInDay()*n-s<=u+1){var y;const i=e.date.last()?o.ZP.dateFromUnixTimestamp(e.date.last()):null,r=(Object.keys(e.getDayToOffset()).length-t)*e.getBarsInDay(),l=(null!==(y=null==i?void 0:i.getHours())&&void 0!==y?y:0)>=a?s:0;p=Math.round(-g(r)+n/2)-l}}return m===r.oK.offScreen?p:f({newLeftOffset:p,chartModel:i,barWidth:n,barIndex:a})},x=t=>{var e;return(null==t?void 0:t.getBarIndex(null!==(e=t.open)&&void 0!==e&&e.length?t.open.length-1:0))||0},C=t=>t===r.oK.smallIndex,w=t=>{let{quote:e,dateRange:i,numberOfBarsToDraw:s,specificChartFunctionality:n}=t;const o=e.isIntraday&&e.instrument===a.Yx.Stock,l=[r.oK.quotePage,r.oK.offScreen].includes(n),h=n===r.oK.chartPage,c=h&&!!i&&[r.NU.d1,r.NU.d5].includes(i);return o&&(l||c||h&&s)},S=t=>{let{canvasCtx:e,width:i,height:s,Settings:n}=t;const a=i-n.left.width-n.right.width,r=s-n.top.height-n.bottom.height;e.beginPath(),e.rect(n.left.width,n.top.height,a,r),e.clip()},M=t=>{const{ChartSettings:e,IndicatorSettings:i}=t.chart().getChartLayoutSettings();for(const e of t.elements().all())if(e.isIndicator())return i;return e},P=t=>{let{chartModel:e,paneModel:i}=t;const{ChartSettings:n,IndicatorSettings:o,MarketSentimentSettings:h}=e.getChartLayoutSettings(),c=e.chart_layout(),d=(0,l.zG)({chartLayout:c,zoomFactor:e.zoomFactor});for(const t of[...i.getAllElements(),...i.getAllChartEvents(!1)]){const l=t.instance,c=t.isChart();if(c||t.isIndicator()){let t,u,m;const g=c?e.scale:r.N3.Linear;u=c?e.instrument===a.Yx.MarketSentiment?h:n:o;const f=i.height-u.top.height-u.bottom.height;e.stretch?(m=e.width-u.left.width-u.right.width,t=s.scaleLinear().range([0,m]).domain([0,Math.max(0,e.quote().close.length-1)])):(t=t=>t*d,t.invert=t=>t/d,t.width=function(t){return this.invert(t)-this.invert(0)}),i.updateAttribute("scale",{x:t});const{min:p,max:y}=i.scaleRange||l.getMinMax();let v;if(g===r.N3.Logarithmic)v=s.scaleSymlog().range([0,f]).domain([y,p]);else v=s.scaleLinear().range([0,f]).domain([y,p]),i.scaleRange||(v=v.nice(10));v.height=function(t){return this.invert(t)-this.invert(0)},i.updateAttribute("scale",{x:t,y:v}),c&&l.setupAxis(t);break}}},k=t=>t%2==0?0:.5,E=t=>{let{lineWidth:e,x1:i,y1:s,x2:n,y2:a}=t;return e%2==0?{x:0,y:0}:s===a?{x:0,y:.5}:i===n?{x:.5,y:0}:{x:.5,y:.5}},T=t=>{const e=Object.entries(t);for(let t=0;t<e.length;t++)e[t][1]=Math.round(e[t][1]);return Object.fromEntries(e)},I=t=>{let{context:e,xOffset:i,yOffset:s}=t;return{do:()=>e.translate(i,s),undo:()=>e.translate(-1*i,-1*s)}},A=t=>{let{number:e,base:i}=t;return(e-i)/i*100},L=t=>{let{number:e,base:i}=t;return e/100*i+i};function D(t){let{chartModel:e,quote:i}=t;const{ChartSettings:s}=e.getChartLayoutSettings(),a=e.width-(s.left.width+s.right.width),{start:r,end:o,numOfBarsToRender:l}=function(t){var e,i;let{dateRange:s,quote:a}=t;const r=g({dateRange:s,quote:a}),[o]=d(s);let l=null,c=null,u=null;if(r.start&&o===h.Prev){var m,f;const t=[...a.getDaysInQuote()].reverse(),e=t.findIndex((t=>t.getTime()<=r.start.getTime())),i=t.findIndex((t=>t.getTime()<=r.end.getTime()));l=null!==(m=t[e])&&void 0!==m?m:null,c=null!==(f=t[i])&&void 0!==f?f:null,u=a.interval<=5?e-i+1:null}return{start:r.start,end:r.end,startQuoteDate:l,endQuoteDate:c,numOfDaysToRender:u,numOfBarsToRender:(null!==(e=u)&&void 0!==e?e:0)*(null!==(i=a.getBarsInDay())&&void 0!==i?i:0)||void 0,renderDateStart:r.start&&n.startOfDay(r.start),renderDateEnd:r.end&&n.endOfDay(r.end)}}({dateRange:e.dateRange,quote:i}),{zoomFactor:c,leftOffset:u}=m({chartVisibleWidth:a,start:r,end:o,quote:i,numOfBarsToRender:l,chartModel:e});e.zoomFactor===c&&e.leftOffset===u||e.updateAttributes({zoomFactor:c,leftOffset:u})}},321:(t,e,i)=>{"use strict";i.d(e,{H:()=>s,d:()=>n});const s={min:200,max:400};let n;!function(t){t[t.vertical=0]="vertical",t[t.horizontal=1]="horizontal"}(n||(n={}))},990:(t,e,i)=>{"use strict";i.d(e,{S:()=>l,l:()=>o});var s=i(560),n=i.n(s),a=i(321);const r={activeModule:null,isOpen:!1,isCloseVisible:!1,direction:a.d.horizontal,width:a.H,close:()=>{},onResize:()=>{},selectModule:()=>{}},o=n().createContext(r),l=()=>n().useContext(o)},6990:(t,e,i)=>{"use strict";let s,n,a;i.d(e,{M6:()=>n,U:()=>s,lu:()=>a}),function(t){t.Arrow="arrow",t.Brush="brush",t.Callout="callout",t.Curve="curve",t.ElliottWaves="elliott-wave",t.Ellipse="ellipse",t.FibonacciRetracements="fibonacci-retracements",t.HorizontalLine="horizontal-line",t.Measure="measure",t.Mouse="mouse",t.Pitchfork="pitchfork",t.Polygon="polygon",t.Position="position",t.Rectangle="rectangle",t.RotatedRectangle="rotated-rectangle",t.ScaledLine="scaled-line",t.ScaledText="scaled-text",t.Triangle="triangle",t.VerticalLine="vertical-line",t.Xabcd="xabcd"}(s||(s={})),function(t){t.AddNote="add-note",t.DeleteDrawings="delete-drawings",t.DeleteAutoSavedDrawings="delete-autosaved-drawings"}(n||(n={})),function(t){t.PreserveDrawings="preserve-drawings",t.DrawingModeContinuous="drawing-mode-continuous",t.HideDrawings="hide-drawings",t.LockDrawings="lock-drawings"}(a||(a={}))},6805:(t,e,i)=>{"use strict";i.d(e,{T8:()=>o,hw:()=>r,nD:()=>a});var s=i(2127),n=i(3888);function a(t){return"".concat(t.name||t.ticker," - ").concat(function(t){switch(t){case s.Yx.Stock:return"Stock";case s.Yx.Futures:return"Futures";case s.Yx.Forex:return"Forex";case s.Yx.Crypto:return"Crypto";case s.Yx.MarketSentiment:return"Market Sentiment"}}(t.instrument)," Price Chart")}const r=t=>{switch(t){case n.nJ.HeikinAshi:return"heikinashi";case n.nJ.HollowCandleStick:return"hollowcandlestick";case n.nJ.LineChart:return"line";case n.nJ.OhlcChart:return"ohlc";case n.nJ.CandleStick:default:return"candlestick"}},o=t=>null===t?null:Object.values(n.nJ).find((e=>t===r(e)))},4982:(t,e,i)=>{"use strict";i.d(e,{Z:()=>a});var s=i(9431);function n(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}const a=class{constructor(t){n(this,"period",void 0),n(this,"sum",void 0),n(this,"count",void 0),n(this,"value",void 0),this.period=t,this.sum=0,this.count=0,this.value=0}add(t,e,i){const n=s.ZP.max([t-e,Math.abs(t-i),Math.abs(e-i)]);this.count<this.period?(this.sum+=n,this.value=this.sum/(this.count+1),this.count===this.period-1&&(this.sum/=this.period)):this.value=(this.value*(this.period-1)+n)/this.period,this.count++}}},6477:(t,e,i)=>{"use strict";function s(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}i.d(e,{Z:()=>n});const n=class{constructor(t){s(this,"period",void 0),s(this,"multiplier",void 0),s(this,"sum",void 0),s(this,"count",void 0),s(this,"value",void 0),this.period=t,this.multiplier=2/(this.period+1),this.sum=0,this.count=0,this.value=0}add(t){this.count<this.period?(this.sum+=t,this.count++,this.value=this.sum/this.count):this.value=t*this.multiplier+this.value*(1-this.multiplier)}}},5169:(t,e,i)=>{"use strict";i.d(e,{u:()=>L});var s=i(7418),n=i(3888),a=(i(6539),i(8497)),r=i(2481),o=i(1213),l=i(9007);function h(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class c extends a.Z{constructor(t,e){super(t,e),h(this,"isOpen",!1),h(this,"left",0),h(this,"top",0),h(this,"getBoundingPointKeys",(()=>({x:["x"],y:[]}))),this.scale(this.getBoundingPointKeys())}get type(){return this.constructor.type}get label(){return this.constructor.label}getChartEventModel(){var t;return null===(t=this.model.chartEvents())||void 0===t?void 0:t.findByAttribute("instance",this)}getXYPosition(){var t;const{top:e,bottom:i}=this.getChartLayoutSettings().ChartSettings,s=this.getChartEventModel(),{x:n}=this.scaled,a=(0,l.Lx)({x:n}),o=this.model.height-e.height-i.height-r.b-(null!==(t=null==s?void 0:s.yIndex)&&void 0!==t?t:0)*r.b;return{x:a.x-r.b/2,y:o}}getIsVisible(){var t;return![n.ih.w,n.ih.m].includes(null===(t=this.model.chart().quote())||void 0===t?void 0:t.timeframe)}renderContent(t){if(!this.getIsVisible())return;this.attrs.x=Math.round(this.attrs.x);const e=this.model.chart(),i=e.chart_layout(),{settingsHeight:s}=i.settings.ChartSettings.general,a=i.specificChartFunctionality===n.oK.chartPage,{x:l,y:h}=this.getXYPosition(),c=10+r.b;if(l+e.leftOffset<-c||l+e.leftOffset>e.width+c)return;const d=(0,r.Z)({theme:i.theme,state:(u=this,u.isOpen?o.EN.selected:u.isHovered?o.EN.hover:o.EN.default),type:this.type});var u;const{left:m,top:g}=this.getChartLayoutSettings().ChartSettings;this.left=l+e.leftOffset+m.width+r.b/2,this.top=h+g.height+(a?s:0),t.drawImage(d,l,h,r.b,r.b)}setIsHovered(t){this.getIsVisible()&&(this.isHovered=t,this.model.updateChartEventsZIndexes(),this.trigger("change"))}toggleIsOpen(t){var e,i;const s=this.model.chart().chart_layout();if(!this.getIsVisible()){var n;if(s.activeChartEvent)null===(n=s.activeChartEvent)||void 0===n||n.instance.toggleIsOpen(!1),s.updateAttribute("activeChartEvent",void 0);return}this.model.updateChartEventsZIndexes(),this.trigger("change");const a=this.getChartEventModel(),r=(null===(e=s.activeChartEvent)||void 0===e?void 0:e.elementId)===(null==a?void 0:a.elementId),o=null!=t?t:!r||!(null!=a&&a.instance.isOpen);var l;(this.isOpen=o,null!==(i=s.activeChartEvent)&&void 0!==i&&i.instance.isOpen&&!r)&&(null===(l=s.activeChartEvent)||void 0===l||l.instance.toggleIsOpen(!1));(o||r)&&s.updateAttribute("activeChartEvent",!o&&r?void 0:a)}isInArea(t){if(!this.getIsVisible())return!1;const e=t.scaled,{x:i,y:s}=this.getXYPosition();return i<=e.x&&i+r.b>=e.x&&s<=e.y&&s+r.b>=e.y}getIsInChartView(t){if(!this.getIsVisible())return!1;const{x:e}=this.getXYPosition();return e+r.b>=-t.leftOffset&&e<=-t.leftOffset+t.width}}h(c,"type",n.o$.ChartEvent),h(c,"label","ChartEvent");const d=c;function u(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class m extends d{}u(m,"type",n.o$.Dividends),u(m,"label",n.fG[n.o$.Dividends]);const g=m;function f(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class p extends d{}f(p,"type",n.o$.Earnings),f(p,"label",n.fG[n.o$.Earnings]);const y=p;function v(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class b extends d{}v(b,"type",n.o$.EarningsNeg),v(b,"label",n.fG[n.o$.EarningsNeg]);const x=b;function C(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class w extends d{}C(w,"type",n.o$.EarningsPos),C(w,"label",n.fG[n.o$.EarningsPos]);const S=w;function M(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class P extends d{}M(P,"type",n.o$.Split),M(P,"label",n.fG[n.o$.Split]);const k=P,E=Object.freeze({[n.o$.ChartEvent]:d,[n.o$.Dividends]:g,[n.o$.Split]:k,[n.o$.EarningsPos]:S,[n.o$.EarningsNeg]:x,[n.o$.Earnings]:y});var T=i(3102),I=i(4049);const A={...i(6364).V,...I.Z,...s.v,...T.M,...E};function L(t){return A[t]}},8723:(t,e,i)=>{"use strict";i.d(e,{O$:()=>n,ZP:()=>l,wQ:()=>a});i(6539),i(9841);var s=i(2127);let n;!function(t){t[t.Thousand=0]="Thousand",t[t.Million=1]="Million",t[t.Billion=2]="Billion",t[t.Trillion=3]="Trillion"}(n||(n={}));const a={[n.Thousand]:1e3,[n.Million]:1e6,[n.Billion]:1e9,[n.Trillion]:1e12},r={[n.Thousand]:3,[n.Million]:6,[n.Billion]:9,[n.Trillion]:12},o={[n.Thousand]:"K",[n.Million]:"M",[n.Billion]:"B",[n.Trillion]:"T"},l={dotProduct:(t,e)=>t.x*e.x+t.y*e.y,crossProduct:(t,e)=>t.x*e.y-t.y*e.x,distance:(t,e)=>Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2)),lineEquation(t){if(t.x1===t.x2)return{a:1,b:0,c:-t.x1};const e=(t.y2-t.y1)/(t.x2-t.x1);return{a:-e,b:1,c:e*t.x1-t.y1,k:e}},pointInPolygon(t,e){let i=e.length-1,s=!1;for(let n=0;n<e.length;n++){const a=e[n];(a.y<t.y&&e[i].y>=t.y||e[i].y<t.y&&a.y>=t.y)&&(a.x<=t.x||e[i].x<=t.x)&&a.x+(t.y-a.y)/(e[i].y-a.y)*(e[i].x-a.x)<t.x&&(s=!s),i=n}return s},distanceToLine(t,e){const{a:i,b:s,c:n}=this.lineEquation(e);return Math.abs(i*t.x+s*t.y+n)/Math.sqrt(i*i+s*s)},distanceToSegment(t,e){const i=Math.pow(e.x1-e.x2,2)+Math.pow(e.y1-e.y2,2);if(0===i)return Math.sqrt(Math.pow(t.x-e.x1,2)+Math.pow(t.y-e.y1,2));const s=((t.x-e.x1)*(e.x2-e.x1)+(t.y-e.y1)*(e.y2-e.y1))/i;if(s<0)return Math.sqrt(Math.pow(t.x-e.x1,2)+Math.pow(t.y-e.y1,2));if(s>1)return Math.sqrt(Math.pow(t.x-e.x2,2)+Math.pow(t.y-e.y2,2));const n=e.x1+s*(e.x2-e.x1),a=e.y1+s*(e.y2-e.y1);return Math.sqrt(Math.pow(t.x-n,2)+Math.pow(t.y-a,2))},getInstrumentDecimalPlaces(t){let{value:e,instrument:i}=t;return i===s.Yx.Crypto&&e<=.001?8:i!==s.Yx.Stock&&e<=6||i===s.Yx.Stock&&e<1?4:2},formatBigNumber(t,e,i){const s=Math.abs(t),l=t=>{let{num:i,suffix:n,zeroes:a}=t;const r=i.toString();if(r.includes("e")){const t=r.split("e"),e=Number(t[1])-a;return Math.round(Number(t[0])).toString().padEnd(Math.max(0,e),"0")+n}const o=Math.sign(i),l=Math.pow(10,a),h=s/l*o;return(Number.isInteger(h)?h:h.toFixed(void 0!==e?e:1))+n};return s>=a[n.Trillion]||i===n.Trillion?l({num:t,suffix:o[n.Trillion],zeroes:r[n.Trillion]}):s>=a[n.Billion]||i===n.Billion?l({num:t,suffix:o[n.Billion],zeroes:r[n.Billion]}):s>=a[n.Million]||i===n.Million?l({num:t,suffix:o[n.Million],zeroes:r[n.Million]}):s>=a[n.Thousand]||i===n.Thousand?l({num:t,suffix:o[n.Thousand],zeroes:r[n.Thousand]}):void 0!==e?t.toFixed(e):t.toString()},round(t){let{value:e,lastClose:i=0,instrument:s,overridePlaces:r}=t;if(Math.abs(e)>=a[n.Million])return this.formatBigNumber(e,r);const o="number"==typeof r?r:this.getInstrumentDecimalPlaces({value:i,instrument:s});return o>=8&&e<1e-6?e.toFixed(o):Number("".concat(Math.round(Number("".concat(e,"e+").concat(o))),"e-").concat(o)).toFixed(o)},perpendicularPointToLine(t){let e,i,{line:s,distance:n}=t;if(0===n)return{x:s.x2,y:s.y2};s.x1<=s.x2&&s.y1>=s.y2?(i=-1,e=-1):s.x1<=s.x2&&s.y1<=s.y2?(i=1,e=-1):s.x1>=s.x2&&s.y1>=s.y2?(i=-1,e=1):(i=1,e=1);const a=Math.atan2(Math.abs(s.x2-s.x1),Math.abs(s.y2-s.y1));return{x:s.x2+i*(n*Math.cos(a)),y:s.y2+e*(n*Math.sin(a))}},rotatedPointCoordinates(t){let{rotationAxisPoint:e,angle:i,pointToRotate:s}=t;const n=Math.sin(i),a=Math.cos(i);return{x:a*(s.x-e.x)+n*(s.y-e.y)+e.x,y:a*(s.y-e.y)-n*(s.x-e.x)+e.y}},sharedPointLinesAngle(t){let{sharedPoint:e,oldLinePoint:i,newLinePoint:s}=t;const n=(i.y*(e.x-s.x)+e.y*(s.x-i.x)+s.y*(i.x-e.x))/((i.x-e.x)*(e.x-s.x)+(i.y-e.y)*(e.y-s.y));return Math.atan(n)},twoSegmentLinesIntersection(t,e,i,s){if(t.x===e.x&&t.y===e.y||i.x===s.x&&i.y===s.y)return!1;const n=(s.y-i.y)*(e.x-t.x)-(s.x-i.x)*(e.y-t.y);if(0===n)return!1;const a=((s.x-i.x)*(t.y-i.y)-(s.y-i.y)*(t.x-i.x))/n,r=((e.x-t.x)*(t.y-i.y)-(e.y-t.y)*(t.x-i.x))/n;if(a<0||a>1||r<0||r>1)return!1;return{x:t.x+a*(e.x-t.x),y:t.y+a*(e.y-t.y)}},checkLineIntersection(t,e,i,s){let n,a;const r={x:0,y:0,onLine1:!1,onLine2:!1},o=(s.y-i.y)*(e.x-t.x)-(s.x-i.x)*(e.y-t.y);if(0===o)return!1;n=t.y-i.y,a=t.x-i.x;const l=(s.x-i.x)*n-(s.y-i.y)*a,h=(e.x-t.x)*n-(e.y-t.y)*a;return n=l/o,a=h/o,r.x=t.x+n*(e.x-t.x),r.y=t.y+n*(e.y-t.y),n>0&&n<1&&(r.onLine1=!0),a>0&&a<1&&(r.onLine2=!0),r},getRayToLineSegmentIntersection(t,e,i,s){const n=this.checkLineIntersection(t,e,i,s);return!(!n||n.onLine1||this.dotProduct(this.subtractPoints(t,n),this.subtractPoints(t,e))<=0)&&{...n,x:Math.round(n.x),y:Math.round(n.y)}},getMiddlePointOnLineSegment:(t,e)=>({x:(t.x-e.x)/2+e.x,y:(t.y-e.y)/2+e.y}),normalizeVector(t){const e=Math.sqrt(t.x*t.x+t.y*t.y);return{x:t.x/e,y:t.y/e}},multiplyVectorByScalar:(t,e)=>({x:t.x*e,y:t.y*e}),addPoints:(t,e)=>({x:t.x+e.x,y:t.y+e.y}),subtractPoints:(t,e)=>({x:t.x-e.x,y:t.y-e.y})}},561:(t,e,i)=>{"use strict";i(8661),i(8322);var s=i(2340),n=i.n(s);const a={enabled:!1,collapsed:!0,duration:!1,timestamp:!0,logErrors:!0,withStackTrace:!1,level:"log",logger:console,filterChanges:(t,e)=>{const i=Object.keys(e);return"Mouse"===t.constructor.name||"Quote"===t.constructor.name||1===i.length&&("scale"===i[0]||"leftOffset"===i[0])},errorTransformer:t=>t,titleFormatter:(t,e,i,s)=>{let{timestamp:n,duration:a}=t;const r=["model"];return r.push("%c".concat(String(e))),n&&r.push("%c@ ".concat(i)),a&&r.push("%c(in ".concat(s.toFixed(2)," ms)")),r.join(" ")},colors:{title:()=>"inherit",prevState:()=>"#9E9E9E",action:()=>"#03A9F4",nextState:()=>"#4CAF50",error:()=>"#F20404"}},r=function(t){return e="0",i=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:2)-t.toString().length,new Array(i+1).join(e)+t;var e,i},o=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{logger:i,logErrors:s,titleFormatter:n,collapsed:o,timestamp:l,duration:h,withStackTrace:c,colors:d,level:u}={...a,...e},{startedTime:m,title:g,prevState:f,data:p,error:y,nextState:v,took:b}=t,x="".concat(r((C=m).getHours()),":").concat(r(C.getMinutes()),":").concat(r(C.getSeconds()),".").concat(r(C.getMilliseconds(),3));var C;const w=d.title?"color: ".concat(d.title(g),";"):"",S=["color: gray; font-weight: lighter;"];S.push(w),l&&S.push("color: gray; font-weight: lighter;"),h&&S.push("color: gray; font-weight: lighter;");const M=n(a,g,x,b);try{o?d.title?i.groupCollapsed("%c ".concat(M),...S):i.groupCollapsed(M):d.title?i.group("%c ".concat(M),...S):i.group(M)}catch(t){i.log(M)}if(d.prevState){const t="color: ".concat(d.prevState(f),"; font-weight: bold");i[u]("%c prev state",t,f)}else i[u]("prev state",f);if(d.action){const t="color: ".concat(d.action(p),"; font-weight: bold");i[u]("%c arguments ",t,p)}else i[u]("arguments ",p);if(y&&s)if(d.error){const t="color: ".concat(d.error(y,f),"; font-weight: bold;");i.error("%c error     ",t,y)}else i.error("error     ",y);if(d.nextState){const t="color: ".concat(d.nextState(v),"; font-weight: bold");i[u]("%c next state",t,v)}else i[u]("next state",v);c&&(i.groupCollapsed("TRACE"),i.trace(),i.groupEnd());try{i.groupEnd()}catch(t){i.log("—— log end ——")}},l=()=>{window.logger=a;const t=n().Model.prototype.load;n().Model.prototype.load=function(e){if(a.enabled&&!a.filterChanges(this,e)){const i=Date.now(),s={title:"".concat(this.constructor.name,"[#").concat(this.id||this.cid,"]"),started:i,startedTime:new Date(i),prevState:this.attributes(),data:e};let n;try{n=t.apply(this,arguments)}catch(t){s.error=t}return s.nextState=this.attributes(),s.took=Date.now()-s.started,o(s),n}return t.apply(this,arguments)}};var h=i(3168),c=i(6269);class d extends c.Z{constructor(){var t,e,i;super(...arguments),i=0,(e="yIndex")in(t=this)?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i}static initClass(t){this.configure("ChartEventElement","instance","lastChange","zIndex","yIndex","elementId"),this.belongsTo("pane",t)}toObject(){return{...super.toObject(),yIndex:this.yIndex}}toConfig(){return{...super.toConfig(),yIndex:this.yIndex}}}const u=d;var m=i(9966),g=i(3428);class f extends n().Model{static initClass(t){this.configure("Indicator","instance"),this.belongsTo("chart",t)}}const p=f;class y extends n().Model{static initClass(t){this.configure("Overlay","overlay"),this.belongsTo("chart",t)}}const v=y;var b=i(9528),x=i(7256);h.Z.initClass(b.Z,x.Z,m.Z),m.Z.initClass(h.Z,g.Z),g.Z.initClass(),c.Z.initClass(b.Z),u.initClass(b.Z),p.initClass(h.Z),v.initClass(h.Z),b.Z.initClass(c.Z,u,h.Z),"localhost"===document.location.hostname&&l()},4049:(t,e,i)=>{"use strict";i.d(e,{Z:()=>Vt});var s=i(3888),n=(i(8322),i(9431)),a=i(1185),r=(i(6539),i(2340)),o=i.n(r),l=i(1045),h=i.n(l),c=i(2127),d=i(3104),u=i(2740),m=i(5327),g=i.n(m),f=i(9007),p=i(8723),y=i(2120),v=i(5622);var b=i(5495),x=i(5200);function C(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class w extends o().Module{static initClass(){Object.defineProperty(this.prototype,"height",{get(){return this.model.height}}),Object.defineProperty(this.prototype,"contentHeight",{get(){const{IndicatorSettings:t}=this.getChartLayoutSettings();return this.height-t.top.height-t.bottom.height}})}static fromObject(t,e){const i=new this(t,e);return i.set(t),i}static getNumOfBarsBuffer(t){let{period:e}=t;const[i=0]=(0,x.G8)(e);return i}constructor(t,e){super(t,e),C(this,"attrs",void 0),C(this,"model",void 0),C(this,"labelWidth",0),C(this,"fetchedAt",-1),C(this,"leftOffset",0),C(this,"width",0),C(this,"contentWidth",0),C(this,"lastValue",null),C(this,"shouldUpdate",!0),C(this,"tickers",null),C(this,"period",void 0),C(this,"fx",(t=>this.model.scale.x(this.data.barIndex[t]))),C(this,"fy",(t=>this.model.scale.y(t))),C(this,"getDomainDefaults",(t=>(t=>{switch(t){case s.A.Atr:return{min:0,max:10};case s.A.Adx:case s.A.Aro:case s.A.Mfi:case s.A.Perf:case s.A.Rmi:case s.A.Rsi:case s.A.Stofu:case s.A.Ult:return{min:0,max:100};case s.A.Macd:case s.A.Rwi:case s.A.Trix:return{min:-1,max:1};case s.A.Wr:return{min:-100,max:0};case s.A.Aroosc:case s.A.Roc:return{min:-100,max:100};case s.A.Cci:case s.A.Fi:return{min:-200,max:200};default:return{min:0,max:100}}})(t))),this.attrs=t,this.model=e,this.data=this.model.chart().quote(),this.renderYAxis=this.renderYAxis.bind(this),this.renderCrossText=this.renderCrossText.bind(this),this.model.chart().bind("update",this.trigger.bind(this,"change")),this.model.bind("update change",this.trigger.bind(this,"change"));const i=this.trigger.bind(this,"change","cross");this.model.bind("destroy",(()=>{y.Z.unbind("change",i)})),y.Z.bind("change",i),this.model.chart().chart_layout().bind("theme",this.setupCache.bind(this))}get type(){return this.constructor.type}get label(){return this.constructor.label}render(t){const{IndicatorSettings:e}=this.getChartLayoutSettings();this.data=this.model.chart().quote(),this.leftOffset=this.model.chart().leftOffset,this.width=this.model.chart().width,this.contentWidth=this.width-e.left.width-e.right.width,this.compute(),this.setupCache(),this.renderYAxis(t),t.save(),this.clip(t),this.renderXAxis(t);const i=(0,f.R6)({context:t,xOffset:this.leftOffset+e.left.width,yOffset:e.top.height});i.do(),this.renderIndicator(t),i.undo(),t.restore(),this.getIsChartPageSpecificFunctionality()||this.renderLabel(t)}isComputeNecessary(){return!(this.fetchedAt===this.data.fetchedAt&&!this.shouldUpdate)&&(this.fetchedAt=this.data.fetchedAt,this.shouldUpdate=!1,!0)}renderYAxis(t){const{IndicatorSettings:e,ChartSettings:i}=this.getChartLayoutSettings(),{Colors:n}=i.general;let a;const r=(0,f.R6)({context:t,xOffset:e.left.width,yOffset:e.top.height});r.do();const o=this.model.scale.y.ticks(10),l=Math.abs(o[2]-o[0]),h=new d.Z({x1:0,x2:this.contentWidth,strokeStyle:n.grid,dashLength:3},this.model),c=new u.Z({x:this.contentWidth+s.ew.M+e.right.axis.margin.left,font:u.Z.getMergedPropsWithDefaults("font",e.right.axis.font),fillStyle:n.text,textBaseline:s.EQ.middle},this.model);for(let e=0;e<o.length;e++){const i=o[e];a=Math.round(this.fy(i)),h.set({y1:a,y2:a}).render(t),e%2==0&&c.set({text:this.formatAxis(i,l),y:a}).render(t)}const m=this.contentHeight,g=null===this.lastValue?0:Math.round(this.fy(this.lastValue));var y,v,b,x,C,w,S,M,P,k,E,T;null!=this.lastValue&&g>=0&&g<=m&&new u.Z({text:p.ZP.formatBigNumber(this.lastValue,2),x:this.contentWidth+s.ew.M-s.tr.XXS+e.right.axis.margin.left,y:g,font:u.Z.getMergedPropsWithDefaults("font",e.right.axis.font),lineHeight:e.right.axis.font.lineHeight,padding:{top:null!==(y=null===(v=e.right.axis.font)||void 0===v||null===(b=v.padding)||void 0===b?void 0:b.top)&&void 0!==y?y:s.tr.XXS,right:null!==(x=null===(C=e.right.axis.font)||void 0===C||null===(w=C.padding)||void 0===w?void 0:w.right)&&void 0!==x?x:s.tr.XXS,bottom:null!==(S=null===(M=e.right.axis.font)||void 0===M||null===(P=M.padding)||void 0===P?void 0:P.bottom)&&void 0!==S?S:s.tr.XXS,left:null!==(k=null===(E=e.right.axis.font)||void 0===E||null===(T=E.padding)||void 0===T?void 0:T.left)&&void 0!==k?k:s.tr.XXS},textBaseline:s.EQ.middle,fillStyle:n.indicatorCurrentText,background:n.indicatorCurrentBackground},this.model).render(t);r.undo()}renderXAxis(t){const{IndicatorSettings:e,ChartSettings:i}=this.getChartLayoutSettings(),{Colors:s}=i.general,n=new d.Z({x1:0,x2:0,y1:0,y2:this.contentHeight,strokeStyle:s.grid,dashLength:3},this.model),a=(0,f.R6)({context:t,xOffset:e.left.width,yOffset:e.top.height});a.do();for(let e=0,i=this.data.date.length;e<i;e+=10){const i=Math.round(this.fx(e)+this.leftOffset);i<-15||i>this.width+15||n.set({x1:i,x2:i}).render(t)}a.undo()}renderLabel(t){this.getIsChartPageSpecificFunctionality()?this.renderLabelChartsPage(t):this.renderLabelQuotePage(t)}renderLabelQuotePage(t){const{IndicatorSettings:e,ChartSettings:i}=this.getChartLayoutSettings(),{Colors:n}=i.general,a=new u.Z({text:this.toString(),x:e.left.indicatorLabel.margin.left,y:e.left.indicatorLabel.margin.top,font:u.Z.getMergedPropsWithDefaults("font",e.left.indicatorLabel.font),fillStyle:n.text,textAlign:s.PH.left,textBaseline:s.EQ.top},this.model);return this.labelWidth=a.measure(t),a.render(t)}renderLabelChartsPage(t){const{IndicatorSettings:e}=this.getChartLayoutSettings(),i=this.model.chart().chart_layout().theme===c.Q2.dark,n=e.left.indicatorLabel.margin.left,a=e.left.indicatorLabel.margin.top,r=new u.Z({text:this.toString(),x:2*n,font:u.Z.getMergedPropsWithDefaults("font",e.left.indicatorLabel.font),fillStyle:g().gray[i?50:900],textAlign:s.PH.left,textBaseline:s.EQ.middle},this.model);return this.labelWidth=r.measure(t)+2*e.left.indicatorLabel.margin.left,r.set({y:a+(s.et-r.attrs.lineHeight/2)}),function(t){let{ctx:e,x:i,y:s,width:n,height:a,radius:r,color:o}=t;e.translate(.5,.5),e.set("strokeStyle",o),e.set("fillStyle",o),e.beginPath(),e.moveTo(i,s+r),e.lineTo(i,s+a-r),e.arcTo(i,s+a,i+r,s+a,r),e.lineTo(i+n-r,s+a),e.arcTo(i+n,s+a,i+n,s+a-r,r),e.lineTo(i+n,s+r),e.arcTo(i+n,s,i+n-r,s,r),e.lineTo(i+r,s),e.arcTo(i,s,i,s+r,r),e.stroke(),e.fill(),e.translate(-.5,-.5)}({ctx:t,x:n,y:a,height:s.et,width:this.labelWidth,radius:6,color:"".concat(g().gray[i?700:50],"cc")}),r.render(t),{x:n,y:a,labelWidth:this.labelWidth}}renderCross(t){(0,b.rf)({context:t,mouseModel:y.Z,paneModel:this.model,quote:this.data,contentWidth:this.contentWidth,contentHeight:this.contentHeight,isIndicator:!0,isPerfIndicator:this.type===s.A.Perf,onRenderCrossText:this.getIsChartPageSpecificFunctionality()?void 0:this.renderCrossText}),this.getIsChartPageSpecificFunctionality()&&this.renderCrossText(t,y.Z.getCrossIndexForPane(this.model))}renderCrossText(t,e){this.data=this.model.chart().quote();const i=Number.isNaN(e)?this.data.close.length-1:e;this.getIsChartPageSpecificFunctionality()?(this.renderLabelChartsPage(t),this.renderCrossTextChartsPage(t,i)):this.renderCrossTextQuotePage(t,i)}renderCrossTextChartsPage(t,e){}renderCrossTextQuotePage(t,e){}renderOversoldOverbought(t,e,i,s,n,r,o){const{IndicatorSettings:l}=this.getChartLayoutSettings();if(0===this.data.close.length)return;null==o&&(o=!0),t.save();let h=Math.round(this.fy(s)-this.fy(this.model.scale.y.domain()[1]));(h<=0||(0,x.EJ)())&&(t.beginPath(),t.rect(-this.leftOffset,this.fy(this.model.scale.y.domain()[1])+1,this.contentWidth,h<0?h-1:-1)),t.clip(),t.set("fillStyle","#87ceef"),t.beginPath(),t.moveTo(this.fx(0),Math.round(this.fy(this.model.scale.y.domain()[0])));const c={quote:this.data,scale:this.model.scale,leftOffset:this.leftOffset,width:this.width,fromIndexOffset:i};(0,a.E9)({...c,drawBarCallback:(i,s)=>{t.lineTo(s,Math.round(this.fy(e[i])))}}),t.lineTo(this.fx(this.data.close.length-1),Math.round(this.fy(this.model.scale.y.domain()[0]))),t.fill(),t.restore(),o&&new d.Z({x1:-this.leftOffset,x2:-this.leftOffset+this.contentWidth,y1:Math.round(this.fy(s)),y2:Math.round(this.fy(s)),strokeStyle:"#69c1ea"},this.model).render(t),o&&this.renderZeroLine(t,n),t.save(),h=Math.round(this.fy(r)),(h>=0||(0,x.EJ)())&&(t.beginPath(),t.rect(-this.leftOffset,this.fy(this.model.scale.y.domain()[0]),this.contentWidth,h>0?h:1)),t.clip(),t.set("fillStyle","#dc9fe5"),t.beginPath(),t.moveTo(this.fx(0),Math.round(this.fy(this.model.scale.y.domain()[1]))),(0,a.E9)({...c,drawBarCallback:(i,s)=>{t.lineTo(s,Math.round(this.fy(e[i])))}}),t.lineTo(this.fx(this.data.close.length-1),Math.round(this.fy(this.model.scale.y.domain()[1])+1)),t.fill(),t.restore(),o&&new d.Z({x1:-this.leftOffset,x2:-this.leftOffset+this.contentWidth,y1:Math.round(this.fy(r)),y2:Math.round(this.fy(r)),strokeStyle:"#d386df"},this.model).render(t),t.set("strokeStyle",l.general.Colors.line),t.set("fillStyle","#dc9fe5"),t.translate(.5,.5),t.beginPath(),(0,a.E9)({...c,drawBarCallback:(i,s)=>{t.lineTo(Math.round(s),Math.round(this.fy(e[i])))}}),t.stroke(),t.translate(-.5,-.5)}renderZeroLine(t,e){new d.Z({x1:-this.leftOffset,x2:-this.leftOffset+this.contentWidth,y1:Math.round(this.fy(e)),y2:Math.round(this.fy(e)),strokeStyle:"#ff8787",dashLength:3},this.model).render(t)}setupCache(){}clip(t){const{IndicatorSettings:e}=this.getChartLayoutSettings();return t.beginPath(),t.rect(e.left.width,e.top.height,this.contentWidth,this.contentHeight+1),t.clip()}formatAxis(t,e){return void 0!==e&&10>e?t.toFixed(2):t.toString()}set(t){const{IndicatorSettings:e}=this.getChartLayoutSettings();this.shouldUpdate=!0;for(const e in t)"type"!==e&&(this[e]=t[e]);this.width=this.model.chart().width,this.contentWidth=this.width-e.left.width-e.right.width;const i=this.getModalConfig().inputs.map((t=>{let{value:e}=t;return e.toString()})).join(",");i&&(this.attrs={...this.attrs,period:i}),this.trigger("change")}parsePeriodInt(t){"string"==typeof t.period&&(this.period=Number.parseInt(t.period,10),this.trigger("change"))}setModel(t){return this.model=t}isInArea(t){const{IndicatorSettings:e}=this.getChartLayoutSettings(),i=e.left.indicatorLabel.margin.left,n=e.left.indicatorLabel.margin.top;let a=2*s.ew.M+this.labelWidth,r=2*s.ew.S+s.Kt.M;return this.getIsChartPageSpecificFunctionality()&&(a=this.labelWidth,r=s.et),i<t.cursorX&&t.cursorX<a+i&&n<t.cursorY&&t.cursorY<r+n}moveBy(){}thumbsAreInArea(){return!1}computeVisibleMinMax(){let t=Number.MAX_VALUE,e=-Number.MAX_VALUE;const{leftOffset:i}=this.model.chart();for(var s=arguments.length,n=new Array(s),a=0;a<s;a++)n[a]=arguments[a];for(const s of n)for(let n=0,a=s.length,r=a>=0;r?n<a:n>a;r?n++:n--){const a=this.fx(n);a+i<0||a+i>this.width||(t>s[n]&&(t=s[n]),e<s[n]&&(e=s[n]))}return t!==e?{min:t,max:e}:this.getDomainDefaults(this.type)}getModalConfig(){return{title:"",inputs:[],inputsErrorMessages:{}}}getMinMax(){return this.data=this.model.chart().quote(),this.compute(),{min:this.min,max:this.max}}toObject(){return h()({},this.attrs,{type:this.type,tickers:this.tickers})}toConfig(){return{type:this.type,period:this.getModalConfig().inputs.map((t=>t.value.toString())).join(",")}}getChartLayoutSettings(){return(0,v.getChartLayoutSettings)(this.model.chart().chart_layout())}renderIndicator(t){throw Error("Implement renderIndicator method")}getIsValid(t){throw Error("Implement")}getIsNumberInputValid(t){let{key:e,integerOnly:i=!0}=t;const s=this.getModalConfig().inputs.find((t=>{let{name:i}=t;return e===i}));return!!s&&(0,x.mh)(s)&&(!i||(0,x.aP)(s.value))}getIsChartPageSpecificFunctionality(){const{specificChartFunctionality:t}=this.model.chart().chart_layout(),e=t===s.oK.chartPage,i=(0,n.yG)()&&[s.oK.futuresPage,s.oK.forexPage,s.oK.cryptoPage].includes(t);return e||i}getIsDrawing(){return!1}getIsChartEvent(){return!1}compute(){throw Error("Implement compute method")}}C(w,"type",s.A.Indicator),C(w,"label","Indicator"),w.initClass();const S=w;function M(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class P extends S{constructor(){super(...arguments),M(this,"pdi",[]),M(this,"mdi",[]),M(this,"adx",[])}set(t){super.set(t),this.parsePeriodInt(t)}compute(){if(this.isComputeNecessary()){var t;let e,i,s,a,r;this.pdi=[],this.mdi=[],this.adx=[];let o=s=i=e=0;for(let t=this.period;t<this.data.close.length;t++){const l=this.data.high[t]-this.data.high[t-1],h=this.data.low[t-1]-this.data.low[t];let c=0;l>0&&l>h&&(c=l);let d=0;h>0&&h>l&&(d=h);const u=n.ZP.max([this.data.high[t]-this.data.low[t],Math.abs(this.data.high[t]-this.data.close[t-1]),Math.abs(this.data.low[t]-this.data.close[t-1])]);o=(o*(this.period-1)+u)/this.period,s=(s*(this.period-1)+c)/this.period,i=(i*(this.period-1)+d)/this.period,r=o>0?100*s/o:0,a=o>0?100*i/o:0;const m=Math.abs(r-a),g=r+a>0?100*m/(r+a):0;e=(e*(this.period-1)+g)/this.period,this.pdi[t]=r,this.mdi[t]=a,this.adx[t]=e}this.lastValue=null!==(t=this.adx.last())&&void 0!==t?t:null}const{min:e,max:i}=this.pdi.length>0||this.mdi.length>0||this.adx.length>0?this.computeVisibleMinMax(this.pdi,this.mdi,this.adx):this.getDomainDefaults(this.type);this.min=e,this.max=i}renderIndicator(t){if(0===this.data.close.length)return;t.translate(.5,.5),t.set("strokeStyle","#2eb12e"),t.beginPath();const e={quote:this.data,scale:this.model.scale,leftOffset:this.leftOffset,width:this.width,fromIndexOffset:this.period};(0,a.E9)({...e,drawBarCallback:(e,i)=>{t.lineTo(i,Math.round(this.fy(this.pdi[e])))}}),t.stroke(),t.set("strokeStyle","#d43737"),t.beginPath(),(0,a.E9)({...e,drawBarCallback:(e,i)=>{t.lineTo(i,Math.round(this.fy(this.mdi[e])))}}),t.stroke(),t.set("strokeStyle",this.getChartLayoutSettings().IndicatorSettings.general.Colors.line),t.beginPath(),(0,a.E9)({...e,drawBarCallback:(e,i)=>{t.lineTo(i,Math.round(this.fy(this.adx[e])))}}),t.stroke(),t.translate(-.5,-.5)}getModalConfig(){var t;const e={type:"number",label:"Period",name:"period",value:null!==(t=this.period)&&void 0!==t?t:14,required:!0,min:1,max:999999};return{title:this.label,inputs:[e],inputsErrorMessages:{period:"".concat(e.label," must be a whole number between ").concat(e.min," and ").concat(e.max)}}}getIsValid(t){return"period"===t&&this.getIsNumberInputValid({key:t})}toString(){return"ADX ".concat(this.period)}}M(P,"type",s.A.Adx),M(P,"label","ADX");const k=P;function E(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}const T="#00a000",I="#c80000";class A extends S{constructor(t,e){super(t,e),E(this,"aroonUp",[]),E(this,"aroonDown",[]),this.renderYAxis=this.renderYAxis.bind(this)}set(t){super.set(t),this.parsePeriodInt(t)}compute(){if(!this.isComputeNecessary())return;this.aroonUp=[],this.aroonDown=[];const t=this.period-1;for(let e=t;e<this.data.close.length;e++){const i=this.data.high.slice(e-t,e+1),s=Math.max(...i),n=this.period-(i.indexOf(s)+1);this.aroonUp[e]=(this.period-n)/this.period*100;const a=this.data.low.slice(e-t,e+1),r=Math.min(...a),o=this.period-(a.indexOf(r)+1);this.aroonDown[e]=(this.period-o)/this.period*100}const{min:e,max:i}=this.getDomainDefaults(this.type);this.min=e,this.max=i}renderIndicator(t){if(0===this.data.close.length)return;t.translate(.5,.5),t.set("strokeStyle",I),t.beginPath();const e={quote:this.data,scale:this.model.scale,leftOffset:this.leftOffset,width:this.width,fromIndexOffset:this.period};(0,a.E9)({...e,drawBarCallback:(e,i)=>{t.lineTo(i,Math.round(this.fy(this.aroonDown[e])))}}),t.stroke(),t.set("strokeStyle",T),t.beginPath(),(0,a.E9)({...e,drawBarCallback:(e,i)=>{t.lineTo(i,Math.round(this.fy(this.aroonUp[e])))}}),t.stroke(),t.translate(-.5,-.5)}renderYAxis(t){var e,i,n,a,r,o,l,h,c,d,m,g;super.renderYAxis(t);const{IndicatorSettings:p,ChartSettings:y}=this.getChartLayoutSettings(),{Colors:v}=y.general,b=(0,f.R6)({context:t,xOffset:p.left.width,yOffset:p.top.height});b.do();const x=new u.Z({x:this.contentWidth+s.ew.M-s.tr.XXS+p.right.axis.margin.left,font:u.Z.getMergedPropsWithDefaults("font",p.right.axis.font),lineHeight:p.right.axis.font.lineHeight,padding:{top:null!==(e=null===(i=p.right.axis.font)||void 0===i||null===(n=i.padding)||void 0===n?void 0:n.top)&&void 0!==e?e:s.tr.XXS,right:null!==(a=null===(r=p.right.axis.font)||void 0===r||null===(o=r.padding)||void 0===o?void 0:o.right)&&void 0!==a?a:s.tr.XXS,bottom:null!==(l=null===(h=p.right.axis.font)||void 0===h||null===(c=h.padding)||void 0===c?void 0:c.bottom)&&void 0!==l?l:s.tr.XXS,left:null!==(d=null===(m=p.right.axis.font)||void 0===m||null===(g=m.padding)||void 0===g?void 0:g.left)&&void 0!==d?d:s.tr.XXS},textBaseline:s.EQ.middle,fillStyle:v.indicatorCurrentText},this.model),C=[];this.aroonDown.length>0&&C.push({text:this.aroonDown.last().toFixed(2),y:Math.round(this.fy(this.aroonDown.last())),background:I}),this.aroonUp.length>0&&C.push({text:this.aroonUp.last().toFixed(2),y:Math.round(this.fy(this.aroonUp.last())),background:T});const w=this.height-p.bottom.height-p.top.height;C.forEach((e=>{e.y>=0&&e.y<=w&&x.set(e).render(t)})),b.undo()}getModalConfig(){var t;const e={type:"number",label:"Period",name:"period",value:null!==(t=this.period)&&void 0!==t?t:25,required:!0,min:1,max:999999};return{title:this.label,inputs:[e],inputsErrorMessages:{period:"".concat(e.label," must be a whole number between ").concat(e.min," and ").concat(e.max)}}}getIsValid(t){return"period"===t&&this.getIsNumberInputValid({key:t})}toString(){return"Aroon ".concat(this.period)}}E(A,"type",s.A.Aro),E(A,"label","Aroon");const L=A;function D(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class O extends S{constructor(){super(...arguments),D(this,"oscillator",[])}set(t){super.set(t),this.parsePeriodInt(t)}compute(){if(this.isComputeNecessary()){var t;this.oscillator=[];const e=this.period-1;for(let t=e;t<this.data.close.length;t++){const i=this.data.high.slice(t-e,t+1),s=Math.max(...i),n=this.period-i.indexOf(s),a=(this.period-n)/this.period*100,r=this.data.low.slice(t-e,t+1),o=Math.min(...r),l=this.period-r.indexOf(o),h=(this.period-l)/this.period*100;this.oscillator[t]=a-h}this.lastValue=null!==(t=this.oscillator.last())&&void 0!==t?t:null}const{min:e,max:i}=this.getDomainDefaults(this.type);this.min=e,this.max=i}renderIndicator(t){this.renderOversoldOverbought(t,this.oscillator,this.period,0,0,0,!1)}getModalConfig(){var t;const e={type:"number",label:"Period",name:"period",value:null!==(t=this.period)&&void 0!==t?t:25,required:!0,min:1,max:999999};return{title:this.label,inputs:[e],inputsErrorMessages:{period:"".concat(e.label," must be a whole number between ").concat(e.min," and ").concat(e.max)}}}getIsValid(t){return"period"===t&&this.getIsNumberInputValid({key:t})}toString(){return"Aroon Oscillator ".concat(this.period)}}D(O,"type",s.A.Aroosc),D(O,"label","Aroon Oscillator");const R=O;var F=i(4982);function B(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class N extends S{constructor(){super(...arguments),B(this,"atr",[])}set(t){super.set(t),this.parsePeriodInt(t)}compute(){if(this.isComputeNecessary()){var t;this.atr=[];const e=new F.Z(this.period);for(let t=0;t<this.data.close.length;t++)e.add(this.data.high[t],this.data.low[t],this.data.close[t-1]),this.atr[t]=e.value;this.lastValue=null!==(t=this.atr.last())&&void 0!==t?t:null}const{min:e,max:i}=this.atr.length>0?this.computeVisibleMinMax(this.atr):this.getDomainDefaults(this.type);this.min=e,this.max=i}renderIndicator(t){t.set("strokeStyle",this.getChartLayoutSettings().IndicatorSettings.general.Colors.line),t.translate(.5,.5),t.beginPath(),(0,a.E9)({quote:this.data,scale:this.model.scale,leftOffset:this.leftOffset,width:this.width,drawBarCallback:(e,i)=>{t.lineTo(i,Math.round(this.fy(this.atr[e])))}}),t.stroke(),t.translate(-.5,-.5)}getModalConfig(){var t;const e={type:"number",label:"Period",name:"period",value:null!==(t=this.period)&&void 0!==t?t:14,required:!0,min:1,max:999999};return{title:this.label,inputs:[e],inputsErrorMessages:{period:"".concat(e.label," must be a whole number between ").concat(e.min," and ").concat(e.max)}}}getIsValid(t){return"period"===t&&this.getIsNumberInputValid({key:t})}toString(){return"ATR ".concat(this.period)}}B(N,"type",s.A.Atr),B(N,"label","Average True Range");const Z=N;function z(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class X extends S{constructor(){super(...arguments),z(this,"cci",[])}set(t){super.set(t),this.parsePeriodInt(t)}compute(){if(this.isComputeNecessary()){var t;let e;const i=[];this.cci=[];let s=e=0;for(let t=0;t<this.data.close.length;t++){let n;const a=(this.data.close[t]+this.data.low[t]+this.data.high[t])/3;i[t]=a,s+=a,e++,e>this.period&&(s-=i[t-this.period],e--);const r=s/e;if(t<this.period-1)continue;let o=n=0;for(let e=t-this.period+1;e<=t;e++)o+=Math.abs(i[e]-r),n++;const l=o/n;this.cci[t]=0,l>0&&(this.cci[t]=(a-r)/(.015*l))}this.lastValue=null!==(t=this.cci.last())&&void 0!==t?t:null}const{min:e,max:i}=this.cci.length>0?this.computeVisibleMinMax(this.cci):this.getDomainDefaults(this.type);this.min=e,this.max=i}renderIndicator(t){this.renderOversoldOverbought(t,this.cci,this.period,-100,0,100)}getModalConfig(){var t;const e={type:"number",label:"Period",name:"period",value:null!==(t=this.period)&&void 0!==t?t:20,required:!0,min:1,max:999999};return{title:this.label,inputs:[e],inputsErrorMessages:{period:"".concat(e.label," must be a whole number between ").concat(e.min," and ").concat(e.max)}}}getIsValid(t){return"period"===t&&this.getIsNumberInputValid({key:t})}toString(){return"CCI ".concat(this.period)}}z(X,"type",s.A.Cci),z(X,"label","Commodity Channel Index");const H=X;i(9841),i(5422);function W(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class U extends S{static getNumOfBarsBuffer(){return 0}compute(){if(!this.isComputeNecessary()||!this.data.COTs)return;const t=Object.keys(this.data.COTs)[0];!this.attrs.code&&t&&(this.attrs.code=t);const e=this.data.COTs[this.attrs.code],[i,s]=n.ZP.minMax(e.commercialHedgers,e.largeTraders,e.smallTraders);this.max=Math.max(Math.abs(s),Math.abs(i)),this.min=-this.max}renderIndicator(t){if(this.data.COTs){t.translate(.5,.5);for(const e in this.colors){t.set("strokeStyle",this.colors[e]),t.beginPath();const i=this.data.COTs[this.attrs.code][e];(0,a.E9)({quote:this.data,scale:this.model.scale,leftOffset:this.leftOffset,width:this.width,drawBarCallback:(e,s)=>{t.lineTo(s,Math.round(this.fy(i[e])))}}),t.stroke()}t.translate(-.5,-.5)}}renderLabel(t){if(!this.data.COTs)return;const{ChartSettings:e}=this.getChartLayoutSettings(),{Colors:i}=e.general,n=new u.Z({text:this.toString(),x:8,y:16,font:{size:10,style:"bold"},fillStyle:i.text,textAlign:s.PH.left,textBaseline:s.EQ.bottom},this.model);n.render(t),new u.Z({text:this.data.COTs[this.attrs.code].units,x:38+n.measure(),y:16,font:{size:8},fillStyle:i.text,textAlign:s.PH.left,textBaseline:s.EQ.bottom},this.model).render(t),this.renderAdditionalLabels(t)}renderLabelChartsPage(t){const{x:e,y:i,labelWidth:n}=super.renderLabelChartsPage(t),{IndicatorSettings:a}=this.getChartLayoutSettings(),r=this.model.chart().chart_layout().theme===c.Q2.dark,o=n+2*e,l=a.left.indicatorLabel.font,h=new u.Z({text:this.data.COTs[this.attrs.code].units,x:o+e,font:u.Z.getMergedPropsWithDefaults("font",{...l,size:l.size?.7*l.size:void 0,style:"normal"}),fillStyle:g().gray[r?50:900],textAlign:s.PH.left,textBaseline:s.EQ.middle},this.model);h.set({y:i+(.7*s.et-.7*h.attrs.lineHeight/2)}),h.render(t),this.renderAdditionalLabels(t)}renderAdditionalLabels(t){const{ChartSettings:e,IndicatorSettings:i}=this.getChartLayoutSettings(),{Colors:n}=e.general;new u.Z({text:"COT",x:23,y:i.top.height+(i.bottom.height+this.contentHeight)/2,angle:-90,font:{size:10,weight:"900",family:"Lato, sans-serif"},fillStyle:n.textSecondary,textAlign:s.PH.center,textBaseline:s.EQ.alphabetic},this.model).render(t);const a=new u.Z({text:"Commercial Hedgers",x:i.left.width,y:i.top.height+this.contentHeight+i.bottom.height-1,font:{size:8,style:"bold"},fillStyle:this.colors.commercialHedgers,textAlign:s.PH.left,textBaseline:s.EQ.bottom},this.model);a.render(t);let r=a.get("x")+8+a.measure();a.set({text:"Large Traders",x:r,fillStyle:this.colors.largeTraders}),a.render(t),r+=8+a.measure(),a.set({text:"Small Traders",x:r,fillStyle:this.colors.smallTraders}),a.render(t)}formatAxis(t){return this.model.scale.y.tickFormat(4,"s")(t).replace(/G/,"B")}getModalConfig(){return{title:"COT",inputs:[],inputsErrorMessages:{}}}toString(){var t;return null!==(t=this.data)&&void 0!==t&&t.COTs?this.data.COTs[this.attrs.code].name:void 0}toConfig(){return{type:this.type,code:this.attrs.code}}}W(U,"type",s.A.Cot),W(U,"label","COT"),U.prototype.colors={commercialHedgers:"#10cc10",largeTraders:"#cc1010",smallTraders:"#1010cc"};const Y=U;var q=i(6477);function V(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class j extends S{constructor(){super(...arguments),V(this,"fi",[])}set(t){super.set(t),this.parsePeriodInt(t)}compute(){if(this.isComputeNecessary()){var t;this.fi=[];const e=new q.Z(this.period);for(let t=1;t<this.data.close.length;t++)e.add((this.data.close[t]-this.data.close[t-1])*this.data.volume[t]/1e6),this.fi[t]=e.value;this.lastValue=null!==(t=this.fi.last())&&void 0!==t?t:null}const{min:e,max:i}=this.fi.length>0?this.computeVisibleMinMax(this.fi):this.getDomainDefaults(this.type);this.min=e,this.max=i}renderIndicator(t){this.renderOversoldOverbought(t,this.fi,1,0,0,0,!1)}getModalConfig(){var t;const e={type:"number",label:"Period",name:"period",value:null!==(t=this.period)&&void 0!==t?t:13,required:!0,min:1,max:999999};return{title:this.label,inputs:[e],inputsErrorMessages:{period:"".concat(e.label," must be a whole number between ").concat(e.min," and ").concat(e.max)}}}getIsValid(t){return"period"===t&&this.getIsNumberInputValid({key:t})}toString(){return"FORCE ".concat(this.period)}}V(j,"type",s.A.Fi),V(j,"label","Force Index");const _=j;function Q(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class K extends S{static getNumOfBarsBuffer(t){let{period:e}=t;const[i=0,s=0,n=0]=(0,x.G8)(e);return Math.max(i,s,n)}constructor(t,e){if(super(t,e),Q(this,"macd",[]),Q(this,"signal",[]),Q(this,"histogram",[]),"string"==typeof this.attrs.period){const[t=0,e=0,i=0]=(0,x.G8)(this.attrs.period);this.fastPeriod=t,this.slowPeriod=e,this.signalPeriod=i}}compute(){if(this.isComputeNecessary()){var t;this.macd=[],this.signal=[],this.histogram=[];const e=new q.Z(this.fastPeriod),i=new q.Z(this.slowPeriod),s=new q.Z(this.signalPeriod);for(let t=0;t<this.data.close.length;t++){e.add(this.data.close[t]),i.add(this.data.close[t]);const n=e.value-i.value;s.add(n);const a=s.value;this.macd[t]=n,this.signal[t]=a,this.histogram[t]=n-a}this.lastValue=null!==(t=this.macd.last())&&void 0!==t?t:null}const{min:e,max:i}=this.macd.length>0||this.signal.length>0||this.histogram.length>0?this.computeVisibleMinMax(this.macd,this.signal,this.histogram):this.getDomainDefaults(this.type);this.min=e,this.max=i}renderIndicator(t){const{IndicatorSettings:e,ChartSettings:i}=this.getChartLayoutSettings();if(0===this.data.close.length)return;const s=Math.round(this.fy(0)),n=i.center.barWidth+2*i.center.border,r={quote:this.data,scale:this.model.scale,leftOffset:this.leftOffset,width:this.width};t.set("fillStyle","#79c3e8"),t.beginPath(),(0,a.E9)({...r,drawBarCallback:(e,a)=>{t.rect(a-~~(i.center.barWidth/2),s,n,Math.round(this.fy(this.histogram[e])-s))}}),t.fill(),t.translate(.5,.5),t.set("strokeStyle",e.general.Colors.line),t.beginPath(),(0,a.E9)({...r,drawBarCallback:(e,i)=>{t.lineTo(i,Math.round(this.fy(this.macd[e])))}}),t.stroke(),t.set("strokeStyle",e.general.Colors.signalLine),t.beginPath(),(0,a.E9)({...r,drawBarCallback:(e,i)=>{t.lineTo(i,Math.round(this.fy(this.signal[e])))}}),t.stroke(),t.translate(-.5,-.5)}getModalConfig(){var t,e,i;const s={type:"number",label:"Period",name:"fastPeriod",value:null!==(t=this.fastPeriod)&&void 0!==t?t:12,required:!0,min:1,max:999999},n={type:"number",label:"Slow",name:"slowPeriod",value:null!==(e=this.slowPeriod)&&void 0!==e?e:26,required:!0,min:1,max:999999},a={type:"number",label:"Signal",name:"signalPeriod",value:null!==(i=this.signalPeriod)&&void 0!==i?i:9,required:!0,min:1,max:999999};return{title:this.label,inputs:[s,n,a],inputsErrorMessages:{fastPeriod:"".concat(s.label," must be a whole number between ").concat(s.min," and ").concat(s.max),slowPeriod:"".concat(n.label," must be a whole number between ").concat(n.min," and ").concat(n.max),signalPeriod:"".concat(a.label," must be a whole number between ").concat(a.min," and ").concat(a.max)}}}getIsValid(t){switch(t){case"fastPeriod":case"slowPeriod":case"signalPeriod":return this.getIsNumberInputValid({key:t});default:return!1}}toString(){return"MACD ".concat(this.fastPeriod,",").concat(this.slowPeriod,",").concat(this.signalPeriod)}}Q(K,"type",s.A.Macd),Q(K,"label","MACD");const G=K;function J(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class $ extends S{constructor(){super(...arguments),J(this,"mfi",[])}set(t){super.set(t),this.parsePeriodInt(t)}compute(){var t;if(!this.isComputeNecessary())return;let e;const i=[];this.mfi=[];let s=(this.data.close[0]+this.data.low[0]+this.data.high[0])/3,n=e=0;for(let t=1;t<this.data.close.length;t++){const a=(this.data.close[t]+this.data.low[t]+this.data.high[t])/3,r=a*this.data.volume[t];if(a>s?(n+=r,i[t]=r):a<s&&(e+=r,i[t]=-r),t>this.period){const s=i[t-this.period];s>0?n-=s:s<0&&(e+=s),this.mfi[t]=n+e>0?100*n/(n+e):50}s=a}this.lastValue=null!==(t=this.mfi.last())&&void 0!==t?t:null;const{min:a,max:r}=this.getDomainDefaults(this.type);this.min=a,this.max=r}renderIndicator(t){this.renderOversoldOverbought(t,this.mfi,this.period,20,50,80)}getModalConfig(){var t;const e={type:"number",label:"Period",name:"period",value:null!==(t=this.period)&&void 0!==t?t:14,required:!0,min:1,max:999999};return{title:this.label,inputs:[e],inputsErrorMessages:{period:"".concat(e.label," must be a whole number between ").concat(e.min," and ").concat(e.max)}}}getIsValid(t){return"period"===t&&this.getIsNumberInputValid({key:t})}toString(){return"MFI ".concat(this.period)}}J($,"type",s.A.Mfi),J($,"label","Money Flow Index");const tt=$;function et(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class it extends S{compute(){}renderIndicator(){}toString(){return""}}et(it,"type",s.A.None),et(it,"label","None");const st=it;function nt(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class at extends S{constructor(){super(...arguments),nt(this,"obv",[])}compute(){if(this.isComputeNecessary()){var t;this.obv=[0];for(let t=1;t<this.data.volume.length;t++){let e=this.obv[t-1];this.data.close[t]>this.data.close[t-1]?e+=this.data.volume[t]:this.data.close[t]<this.data.close[t-1]&&(e-=this.data.volume[t]),this.obv[t]=e}this.lastValue=null!==(t=this.obv.last())&&void 0!==t?t:null}const{min:e,max:i}=this.obv.length>0?this.computeVisibleMinMax(this.obv):this.getDomainDefaults(this.type);this.min=e,this.max=i}renderIndicator(t){t.set("strokeStyle",this.getChartLayoutSettings().IndicatorSettings.general.Colors.line),t.translate(.5,.5),t.beginPath(),(0,a.E9)({quote:this.data,scale:this.model.scale,leftOffset:this.leftOffset,width:this.width,drawBarCallback:(e,i)=>{t.lineTo(i,Math.round(this.fy(this.obv[e])))}}),t.stroke(),t.translate(-.5,-.5)}formatAxis(t){return p.ZP.formatBigNumber(t,2)}getModalConfig(){return{title:this.label,inputs:[],inputsErrorMessages:{}}}toString(){return"OBV"}}nt(at,"type",s.A.Obv),nt(at,"label","On-Balance Volume");const rt=at;i(7012);var ot=i(264),lt=i(7256),ht=i(5965);function ct(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class dt extends S{static getNumOfBarsBuffer(){return 0}constructor(t,e){super(t,e),ct(this,"timeframe",void 0),ct(this,"tickers",""),ct(this,"ready",!1),ct(this,"firstFetchCalled",!1),ct(this,"first",{}),ct(this,"perf",{}),ct(this,"quotes",{}),ct(this,"indicatorLabelWidth",{}),this.renderYAxis=this.renderYAxis.bind(this),this.timeframe=this.model.chart().timeframe,this.fy=ot.scaleLinear().range([0,this.contentHeight]),this.attrs.period&&!this.tickers&&(this.tickers=this.attrs.period)}async compute(){const t=this.getTickers(),e=this.model.chart().chart_layout(),i=e.uuid,s=this.getTickersAndTimeframe().every((t=>{let{ticker:s,instrument:n,timeframe:a}=t;return lt.Z.select((t=>t.ticker===s&&t.instrument===n&&t.timeframe===a&&e.isIdeaId(t.ideaID)&&i===t.chartUuid&&!t.isFetching)).length>0}));if(this.timeframe!==this.model.chart().quote().timeframe||!this.ready&&!this.firstFetchCalled)if(this.timeframe=this.model.chart().quote().timeframe,this.firstFetchCalled=!0,s)this.ready=!0,this.compute();else{const e=await lt.Z.getAll(this.getTickersAndTimeframe());e&&(this._compute(t,e),this.trigger("change"))}else if(this.ready){const s={};for(const n of t)s[n]=lt.Z.select((t=>t.ticker===n&&t.timeframe===this.timeframe&&i===t.chartUuid&&e.isIdeaId(t.ideaID)))[0];this._compute(t,s)}}_compute(t,e){var i,s,n,a;const{leftOffset:r}=this.model.chart();let o=null,l=null;for(let t=0;t<this.data.close.length;t++){const e=this.fx(t);e+r<0||e+r>this.contentWidth||(null===o&&(o=this.data.date[t]),l=this.data.date[t])}e[this.data.ticker]=this.data,this.quotes=e,this.perf={};const h=this.data.getDateToIndex();for(const i of[this.data.ticker,...t]){this.perf[i]=[];const t=e[i];if(!t)continue;let s=null,n=-1;for(let e=0;e<t.close.length;e++){const a=t.date[e];a<o||a>l||(n=h[a],null!=n&&(null===s&&(s=t.close[e],this.first[i]=s,n>0&&(this.perf[i][n-1]=100*t.close[e]/s-100)),this.perf[i][n]=100*t.close[e]/s-100))}n<this.data.date.length-1&&null!==s&&(this.perf[i][n+1]=this.perf[i][n])}const c=Object.keys(this.perf).map((t=>this.perf[t])),{min:d,max:u}=c.some((t=>t.length>0))?this.computeVisibleMinMax(...c):this.getDomainDefaults(this.type);this.min=d,this.max=u;const m=ot.scaleLinear().range([0,this.contentHeight]).domain([null!==(i=null===(s=this.model.scaleRange)||void 0===s?void 0:s.max)&&void 0!==i?i:this.max,null!==(n=null===(a=this.model.scaleRange)||void 0===a?void 0:a.min)&&void 0!==n?n:this.min]);this.model.scaleRange||m.nice(10),this.model.scale.y=this.fy=m,this.ready=!0}renderIndicator(t){if(!this.ready)return;const{ColorsSettings:e,IndicatorSettings:i}=this.getChartLayoutSettings();new d.Z({x1:-this.leftOffset,x2:-this.leftOffset+this.contentWidth,y1:Math.round(this.fy(0)),y2:Math.round(this.fy(0)),strokeStyle:"#ff8787",dashLength:3},this.model).render(t),t.translate(.5,.5);const s=this.getTickers();for(let i=0;i<s.length;i++){const n=s[i];if(this.perf[n].length>0){t.set("strokeStyle",e[i%e.length]),t.beginPath();for(let e=0;e<this.perf[n].length;e++){const i=Math.round(this.fy(this.perf[n][e]));t.lineTo(this.fx(e),i)}t.stroke()}}t.set("strokeStyle",i.general.Colors.line),t.beginPath();for(let e=0;e<this.perf[this.data.ticker].length;e++){const i=Math.round(this.fy(this.perf[this.data.ticker][e]));isNaN(i)||t.lineTo(this.fx(e),i)}t.stroke(),t.translate(-.5,-.5)}renderCrossTextQuotePage(t,e){if(!t||!e)return;const{ColorsSettings:i,ChartSettings:n,IndicatorSettings:a}=this.getChartLayoutSettings(),{Colors:r}=n.general;[this.data.ticker,...this.getTickers()].forEach(((n,o)=>{var l,h,c,d,m,g,f,p;const y=null===(l=this.quotes)||void 0===l||null===(h=l[this.data.ticker])||void 0===h?void 0:h.getDataByBarIndex("date",e),v=y?null===(c=this.quotes)||void 0===c||null===(d=c[n])||void 0===d||null===(m=d.getDateToIndex())||void 0===m?void 0:m[y]:null,b=v?100*(null===(g=this.quotes)||void 0===g||null===(f=g[n])||void 0===f||null===(p=f.close)||void 0===p?void 0:p[v])/this.first[n]-100:null;null===b||isNaN(b)||(t.fillStyle=r.canvasFill,t.fillRect(a.left.indicatorLabel.margin.left-s.tr.XXXS,(a.left.indicatorLabel.font.lineHeight+a.left.indicatorLabel.labelSpacing)*(o+1)+a.left.indicatorLabel.margin.top-s.tr.XXXS,s.tr.XXXS+this.indicatorLabelWidth[n]+s.tr.XXXS,s.tr.XXXS+a.left.indicatorLabel.font.size+s.tr.XXXS),new u.Z({text:"".concat(n," ").concat(b.toFixed(2),"%"),x:a.left.indicatorLabel.margin.left,y:(a.left.indicatorLabel.font.lineHeight+a.left.indicatorLabel.labelSpacing)*(o+1)+a.left.indicatorLabel.margin.top,font:u.Z.getMergedPropsWithDefaults("font",a.left.indicatorLabel.font),fillStyle:0===o?r.performanceIndicatorLabel:i[o-1%i.length],textAlign:s.PH.left,textBaseline:s.EQ.top},this.model).render(t))}))}renderCrossTextChartsPage(t,e){var i,n;if(!t||!e)return;const{ColorsSettings:a,ChartSettings:r,IndicatorSettings:o}=this.getChartLayoutSettings(),{Colors:l}=r.general;let h=!0;const c=o.left.indicatorLabel.margin.top+s.et,d=[this.data.ticker,...this.getTickers()],m=new u.Z({font:u.Z.getMergedPropsWithDefaults("font",{...o.left.indicatorLabel.font,style:"normal"}),textAlign:s.PH.left,textBaseline:s.EQ.middle,background:(0,ht.Qm)(l.canvasFill,.8),padding:{top:0,bottom:0,left:5,right:5}},this.model);let g=o.left.indicatorLabel.margin.left,f=o.left.indicatorLabel.margin.top+(2*s.et-m.attrs.lineHeight)/2;const p=m.attrs.lineHeight*d.length+c<=this.height;this.width<=s.QX||!p?(h=!1,g+=g+this.labelWidth):f+=o.left.indicatorLabel.margin.top+s.et;const y=null===(i=this.quotes)||void 0===i?void 0:i[this.data.ticker],v=Math.min(e,(null!==(n=null==y?void 0:y.close.length)&&void 0!==n?n:1/0)-1);d.forEach(((e,i)=>{var s,n,r,c,d,u;const p=null==y?void 0:y.getDataByBarIndex("date",v),b=p?null===(s=this.quotes)||void 0===s||null===(n=s[e])||void 0===n||null===(r=n.getDateToIndex())||void 0===r?void 0:r[p]:null,x=b?100*(null===(c=this.quotes)||void 0===c||null===(d=c[e])||void 0===d||null===(u=d.close)||void 0===u?void 0:u[b])/this.first[e]-100:null;if(null!==x&&!isNaN(x)){m.set({x:g,y:f,fillStyle:0===i?l.performanceIndicatorLabel:a[i-1%a.length],text:"".concat(e," ").concat(x.toFixed(2),"%")});const s=m.measure(t)+m.attrs.padding.left+m.attrs.padding.right;!h&&this.width-o.left.indicatorLabel.margin.left-o.right.width<=g+s&&(g=2*o.left.indicatorLabel.margin.left+this.labelWidth,f+=m.attrs.lineHeight,m.set({x:g,y:f})),m.render(t),h?f+=m.attrs.lineHeight:g+=s}}))}renderXAxis(t){if(this.ready)return super.renderXAxis(t)}renderYAxis(t){let e;super.renderYAxis(t);const{IndicatorSettings:i,ChartSettings:n,ColorsSettings:a}=this.getChartLayoutSettings(),{Colors:r}=n.general;if(!this.ready)return;if(0===this.perf[this.data.ticker].length)return;const o=(0,f.R6)({context:t,xOffset:i.left.width,yOffset:i.top.height});o.do();const{lineHeight:l,padding:h,size:c}=i.right.axis.font,d=new u.Z({x:this.contentWidth+s.ew.M-h.left+i.right.axis.margin.left,font:u.Z.getMergedPropsWithDefaults("font",{size:c}),lineHeight:l,padding:{left:h.left,right:h.right,top:h.top,bottom:h.bottom},textBaseline:s.EQ.middle,fillStyle:r.crossText},this.model),m=this.getTickers(),g=[];for(let t=0;t<m.length;t++)e=m[t],this.perf[e].length>0&&g.push({text:this.perf[e].last().toFixed(2)+"%",y:Math.round(this.fy(this.perf[e].last())),background:a[t%a.length]});g.push({text:this.perf[this.data.ticker].last().toFixed(2)+"%",y:Math.round(this.fy(this.perf[this.data.ticker].last())),background:r.performanceIndicatorLabel});const p=this.contentHeight;g.forEach((e=>{e.y>=0&&e.y<=p&&d.set(e).render(t)})),o.undo()}renderLabelQuotePage(t){super.renderLabelQuotePage(t);const{ColorsSettings:e,ChartSettings:i,IndicatorSettings:n}=this.getChartLayoutSettings(),{Colors:a}=i.general;if(this.ready){const i=this.getTickers(),r=[{[this.data.ticker]:this.perf[this.data.ticker][this.perf[this.data.ticker].length-1]},...i.map((t=>({[t]:this.perf[t][this.perf[t].length-1]})))].reduce(((t,e)=>({...t,...e})),{});Object.keys(r).forEach(((i,o)=>{if(r[i]){const l=new u.Z({text:"".concat(i," ").concat(r[i].toFixed(2),"%"),x:n.left.indicatorLabel.margin.left,y:(n.left.indicatorLabel.font.lineHeight+n.left.indicatorLabel.labelSpacing)*(o+1)+n.left.indicatorLabel.margin.top,font:u.Z.getMergedPropsWithDefaults("font",n.left.indicatorLabel.font),fillStyle:0===o?a.performanceIndicatorLabel:e[o-1%e.length],textAlign:s.PH.left,textBaseline:s.EQ.top},this.model);this.indicatorLabelWidth={...this.indicatorLabelWidth,[i]:l.measure(t)},l.render(t)}}))}}getTickers(){return this.tickers.split(",").map((t=>t)).filter((t=>t))}getTickersAndTimeframe(){const{timeframe:t}=this.model.chart().quote();return this.getTickers().map((e=>({ticker:e,instrument:(0,b.mQ)(e),timeframe:t})))}set(t){this.ready=!1,this.firstFetchCalled=!1,super.set({...t,tickers:t.period||(t.tickers?(0,n.Hp)(t.tickers,!0):"")}),this.tickers=(this.tickers||"").toUpperCase()}getModalConfig(){return{title:this.label,inputs:[{type:"text",label:"Tickers",name:"tickers",value:this.tickers?this.tickers:"SPY,QQQ",required:!0}],inputsErrorMessages:{tickers:"At least one ticker has to be provided"}}}getIsValid(t){return"tickers"===t&&this[t].length>0}toString(){return this.getIsChartPageSpecificFunctionality()?"PERF %":"PERF% ".concat(this.tickers)}}ct(dt,"type",s.A.Perf),ct(dt,"label","Price Performance %");const ut=dt;function mt(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class gt extends S{constructor(){super(...arguments),mt(this,"rmi",[])}set(t){if(super.set(t),"string"==typeof t.period&&void 0===this.momentum){const[e=0,i=0]=(0,x.G8)(t.period);this.period=e,this.momentum=i}return this.trigger("change")}compute(){var t;if(!this.isComputeNecessary())return;this.rmi=[];let e,i,s,n,a=0,r=0,o=0;for(let t=this.momentum;t<this.data.close.length;t++){e=i=0,this.data.close[t]>this.data.close[t-this.momentum]&&(e=this.data.close[t]-this.data.close[t-this.momentum]),this.data.close[t]<this.data.close[t-this.momentum]&&(i=this.data.close[t-this.momentum]-this.data.close[t]),a<this.period?(r+=e,o+=i,a++,n=r/a,s=o/a):(n=(n*(this.period-1)+e)/this.period,s=(s*(this.period-1)+i)/this.period);const l=s>0?n/s:1;this.rmi[t]=100-1/(1+l)*100}this.lastValue=null!==(t=this.rmi.last())&&void 0!==t?t:null;const{min:l,max:h}=this.getDomainDefaults(this.type);this.min=l,this.max=h}renderIndicator(t){this.renderOversoldOverbought(t,this.rmi,this.momentum,30,50,70)}getModalConfig(){var t,e;const i={type:"number",label:"Period",name:"period",value:null!==(t=this.period)&&void 0!==t?t:20,required:!0,min:1,max:999999},s={type:"number",label:"Momentum",name:"momentum",value:null!==(e=this.momentum)&&void 0!==e?e:5,required:!0,min:1,max:999999};return{title:this.label,inputs:[i,s],inputsErrorMessages:{period:"".concat(i.label," must be a whole number between ").concat(i.min," and ").concat(i.max),momentum:"".concat(s.label," must be a whole number between ").concat(s.min," and ").concat(s.max)}}}getIsValid(t){switch(t){case"period":case"momentum":return this.getIsNumberInputValid({key:t});default:return!1}}toString(){return"RMI ".concat(this.period,",").concat(this.momentum)}}mt(gt,"type",s.A.Rmi),mt(gt,"label","Relative Momentum Index");const ft=gt;function pt(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class yt extends S{constructor(){super(...arguments),pt(this,"roc",[])}set(t){super.set(t),this.parsePeriodInt(t)}compute(){if(this.isComputeNecessary()){var t;this.roc=[];for(let t=this.period;t<this.data.close.length;t++)this.roc[t]=(this.data.close[t]-this.data.close[t-this.period])/this.data.close[t-this.period]*100;this.lastValue=null!==(t=this.roc.last())&&void 0!==t?t:null}const{min:e,max:i}=this.roc.length>0?this.computeVisibleMinMax(this.roc):this.getDomainDefaults(this.type);this.min=e,this.max=i}renderIndicator(t){new d.Z({x1:-this.leftOffset,x2:-this.leftOffset+this.contentWidth,y1:Math.round(this.fy(0)),y2:Math.round(this.fy(0)),strokeStyle:"#ff8787",dashLength:3},this.model).render(t),t.set("strokeStyle",this.getChartLayoutSettings().IndicatorSettings.general.Colors.line),t.translate(.5,.5),t.beginPath(),(0,a.E9)({quote:this.data,scale:this.model.scale,leftOffset:this.leftOffset,width:this.width,drawBarCallback:(e,i)=>{t.lineTo(i,Math.round(this.fy(this.roc[e])))}}),t.stroke(),t.translate(-.5,-.5)}getModalConfig(){var t;const e={type:"number",label:"Period",name:"period",value:null!==(t=this.period)&&void 0!==t?t:12,required:!0,min:1,max:999999};return{title:this.label,inputs:[e],inputsErrorMessages:{period:"".concat(e.label," must be a whole number between ").concat(e.min," and ").concat(e.max)}}}getIsValid(t){return"period"===t&&this.getIsNumberInputValid({key:t})}toString(){return"ROC ".concat(this.period)}}pt(yt,"type",s.A.Roc),pt(yt,"label","Rate of Change %");const vt=yt;function bt(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class xt extends S{constructor(){super(...arguments),bt(this,"rsi",[])}set(t){super.set(t),this.parsePeriodInt(t)}compute(){var t;if(!this.isComputeNecessary())return;this.rsi=[];let e,i,s,n,a=0,r=0,o=0;for(let t=1;t<this.data.close.length;t++){e=i=0,this.data.close[t]>this.data.close[t-1]&&(e=this.data.close[t]-this.data.close[t-1]),this.data.close[t]<this.data.close[t-1]&&(i=this.data.close[t-1]-this.data.close[t]),a<this.period?(r+=e,o+=i,a++,n=r/a,s=o/a):(n=(n*(this.period-1)+e)/this.period,s=(s*(this.period-1)+i)/this.period);const l=s>0?n/s:1;this.rsi[t]=100-1/(1+l)*100}this.lastValue=null!==(t=this.rsi.last())&&void 0!==t?t:null;const{min:l,max:h}=this.getDomainDefaults(this.type);this.min=l,this.max=h}renderIndicator(t){this.renderOversoldOverbought(t,this.rsi,1,30,50,70)}getModalConfig(){var t;const e={type:"number",label:"Period",name:"period",value:null!==(t=this.period)&&void 0!==t?t:14,required:!0,min:1,max:999999};return{title:this.label,inputs:[e],inputsErrorMessages:{period:"".concat(e.label," must be a whole number between ").concat(e.min," and ").concat(e.max)}}}getIsValid(t){return"period"===t&&this.getIsNumberInputValid({key:t})}toString(){return"RSI ".concat(this.period)}}bt(xt,"type",s.A.Rsi),bt(xt,"label","Relative Strength Index");const Ct=xt;function wt(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class St extends S{constructor(t,e){super(t,e),wt(this,"tr",[]),wt(this,"atr",[]),wt(this,"rwiHi",[]),wt(this,"rwiLo",[]),this.renderYAxis=this.renderYAxis.bind(this)}set(t){super.set(t),this.parsePeriodInt(t)}compute(){if(this.isComputeNecessary()){this.tr=[],this.atr=[],this.rwiHi=[],this.rwiLo=[];let t=0;for(let e=0;e<this.data.close.length;e++){const i=n.ZP.max([this.data.high[e]-this.data.low[e],Math.abs(this.data.high[e]-this.data.close[e-1]),Math.abs(this.data.low[e]-this.data.close[e-1])]);this.tr[e]=i,e<this.period?(t+=i,this.atr[e]=t/(e+1),e===this.period-1&&(t/=this.period)):this.atr[e]=(this.atr[e-1]*(this.period-1)+i)/this.period}for(let t=this.period+2;t<this.data.close.length;t++){const e=this.data.high[t],i=this.data.low[t];let s=this.tr[t-1]+this.tr[t-2],n=2,a=s/n*Math.sqrt(n),r=a>0?(e-this.data.low[t-1])/a:-1,o=a>0?(this.data.high[t-1]-i)/a:-1;for(let l=t-1;l>t-this.period+1;l--){if(s+=this.tr[l-2],n++,a=s/n*Math.sqrt(n),0===a)continue;const t=(e-this.data.low[l-1])/a;t>r&&(r=t);const h=(this.data.high[l-1]-i)/a;h>o&&(o=h)}this.rwiHi[t]=r,this.rwiLo[t]=o}}const{min:t,max:e}=this.rwiHi.length>0||this.rwiLo.length>0?this.computeVisibleMinMax(this.rwiHi,this.rwiLo):this.getDomainDefaults(this.type);this.min=t,this.max=e}renderIndicator(t){if(0===this.data.close.length)return;const e={quote:this.data,scale:this.model.scale,leftOffset:this.leftOffset,width:this.width,fromIndexOffset:this.period};t.translate(.5,.5),t.set("strokeStyle","#c80000"),t.beginPath(),(0,a.E9)({...e,drawBarCallback:(e,i)=>{t.lineTo(i,Math.round(this.fy(this.rwiLo[e])))}}),t.stroke(),t.set("strokeStyle","#00a000"),t.beginPath(),(0,a.E9)({...e,drawBarCallback:(e,i)=>{t.lineTo(i,Math.round(this.fy(this.rwiHi[e])))}}),t.stroke(),t.translate(-.5,-.5)}renderYAxis(t){var e,i,n,a,r,o,l,h,c,d,m,g;super.renderYAxis(t);const{IndicatorSettings:p,ChartSettings:y}=this.getChartLayoutSettings(),{Colors:v}=y.general,b=(0,f.R6)({context:t,xOffset:p.left.width,yOffset:p.top.height});b.do();const x=new u.Z({x:this.contentWidth+s.ew.M-s.tr.XXS+p.right.axis.margin.left,font:u.Z.getMergedPropsWithDefaults("font",p.right.axis.font),lineHeight:p.right.axis.font.lineHeight,padding:{top:null!==(e=null===(i=p.right.axis.font)||void 0===i||null===(n=i.padding)||void 0===n?void 0:n.top)&&void 0!==e?e:s.tr.XXS,right:null!==(a=null===(r=p.right.axis.font)||void 0===r||null===(o=r.padding)||void 0===o?void 0:o.right)&&void 0!==a?a:s.tr.XXS,bottom:null!==(l=null===(h=p.right.axis.font)||void 0===h||null===(c=h.padding)||void 0===c?void 0:c.bottom)&&void 0!==l?l:s.tr.XXS,left:null!==(d=null===(m=p.right.axis.font)||void 0===m||null===(g=m.padding)||void 0===g?void 0:g.left)&&void 0!==d?d:s.tr.XXS},textBaseline:s.EQ.middle,fillStyle:v.indicatorCurrentText},this.model),C=[];this.rwiLo.length>0&&C.push({text:this.rwiLo.last().toFixed(2),y:Math.round(this.fy(this.rwiLo.last())),background:"#c80000"}),this.rwiHi.length>0&&C.push({text:this.rwiHi.last().toFixed(2),y:Math.round(this.fy(this.rwiHi.last())),background:"#00a000"});const w=this.height-p.bottom.height-p.top.height;C.forEach((e=>{e.y>=0&&e.y<=w&&x.set(e).render(t)})),b.undo()}getModalConfig(){var t;const e={type:"number",label:"Period",name:"period",value:null!==(t=this.period)&&void 0!==t?t:9,required:!0,min:1,max:999999};return{title:this.label,inputs:[e],inputsErrorMessages:{period:"".concat(e.label," must be a whole number between ").concat(e.min," and ").concat(e.max)}}}getIsValid(t){return"period"===t&&this.getIsNumberInputValid({key:t})}toString(){return"RWI ".concat(this.period)}}wt(St,"type",s.A.Rwi),wt(St,"label","Random Walk Index");const Mt=St;function Pt(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class kt extends S{constructor(){super(...arguments),Pt(this,"k",[]),Pt(this,"k1",[]),Pt(this,"d",[])}set(t){if(super.set(t),"string"==typeof t.period&&void 0===this.kPeriod){const[e=0,i=0,s=0]=(0,x.G8)(t.period);this.period=e,this.kPeriod=i,this.dPeriod=s}this.trigger("change")}compute(){var t;if(!this.isComputeNecessary())return;const e=Math.min(this.period,this.data.close.length-1);let i,s,n;this.k1=[],this.k=[],this.d=[];let a=s=0,r=i=0;for(let t=0;t<this.data.close.length;t++){let o=this.data.high[t],l=this.data.low[t];for(let i=t-e+1;i<=t;i++)this.data.high[i]>o&&(o=this.data.high[i]),this.data.low[i]<l&&(l=this.data.low[i]);n=(this.data.close[t]-l)/(o-l)*100,o===l&&(n=100),this.k1[t]=n,this.kPeriod>1&&(a+=n,r++,r>this.kPeriod&&(a-=this.k1[t-this.kPeriod],r--),n=a/r),s+=n,i++,i>this.dPeriod&&(s-=this.k[t-this.dPeriod],i--);const h=s/i;this.k[t]=n,this.d[t]=h}this.lastValue=null!==(t=this.k.last())&&void 0!==t?t:null;const{min:o,max:l}=this.getDomainDefaults(this.type);this.min=o,this.max=l}renderIndicator(t){if(0===this.data.close.length)return;new d.Z({x1:-this.leftOffset,x2:-this.leftOffset+this.contentWidth,y1:Math.round(this.fy(50)),y2:Math.round(this.fy(50)),strokeStyle:"#ff8787",dashLength:3},this.model).render(t),new d.Z({x1:-this.leftOffset,x2:-this.leftOffset+this.contentWidth,y1:Math.round(this.fy(20)),y2:Math.round(this.fy(20)),strokeStyle:"#69c1ea"},this.model).render(t),new d.Z({x1:-this.leftOffset,x2:-this.leftOffset+this.contentWidth,y1:Math.round(this.fy(80)),y2:Math.round(this.fy(80)),strokeStyle:"#d386df"},this.model).render(t),t.set("strokeStyle",this.getChartLayoutSettings().IndicatorSettings.general.Colors.line),t.translate(.5,.5),t.beginPath();const e={quote:this.data,scale:this.model.scale,leftOffset:this.leftOffset,width:this.width,fromIndexOffset:this.period};(0,a.E9)({...e,drawBarCallback:(e,i)=>{t.lineTo(i,Math.round(this.fy(this.k[e])))}}),t.stroke(),t.set("strokeStyle","#c80000"),t.beginPath(),(0,a.E9)({...e,drawBarCallback:(e,i)=>{t.lineTo(i,Math.round(this.fy(this.d[e])))}}),t.stroke(),t.translate(-.5,-.5)}getModalConfig(){var t,e,i;const s={type:"number",label:"Period",name:"period",value:null!==(t=this.period)&&void 0!==t?t:14,required:!0,min:1,max:999999},n={type:"number",label:"K Period",name:"kPeriod",value:null!==(e=this.kPeriod)&&void 0!==e?e:3,required:!0,min:1,max:999999},a={type:"number",label:"D Period",name:"dPeriod",value:null!==(i=this.dPeriod)&&void 0!==i?i:3,required:!0,min:1,max:999999};return{title:this.label,inputs:[s,n,a],inputsErrorMessages:{period:"".concat(s.label," must be a whole number between ").concat(s.min," and ").concat(s.max),dPeriod:"".concat(a.label," must be a whole number between ").concat(a.min," and ").concat(a.max),kPeriod:"".concat(n.label," must be a whole number between ").concat(n.min," and ").concat(n.max)}}}getIsValid(t){switch(t){case"period":case"dPeriod":case"kPeriod":return this.getIsNumberInputValid({key:t});default:return!1}}toString(){return"Stochastics FULL ".concat(this.period,",").concat(this.kPeriod,",").concat(this.dPeriod)}}Pt(kt,"type",s.A.Stofu),Pt(kt,"label","Stochastics FULL");const Et=kt;function Tt(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class It extends Et{constructor(t,e){super(t,e),this.kPeriod=1}set(t){if(super.set(t),"string"==typeof t.period&&void 0===this.dPeriod){this.kPeriod=1;const[e=0,i=0]=(0,x.G8)(t.period);this.period=e,this.dPeriod=i}this.trigger("change")}getModalConfig(){var t,e;const i={type:"number",label:"Period",name:"period",value:null!==(t=this.period)&&void 0!==t?t:14,required:!0,min:1,max:999999},s={type:"number",label:"D Period",name:"dPeriod",value:null!==(e=this.dPeriod)&&void 0!==e?e:3,required:!0,min:1,max:999999};return{title:this.label,inputs:[i,s],inputsErrorMessages:{period:"".concat(i.label," must be a whole number between ").concat(i.min," and ").concat(i.max),dPeriod:"".concat(s.label," must be a whole number between ").concat(s.min," and ").concat(s.max)}}}getIsValid(t){switch(t){case"period":case"dPeriod":return this.getIsNumberInputValid({key:t});default:return!1}}toString(){return"Stochastics FAST ".concat(this.period,",").concat(this.dPeriod)}}Tt(It,"type",s.A.Stofa),Tt(It,"label","Stochastics FAST");const At=It;function Lt(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class Dt extends Et{constructor(){super(...arguments),Lt(this,"kPeriod",3)}set(t){if(super.set(t),"string"==typeof t.period&&void 0===this.dPeriod){this.kPeriod=3;const[e=0,i=0]=(0,x.G8)(t.period);this.period=e,this.dPeriod=i}this.trigger("change")}getModalConfig(){var t,e;const i={type:"number",label:"Period",name:"period",value:null!==(t=this.period)&&void 0!==t?t:14,required:!0,min:1,max:999999},s={type:"number",label:"D Period",name:"dPeriod",value:null!==(e=this.dPeriod)&&void 0!==e?e:3,required:!0,min:1,max:999999};return{title:this.label,inputs:[i,s],inputsErrorMessages:{period:"".concat(i.label," must be a whole number between ").concat(i.min," and ").concat(i.max),dPeriod:"".concat(s.label," must be a whole number between ").concat(s.min," and ").concat(s.max)}}}getIsValid(t){switch(t){case"period":case"dPeriod":return this.getIsNumberInputValid({key:t});default:return!1}}toString(){return"Stochastics SLOW ".concat(this.period,",").concat(this.dPeriod)}}Lt(Dt,"type",s.A.Stosl),Lt(Dt,"label","Stochastics SLOW");const Ot=Dt;function Rt(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class Ft extends S{constructor(){super(...arguments),Rt(this,"trix",[])}set(t){super.set(t),this.parsePeriodInt(t)}compute(){if(this.isComputeNecessary()){var t;this.trix=[];const e=new q.Z(this.period),i=new q.Z(this.period),s=new q.Z(this.period);let n=0;for(let t=0;t<this.data.close.length;t++)e.add(this.data.close[t]),i.add(e.value),s.add(i.value),n>0&&(this.trix[t]=100*s.value/n-100),n=s.value;this.lastValue=null!==(t=this.trix.last())&&void 0!==t?t:null}const{min:e,max:i}=this.trix.length>0?this.computeVisibleMinMax(this.trix):this.getDomainDefaults(this.type);this.min=e,this.max=i}renderIndicator(t){new d.Z({x1:-this.leftOffset,x2:-this.leftOffset+this.contentWidth,y1:Math.round(this.fy(0)),y2:Math.round(this.fy(0)),strokeStyle:"#ff8787",dashLength:3},this.model).render(t),t.set("strokeStyle",this.getChartLayoutSettings().IndicatorSettings.general.Colors.line),t.translate(.5,.5),t.beginPath(),(0,a.E9)({quote:this.data,scale:this.model.scale,leftOffset:this.leftOffset,width:this.width,drawBarCallback:(e,i)=>{this.trix[e]&&t.lineTo(i,~~this.fy(this.trix[e]))}}),t.stroke(),t.translate(-.5,-.5)}getModalConfig(){var t;const e={type:"number",label:"Period",name:"period",value:null!==(t=this.period)&&void 0!==t?t:9,required:!0,min:1,max:999999};return{title:this.label,inputs:[e],inputsErrorMessages:{period:"".concat(e.label," must be a whole number between ").concat(e.min," and ").concat(e.max)}}}getIsValid(t){return"period"===t&&this.getIsNumberInputValid({key:t})}toString(){return"TRIX ".concat(this.period)}}Rt(Ft,"type",s.A.Trix),Rt(Ft,"label","TRIX");const Bt=Ft;function Nt(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class Zt extends S{constructor(){super(...arguments),Nt(this,"ult",[]),Nt(this,"tr",[]),Nt(this,"bp",[])}static getNumOfBarsBuffer(t){let{period:e}=t;const[i=0,s=0,n=0]=(0,x.G8)(e);return Math.max(i,s,n)}set(t){if(super.set(t),"string"==typeof t.period){const[e=0,i=0,s=0]=(0,x.G8)(t.period);this.period1=e,this.period2=i,this.period3=s}this.trigger("change")}compute(){var t;if(!this.isComputeNecessary())return;let e,i,s,n,a,r;this.ult=[];const o=[],l=[];let h,c,d=e=i=0,u=a=r=0,m=s=n=0;for(let t=1;t<this.data.close.length;t++){l[t]=this.data.close[t]-Math.min(this.data.low[t],this.data.close[t-1]),o[t]=Math.max(this.data.high[t],this.data.close[t-1])-Math.min(this.data.low[t],this.data.close[t-1]),d+=l[t],u+=o[t],m++,m>this.period1&&(d-=l[t-this.period1],u-=o[t-this.period1]),e+=l[t],a+=o[t],s++,s>this.period2&&(e-=l[t-this.period2],a-=o[t-this.period2]),i+=l[t],r+=o[t],n++,n>this.period3&&(i-=l[t-this.period3],r-=o[t-this.period3]);let g=h=c=0;u>0&&(g=d/u),a>0&&(h=e/a),r>0&&(c=i/r),this.ult[t]=100*(4*g+2*h+c)/7}this.lastValue=null!==(t=this.ult.last())&&void 0!==t?t:null;const{min:g,max:f}=this.getDomainDefaults(this.type);this.min=g,this.max=f}renderIndicator(t){this.renderOversoldOverbought(t,this.ult,1,30,50,70)}getModalConfig(){var t,e,i;const s={type:"number",label:"Period 1",name:"period1",value:null!==(t=this.period1)&&void 0!==t?t:7,required:!0,min:1,max:999999},n={type:"number",label:"Period 2",name:"period2",value:null!==(e=this.period2)&&void 0!==e?e:14,required:!0,min:1,max:999999},a={type:"number",label:"Period 3",name:"period3",value:null!==(i=this.period3)&&void 0!==i?i:28,required:!0,min:1,max:999999};return{title:this.label,inputs:[s,n,a],inputsErrorMessages:{period1:"".concat(s.label," must be a whole number between ").concat(s.min," and ").concat(s.max),period2:"".concat(n.label," must be a whole number between ").concat(n.min," and ").concat(n.max),period3:"".concat(a.label," must be a whole number between ").concat(a.min," and ").concat(a.max)}}}getIsValid(t){switch(t){case"period1":case"period2":case"period3":return this.getIsNumberInputValid({key:t});default:return!1}}toString(){return"ULT ".concat(this.period1,",").concat(this.period2,",").concat(this.period3)}}Nt(Zt,"type",s.A.Ult),Nt(Zt,"label","Ultimate Oscillator");const zt=Zt;function Xt(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class Ht extends S{compute(){var t;const{min:e,max:i}=this.data.volume.length>0?this.computeVisibleMinMax(this.data.volume):this.getDomainDefaults(this.type);this.min=e,this.max=i,this.lastValue=null!==(t=this.data.volume.last())&&void 0!==t?t:null}renderIndicator(t){const{ChartSettings:e}=this.getChartLayoutSettings(),{Colors:i}=e.general,s=this.model.chart(),{zoomFactor:n}=s,{barFillWidth:r,barBorderWidth:o}=(0,b.ee)({zoomFactor:n,chartLayout:s.chart_layout()}),l=r+2*o,h=~~Math.max(1,l/2);(0,a.E9)({quote:this.data,scale:this.model.scale,leftOffset:this.leftOffset,width:this.width,drawBarCallback:(e,s)=>{t.fillStyle=this.data.close[e]<this.data.open[e]?i.volumeTrendDown:i.volumeTrendUp;const n=Math.round(this.fy(this.data.volume[e]));t.fillRect(s-h,n,l,t.canvas.height-n)}})}formatAxis(t){return p.ZP.formatBigNumber(t,2)}getModalConfig(){return{title:this.label,inputs:[],inputsErrorMessages:{}}}toString(){return"Volume"}}Xt(Ht,"type",s.A.Vol),Xt(Ht,"label","Volume");const Wt=Ht;function Ut(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class Yt extends S{constructor(){super(...arguments),Ut(this,"r",[])}set(t){super.set(t),this.parsePeriodInt(t)}compute(){if(this.isComputeNecessary()){var t;this.r=[];for(let t=this.period;t<this.data.close.length;t++){let e=this.data.high[t],i=this.data.low[t];for(let s=t-this.period+1;s<=t;s++)this.data.high[s]>e&&(e=this.data.high[s]),this.data.low[s]<i&&(i=this.data.low[s]);this.r[t]=0,e-i>0&&(this.r[t]=(e-this.data.close[t])/(e-i)*-100)}this.lastValue=null!==(t=this.r.last())&&void 0!==t?t:null}const{min:e,max:i}=this.r.length>0?this.computeVisibleMinMax(this.r):this.getDomainDefaults(this.type);this.min=e,this.max=i}renderIndicator(t){this.renderOversoldOverbought(t,this.r,this.period,-80,-50,-20)}getModalConfig(){var t;const e={type:"number",label:"Period",name:"period",value:null!==(t=this.period)&&void 0!==t?t:14,required:!0,min:1,max:999999};return{title:this.label,inputs:[e],inputsErrorMessages:{period:"".concat(e.label," must be a whole number between ").concat(e.min," and ").concat(e.max)}}}getIsValid(t){return"period"===t&&this.getIsNumberInputValid({key:t})}toString(){return"W%R ".concat(this.period)}}Ut(Yt,"type",s.A.Wr),Ut(Yt,"label","Williams %R");const qt=Yt,Vt=Object.freeze({[s.A.Indicator]:S,[s.A.None]:st,[s.A.Adx]:k,[s.A.Aro]:L,[s.A.Aroosc]:R,[s.A.Atr]:Z,[s.A.Cci]:H,[s.A.Cot]:Y,[s.A.Fi]:_,[s.A.Macd]:G,[s.A.Mfi]:tt,[s.A.Obv]:rt,[s.A.Perf]:ut,[s.A.Rmi]:ft,[s.A.Roc]:vt,[s.A.Rsi]:Ct,[s.A.Rwi]:Mt,[s.A.Stofa]:At,[s.A.Stofu]:Et,[s.A.Stosl]:Ot,[s.A.Trix]:Bt,[s.A.Ult]:zt,[s.A.Vol]:Wt,[s.A.Wr]:qt});Object.freeze([s.A.Obv,s.A.Vol])},8661:(t,e,i)=>{"use strict";i.d(e,{h:()=>r});i(8322);var s=i(2340),n=i.n(s);Array.prototype.last=function(){return this[this.length-1]},String.prototype.padLeft=function(t){return String(t+this).slice(-t.length)},String.prototype.startsWith=function(t){return 0===this.indexOf(t)};const a=[];function r(t){if(!t)return null;const e=t.getContext("2d");var i;if(!e)return null===(i=window.Sentry)||void 0===i||i.captureMessage("Context unavailable"),null;e._cache={};const s=CanvasRenderingContext2D.prototype.restore;return e.restore=function(){return this._cache={},s.apply(this)},e.set=function(t,e){this._cache[t]!==e&&(this[t]=e,this._cache[t]=e)},e}n().Collection.prototype.bind=function(t,e){const i=this,s=function(t){if(t[i.fkey]===i.record.id){for(var s=arguments.length,n=new Array(s>1?s-1:0),a=1;a<s;a++)n[a-1]=arguments[a];return e(t,...n)}};return a.push({newCb:s,origCb:e}),this.model.bind(t,s),this},n().Collection.prototype.unbind=function(t,e){let i;for(const t of a)if(t.origCb===e){i=t.newCb;break}return this.model.unbind(t,i)},n().Model.findIndex=function(t){const e=this.all();for(let i=0;i<e.length;i++){const s=e[i];if(t.eql(s))return i}}},4613:(t,e,i)=>{"use strict";i.d(e,{l:()=>m});i(7012);var s=i(2340),n=i.n(s),a=i(560),r=i(2127),o=i(4750),l=i(5200);const h=(t,e)=>{if("function"==typeof t){const i=t.call(e);if(i&&!(t=>[n().Model,n().Module,n().Collection].some((e=>t instanceof e)))(i))throw Error("Watched prop should have a primitive value or a spine object");return"function"==typeof(null==i?void 0:i.all)?i.all():i}if("object"==typeof t){const e=!!t&&"toObject"in t;return JSON.stringify(e?t.toObject():t,(0,l.c)())}return t},c=(t,e)=>null==e?void 0:e.reduce(((e,i)=>({...e,[i]:h(null==t?void 0:t[i],t)})),{}),d=(t,e)=>t instanceof n().Model?t.eql(e):t===e,u=Object.values(r.dG);function m(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{watchProperties:i=[],listenOnEvents:s=u}=e,n=JSON.stringify(e),{forceUpdate:r}=(0,o.N)(),l=a.useRef(c(t,i));return a.useEffect((()=>{const e=()=>{i.some((e=>{var i;const s=h(null==t?void 0:t[e],t),n=null===(i=l.current)||void 0===i?void 0:i[e];return Array.isArray(s)?!Array.isArray(n)||s.length!==n.length||s.some(((t,e)=>!d(t,n[e]))):!d(s,n)}))&&(l.current=c(t,i),r())},n=s.join(" ");return null==t||t.bind(n,e),r(),()=>{null==t||t.unbind(n,e)}}),[null==t?void 0:t.cid,n,r]),t}},3168:(t,e,i)=>{"use strict";i.d(e,{Z:()=>g});i(8322),i(6539),i(90);var s=i(2340),n=i.n(s),a=i(7005),r=i.n(a),o=i(2127),l=i(3888),h=i(5169),c=i(5622),d=i(9431),u=i(4088);class m extends n().Model{static initClass(t,e,i){this.configure("Chart","width","height","timeframe","dateRange","scale","leftOffset","ticker","instrument","fx","fy","zoomFactor","refreshData","stretch","isHideDrawingsActive","isScrolled","firstBarClose","premarket","aftermarket","hasChartEvents"),this.hasMany("panes",t),this.belongsTo("quote",e),this.belongsTo("chart_layout",i)}getChartPane(){return this.panes().all().find((t=>t.elements().all().some((t=>t.isChart()))))}getChartElement(){for(const t of this.panes().all())for(const e of t.elements().all())if(e.isChart())return e}getChartType(){var t;return null===(t=this.getChartElement())||void 0===t?void 0:t.instance.type}getRefreshInterval(){let t=null;"number"==typeof this.refreshData?t=this.refreshData:!0===this.refreshData&&(t=l.M$.Default);const e=this.instrument===o.Yx.Stock,i=window.FinvizSettings.hasUserPremium;let s=l.M$.Elite;return i?e&&!d.ZP.isStockFastRefreshAvailable()&&(s=l.M$.EliteStocksReduced):s=l.M$.Free,t&&Math.max(t,s)}toObject(){const t=this.panes().all().map((t=>t.toObject()));return{width:this.width,dateRange:this.dateRange,height:this.height,timeframe:this.timeframe,scale:this.scale,leftOffset:this.leftOffset,ticker:this.ticker,instrument:this.instrument,zoomFactor:this.zoomFactor,refreshData:this.refreshData,stretch:this.stretch,chartId:this.cid,panes:t,isHideDrawingsActive:this.isHideDrawingsActive,isScrolled:this.isScrolled,premarket:this.premarket,aftermarket:this.aftermarket,hasChartEvents:this.hasChartEvents}}toConfig(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];const e=this.panes().all().map((e=>e.toConfig(t)));return r()({width:this.width,height:this.height,timeframe:this.timeframe,scale:this.scale,leftOffset:this.leftOffset,ticker:this.ticker,instrument:this.instrument,zoomFactor:this.zoomFactor,refreshData:this.refreshData,stretch:this.stretch,chartId:this.cid,panes:e,isHideDrawingsActive:this.isHideDrawingsActive,isScrolled:this.isScrolled,premarket:this.premarket,aftermarket:this.aftermarket,hasChartEvents:this.hasChartEvents},t)}destroyCascade(t){return this.panes().all().forEach((t=>{t.destroyCascade()})),this.destroy(t)}getChartLayoutSettings(){return(0,c.getChartLayoutSettings)(this.chart_layout())}getIsDisabled(){var t;return 0===(null===(t=this.quote())||void 0===t?void 0:t.close.length)}getIsScrollable(){return this.chart_layout().scrollable}getAllPanes(){return this.panes().all()}getAllValidPanes(){var t;const e=Object.keys(null!==(t=this.quote().COTs)&&void 0!==t?t:{});return this.getAllPanes().filter((t=>{const i=t.mainElement();return(null==i?void 0:i.instance.type)!==l.A.Cot||e.includes(i.instance.attrs.code)}))}getAllElements(){return this.getAllPanes().flatMap((t=>t.getAllElements()))}getAllQuotes(){return[...this.getAllElements().filter((t=>{let{instance:e}=t;return e.type===l.A.Perf})).flatMap((t=>{let{instance:e}=t;return Object.values(e.quotes)})),this.quote()].filter((t=>t))}createPaneCascade(t){var e,i;const s=this.panes().create(t);null===(e=t.elements)||void 0===e||e.forEach((t=>{let{zIndex:e,elementId:i,...n}=t;const a=(0,h.u)(n.type).fromObject(n,s);s.elements().create({instance:a,zIndex:e,elementId:i}),s.chart().trigger(o.wq.IndicatorsChange)}));const n=s.getChartOrIndicatorElement();return(null===(i=s.mainElement())||void 0===i?void 0:i.elementId)!==(null==n?void 0:n.elementId)&&s.updateAttributes({mainElement:n}),s}updateAttributesAndSync(t){const e=Object.entries(u.PU).filter((t=>{let[e]=t;return this.getIsChartPartInSync(e)})).flatMap((t=>{let[e,i]=t;return i}));this.updateAttributes(t),e.length>0&&this.chart_layout().getAllCharts().forEach((i=>{if(this.eql(i))return;const s={};e.forEach((e=>{t.hasOwnProperty(e)&&(s[e]=t[e])})),i.updateAttributes(s)}))}setSyncChartParts(t,e){this.chart_layout().setSyncChartParts(t,e)}getIsChartPartInSync(t){return this.chart_layout().getIsChartPartInSync(t)}getHasPatterns(){return this.getAllElements().some((t=>{var e,i;return"hasOverlay"in t.instance&&(null===(e=(i=t.instance).hasOverlay)||void 0===e?void 0:e.call(i,"patterns"))}))}getQuoteRawTicker(){var t,e;return null!==(t=null===(e=this.quote())||void 0===e?void 0:e.getRawTicker())&&void 0!==t?t:null}setChartEvents(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const i=this.getChartPane();if(!i)return;const s=i.chartEvents().all();e&&s.forEach((t=>t.destroyCascade()));const n=e?t:null==t?void 0:t.filter((t=>!s.some((e=>{let{elementId:i}=e;return t.elementId===i}))));null==n||n.forEach((t=>{let{elementId:e,eventType:s,dateTimestamp:n}=t;i.chartEvents().create({instance:(0,h.u)(s).fromObject({positionTimestamps:{x:n}},i),elementId:e}).instance.updateScales()})),i.updateChartEventsZIndexes()}}const g=m},4088:(t,e,i)=>{"use strict";let s;i.d(e,{PU:()=>n,lL:()=>a,pr:()=>s}),function(t){t.Crosshair="crosshair",t.Ticker="ticker",t.Timeframe="timeframe"}(s||(s={}));const n={[s.Ticker]:["ticker"],[s.Timeframe]:["timeframe","dateRange"]},a=[{value:s.Ticker,label:"Ticker"},{value:s.Timeframe,label:"Timeframe"},{value:s.Crosshair,label:"Crosshair"}]},9966:(t,e,i)=>{"use strict";i.d(e,{Z:()=>h});i(8322),i(9841),i(90),i(6539);var s=i(2340),n=i.n(s),a=i(7005),r=i.n(a),o=i(1541);class l extends n().Model{static initClass(t,e){this.configure("ChartLayout","layout","activeChart","activePane","activeChartEvent","width","height","editable","canChangeTicker","scrollable","initialScrollable","cross","editors","theme","settings","isWheelZoomEnabled","specificChartFunctionality","isLargeChart","isHideDrawingsActive","isPreserveDrawingsActive","isLockDrawingsActive","isDrawingModeContinuousActive","uuid","isTouchCrossActive","defaultZoomFactor","syncChartParts","isInit","idea"),this.hasMany("charts",t),this.belongsTo("drawingsInternalStore",e)}getPaneWithSelection(){for(const t of this.getAllPanes())if(t.selection)return t}toObject(){const t=this.getAllCharts().map((t=>t.toObject()));return{layout:this.layout,width:this.width,height:this.height,charts:t,isHideDrawingsActive:this.isHideDrawingsActive,isPreserveDrawingsActive:this.isPreserveDrawingsActive}}toConfig(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];const e=this.getAllCharts().map((e=>e.toConfig(t)));return JSON.parse(JSON.stringify(r()({...this.settings.ChartSettings.center,layout:this.layout,width:this.width,height:this.height,charts:e,isHideDrawingsActive:this.isHideDrawingsActive,isPreserveDrawingsActive:this.isPreserveDrawingsActive,colors:this.settings.ChartSettings.general.Colors,specificChartFunctionality:this.specificChartFunctionality,editors:this.editors,editable:this.editable,scrollable:this.scrollable,theme:this.theme,newCharts:/\bcharts\b/.test(window.location.pathname)},t)))}destroyCascade(t){return this.getAllCharts().forEach((t=>{t.destroyCascade()})),this.destroy(t)}getAllCharts(){return this.charts().all()}getAllPanes(){return this.getAllCharts().flatMap((t=>t.getAllPanes()))}getAllElements(){return this.getAllCharts().flatMap((t=>t.getAllElements()))}setSyncChartParts(t,e){var i,s;const n=Array.isArray(t)?t:[t],a=null!==(i=null===(s=this.syncChartParts)||void 0===s?void 0:s.filter((t=>!n.includes(t))))&&void 0!==i?i:[];e&&a.push(...n),this.updateAttributes({syncChartParts:a})}getIsChartPartInSync(t){var e;return!(null===(e=this.syncChartParts)||void 0===e||!e.includes(t))}getIsIndicatorPresent(t){var e;return!(null===(e=this.charts().first())||void 0===e||!e.getAllElements().some((e=>e.isIndicator()&&e.instance.type===t)))}getHTMLElementId(){return"chart-layout-".concat(this.id)}exitIdea(){this.updateAttribute("idea",void 0),this.getAllCharts().forEach((t=>{t.getAllQuotes().forEach((t=>{t.ideaID&&(t.updateAttributes({ideaID:void 0}),t.fetchData({fetchType:o.p.Refetch}))})),t.updateAttributes({refreshData:!0})}))}isIdeaId(){var t,e;let i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return(null!==(t=null===(e=this.idea)||void 0===e?void 0:e.id)&&void 0!==t?t:null)===i}}const h=l},1758:(t,e,i)=>{"use strict";i.d(e,{U:()=>s});const s={S:8,M:10,XXL:16,XXXL:24}},18:(t,e,i)=>{"use strict";i.d(e,{gh:()=>b,xF:()=>C});i(9841),i(5422),i(7012);var s=i(2127),n=i(221),a=i(3888),r=i(1758),o=i(5978);const l={barWidth:2,barMargin:0,border:1},h={barWidth:3,barMargin:1,border:1},c={barWidth:2,barMargin:0,border:0},d=7,u=8,m=16,g={barWidth:2,barMargin:0,border:1},f=7,p=8,y=16;let v;!function(t){t.INTERACTIVE="INTERACTIVE",t.BE_SMALL_CHART_WITHOUT_OVERLAYS="BE_SMALL_CHART_WITHOUT_OVERLAYS",t.BE_SMALL_CHART_WITH_OVERLAYS="BE_SMALL_CHART_WITH_OVERLAYS",t.BE_LARGE_CHART_WITHOUT_OVERLAYS="BE_LARGE_CHART_WITHOUT_OVERLAYS",t.BE_LARGE_CHART_WITH_OVERLAYS="BE_LARGE_CHART_WITH_OVERLAYS"}(v||(v={}));const b=t=>{let{chartFormat:e,theme:i}=t;switch(e){case v.BE_SMALL_CHART_WITHOUT_OVERLAYS:return(t=>({ChartSettings:{general:{Colors:{...n.XH,[s.Q2.light]:n.XH,[s.Q2.dark]:n.VE},settingsHeight:a.Gj},center:g,top:{height:15,baseline:a.EQ.top,ticker:{margin:{left:-26,top:0},font:{size:y,style:"bold"}},ohlc:{margin:{top:2,left:15,right:15},font:{size:f,textAlign:a.PH.left,baseline:a.EQ.top},type:o.l.dateOnly},change:{margin:{top:1,right:30},font:{size:p,style:"bold"}}},right:{width:34,axis:{margin:{left:-4},font:{size:f,lineHeight:f,padding:{top:a.tr.XXXS,bottom:a.tr.XS,left:a.tr.XXS,right:a.tr.XXS}}}},bottom:{height:15,baseline:a.EQ.top,axis:{margin:{top:2},font:{size:f}}},left:{width:30,overlayLabel:{labelSpacing:12,margin:{top:-4,left:4},font:{size:a.Kt.S,weight:"bold"}},timeframe:{margin:{top:0,left:20},font:{size:p,weight:"900",family:"Lato, sans-serif"}},volumeAxis:{margin:{left:25},font:{size:f}}}},IndicatorSettings:{general:{height:140,Colors:t===s.Q2.light?n.s:n.js},center:g,top:{height:8},right:{width:34,axis:{margin:{left:-4},font:{size:f,lineHeight:f,padding:{top:a.tr.XXXS,bottom:a.tr.XS,left:a.tr.XXS,right:a.tr.XXS}}}},bottom:{height:8},left:{width:30,indicatorLabel:{labelSpacing:1,margin:{top:a.ew.XXS,left:a.ew.M},font:{size:p,style:"bold",lineHeight:p}}}},MarketSentimentSettings:{general:{Colors:t===s.Q2.light?n.XH:n.VE},center:{barWidth:3,barMargin:1,border:1},top:{height:0},bottom:{height:12},left:{width:0},right:{width:30}},ColorsSettings:n.RG,ThumbSettings:{size:8,touchSize:16,color:"#ddd",borderWidth:1,borderColor:"#999"},ElementSettings:{Colors:t===s.Q2.light?n.TA:n.bY,defaultFill:"#1e6dc066",defaultTransparentFill:"#1e6dc000"}}))(i);case v.BE_SMALL_CHART_WITH_OVERLAYS:return(t=>({ChartSettings:{general:{Colors:{...n.XH,[s.Q2.light]:n.XH,[s.Q2.dark]:n.VE},settingsHeight:a.Gj},center:c,top:{height:15,baseline:a.EQ.top,ticker:{margin:{left:-26,top:0},font:{size:m,style:"bold"}},ohlc:{margin:{top:2,left:15,right:15},font:{size:d,textAlign:a.PH.left,baseline:a.EQ.top},type:o.l.dateOnly},change:{margin:{top:1,right:30},font:{size:u,style:"bold"}}},right:{width:34,axis:{margin:{left:-4},font:{size:d,lineHeight:d,padding:{top:a.tr.XXXS,bottom:a.tr.XS,left:a.tr.XXS,right:a.tr.XXS}}}},bottom:{height:15,baseline:a.EQ.top,axis:{margin:{top:2},font:{size:d}}},left:{width:30,overlayLabel:{labelSpacing:12,margin:{top:-4,left:4},font:{size:a.Kt.S,weight:"bold"}},timeframe:{margin:{top:0,left:20},font:{size:u,weight:"900",family:"Lato, sans-serif"}},volumeAxis:{margin:{left:25},font:{size:d}}}},IndicatorSettings:{general:{height:140,Colors:t===s.Q2.light?n.s:n.js},center:c,top:{height:8},right:{width:34,axis:{margin:{left:-4},font:{size:d,lineHeight:d,padding:{top:a.tr.XXXS,bottom:a.tr.XS,left:a.tr.XXS,right:a.tr.XXS}}}},bottom:{height:8},left:{width:30,indicatorLabel:{labelSpacing:1,margin:{top:a.ew.XXS,left:a.ew.M},font:{size:u,style:"bold",lineHeight:u}}}},MarketSentimentSettings:{general:{Colors:t===s.Q2.light?n.XH:n.VE},center:{barWidth:3,barMargin:1,border:1},top:{height:0},bottom:{height:12},left:{width:0},right:{width:30}},ColorsSettings:n.RG,ThumbSettings:{size:8,touchSize:16,color:"#ddd",borderWidth:1,borderColor:"#999"},ElementSettings:{Colors:t===s.Q2.light?n.TA:n.bY,defaultFill:"#1e6dc066",defaultTransparentFill:"#1e6dc000"}}))(i);case v.BE_LARGE_CHART_WITHOUT_OVERLAYS:return(t=>({ChartSettings:{general:{Colors:{...n.XH,[s.Q2.light]:n.XH,[s.Q2.dark]:n.VE},settingsHeight:a.Gj},center:h,top:{height:20,baseline:a.EQ.top,ticker:{margin:{left:-46,top:-4},font:{size:r.U.XXXL,style:"bold"}},ohlc:{margin:{top:2,left:15,right:15},font:{size:r.U.S,textAlign:a.PH.left,baseline:a.EQ.top},type:o.l.singleLine},change:{margin:{top:1,right:40},font:{size:r.U.M,style:"bold"}}},right:{width:50,axis:{margin:{left:0},font:{size:r.U.S,lineHeight:r.U.S,padding:{top:a.tr.XXXS,bottom:a.tr.XS,left:a.tr.XXS,right:a.tr.XXS}}}},bottom:{height:20,baseline:a.EQ.top,axis:{margin:{top:3},font:{size:r.U.S}}},left:{width:50,overlayLabel:{labelSpacing:12,margin:{top:6,left:4},font:{size:a.Kt.S,weight:"bold"}},timeframe:{margin:{top:0,left:35},font:{size:r.U.M,weight:"900",family:"Lato, sans-serif"}},volumeAxis:{margin:{left:40},font:{size:r.U.S}}}},IndicatorSettings:{general:{height:140,Colors:t===s.Q2.light?n.s:n.js},center:h,top:{height:20},right:{width:50,axis:{margin:{left:-2},font:{size:r.U.S,lineHeight:r.U.S,padding:{top:a.tr.XXXS,bottom:a.tr.XS,left:a.tr.XXS,right:a.tr.XXS}}}},bottom:{height:20},left:{width:50,indicatorLabel:{labelSpacing:1,margin:{top:a.ew.S,left:a.ew.M},font:{size:r.U.M,style:"bold",lineHeight:r.U.M}}}},MarketSentimentSettings:{general:{Colors:t===s.Q2.light?n.XH:n.VE},center:{barWidth:3,barMargin:1,border:1},top:{height:0},bottom:{height:12},left:{width:0},right:{width:30}},ColorsSettings:n.RG,ThumbSettings:{size:8,touchSize:16,color:"#ddd",borderWidth:1,borderColor:"#999"},ElementSettings:{Colors:t===s.Q2.light?n.TA:n.bY,defaultFill:"#1e6dc066",defaultTransparentFill:"#1e6dc000"}}))(i);case v.BE_LARGE_CHART_WITH_OVERLAYS:return(t=>({ChartSettings:{general:{Colors:{...n.XH,[s.Q2.light]:n.XH,[s.Q2.dark]:n.VE},settingsHeight:a.Gj},center:l,top:{height:20,baseline:a.EQ.top,ticker:{margin:{left:-46,top:-4},font:{size:r.U.XXXL,style:"bold"}},ohlc:{margin:{top:2,left:15,right:15},font:{size:r.U.S,textAlign:a.PH.left,baseline:a.EQ.top},type:o.l.singleLine},change:{margin:{top:1,right:40},font:{size:r.U.M,style:"bold"}}},right:{width:50,axis:{margin:{left:0},font:{size:r.U.S,lineHeight:r.U.S,padding:{top:a.tr.XXXS,bottom:a.tr.XS,left:a.tr.XXS,right:a.tr.XXS}}}},bottom:{height:20,baseline:a.EQ.top,axis:{margin:{top:3},font:{size:r.U.S}}},left:{width:50,overlayLabel:{labelSpacing:12,margin:{top:6,left:4},font:{size:a.Kt.S,weight:"bold"}},timeframe:{margin:{top:0,left:35},font:{size:r.U.M,weight:"900",family:"Lato, sans-serif"}},volumeAxis:{margin:{left:40},font:{size:r.U.S}}}},IndicatorSettings:{general:{height:140,Colors:t===s.Q2.light?n.s:n.js},center:l,top:{height:20},right:{width:50,axis:{margin:{left:-2},font:{size:r.U.S,lineHeight:r.U.S,padding:{top:a.tr.XXXS,bottom:a.tr.XS,left:a.tr.XXS,right:a.tr.XXS}}}},bottom:{height:20},left:{width:50,indicatorLabel:{labelSpacing:1,margin:{top:a.ew.S,left:a.ew.M},font:{size:r.U.M,style:"bold",lineHeight:r.U.M}}}},MarketSentimentSettings:{general:{Colors:t===s.Q2.light?n.XH:n.VE},center:{barWidth:3,barMargin:1,border:1},top:{height:0},bottom:{height:12},left:{width:0},right:{width:30}},ColorsSettings:n.RG,ThumbSettings:{size:8,touchSize:16,color:"#ddd",borderWidth:1,borderColor:"#999"},ElementSettings:{Colors:t===s.Q2.light?n.TA:n.bY,defaultFill:"#1e6dc066",defaultTransparentFill:"#1e6dc000"}}))(i);case v.INTERACTIVE:default:return(t=>({ChartSettings:{general:{Colors:{...t===s.Q2.light?n.XH:n.VE,[s.Q2.light]:n.XH,[s.Q2.dark]:n.VE},settingsHeight:a.Gj},center:{barWidth:3,barMargin:1,border:1},top:{height:a.oG.XL,baseline:a.EQ.alphabetic,ticker:{margin:{top:30,left:0},font:{size:a.Kt.XXXL,style:"bold"}},ohlc:{margin:{top:30,left:30,right:30},font:{size:a.Kt.S}},change:{margin:{top:30,right:0},font:{size:a.Kt.M,style:"bold"}}},right:{width:a.oG.XXL,axis:{margin:{left:0},font:{size:a.Kt.S,lineHeight:a.Ac.S,padding:{top:a.tr.XXS,bottom:a.tr.XXS,left:a.tr.XXS,right:a.tr.XXS}}}},bottom:{height:a.oG.M,baseline:a.EQ.top,axis:{margin:{top:8},font:{size:a.Kt.S}}},left:{width:a.oG.L,overlayLabel:{labelSpacing:12,margin:{top:-8,left:6},font:{size:a.Kt.S,weight:"bold"}},timeframe:{margin:{top:0,left:28},font:{size:a.Kt.M,weight:"900",family:"Lato, sans-serif"}},volumeAxis:{margin:{left:33},font:{size:a.Kt.S}}}},IndicatorSettings:{general:{height:140,Colors:t===s.Q2.light?n.s:n.js},center:{barWidth:3,barMargin:2,border:1},top:{height:a.oG.S},right:{width:a.oG.XXL,axis:{margin:{left:0},font:{size:a.Kt.S,lineHeight:a.Ac.S,padding:{top:a.tr.XXS,bottom:a.tr.XXS,left:a.tr.XXS,right:a.tr.XXS}}}},bottom:{height:a.oG.S},left:{width:a.oG.L,indicatorLabel:{labelSpacing:4,margin:{top:a.ew.S,left:a.ew.M},font:{size:a.Kt.M,style:"bold",lineHeight:a.Ac.M}}}},MarketSentimentSettings:{general:{Colors:t===s.Q2.light?n.XH:n.VE},center:{barWidth:3,barMargin:1,border:1},top:{height:0},bottom:{height:12},left:{width:0},right:{width:30}},ColorsSettings:n.RG,ThumbSettings:{size:8,touchSize:16,color:"#ddd",borderWidth:1,borderColor:"#999"},ElementSettings:{Colors:t===s.Q2.light?n.TA:n.bY,defaultFill:"#1e6dc066",defaultTransparentFill:"#1e6dc000"}}))(i)}};function x(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return 6===t.replace("#","").length?"".concat(t,"FF"):t}const C=t=>{let{theme:e,colors:i}=t;const a=i[e],r=Object.keys(a),o=e===s.Q2.light?n.XH:n.VE;return r.reduce(((t,e)=>x(a[e]).toLowerCase()!==x(o[e]).toLowerCase()?{...t,[e]:a[e]}:t),{})}},5978:(t,e,i)=>{"use strict";let s;i.d(e,{l:()=>s}),function(t){t.singleLine="singleLine",t.multiLine="multiLine",t.dateOnly="dateOnly",t.timeOnly="timeOnly"}(s||(s={}))},221:(t,e,i)=>{"use strict";i.d(e,{Cc:()=>g,FZ:()=>f,Qw:()=>l,RG:()=>m,TA:()=>d,VE:()=>o,XH:()=>r,bY:()=>u,js:()=>c,s:()=>h});var s=i(5327),n=i.n(s),a=i(5965);const r={aftermarketFade:"#FFFFFF99",background:"#008CFF0E",borderDown:"#000000FF",borderUp:"#000000FF",canvasFill:"#FFFFFFFF",cross:"#0000004C",crossText:"#fff",crossTextBackground:"#111",currentBackground:n().brightYellow[100],currentText:n().gray[800],grid:"#D2D2D2FF",gridSecondary:"#ECECEC",indicatorCurrentBackground:n().gray[600],indicatorCurrentText:"#fff",line:"#1E6DC0FF",marketDown:n().red[500],marketUp:n().green[500],negativeChange:"#C80000FF",ohlcTrendDown:"#E54040FF",ohlcTrendUp:"#40A140FF",overlayTransparentBackground:(0,a.Qm)("#C9CCD6",.25),percentageZeroLineText:"#111",performanceIndicatorLabel:"#646464",positiveChange:"#009600FF",premarketFade:"#FFFFFF99",prevClose:"#C80000FF",text:"#828282",textSecondary:"#dedede",trendDown:"#FF0000FF",trendUp:"#00FF00FF",volumeTrendDown:"#ffc0c0",volumeTrendUp:"#a8e0a8",wickDown:"#000000FF",wickUp:"#000000FF",zeroChange:"#000"},o={aftermarketFade:"#4C526133",background:"#1E6DC019",borderDown:"#F63538FF",borderUp:"#30CC5AFF",canvasFill:n().gray[800],cross:"#404553",crossText:"#fff",crossTextBackground:"#111",currentBackground:n().yellow[200],currentText:n().gray[700],grid:"#363A46FF",gridSecondary:"#2C303A",indicatorCurrentBackground:n().gray[500],indicatorCurrentText:"#fff",line:"#1E6DC0FF",marketDown:n().red[300],marketUp:n().green[300],negativeChange:n().red[400],ohlcTrendDown:"#E54040FF",ohlcTrendUp:"#40A140FF",overlayTransparentBackground:(0,a.Qm)("#0C0E13",.35),percentageZeroLineText:"#fff",performanceIndicatorLabel:"#646464",positiveChange:n().green[400],premarketFade:"#4C526133",prevClose:"#C80000FF",text:"#929cb3",textSecondary:"#929CB399",trendDown:"#F63538FF",trendUp:"#30CC5AFF",volumeTrendDown:"#F635387F",volumeTrendUp:"#30CC5A7F",wickDown:"#F63538FF",wickUp:"#30CC5AFF",zeroChange:"#929cb3"},l={borderUp:"#006400FF",wickUp:"#006400",borderDown:"#6E0000FF",wickDown:"#6E0000FF"},h={line:"#000000",signalLine:n().red[400]},c={line:"#D07933",signalLine:n().red[400]},d={line:"#000000",border:"#000000",textWithoutBackground:"#000000"},u={line:"#5faaf4",border:"#5192D1",textWithoutBackground:"#929cb3"},m=["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf"],g={trendUp:"#00b400",trendDown:"#b40000"};let f;!function(t){t[t.Off=0]="Off",t[t.Saved=1]="Saved",t[t.Unsaved=2]="Unsaved",t[t.Saving=3]="Saving"}(f||(f={}))},3428:(t,e,i)=>{"use strict";i.d(e,{Z:()=>c});var s=i(2340),n=i.n(s),a=i(5200),r=i(3926),o=i(221);function l(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class h extends n().Model{static initClass(){this.configure("DrawingsInternalState","elements","latestRemoteUpdateTimestamp","latestLocalUpdateTimestamp","autoSaveState","instanceUUID")}constructor(){var t,e,i,s,n;let h=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(h),l(this,"elements",void 0),l(this,"latestRemoteUpdateTimestamp",void 0),l(this,"latestLocalUpdateTimestamp",void 0),l(this,"instanceUUID",void 0),l(this,"autoSaveState",void 0),l(this,"setAutoSaveState",(t=>{this.autoSaveState!==t&&this.updateAttributes({autoSaveState:t})})),this.elements=null!==(t=h.elements)&&void 0!==t?t:[],this.instanceUUID=null!==(e=h.instanceUUID)&&void 0!==e?e:(0,a.pB)(),this.latestLocalUpdateTimestamp=null!==(i=h.latestLocalUpdateTimestamp)&&void 0!==i?i:(0,r.hY)(this.instanceUUID,0),this.latestRemoteUpdateTimestamp=null!==(s=h.latestRemoteUpdateTimestamp)&&void 0!==s?s:(0,r.hY)(this.instanceUUID,0),this.autoSaveState=null!==(n=h.autoSaveState)&&void 0!==n?n:o.FZ.Off}}const c=h},6269:(t,e,i)=>{"use strict";i.d(e,{Z:()=>u});i(8322);var s=i(2340),n=i.n(s),a=i(1045),r=i.n(a),o=i(7418),l=i(5200),h=i(8755);function c(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class d extends n().Model{static initClass(t){this.configure("Element","instance","lastChange","zIndex","elementId"),this.belongsTo("pane",t)}constructor(){var t,e;super(...arguments),c(this,"lastChange",null),c(this,"elementId",null),c(this,"zIndex",-1),c(this,"generateUuid",(0,l.EJ)()?void 0:l.pB);const i=arguments.length<=0?void 0:arguments[0];this.elementId=null!==(t=null==i?void 0:i.elementId)&&void 0!==t?t:null===(e=this.generateUuid)||void 0===e?void 0:e.call(this),this.one("create",(()=>{var t;this.updateAttributes({zIndex:null!==(t=null==i?void 0:i.zIndex)&&void 0!==t?t:this.pane().getElementZIndexRange().max+1})}))}replace(t){const e=this.instance;this.updateAttribute("instance",t),this.trigger("replace",this,e)}makeClone(){const{instance:t,pane_id:e}=this,{attrs:i}=t,{scale:s}=t.model,n=r()({pane_id:e},i),a=o.v[t.type].fromObject(n,t.model),{ThumbSettings:l}=this.pane().getChartLayoutSettings(),h=l.size+2*l.borderWidth;a.moveBy(s.x.invert(h),s.y.invert(h)-s.y.invert(0)),a.cachePointPositionTimestamp(),d.create({instance:a,pane_id:e}),this.trigger("makeClone",this,a)}moveToZIndex(t){const e=this.zIndex,i=t>e?1:-1;if(this.isChart()||this.isIndicator())return 0!==this.zIndex&&this.updateAttributes({zIndex:0}),void this.pane().getAllElements().filter((e=>(1===i?e.zIndex<=t:e.zIndex>=t)&&e.isDrawing())).forEach((t=>t.moveToZIndex(-1*i)));const s=0===t?i:t,{min:n,max:a}=this.pane().getElementZIndexRange();if(e===s||e===n&&-1===i||e===a&&1===i)return;const{elementsBelowZero:r,elementsAboveZero:o}=this.pane().getBelowAboveZeroElements();(0,h.Ut)({elementsArray:r,addElement:s<0?this:void 0,oldZIndex:e,newZIndex:s,isBelowZero:!0}),(0,h.Ut)({elementsArray:o,addElement:s>0?this:void 0,oldZIndex:e,newZIndex:s})}bringToFront(){this.moveToZIndex(this.pane().getElementZIndexRange().max+1)}sendToBack(){this.moveToZIndex(this.pane().getElementZIndexRange().min-1)}bringForward(){this.moveToZIndex(this.zIndex+1)}sendBackward(){this.moveToZIndex(this.zIndex-1)}isChart(){var t;return!(null===(t=this.instance)||void 0===t||!t.type.startsWith("charts/"))}isIndicator(){var t;return!(null===(t=this.instance)||void 0===t||!t.type.startsWith("indicators/"))}isOverlay(){var t;return!(null===(t=this.instance)||void 0===t||!t.type.startsWith("overlays/"))}isDrawing(){var t;return!(null===(t=this.instance)||void 0===t||!t.type.startsWith("canvas/"))}isChartEvent(){var t;return!(null===(t=this.instance)||void 0===t||!t.type.startsWith("chartEvent/"))}isMouseDown(){var t;return!(null===(t=this.instance)||void 0===t||!t.isMouseDown)}hasOngoingInteraction(){return this.isMouseDown()||this.instance.isEditInProgress}toObject(){return{...this.instance.toObject(),elementId:this.elementId,zIndex:this.zIndex}}toConfig(){return{...this.instance.toConfig(),elementId:this.elementId,zIndex:this.zIndex}}destroyCascade(t){return this.destroy(t)}refreshElementId(){var t;this.updateAttribute("elementId",null===(t=this.generateUuid)||void 0===t?void 0:t.call(this))}}const u=d},2120:(t,e,i)=>{"use strict";i.d(e,{Z:()=>b});i(8322);var s=i(2340),n=i.n(s),a=i(4088),r=i(9528),o=(i(6539),i(4104)),l=i(9292),h=i(4743),c=i(3213),d=i(3888),u=i(9431);const m={hours:9,minutes:30},g={hours:23,minutes:59};function f(t){let{sourceChart:e,targetChart:i,timestamp:s}=t,n=(0,u.X2)(s);const a=e.quote().premarket&&d.Mm.includes(e.timeframe),r=i.quote().premarket&&d.Mm.includes(i.timeframe);return[d.ih.d,d.ih.w,d.ih.m].includes(e.timeframe)&&(n=(0,c.Z)(n,m)),i.timeframe===d.ih.m?n=(0,c.Z)((0,l.Z)(n),g):i.timeframe===d.ih.w?n=(0,c.Z)((0,h.Z)(n,{weekStartsOn:1}),g):i.timeframe===d.ih.d&&"stock"!==i.quote().instrument&&(n=(0,o.Z)(n)),a&&!r&&"stock"===i.quote().instrument&&(n=function(t){const e=t.getHours(),i=t.getMinutes();return e<m.hours||e===m.hours&&i<m.minutes}(n)?(0,c.Z)(n,m):n),~~((0,u.Hn)(n,!1).getTime()/1e3)}function p(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class y extends n().Model{constructor(){super(...arguments),p(this,"getIsCrossSyncOn",(()=>{var t;return!(null===(t=this.pane())||void 0===t||!t.chart().getIsChartPartInSync(a.pr.Crosshair))})),p(this,"getIsMouseInChartOfPane",(t=>{var e;return!(null===(e=this.pane())||void 0===e||!e.chart().eql(t.chart()))})),p(this,"getShouldRenderCrossInPane",(t=>this.getIsCrossSyncOn()||this.getIsMouseInChartOfPane(t))),p(this,"getCrossIndexForPane",(t=>{if(this.position){if(this.getIsMouseInChartOfPane(t))return Math.round(this.position.x);const e=this.pane();if(this.getIsCrossSyncOn()&&e){const i=e.chart(),s=t.chart(),n=i.quote().getTimestampFomPositionX(Math.round(this.position.x)),a=s.quote().getPositionXFromTimestamp(f({sourceChart:i,targetChart:s,timestamp:n}));return Math.floor(a)}}return Number.NaN})),p(this,"getPriceForPane",(t=>{var e,i,s;const n=null!==(e=null===(i=this.position)||void 0===i?void 0:i.y)&&void 0!==e?e:null;if(null!==(s=this.pane())&&void 0!==s&&s.eql(t))return n;if(this.getIsCrossSyncOn()&&this.pane()){var a;return(null===(a=this.pane())||void 0===a?void 0:a.getIndexInChart())===t.getIndexInChart()?n:null}return null}))}static initClass(){this.configure("Mouse","position"),this.belongsTo("pane",r.Z)}}y.initClass();const v=y.create();v.save();const b=v},9528:(t,e,i)=>{"use strict";i.d(e,{Z:()=>g});i(8322),i(9841),i(5422);var s=i(2340),n=i.n(s),a=i(7005),r=i.n(a),o=i(2127),l=i(3888),h=i(5622),c=i(8755);function d(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}const u=[l.o$.Split,l.o$.Dividends,l.o$.EarningsPos,l.o$.EarningsNeg,l.o$.Earnings];class m extends n().Model{constructor(){super(...arguments),d(this,"selection",null),d(this,"scaleRange",null)}static initClass(t,e,i){this.configure("Pane","height","scale","scaleRange","instance","selection"),this.hasMany("elements",t),this.hasMany("chartEvents",e),this.belongsTo("mainElement",t),this.belongsTo("chart",i)}destroyCascade(t){return this.elements().all().forEach((t=>{t.destroyCascade()})),this.destroy(t)}toObject(){const t=this.elements().all().map((t=>t.toObject()));return{height:this.height,scale:this.scale,scaleRange:this.scaleRange,elements:t}}toConfig(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];const e=this.elements().all().map((t=>t.toConfig()));return r()({height:this.height,scaleRange:this.scaleRange,elements:e},t)}move(t){const e=this.chart().getAllPanes(),i=e.find((t=>!t.getIsIndicatorPane())),s=e.find((t=>this.eql(t)));if(!i||!s)return;const n=m.records.filter((t=>t.chart_id===s.chart_id)),a=m.records.filter((t=>t.chart_id!==s.chart_id)),r=n.findIndex((t=>t.id===s.id)),l=n.filter(((t,e)=>e!==r)),h=l.findIndex((t=>t.id===i.id)),c=l.slice(0,h),d=l.slice(h+1);t===o.Ly.Above&&(c.push(n[r]),c.sort(((t,e)=>t.getNumericId()-e.getNumericId()))),t===o.Ly.Below&&(d.push(n[r]),d.sort(((t,e)=>t.getNumericId()-e.getNumericId()))),m.records=a.concat([...c,l[h],...d]),this.chart().trigger("change",this.chart())}getChartLayoutSettings(){return(0,h.getChartLayoutSettings)(this.chart().chart_layout())}getAllElements(){return this.elements().all().sort(((t,e)=>t.zIndex-e.zIndex))}getAllChartEvents(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];const e=this.chartEvents().all();return t?e.sort(((t,e)=>t.zIndex-e.zIndex)):e}getChartOrIndicatorElement(){var t;return null!==(t=this.getAllElements().find((t=>t.isChart()||t.isIndicator())))&&void 0!==t?t:null}getIsIndicatorPane(){var t;return!(null===(t=this.mainElement())||void 0===t||!t.isIndicator())}getIsChartPane(){var t;return!(null===(t=this.mainElement())||void 0===t||!t.isChart())}resetHeight(){this.getIsIndicatorPane()&&this.updateAttribute("height",l.kU.indicator),this.getIsChartPane()&&this.updateAttribute("height",l.kU.chart)}getIndexInChart(){return this.chart().getAllPanes().findIndex((t=>t.eql(this)))}getElementZIndexRange(){let t=-1,e=1;return this.getAllElements().forEach((i=>{i.zIndex>t&&(t=i.zIndex),i.zIndex<e&&(e=i.zIndex)})),{min:e,max:t}}getBelowAboveZeroElements(){const t=this.getAllElements(),e=[],i=[];return t.forEach((t=>{t.zIndex<0&&e.push(t),t.zIndex>0&&i.push(t)})),{elementsBelowZero:e,elementsAboveZero:i}}normalizeZIndexes(){const{elementsBelowZero:t,elementsAboveZero:e}=this.getBelowAboveZeroElements();(0,c.B6)({elementsArray:t,isBelowZero:!0}),(0,c.B6)({elementsArray:e,isBelowZero:!1})}getQuoteRawTicker(){return this.chart().getQuoteRawTicker()}getNumericId(){return Number(this.id.replace("c-",""))}updateChartEventsZIndexes(){if(!this.scale||!this.scale.hasOwnProperty("x"))return;const t=this.getAllChartEvents(!1).sort(((t,e)=>t.instance.scaled.x-e.instance.scaled.x)),e=t.find((t=>t.instance.isHovered)),i=t.find((t=>t.instance.isOpen)),s=[],n=[],a=[];t.forEach(((r,o)=>{const l=t.filter(((t,e)=>e<o&&Math.round(r.instance.attrs.x)===Math.round(t.instance.attrs.x)));r.updateAttributes({yIndex:l.length});const h=r.instance===(null==e?void 0:e.instance),c=r.instance===(null==i?void 0:i.instance),d=r.instance.type===(null==e?void 0:e.instance.type),u=r.instance.type===(null==i?void 0:i.instance.type);h&&c||(d?s.push(r):u?n.push(r):a.push(r))})),a.sort(((t,e)=>u.indexOf(t.instance.type)-u.indexOf(e.instance.type)));[...a,...n,i,...s,e].filter(Boolean).forEach(((t,e)=>{t.updateAttributes({zIndex:e})}))}}const g=m},7256:(t,e,i)=>{"use strict";i.d(e,{Z:()=>C});i(9841),i(5422),i(8322),i(7012),i(6539),i(90);var s=i(2340),n=i.n(s),a=i(2497),r=i(9587),o=i(2127),l=i(3888),h=i(9431),c=i(9197),d=i(5495),u=i(6372),m=i(5200),g=i(1541);const f={};function p(t){let{cid:e,key:i,fetchedAt:s}=t;const n=f[e];return(null==n?void 0:n.cachedAt)===s&&i?n[i]:i?null:n}function y(t){var e;let{cid:i,key:s,value:n,fetchedAt:a}=t;f[i]={...(null===(e=f[i])||void 0===e?void 0:e.cachedAt)===a?f[i]:{},[s]:n,cachedAt:a}}var v=i(8755);const b={open:[],high:[],low:[],close:[],volume:[],date:[],fetchedAt:-1,numberOfRefreshChecks:0,isFetching:!1,is404:!1,COTs:void 0,name:void 0,drawMinutesPerDay:void 0,marketStartMinutes:void 0,premarketLengthMinutes:void 0,aftermarketLengthMinutes:void 0,patternsMinRange:void 0,patternsMaxRange:void 0,relativeVolume:void 0,lastOpen:void 0,lastHigh:void 0,lastLow:void 0,lastClose:void 0,lastVolume:void 0,dataId:void 0,lastDate:void 0,prevClose:void 0,afterClose:void 0,afterChange:void 0,chartEvents:void 0};class x extends n().Model{static initClass(){this.configure("Quote","ticker","name","instrument","timeframe","open","high","low","close","date","volume","lastOpen","lastHigh","lastLow","lastClose","lastDate","lastVolume","dataId","prevClose","COTs","chartEvents","afterClose","afterChange","drawMinutesPerDay","marketStartMinutes","premarketLengthMinutes","aftermarketLengthMinutes","aftermarket","premarket","events","hasPatterns","patterns","patternsMinRange","patternsMaxRange","relativeVolume","fetchedAt","isIntraday","interval","drawDays","barIndex","barToDataIndex","fetchingPromise","isFetching","wasFetchAborted","chartUuid","numberOfRefreshChecks","maxBars","ideaID","is404")}static async get(t){var e;let{ticker:i,instrument:s,timeframe:n,options:a,abortController:r,fetchFunc:l,shouldUseCache:h=!0,chartUuid:c}=t;const d=i.replace("@",""),[u]=h?x.select((t=>(t=>{let{quote:e,ticker:i,instrument:s,timeframe:n}=t;return e.ticker===i&&e.instrument===s&&e.timeframe===n})({quote:t,ticker:d,instrument:s,timeframe:n})&&(t=>{let{quote:e,uuid:i}=t;return!i||e.chartUuid===i})({quote:t,uuid:c})&&(t=>-1!==t.fetchedAt||t.isFetching)(t)&&(t=>{let{quote:e,options:i}=t;return!(null!=i&&i.cachePredicate)||i.cachePredicate(e)})({quote:t,options:a})&&(t.instrument!==o.Yx.Stock||Number.isInteger(t.ideaID)||(t=>{let{quote:e,options:i}=t;return!e.premarket==!(null!=i&&i.premarket)&&!e.aftermarket==!(null!=i&&i.aftermarket)&&!e.hasPatterns==!(null!=i&&i.patterns)})({quote:t,options:a})))):[];if(u)return u.isFetching?await u.getResolvedFetchingPromise():null!=a&&a.fetchNewDataOnCachedQuote&&await u.fetchData({fetchType:g.p.NewerData,abortController:r,fetchFunc:l}),u;const m=x.create({...b,ticker:d,timeframe:n,instrument:s,chartUuid:c,maxBars:null==a?void 0:a.maxBars,premarket:null==a?void 0:a.premarket,aftermarket:null==a?void 0:a.aftermarket,hasPatterns:null==a?void 0:a.patterns,patterns:null==a?void 0:a.patterns,events:null===(e=null==a?void 0:a.events)||void 0===e||e});return await m.fetchData({fetchType:g.p.Refetch,abortController:r,fetchFunc:l}),m}static async getAll(t){if(0===t.length)return{};try{await Promise.all(t.map((t=>{let{ticker:e,instrument:i,timeframe:s}=t;return this.get({ticker:e,instrument:i,timeframe:s})})));return t.reduce(((t,e)=>({...t,[e.ticker]:x.select((t=>t.ticker===e.ticker&&t.instrument===e.instrument&&t.timeframe===e.timeframe))[0]})),{})}catch(t){}}async fetchRequest(t){let{abortController:e,fetchFunc:i,options:s={type:g.t.New}}=t,n=null,a=!1,r=!1;const o=(0,u.ZP)({location:this.getUrl(s),throwOnStatusCodes:[404],abortController:e,fetchFunc:i});this.updateAttributes({isFetching:!0,fetchingPromise:o});try{n=await o}catch(t){(0,c.wX)(t)&&(r=!0),a=t instanceof u.dR}const l=!n&&!r&&s.type===g.t.New;return this.updateAttributes({...l?b:{},is404:a,wasFetchAborted:r,isFetching:!1,fetchedAt:n?Date.now():this.fetchedAt}),n}async isPossibleToFetchSequentialData(){let{abortController:t,fetchFunc:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const i=await this.fetchRequest({abortController:t,fetchFunc:e});return!!(i&&i.date.length>0&&this.date.length>0)&&this.date[this.date.length-1]>=i.date[0]}async fetchData(t){var e;let i,{fetchType:s,abortController:n,fetchFunc:r}=t;if(s===g.p.Refetch)i={type:g.t.New};else{if(s!==g.p.NewerData)return;var c;i={type:g.t.Newer},(null!==(c=this.numberOfRefreshChecks)&&void 0!==c?c:0)<15&&(i.dataId=this.dataId)}this.instrument===o.Yx.Stock&&(i.events=null==this.events||this.events);const d=await this.fetchRequest({abortController:n,fetchFunc:r,options:i});var u;if(!d||!0===d.noNewData)return void this.updateAttributes({numberOfRefreshChecks:(null!==(u=this.numberOfRefreshChecks)&&void 0!==u?u:0)+1});if(this.timeframe!==d.timeframe||this.ticker.toLowerCase()!==(null===(e=d.ticker)||void 0===e?void 0:e.toLowerCase()))return;const m={COTs:d.COTs,name:d.name,open:d.open,high:d.high,low:d.low,close:d.close,volume:d.volume,date:d.date,drawMinutesPerDay:d.drawMinutesPerDay,marketStartMinutes:d.marketStartMinutes,premarketLengthMinutes:d.premarketLengthMinutes,aftermarketLengthMinutes:d.aftermarketLengthMinutes,patterns:d.patterns,patternsMinRange:d.patternsMinRange,patternsMaxRange:d.patternsMaxRange,relativeVolume:d.relativeVolume,lastOpen:d.lastOpen,lastHigh:d.lastHigh,lastLow:d.lastLow,lastClose:d.lastClose,lastVolume:d.lastVolume,dataId:d.dataId,lastDate:d.lastDate,prevClose:d.prevClose,afterClose:d.afterClose,afterChange:d.afterChange,numberOfRefreshChecks:0,chartEvents:d.chartEvents};if(s!==g.p.Refetch&&![o.Yx.Futures,o.Yx.Forex,o.Yx.Crypto].includes(this.instrument)){let t=0,e=0,i=-1;for(;t<this.date.length||e<d.date.length;){const s=this.date[t],n=d.date[e];if(void 0===n)break;if(s===n)this.open[t]=d.open[e],this.high[t]=d.high[e],this.low[t]=d.low[e],this.close[t]=d.close[e],this.volume[t]=d.volume[e],t++,e++;else if(s>n||void 0===s){if(-1===i&&[l.ih.w,l.ih.m].includes(this.timeframe)){const s=t-1,n=(0,h.X2)(this.date[s]),r=(0,h.X2)(d.date[e]);if(l.ih.w===this.timeframe&&(0,a.isSameWeek)(n,r,{weekStartsOn:1})||l.ih.m===this.timeframe&&(0,a.isSameMonth)(n,r)){this.date[s]=d.date[e],this.open[s]=d.open[e],this.high[s]=d.high[e],this.low[s]=d.low[e],this.close[s]=d.close[e],this.volume[s]=d.volume[e],i=s,e++;continue}}this.date.splice(t,0,d.date[e]),this.open.splice(t,0,d.open[e]),this.high.splice(t,0,d.high[e]),this.low.splice(t,0,d.low[e]),this.close.splice(t,0,d.close[e]),this.volume.splice(t,0,d.volume[e]),t++,e++}else if(s<n)t++;else{var f;console.warn("fetchNewerData merge warning"),null===(f=window.Sentry)||void 0===f||f.captureMessage("quote.ts fetchNewerData merge warning",{extra:{thisDateLength:this.date.length,dataDateLength:d.date.length,AIndex:t,BIndex:e,ADate:s,BDate:n}})}}m.date=this.date,m.open=this.open,m.high=this.high,m.low=this.low,m.close=this.close,m.volume=this.volume}var p,y;this.updateAttributes(m)||(null===(p=window.Sentry)||void 0===p||p.captureMessage("quote.ts fetchNewerData save() validation failed",{extra:this}));this||(null===(y=window.Sentry)||void 0===y||y.captureMessage("quote.ts fetchNewerData this is falsy",{extra:this}));this.trigger(s,this,s)}async getResolvedFetchingPromise(){try{return await this.fetchingPromise}catch{}}fetchOlderData(){}load(t){super.load(t);const{fetchedAt:e=0}=t,{cachedAt:i}=p({cid:this.cid})||{};return this.timeframe&&i!==e&&(y({cid:this.cid,key:"cachedAt",value:e,fetchedAt:e}),this.isIntraday=[l.ih.i1,l.ih.i2,l.ih.i3,l.ih.i5,l.ih.i10,l.ih.i15,l.ih.i30,l.ih.h,l.ih.h2,l.ih.h4].includes(this.timeframe),this.interval=this.isIntraday?l.pq[this.timeframe]:0,this.drawDays=this.getDrawDays(),this.barIndex=this.getBarIndexes(),this.barToDataIndex=this.barIndex.flatMap(((t,e)=>{var i;const s=null!==(i=this.barIndex[e-1])&&void 0!==i?i:-1;return[...Array.from({length:t-s-1}).fill(Math.max(0,e-1)),e]}))),this}destroy(t){return super.destroy(t),function(t){let{cid:e}=t;delete f[e]}({cid:this.cid}),this}getDrawDays(){if(this.instrument!==o.Yx.Stock)return 1/0;switch(this.timeframe){case l.ih.i1:case l.ih.i2:case l.ih.i3:case l.ih.i5:case l.ih.i10:return 10;case l.ih.i15:case l.ih.i30:case l.ih.h:case l.ih.h2:case l.ih.h4:return 15}}getHeikinAshiData(){const t=p({cid:this.cid,key:"heikinAshiData",fetchedAt:this.fetchedAt});if(t)return t;const e=this.open.map(((t,e)=>(this.open[e]+this.high[e]+this.close[e]+this.low[e])/4)),i={open:this.open.reduce(((t,i,s)=>[...t,(0===s?i+e[0]:t[s-1]+e[s-1])/2]),[]),close:e};return y({cid:this.cid,key:"heikinAshiData",value:i,fetchedAt:this.fetchedAt}),i}getDayToOffset(){const t=p({cid:this.cid,key:"dayToOffset",fetchedAt:this.fetchedAt});if(t)return t;const e={};let i,s=0;for(let t=0,n=this.date.length,a=n>=0;a?t<n:t>n;a?t++:t--){const n=(0,h.X2)(this.date[t]),a=(0,h.$2)(n);a!==i&&(e[a]=s,s++,i=a)}if((0,m.EJ)()&&this.lastDate){const[t,n,a]=[~~(this.lastDate/1e4),~~(this.lastDate/100)%100,this.lastDate%100],r="".concat(t,"-").concat(String(n).padStart(2,"0"),"-").concat(String(a).padStart(2,"0"));i!==r&&(e[r]=s)}return y({cid:this.cid,key:"dayToOffset",value:e,fetchedAt:this.fetchedAt}),e}getDaysInQuote(){const t=p({cid:this.cid,key:"daysInQuote",fetchedAt:this.fetchedAt});if(t)return t;const e=this.getDayToOffset(),i=Object.keys(e).map((t=>{const[e,i,s]=t.split("-");return new Date(Number.parseInt(e),Number.parseInt(i)-1,Number.parseInt(s))})).sort(((t,e)=>t.getTime()-e.getTime()));return y({cid:this.cid,key:"daysInQuote",value:i,fetchedAt:this.fetchedAt}),i}getBarIndexes(){if(!this.isIntraday||this.instrument!==o.Yx.Stock)return Array.from({length:this.date.length}).map(((t,e)=>e));const t=[],e=this.getDayToOffset();for(let i=0;i<this.date.length;i+=1){const s=(0,h.X2)(this.date[i]);let n=Math.ceil((60*s.getHours()+s.getMinutes()-this.marketStartMinutes)/this.interval);n+=e[(0,h.$2)(s)]*this.getBarsInDay(),t[i]=n}return t}getBarIndex(t){return this.isIntraday&&this.instrument===o.Yx.Stock?this.barIndex[t]:t}getBarsInDay(){if(this.isIntraday&&this.instrument===o.Yx.Stock)return Math.ceil(this.drawMinutesPerDay/this.interval)}getDataIndexByBarIndex(t){if(this.barIndex)for(let e=0;e<this.barIndex.length;e++)if(this.barIndex[e]===t)return e;return-1}getDataByBarIndex(t,e){const i=this.getDataIndexByBarIndex(e);if(i>-1){var s;return null!==(s=this[t][i])&&void 0!==s?s:null}return null}getDateToIndex(){const t=p({cid:this.cid,key:"dateToIndex",fetchedAt:this.fetchedAt});if(t)return t;const e={};for(let t=0;t<this.date.length;t++)e[this.date[t]]=t;return y({cid:this.cid,key:"dateToIndex",value:e,fetchedAt:this.fetchedAt}),e}getTimestampFomPositionX(t){return 0===this.date.length?0:(0,d.CI)({positionX:t,quote:this})}getPositionXFromTimestamp(t){return 0===this.date.length?0:(0,d.D$)({timestamp:t,quote:this})}getUrl(t){const e={ticker:this.ticker,instrument:this.instrument,timeframe:this.timeframe||"d1",aftermarket:this.aftermarket,premarket:this.premarket,patterns:this.hasPatterns||void 0,maxBars:this.maxBars,...t},i=e.instrument===o.Yx.Stock;let s=!(0,m.EJ)()&&"elite.finviz.com"===document.location.host&&i?"https://api.finviz.com":"";return(0,m.EJ)()&&(s=process.env.BE_API_URL),"".concat(s,"/api/quote.ashx?").concat(r.stringify({rev:Date.now(),...e}))}getRawTicker(){return(0,v.kB)(this.instrument,this.ticker)}clearData(){this.updateAttributes(b)}}x.initClass();const C=x},1541:(t,e,i)=>{"use strict";let s,n;i.d(e,{p:()=>s,t:()=>n}),function(t){t.Refetch="refetch",t.NewerData="newerData"}(s||(s={})),function(t){t.New="new",t.Newer="newer"}(n||(n={}))},5622:(t,e,i)=>{"use strict";i.r(e),i.d(e,{getChartLayoutSettings:()=>m,getSettings:()=>d,updateSettings:()=>u});var s=i(1045),n=i.n(s),a=i(2127),r=i(3888),o=i(9431),l=i(18),h=i(1758),c=i(221);function d(t){const e=n()({},(0,l.gh)({chartFormat:t.chartFormat,theme:t.theme}));if(null!=t.barWidth&&(e.ChartSettings.center.barWidth=t.barWidth,e.IndicatorSettings.center.barWidth=t.barWidth),null!=t.barMargin&&(e.ChartSettings.center.barMargin=t.barMargin,e.IndicatorSettings.center.barMargin=t.barMargin),null!=t.border&&(e.ChartSettings.center.border=t.border,e.IndicatorSettings.center.border=t.border),t.colorsOverride&&(e.ColorsSettings=t.colorsOverride),t.volumeHeight&&(e.ChartSettings.center.volumeHeight=t.volumeHeight),t.colors){const i=e.ChartSettings.general.Colors;e.ChartSettings.general.Colors={...i,[a.Q2.light]:{...i[a.Q2.light],...(0,l.xF)({theme:a.Q2.light,colors:t.colors})},[a.Q2.dark]:{...i[a.Q2.dark],...(0,l.xF)({theme:a.Q2.dark,colors:t.colors})}}}if(t.specificChartFunctionality===r.oK.chartPage&&o.ZP.isMobile()&&(e.ChartSettings.left.width=0,e.ChartSettings.top.ticker.margin.left=e.ChartSettings.left.overlayLabel.margin.left,e.IndicatorSettings.left.width=0),t.specificChartFunctionality===r.oK.chartPage&&(e.ChartSettings.top.height=10),t.specificChartFunctionality===r.oK.offScreen){var i;(null===(i=t.charts)||void 0===i?void 0:i.some((t=>{let{instrument:e}=t;return e===a.Yx.Group})))&&(e.ChartSettings.top.ohlc.margin.top=4,e.ChartSettings.top.ticker.margin.top=0,e.ChartSettings.top.ticker.font={size:h.U.XXL,style:"bold"},e.ChartSettings.left.timeframe.margin.top=12,e.ChartSettings.left.timeframe.font={size:h.U.S,style:"bold"})}return e}function u(t,e){const i=n()({},t.settings),s=e===a.Q2.light;return i.MarketSentimentSettings.general.Colors=s?{...c.XH}:{...c.VE},i.IndicatorSettings.general.Colors=s?{...c.s}:{...c.js},i.ElementSettings.Colors=s?{...c.TA}:{...c.bY},i}function m(t){const e=t.settings;return{...e,ChartSettings:{...e.ChartSettings,general:{...e.ChartSettings.general,Colors:{...e.ChartSettings.general.Colors,...e.ChartSettings.general.Colors[t.theme]}}}}}},8755:(t,e,i)=>{"use strict";i.d(e,{B6:()=>r,C3:()=>n,Ut:()=>o,kB:()=>l});i(8322),i(90),i(6539);var s=i(2127);const n=t=>{let{paneIndex:e,chartLayoutModel:i}=t;i.getAllCharts().forEach((t=>t.getAllPanes()[e].destroyCascade()))};function a(t){let{index:e,isBelowZero:i}=t;return(e+1)*(i?-1:1)}function r(t){let{elementsArray:e,isBelowZero:i}=t;(i?[...e].reverse():e).forEach(((t,e)=>{const s=a({index:e,isBelowZero:i});s!==t.zIndex&&t.updateAttributes({zIndex:s})}))}function o(t){let{elementsArray:e,addElement:i,oldZIndex:s,newZIndex:n,isBelowZero:o=!1}=t;const l=o?[...e].reverse():e,h=0===e.length&&i?[...l,i]:l.filter(((t,e)=>a({index:e,isBelowZero:o})!==s)).flatMap(((t,e)=>a({index:e,isBelowZero:o})===n&&i?[i,t]:t));h.length<Math.abs(n)&&i&&h.push(i),r({elementsArray:o?[...h].reverse():h,isBelowZero:o})}function l(t,e){return"".concat([s.Yx.Crypto,s.Yx.Forex,s.Yx.Futures].includes(t)&&!e.includes("@")?"@":"").concat(e)}},6364:(t,e,i)=>{"use strict";i.d(e,{V:()=>Vt});var s=i(3888),n=(i(9841),i(8322),i(2127)),a=i(5200),r=i(8497),o=i(5965);function l(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class h extends r.Z{constructor(){super(...arguments),l(this,"fx",(t=>this.model.scale.x(this.data.barIndex[t])))}static getNumOfBarsBuffer(t){let{period:e}=t;const[i]=(0,a.G8)(e);return i}get type(){return this.constructor.type}get label(){return this.constructor.label}getLabelColor(){return this.attrs.color?(0,o.Fx)(this.attrs.color):"#0587cd"}getFreeColor(){return this.getChartLayoutSettings().ColorsSettings[0]}renderContent(t){this.data=this.model.chart().quote()}getIsValid(t){throw Error("Implement")}getIsNumberInputValid(t){let{key:e,integerOnly:i=!0}=t;const s=this.getModalConfig().inputs.find((t=>{let{name:i}=t;return e===i}));return!!s&&(0,a.mh)(s)&&(!i||(0,a.aP)(s.value))}isRendered(){return!0}isRenderedOverlaysLabel(){return this.isRendered()}getModalConfig(){return{title:"",inputs:[],inputsErrorMessages:{}}}toConfig(){const t=[],e=[];return this.getModalConfig().inputs.forEach((i=>{"color"===i.type?t.push((0,o.c5)(i.value.toString())):e.push(i.value.toString())})),{type:this.type,period:e.join(","),color:t.join("|")}}}l(h,"type",s.j2.Overlay),l(h,"label","Overlay");const c=h;function d(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}const u={[n.Q2.light]:{TOP:"#D386DF",BOTTOM:"#69C1EA",MIDDLE:"#CFD2F2"},[n.Q2.dark]:{TOP:"#D38BFB",BOTTOM:"#57AEFB",MIDDLE:"#E1B6FC"}},m=20,g=2;class f extends c{static getNumOfBarsBuffer(t){let{period:e}=t;const[i=0]=(0,a.G8)(e);return i+1}set(t){super.set(t);const{period:e}=t;if("string"==typeof e){const[t,i]=function(t){const e=t.split(",");return[parseInt(e[0])||m,parseFloat(e[1])||g]}(e);this.attrs.period=t,this.attrs.deviations=i,this.trigger("change")}return this}renderContent(t){if("number"!=typeof this.attrs.period)return;super.renderContent();const{Colors:e}=this.getChartLayoutSettings().ChartSettings.general,i=this.model.chart().chart_layout().theme,{leftOffset:s,width:n}=this.model.chart(),[a,r]=this.model.scale.y.domain(),o=this.fy(a),l=this.fy(r),{close:h}=this.data,c=Math.min(this.attrs.period,h.length-1);let d,m=0;const g=[],f=[];let p=0;for(let t=0;t<c;t++)p+=h[t];t.translate(.5,.5),t.beginPath(),t.set("lineWidth",1),t.set("strokeStyle",u[i].MIDDLE);for(let e=c;e<h.length;e++){const i=this.fx(e);p=p-h[e-c]+h[e],g[e]=p/c;let a=0;for(let t=e-c+1;t<=e;t++)a+=Math.pow(h[t]-g[e],2);if(f[e]=Math.sqrt(a/c),!(i+s<-10)){if(void 0===d&&(d=e),t.lineTo(this.fx(e),Math.round(this.fy(g[e]))),i+s>n+10)break;m=e}}if(void 0!==d){t.stroke(),t.set("fillStyle",e.overlayTransparentBackground),t.beginPath(),t.moveTo(this.fx(d),o),t.set("strokeStyle",u[i].TOP);for(let e=d;e<=m;e++){const i=g[e]+f[e]*this.attrs.deviations;t.lineTo(this.fx(e),Math.round(this.fy(i)))}t.stroke(),t.lineTo(this.fx(m),o),t.fill(),t.beginPath(),t.moveTo(this.fx(d),l),t.set("strokeStyle",u[i].BOTTOM);for(let e=d;e<=m;e++){const i=g[e]-f[e]*this.attrs.deviations;t.lineTo(this.fx(e),Math.round(this.fy(i)))}t.stroke(),t.lineTo(this.fx(m),l),t.fill(),t.translate(-.5,-.5)}}getModalConfig(){var t,e,i,s;const n={type:"number",label:"Period",name:"period",value:null!==(t=this.attrs.period)&&void 0!==t?t:m,required:!0,min:1,max:999999},a={type:"number",label:"Deviations",name:"deviations",value:null!==(e=this.attrs.deviations)&&void 0!==e?e:g,required:!0,min:.1,max:999,step:.1},r={type:"color",label:"Top Color",name:"topColor",value:null!==(i=this.attrs.topColor)&&void 0!==i?i:this.getFreeColor()},o={type:"color",label:"Bottom Color",name:"bottomColor",value:null!==(s=this.attrs.bottomColor)&&void 0!==s?s:this.getFreeColor()};return{title:this.label,inputs:[n,a,r,o],inputsErrorMessages:{period:"".concat(n.label," must be a whole number between ").concat(n.min," and ").concat(n.max),deviations:"".concat(a.label," must be a number between ").concat(a.min," and ").concat(a.max)}}}getIsValid(t){switch(t){case"period":return this.getIsNumberInputValid({key:t});case"deviations":return this.getIsNumberInputValid({key:t,integerOnly:!1});case"topColor":case"bottomColor":return!0;default:return!1}}getLabelColor(){const t=this.model.chart().chart_layout().theme;return this.attrs.topColor||u[t].TOP}toString(){return"BB ".concat(this.attrs.period,",").concat(this.attrs.deviations)}}d(f,"type",s.j2.Bb),d(f,"label","Bollinger Bands"),f.prototype.defaults={topColor:"#69c1ea",bottomColor:"#d386df"};const p=f;var y=i(9431),v=i(1185);function b(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}const x="#69c1ea",C="#69C1EA12",w="#ffa75f";class S extends c{set(t){super.set(t);const{period:e}=t;return"string"==typeof e&&(this.attrs.period=parseInt(e,10),this.trigger("change")),this}renderContent(t){super.renderContent();const{leftOffset:e,width:i}=this.model.chart(),{period:s}=this.attrs,n=[],a=[],r=[];let o=-1,l=0;if(void 0!==this.data.close.length){t.save(),t.translate(.5,.5),t.set("lineWidth",1),t.set("strokeStyle",x),t.set("fillStyle",C),t.beginPath(),(0,v.E9)({quote:this.data,scale:this.model.scale,leftOffset:e,width:i,drawBarCallback:(e,i)=>{o=-1===o?e:o,n[e]=y.ZP.max(this.data.high.slice(Math.max(0,e-s),e+1)),a[e]=y.ZP.min(this.data.low.slice(Math.max(0,e-s),e+1)),r[e]=(n[e]+a[e])/2,t.lineTo(i,Math.round(this.fy(n[e]))),l=e}}),t.stroke(),t.lineTo(this.fx(l),t.canvas.height),t.lineTo(this.fx(o),t.canvas.height),t.clip(),t.beginPath();for(let e=o;e<=l;e++){const i=this.fx(e);t.lineTo(i,Math.round(this.fy(a[e])))}t.stroke(),t.lineTo(this.fx(l),0),t.lineTo(0,0),t.fill(),t.set("strokeStyle",w),t.beginPath();for(let e=o;e<=l;e++){const i=this.fx(e);t.lineTo(i,Math.round(this.fy(r[e])))}t.stroke(),t.restore()}}getModalConfig(){var t,e,i,s;const n={type:"number",label:"Period",name:"period",value:null!==(t=this.attrs.period)&&void 0!==t?t:20,required:!0,min:1,max:999999},a={type:"color",label:"Channels Stroke Color",name:"strokeColor",value:null!==(e=this.attrs.channelStrokeColor)&&void 0!==e?e:this.getFreeColor()},r={type:"color",label:"Channels Fill Color",name:"fillColor",value:null!==(i=this.attrs.channelFillColor)&&void 0!==i?i:this.getFreeColor()},o={type:"color",label:"Median Band Color",name:"medianBandColor",value:null!==(s=this.attrs.medianBandColor)&&void 0!==s?s:this.getFreeColor()};return{title:this.label,inputs:[n,o,a,r],inputsErrorMessages:{period:"".concat(n.label," must be a whole number between ").concat(n.min," and ").concat(n.max)}}}getIsValid(t){switch(t){case"period":return this.getIsNumberInputValid({key:t});case"medianBandColor":case"strokeColor":case"fillColor":return!0;default:return!1}}getLabelColor(){return this.attrs.medianBandColor}toString(){return"Donchian ".concat(this.attrs.period)}}b(S,"type",s.j2.Dch),b(S,"label","Donchian Channels"),S.prototype.defaults={medianBandColor:w,channelStrokeColor:x,channelFillColor:C};const M=S;var P=i(6477);function k(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class E extends c{set(t){super.set(t);const{period:e}=t;return"string"==typeof e&&(this.attrs.period=parseInt(e,10),this.trigger("change")),this}renderContent(t){super.renderContent();const{leftOffset:e,width:i}=this.model.chart(),s=new P.Z(this.attrs.period);t.translate(.5,.5),t.beginPath(),t.set("lineWidth",1),t.set("strokeStyle",this.attrs.color);for(let n=0;n<this.data.close.length;n++){s.add(this.data.close[n]);const a=this.fx(n);if(!(a+e<-10)){if(a+e>i+10)break;t.lineTo(a,Math.round(this.fy(s.value)))}}t.stroke(),t.translate(-.5,-.5)}getModalConfig(){var t,e;const i={type:"number",label:"Period",name:"period",value:null!==(t=this.attrs.period)&&void 0!==t?t:5,required:!0,min:1,max:999999},s={type:"color",label:"Color",name:"color",value:null!==(e=this.attrs.color)&&void 0!==e?e:this.getFreeColor()};return{title:this.label,inputs:[i,s],inputsErrorMessages:{period:"".concat(i.label," must be a whole number between ").concat(i.min," and ").concat(i.max)}}}getIsValid(t){switch(t){case"period":return this.getIsNumberInputValid({key:t});case"color":return!!this.attrs[t];default:return!1}}toString(){return"EMA ".concat(this.attrs.period)}}k(E,"type",s.j2.Ema),k(E,"label","Exponential Moving Average"),E.prototype.defaults={color:"#ffa75f"};const T=E;class I extends T{}var A,L,D;A=I,L="type",D=s.j2.Ema2,L in A?Object.defineProperty(A,L,{value:D,enumerable:!0,configurable:!0,writable:!0}):A[L]=D,I.prototype.defaults={color:"#ff6400"};const O=I;var R=i(5495);function F(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class B extends c{constructor(t,e){super(t,e),this.renderContent=this.renderContent.bind(this)}set(t){super.set(t);const{period:e}=t;return"string"==typeof e&&(this.attrs.period=parseInt(e,10),this.trigger("change")),this}renderContent(t){super.renderContent();const e=this.model.chart(),{ChartSettings:i}=this.getChartLayoutSettings(),{Colors:s}=i.general,{leftOffset:n,width:a,zoomFactor:r}=e,o=(0,R.zG)({zoomFactor:r,chartLayout:e.chart_layout()})/2,l=Math.min(this.attrs.period,this.data.close.length-1);let h,c=0;t.translate(.5,.5),t.set("fillStyle",s.overlayTransparentBackground),t.beginPath(),t.set("strokeStyle",this.attrs.highColor);let d=-1;for(let e=0;e<this.data.close.length;e++){let i=this.data.high[e];for(let t=e-l+1;t<=e;t++)this.data.high[t]>i&&(i=this.data.high[t]);const s=this.fx(e);if(s+n<-10){d=i;continue}if(void 0===h&&(h=e),s+n>a+10)break;this.data.barIndex[e]-this.data.barIndex[c]>1&&d!==i&&d>0&&t.lineTo(Math.round(s-o),Math.round(this.fy(d))),t.lineTo(Math.round(s-o),Math.round(this.fy(i))),t.lineTo(Math.round(s+o),Math.round(this.fy(i))),d=i,c=e}if(t.stroke(),void 0===h)return;t.lineTo(this.fx(c)+o,0),t.lineTo(this.fx(h)-o,0),t.fill(),t.beginPath(),t.set("strokeStyle",this.attrs.lowColor);let u=-1,m=h;for(let e=h;e<=c;e++){let i=this.data.low[e];for(let t=e-l+1;t<=e;t++)this.data.low[t]<i&&(i=this.data.low[t]);const s=this.fx(e);this.data.barIndex[e]-this.data.barIndex[m]>1&&u!==i&&u>0&&t.lineTo(Math.round(s-o),Math.round(this.fy(u))),t.lineTo(Math.round(s-o),Math.round(this.fy(i))),t.lineTo(Math.round(s+o),Math.round(this.fy(i))),u=i,m=e}t.stroke(),t.translate(-.5,-.5),t.lineTo(this.fx(c),t.canvas.height),t.lineTo(this.fx(h)-o,t.canvas.height),t.fill()}getModalConfig(){var t,e,i;const s={type:"number",label:"Period",name:"period",value:null!==(t=this.attrs.period)&&void 0!==t?t:50,required:!0,min:1,max:999999},n={type:"color",label:"High Color",name:"highColor",value:null!==(e=this.attrs.highColor)&&void 0!==e?e:this.getFreeColor()},a={type:"color",label:"Low Color",name:"lowColor",value:null!==(i=this.attrs.lowColor)&&void 0!==i?i:this.getFreeColor()};return{title:this.label,inputs:[s,n,a],inputsErrorMessages:{period:"".concat(s.label," must be a whole number between ").concat(s.min," and ").concat(s.max)}}}getIsValid(t){switch(t){case"period":return this.getIsNumberInputValid({key:t});case"highColor":case"lowColor":return!0;default:return!1}}getLabelColor(){return this.attrs.highColor}toString(){return"HILO ".concat(this.attrs.period)}}F(B,"type",s.j2.Hilo),F(B,"label","High/Low"),B.prototype.defaults={lowColor:"#69c1ea",highColor:"#d386df"};const N=B;i(7012);function Z(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class z extends c{static getNumOfBarsBuffer(){return 0}set(t){return super.set(t),"string"==typeof this.attrs.period&&void 0===this.attrs.price&&(this.attrs.price=parseFloat(this.attrs.period),this.trigger("change")),this}renderContent(t){super.renderContent();const e=Math.round(this.fy(this.attrs.price));t.set("strokeStyle",this.attrs.color),t.translate(0,.5),t.beginPath(),t.moveTo(-this.model.chart().leftOffset,e),t.lineTo(-this.model.chart().leftOffset+this.model.chart().width,e),t.stroke(),t.translate(0,-.5)}getModalConfig(){var t,e,i,s;const n={type:"number",label:"Price",name:"price",value:this.attrs.price||(null===(t=this.model)||void 0===t||null===(e=t.scale)||void 0===e||null===(i=e.y)||void 0===i?void 0:i.domain().reduce(((t,e)=>t+e),0))/2,required:!0,step:.1},a={type:"color",label:"Color",name:"color",value:null!==(s=this.attrs.color)&&void 0!==s?s:this.getFreeColor()};return{title:this.label,inputs:[n,a],inputsErrorMessages:{price:"".concat(n.label," must be number")}}}getIsValid(t){switch(t){case"price":return(0,a.AH)(this.attrs[t]);case"color":return!!this.attrs[t];default:return!1}}toString(){return"HL ".concat(this.attrs.price)}}Z(z,"type",s.j2.Hline),Z(z,"label","Horizontal Line"),z.prototype.defaults={color:"#0587cd"};const X=z;function H(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}const W={Stroke:"#009600",Fill:"#00960022"},U={Stroke:"#C80000",Fill:"#C8000022"},Y="#69C1EA",q="#E54040",V="#FFA75F",j={Conversion:9,Base:26,SpanB:52};function _(t){const[e=j.Conversion,i=j.Base,s=j.SpanB]=(0,a.G8)(t);return[e,i,s]}class Q extends c{constructor(){super(...arguments),H(this,"fx",(t=>{var e;const i=this.data.close.length-1,s=this.data.barIndex[i]+t-i;return this.model.scale.x(null!==(e=this.data.barIndex[t])&&void 0!==e?e:s)}))}static getNumOfBarsBuffer(t){let{period:e}=t;return Math.max(..._(e))}get renderFull(){return this.constructor.renderFull}set(t){if(super.set(t),"string"==typeof this.attrs.period&&(void 0===this.attrs.conversion||void 0===this.attrs.base||void 0===this.attrs.spanB)){const[t,e,i]=_(this.attrs.period);this.attrs.conversion=t,this.attrs.base=e,this.attrs.spanB=i}return this.trigger("change"),this}renderContent(t){super.renderContent();const{leftOffset:e,width:i}=this.model.chart(),{high:s,low:n,close:a}=this.data,{conversion:r,base:o,spanB:l,spanAFillColor:h,spanAStrokeColor:c,spanBFillColor:d,spanBStrokeColor:u,baseLineColor:m,conversionLineColor:g,laggingSpanColor:f}=this.attrs,p=[],y=[],b=[],x=[],C=r-1,w=o-1,S=l-1,M=Math.min(w,C),P=a.length+w;if(0===this.data.close.length)return;for(let t=M;t<P;t++){if(t>=C&&t<a.length){const e=Math.max(...s.slice(t-C,t+1)),i=Math.min(...n.slice(t-C,t+1));p[t]=(e+i)/2}if(t>=w&&t<a.length){const e=Math.max(...s.slice(t-w,t+1)),i=Math.min(...n.slice(t-w,t+1));y[t]=(e+i)/2,b[t+w]=(y[t]+p[t])/2}if(t>=S){const e=Math.max(...s.slice(t-S,t+1)),i=Math.min(...n.slice(t-S,t+1));x[t+w]=(e+i)/2}}let k=0,E=0;const T=this.fx(S+w);t.set("lineWidth",1),t.translate(.5,.5),t.save(),t.set("strokeStyle",c),t.set("fillStyle",h),t.beginPath(),(0,v.E9)({quote:this.data,scale:this.model.scale,fxOverride:this.fx,toIndexOffset:w,leftOffset:e,width:i,drawBarCallback:(e,i)=>{t.lineTo(i,Math.round(this.fy(b[e]))),k=i}}),t.stroke(),t.lineTo(k,t.canvas.height),t.lineTo(T,t.canvas.height),t.clip(),t.beginPath(),(0,v.E9)({quote:this.data,scale:this.model.scale,fxOverride:this.fx,toIndexOffset:w,leftOffset:e,width:i,drawBarCallback:(e,i)=>{e>=b.length||(t.lineTo(i,Math.round(this.fy(x[e]))),E=i)}}),t.lineTo(E,0),t.lineTo(T,0),t.fill(),t.restore(),t.save(),t.set("strokeStyle",u),t.set("fillStyle",d),t.beginPath(),(0,v.E9)({quote:this.data,scale:this.model.scale,fxOverride:this.fx,toIndexOffset:w,leftOffset:e,width:i,drawBarCallback:(e,i)=>{e>=b.length||t.lineTo(i,Math.round(this.fy(x[e])))}}),t.stroke(),t.lineTo(E,t.canvas.height),t.lineTo(T,t.canvas.height),t.clip(),t.beginPath(),(0,v.E9)({quote:this.data,scale:this.model.scale,fxOverride:this.fx,toIndexOffset:w,leftOffset:e,width:i,drawBarCallback:(e,i)=>{t.lineTo(i,Math.round(this.fy(b[e])))}}),t.lineTo(E,0),t.lineTo(T,0),t.fill(),t.restore(),t.translate(-.5,-.5),this.renderFull&&(t.set("strokeStyle",g),t.translate(.5,.5),t.beginPath(),(0,v.E9)({quote:this.data,scale:this.model.scale,fxOverride:this.fx,toIndexOffset:w,leftOffset:e,width:i,drawBarCallback:(e,i)=>{t.lineTo(i,Math.round(this.fy(p[e])))}}),t.stroke(),t.set("strokeStyle",m),t.beginPath(),(0,v.E9)({quote:this.data,scale:this.model.scale,fxOverride:this.fx,toIndexOffset:w,leftOffset:e,width:i,drawBarCallback:(e,i)=>{t.lineTo(i,Math.round(this.fy(y[e])))}}),t.stroke(),t.set("strokeStyle",f),t.beginPath(),(0,v.E9)({quote:this.data,scale:this.model.scale,fxOverride:t=>this.fx(t-o),leftOffset:e,width:i,drawBarCallback:(e,i)=>{t.lineTo(i,Math.round(this.fy(this.data.close[e])))}}),t.stroke(),t.translate(-.5,-.5))}getModalConfig(){var t,e,i,s,n,a,r,o,l,h;const c={type:"number",label:"Conversion Line",name:"conversion",value:null!==(t=this.attrs.conversion)&&void 0!==t?t:j.Conversion,required:!0,min:1,max:999999},d={type:"number",label:"Base Line Length",name:"base",value:null!==(e=this.attrs.base)&&void 0!==e?e:j.Base,required:!0,min:1,max:999999},u={type:"number",label:"Leading Span B Length",name:"spanB",value:null!==(i=this.attrs.spanB)&&void 0!==i?i:j.SpanB,required:!0,min:1,max:999999},m={type:"color",label:"Span A Stroke Color",name:"spanAStrokeColor",value:null!==(s=this.attrs.spanAStrokeColor)&&void 0!==s?s:this.getFreeColor()},g={type:"color",label:"Span A Fill Color",name:"spanAFillColor",value:null!==(n=this.attrs.spanAFillColor)&&void 0!==n?n:this.getFreeColor()},f={type:"color",label:"Span B Stroke Color",name:"spanBStrokeColor",value:null!==(a=this.attrs.spanBStrokeColor)&&void 0!==a?a:this.getFreeColor()},p={type:"color",label:"Span B Fill Color",name:"spanBFillColor",value:null!==(r=this.attrs.spanBFillColor)&&void 0!==r?r:this.getFreeColor()},y={type:"color",label:"Conversion Line Color",name:"conversionLineColor",value:null!==(o=this.attrs.conversionLineColor)&&void 0!==o?o:this.getFreeColor()},v={type:"color",label:"Base Line Color",name:"baseLineColor",value:null!==(l=this.attrs.baseLineColor)&&void 0!==l?l:this.getFreeColor()},b={type:"color",label:"Lagging Span Color",name:"laggingSpanColor",value:null!==(h=this.attrs.laggingSpanColor)&&void 0!==h?h:this.getFreeColor()};return{title:this.label,inputs:[c,d,u,m,g,f,p,y,v,b],inputsErrorMessages:{conversion:"".concat(c.label," must be a whole number between ").concat(c.min," and ").concat(c.max),base:"".concat(d.label," must be a whole number between ").concat(d.min," and ").concat(d.max),spanB:"".concat(u.label," must be a whole number between ").concat(u.min," and ").concat(u.max)}}}getIsValid(t){switch(t){case"conversion":case"base":case"spanB":case"lagging":return this.getIsNumberInputValid({key:t});case"spanAStrokeColor":case"spanAFillColor":case"spanBStrokeColor":case"spanBFillColor":case"conversionLineColor":case"baseLineColor":case"laggingSpanColor":return!0;default:return!1}}getLabelColor(){return this.attrs.spanAStrokeColor}toString(){return"Ichimoku ".concat(this.attrs.conversion,",").concat(this.attrs.base,",").concat(this.attrs.spanB)}}H(Q,"type",s.j2.Ic),H(Q,"label","Ichimoku Cloud"),H(Q,"renderFull",!1),Q.prototype.defaults={spanAStrokeColor:W.Stroke,spanAFillColor:W.Fill,spanBStrokeColor:U.Stroke,spanBFillColor:U.Fill,conversionLineColor:Y,baseLineColor:q,laggingSpanColor:V};const K=Q;function G(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class J extends K{}G(J,"type",s.j2.Icf),G(J,"label","Ichimoku Cloud (Full)"),G(J,"renderFull",!0);const $=J;var tt=i(4982);function et(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}const it=20,st=2,nt=10,at="#69C1EA",rt="#69C1EA33";function ot(t){const e=t.split(",");return[parseInt(e[0]),parseFloat(e[1]),parseInt(e[2])]}class lt extends c{static getNumOfBarsBuffer(t){let{period:e}=t;return 2*Math.max(...ot(e))}set(t){if(super.set(t),"string"==typeof this.attrs.period&&(void 0===this.attrs.emaPeriod||void 0===this.attrs.multiplier||void 0===this.attrs.atrPeriod)){const[t,e,i]=ot(this.attrs.period);this.attrs.emaPeriod=t,this.attrs.multiplier=e,this.attrs.atrPeriod=i,this.trigger("change")}return this}renderContent(t){super.renderContent();const{leftOffset:e,width:i}=this.model.chart(),{emaPeriod:s,multiplier:n,atrPeriod:a,strokeColor:r,fillColor:o}=this.attrs,l=new P.Z(s),h=new tt.Z(a),c=[],d=[],u=[],m=Math.max(s,a);let g,f=0;t.save(),t.translate(.5,.5),t.set("lineWidth",1),t.set("strokeStyle",r),t.set("fillStyle",o),t.beginPath();for(let s=1;s<this.data.close.length;s++){if(l.add(this.data.close[s]),h.add(this.data.high[s],this.data.low[s],this.data.close[s-1]),s<m)continue;const a=this.fx(s);if(!(a+e<-10)){if(a+e>i+10)break;void 0===g&&(g=s),c[s]=l.value,d[s]=l.value+n*h.value,u[s]=l.value-n*h.value,t.lineTo(a,Math.round(this.fy(d[s]))),f=s}}if(void 0!==g){t.stroke(),t.lineTo(this.fx(f),t.canvas.height),t.lineTo(this.fx(g),t.canvas.height),t.clip(),t.beginPath();for(let e=g;e<=f;e++){const i=this.fx(e);t.lineTo(i,Math.round(this.fy(u[e])))}t.stroke(),t.lineTo(this.fx(f),0),t.lineTo(0,0),t.fill(),t.beginPath();for(let e=g;e<=f;e++){const i=this.fx(e);t.lineTo(i,Math.round(this.fy(c[e])))}t.stroke(),t.restore()}else t.restore()}getModalConfig(){var t,e,i,s,n;const a={type:"number",label:"EMA Period",name:"emaPeriod",value:null!==(t=this.attrs.emaPeriod)&&void 0!==t?t:it,required:!0,min:1,max:999999},r={type:"number",label:"Multiplier",name:"multiplier",value:null!==(e=this.attrs.multiplier)&&void 0!==e?e:st,required:!0,step:.1,min:0,max:999},o={type:"number",label:"ATR Period",name:"atrPeriod",value:null!==(i=this.attrs.atrPeriod)&&void 0!==i?i:nt,required:!0,min:1,max:999999},l={type:"color",label:"Stroke Color",name:"strokeColor",value:null!==(s=this.attrs.strokeColor)&&void 0!==s?s:this.getFreeColor()},h={type:"color",label:"Fill Color",name:"fillColor",value:null!==(n=this.attrs.fillColor)&&void 0!==n?n:this.getFreeColor()};return{title:this.label,inputs:[a,r,o,l,h],inputsErrorMessages:{emaPeriod:"".concat(a.label," must be a whole number between ").concat(a.min," and ").concat(a.max),multiplier:"".concat(r.label," must be a number between ").concat(r.min," and ").concat(r.max),atrPeriod:"".concat(o.label," must be a whole number between ").concat(o.min," and ").concat(o.max)}}}getIsValid(t){switch(t){case"emaPeriod":case"atrPeriod":return this.getIsNumberInputValid({key:t});case"multiplier":return this.getIsNumberInputValid({key:t,integerOnly:!1});case"strokeColor":case"fillColor":return!0;default:return!1}}getLabelColor(){return this.attrs.strokeColor}toString(){return"Keltner Channel ".concat(this.attrs.emaPeriod,",").concat(this.attrs.multiplier,",").concat(this.attrs.atrPeriod)}}et(lt,"type",s.j2.Kch),et(lt,"label","Keltner Channel"),lt.prototype.defaults={strokeColor:at,fillColor:rt};const ht=lt;function ct(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class dt extends c{static getNumOfBarsBuffer(){return 0}isRendered(){return!1}getIsValid(){return!0}}ct(dt,"type",s.j2.None),ct(dt,"label","None");const ut=dt;var mt=i(2740),gt=i(9007);function ft(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class pt extends c{static getNumOfBarsBuffer(){return 0}renderContent(t){super.renderContent();const{ChartSettings:e}=this.getChartLayoutSettings(),i=this.data;if(!Array.isArray(i.patterns)||0===i.patterns.length)return;const n={width:600,height:300,barsInDay:Math.min(i.close.length,200),high:i.patternsMaxRange,low:i.patternsMinRange,barWidth:0};n.barWidth=n.width/200;const a=(n.high-n.low)/n.height,r=t=>0===t?this.fx(0):this.fx(i.close.length-1-~~(n.barsInDay-t/n.barWidth)),o=t=>this.fy(n.high-t*a),l=(e,i,s,n,a)=>{const l=(0,gt.Lx)({x1:r(i),y1:o(s),x2:r(n),y2:o(a)}),h=(0,gt.RJ)({lineWidth:1,...l});t.translate(h.x,h.y),t.beginPath(),t.set("lineWidth",1),t.set("strokeStyle",e),t.lineTo(l.x1,l.y1),t.lineTo(l.x2,l.y2),t.stroke(),t.translate(-1*h.x,-1*h.y)},h=(e,i,n,a,l,h)=>{new mt.Z({x:r((a+l)/2),y:o(h)+("above"===i?-1:2),font:{size:8,style:"bold"},textBaseline:"above"===i?s.EQ.bottom:s.EQ.top,fillStyle:n,textAlign:s.PH.center,text:e},this.model).render(t)},c=(e,i,n,a,l)=>{new mt.Z({x:r(a)+5,y:o(l)+("above"===i?-1:2),font:{size:9,style:"bold"},textBaseline:"above"===i?s.EQ.bottom:s.EQ.top,fillStyle:n,textAlign:s.PH.center,text:e},this.model).render(t)},d=t=>o(t)+10>=this.model.height-e.top.height-e.bottom.height?"above":"below",u=t=>o(t)<=15?"below":"above",m="rgb(0, 150, 220)",g="rgb(180, 50, 200)";for(const t of i.patterns){const{x1:e,x2:i,x3:s,y3:a}=t;let{y1:r,y2:o}=t;switch(t.kind){case 1:l("rgba(50, 50, 180, 0.588)",e,r,i,o);break;case 2:l(g,e,r,i,o);break;case 3:r===n.height&&o===n.height&&(r=o=n.height-1),l(m,e,r,i,o);break;case 12:h("Double Top",u(r),g,e,i,r);break;case 13:h("Double Bottom",d(r),m,e,i,r);break;case 14:h("Multiple Top",u(r),g,e,i,r);break;case 15:h("Multiple Bottom",d(r),m,e,i,r);break;case 16:c("L",u(r),g,e,r),c("H",u(o),g,i,o),c("R",u(a),g,s,a);break;case 17:c("L",d(r),m,e,r),c("H",d(o),m,i,o),c("R",d(a),m,s,a)}}}getModalConfig(){var t,e;const i={type:"color",label:"Support Color",name:"supportColor",value:null!==(t=this.attrs.supportColor)&&void 0!==t?t:this.getFreeColor()},s={type:"color",label:"Resist Color",name:"resistColor",value:null!==(e=this.attrs.resistColor)&&void 0!==e?e:this.getFreeColor()};return{title:this.label,inputs:[i,s],inputsErrorMessages:{}}}getIsValid(){return!0}isRenderedOverlaysLabel(){return!1}toString(){return""}}ft(pt,"type",s.j2.Patterns),ft(pt,"label","Patterns (daily charts)"),pt.prototype.defaults={supportColor:"#69c1ea",resistColor:"#d386df"};const yt=pt;function vt(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class bt extends c{static getNumOfBarsBuffer(){return 0}set(t){if(super.set(t),"string"==typeof this.attrs.period&&(void 0===this.attrs.step||void 0===this.attrs.maxStep)){const[t=0,e=0]=this.attrs.period.split(",").map((t=>parseFloat(t)));this.attrs.step=t,this.attrs.maxStep=e}return this.trigger("change"),this}renderContent(t){super.renderContent();const e=this.data,i=e.high[1]-e.high[0],s=e.low[0]-e.low[1];let n=(i>0&&i>s?i:0)>=(s>0&&s>i?s:0),a=n?e.low[0]:e.high[0],r=n?e.high[1]:e.low[1],o=e.high[0],l=e.low[0],h=this.attrs.step;for(let i=1,s=e.close.length,c=s>=1;c?i<s:i>s;c?i++:i--){let s;const c=o,d=l;o=e.high[i],l=e.low[i],n?l<=a?(n=!1,a=r,a<c&&(a=c),a<o&&(a=o),s=a,h=this.attrs.step,r=l,a+=h*(r-a),a<c&&(a=c),a<o&&(a=o)):(s=a,o>r&&(r=o,h+=this.attrs.step,h>this.attrs.maxStep&&(h=this.attrs.maxStep)),a+=h*(r-a),a>d&&(a=d),a>l&&(a=l)):o>=a?(n=!0,a=r,a>d&&(a=d),a>l&&(a=l),s=a,h=this.attrs.step,r=o,a+=h*(r-a),a>d&&(a=d),a>l&&(a=l)):(s=a,l<r&&(r=l,h+=this.attrs.step,h>this.attrs.maxStep&&(h=this.attrs.maxStep)),a+=h*(r-a),a<c&&(a=c),a<o&&(a=o));const u=Math.round(this.fx(i)-1.5),m=Math.round(this.fy(s)-1.5);t.set("fillStyle",n?this.attrs.risingColor:this.attrs.fallingColor),t.fillRect(u,m,3,3)}}getModalConfig(){var t,e,i,s;const n={type:"number",step:.01,min:.01,max:999,label:"Step",name:"step",value:null!==(t=this.attrs.step)&&void 0!==t?t:.02,required:!0},a={type:"number",step:.01,min:.01,max:999,label:"Maximum Step",name:"maxStep",value:null!==(e=this.attrs.maxStep)&&void 0!==e?e:.2,required:!0},r={type:"color",label:"Rising Color",name:"risingColor",value:null!==(i=this.attrs.risingColor)&&void 0!==i?i:this.getFreeColor(),customizable:!1},o={type:"color",label:"Falling Color",name:"fallingColor",value:null!==(s=this.attrs.fallingColor)&&void 0!==s?s:this.getFreeColor(),customizable:!1};return{title:this.label,inputs:[n,a,r,o],inputsErrorMessages:{step:"".concat(n.label," must be a number between ").concat(n.min," and ").concat(n.max),maxStep:"".concat(a.label," must be a number between ").concat(a.min," and ").concat(a.max)}}}getIsValid(t){switch(t){case"step":case"maxStep":return this.getIsNumberInputValid({key:t,integerOnly:!1});case"risingColor":case"fallingColor":return!0;default:return!1}}getLabelColor(){return this.attrs.risingColor}toString(){return"SAR ".concat(this.attrs.step,",").concat(this.attrs.maxStep)}}vt(bt,"type",s.j2.Sar),vt(bt,"label","Parabolic SAR"),bt.prototype.defaults={risingColor:"#69c1ea",fallingColor:"#d386df"};const xt=bt;function Ct(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class wt extends c{static getNumOfBarsBuffer(t){return c.getNumOfBarsBuffer(t)+1}set(t){super.set(t);const{period:e}=t;return"string"==typeof e&&(this.attrs.period=parseInt(e,10),this.trigger("change")),this}renderContent(t){super.renderContent();const{leftOffset:e,width:i}=this.model.chart(),s=Math.min(this.attrs.period,this.data.close.length-1);t.beginPath(),t.translate(.5,.5),t.set("lineWidth",1),t.set("strokeStyle",this.attrs.color);let n=0;for(let t=0;t<s;t++)n+=this.data.close[t];for(let a=s;a<this.data.close.length;a++){const r=this.fx(a);if(n=n-this.data.close[a-s]+this.data.close[a],!(r+e<-10)){if(r+e>i+10)break;t.lineTo(r,Math.round(this.fy(n/s)))}}t.translate(-.5,-.5),t.stroke()}getModalConfig(){var t,e;const i={type:"number",label:"Period",name:"period",value:null!==(t=this.attrs.period)&&void 0!==t?t:5,required:!0,min:1,max:999999},s={type:"color",label:"Color",name:"color",value:null!==(e=this.attrs.color)&&void 0!==e?e:this.getFreeColor()};return{title:this.label,inputs:[i,s],inputsErrorMessages:{period:"".concat(i.label," must be a whole number between ").concat(i.min," and ").concat(i.max)}}}getIsValid(t){switch(t){case"period":return this.getIsNumberInputValid({key:t});case"color":return!!this.attrs[t];default:return!1}}toString(){return"SMA ".concat(this.attrs.period)}}Ct(wt,"type",s.j2.Sma),Ct(wt,"label","Simple Moving Average"),wt.prototype.defaults={color:"#ffa75f"};const St=wt;class Mt extends St{}!function(t,e,i){e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i}(Mt,"type",s.j2.Sma2),Mt.prototype.defaults={color:"#ff6400"};const Pt=Mt;function kt(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}const Et=7,Tt=3,It="#00a000",At="#c80000";function Lt(t){const e=t.split(",");return[parseInt(e[0])||Et,parseFloat(e[1])||Tt]}class Dt extends c{static getNumOfBarsBuffer(t){let{period:e}=t;const[i]=Lt(e);return i+1}set(t){super.set(t);const{period:e}=t;if("string"==typeof e){const[t,i]=Lt(e);this.attrs.period=t,this.attrs.multiplier=i,this.trigger("change")}return this}renderContent(t){super.renderContent();const{leftOffset:e,width:i}=this.model.chart(),{period:s,multiplier:n}=this.attrs,{high:a,low:r,close:o}=this.data,l=new tt.Z(s),h=[],c=[],d=[];let u,m=0;t.translate(.5,.5),t.beginPath(),t.set("lineWidth",1),t.set("strokeStyle",this.attrs.uptrendColor);for(let g=1;g<o.length;g++){l.add(a[g],r[g],o[g-1]);const f=(a[g]+r[g])/2,p=f+n*l.value,y=f-n*l.value;h[g]=p,c[g]=y,o[g]>h[g-1]?d[g]=!0:o[g]<c[g-1]?d[g]=!1:d[g]=d[g-1],d[g]&&c[g]<c[g-1]&&(c[g]=c[g-1]),!d[g]&&h[g]>h[g-1]&&(h[g]=h[g-1]);const v=this.fx(g);if(!(g<s||v+e<-10)){if(v+e>i+10)break;void 0===u&&(u=g),d[g]&&!d[g-1]?(t.moveTo(this.fx(g-1),Math.round(this.fy(h[g-1]))),t.lineTo(v,Math.round(this.fy(c[g])))):d[g]?t.lineTo(v,Math.round(this.fy(c[g]))):t.moveTo(v,Math.round(this.fy(c[g]))),m=g}}if(t.stroke(),void 0!==u){t.beginPath(),t.set("strokeStyle",this.attrs.downtrendColor);for(let e=u;e<=m;e++){const i=this.fx(e);!d[e]&&d[e-1]?(t.moveTo(this.fx(e-1),Math.round(this.fy(c[e-1]))),t.lineTo(i,Math.round(this.fy(h[e])))):d[e]?t.moveTo(i,Math.round(this.fy(h[e]))):t.lineTo(i,Math.round(this.fy(h[e])))}t.stroke(),t.translate(-.5,-.5)}else t.translate(-.5,-.5)}getModalConfig(){var t,e,i,s;const n={type:"number",label:"Period",name:"period",value:null!==(t=this.attrs.period)&&void 0!==t?t:Et,required:!0,min:1,max:999999},a={type:"number",label:"Period",name:"multiplier",value:null!==(e=this.attrs.multiplier)&&void 0!==e?e:Tt,required:!0,step:.1,min:0,max:999},r={type:"color",label:"Uptrend Color",name:"uptrendColor",value:null!==(i=this.attrs.uptrendColor)&&void 0!==i?i:this.getFreeColor()},o={type:"color",label:"Downtrend Color",name:"downtrendColor",value:null!==(s=this.attrs.downtrendColor)&&void 0!==s?s:this.getFreeColor()};return{title:this.label,inputs:[n,a,r,o],inputsErrorMessages:{period:"".concat(n.label," must be a whole number between ").concat(n.min," and ").concat(n.max),multiplier:"".concat(a.label," must be a number between ").concat(a.min," and ").concat(a.max)}}}getIsValid(t){switch(t){case"period":return this.getIsNumberInputValid({key:t});case"multiplier":return this.getIsNumberInputValid({key:t,integerOnly:!1});case"uptrendColor":case"downtrendColor":return!0;default:return!1}}getLabelColor(){return this.attrs.uptrendColor}toString(){return"Supertrend ".concat(this.attrs.period,",").concat(this.attrs.multiplier)}}kt(Dt,"type",s.j2.Str),kt(Dt,"label","Supertrend"),Dt.prototype.defaults={uptrendColor:It,downtrendColor:At};const Ot=Dt;var Rt=i(264);function Ft(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}const Bt="#00FF00",Nt="#FF0000",Zt=20,zt=.3;function Xt(t,e){return(0,o.Qm)((0,o.Fx)(t),e)}class Ht extends c{static getNumOfBarsBuffer(t){let{period:e}=t;const[i=0]=(0,a.G8)(e);return i+1}set(t){super.set(t);const{period:e}=t;if("string"==typeof e){const[t,i]=function(t){const e=t.split(",");return[parseInt(e[0])||Zt,parseFloat(e[1])||zt]}(e);this.attrs.period=t,this.attrs.opacity=i,this.trigger("change")}return this}renderContent(t){if("number"!=typeof this.attrs.period)return;super.renderContent();const e=this.model.chart(),{leftOffset:i,width:s}=e,{left:n,right:a}=e.getChartLayoutSettings().ChartSettings,r=s-n.width-a.width;if(0===this.data.close.length)return;const o=(0,v.j2)({quote:this.data,scale:this.model.scale,leftOffset:i}),l=(0,v.dR)({quote:this.data,scale:this.model.scale,leftOffset:i,chartWidth:r}),[h,c]=(d=this.attrs,[Xt(null!==(u=d.upColor)&&void 0!==u?u:Bt,d.opacity),Xt(null!==(m=d.downColor)&&void 0!==m?m:Nt,d.opacity)]);var d,u,m;const[g,f]=y.ZP.minMax(this.data.close.slice(o,l+1)),p=Math.abs(f-g)/this.attrs.period,b=[];for(let t=0;t<this.attrs.period;t++){const e=g+p*t,i=e+p;b.push({start:e,end:i,up:0,down:0})}for(let t=o;t<=l;t++){const e=b.findIndex(((e,i)=>{return s=this.data.close[t],n=e.start,a=e.end,(!!i?s>n:s>=n)&&s<=a;var s,n,a}));if(-1===e)continue;const i=this.data.close[t]<this.data.open[t]?"down":"up";b[e][i]+=this.data.volume[t]}const x=y.ZP.max(b.map((t=>t.up+t.down))),C=.4*r,w=Rt.scaleLinear().range([0,C]).domain([0,x]);b.forEach((e=>{const s=Math.round(this.fy(e.start)),n=Math.round(this.fy(e.end))-s,a=n+(Math.abs(n)>5?2:1),r=Math.abs(i),o=Math.round(w(e.up)),l=Math.round(w(e.down));t.fillStyle=h,t.fillRect(r,s,o,a),t.fillStyle=c,t.fillRect(r+o,s,l,a)}))}getModalConfig(){var t,e,i,s;const n={type:"number",label:"Zones",name:"period",value:null!==(t=this.attrs.period)&&void 0!==t?t:Zt,required:!0,min:1,max:999999},a={type:"number",label:"Opacity",name:"opacity",value:null!==(e=this.attrs.opacity)&&void 0!==e?e:zt,required:!0,min:0,max:1,step:.1},r={type:"color",label:"Up Color",name:"upColor",value:null!==(i=this.attrs.upColor)&&void 0!==i?i:Bt},o={type:"color",label:"Down Color",name:"downColor",value:null!==(s=this.attrs.downColor)&&void 0!==s?s:Nt};return{title:this.label,inputs:[n,a,r,o],inputsErrorMessages:{period:"".concat(n.label," must be a whole number between ").concat(n.min," and ").concat(n.max),opacity:"".concat(a.label," must be a number between ").concat(a.min," and ").concat(a.max)}}}getIsValid(t){switch(t){case"period":return this.getIsNumberInputValid({key:t});case"opacity":return this.getIsNumberInputValid({key:t,integerOnly:!1});case"upColor":case"downColor":return!0;default:return!1}}getLabelColor(){return this.attrs.upColor||Bt}toString(){return"VP ".concat(this.attrs.period)}}Ft(Ht,"type",s.j2.Vp),Ft(Ht,"label","Volume Profile"),Ht.prototype.defaults={upColor:Bt,downColor:Nt};const Wt=Ht;function Ut(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class Yt extends c{static getNumOfBarsBuffer(){return 1}constructor(t,e){super(t,e),this.attrs.period=5}renderContent(t){if(super.renderContent(),!this.isRendered())return;const{leftOffset:e,width:i}=this.model.chart();t.translate(.5,.5),t.beginPath(),t.set("lineWidth",1),t.set("strokeStyle",this.attrs.color);let s=0,n=0;for(let o=0;o<this.data.close.length;o++){if(o>0){const t=(0,y.X2)(this.data.date[o-1]),e=(0,y.X2)(this.data.date[o]);r=e,((a=t).getFullYear()!==r.getFullYear()||a.getMonth()!==r.getMonth()||a.getDate()!==r.getDate())&&(s=0,n=0)}s+=(this.data.close[o]+this.data.low[o]+this.data.high[o])/3*this.data.volume[o],n+=this.data.volume[o];const l=s/n,h=this.fx(o);if(h+e<-10)continue;if(h+e>i+10)break;const c=Math.round(this.fy(l));t.lineTo(h,c)}var a,r;t.stroke(),t.translate(-.5,-.5)}getModalConfig(){var t;const e={type:"color",label:"Color",name:"color",value:null!==(t=this.attrs.color)&&void 0!==t?t:this.getFreeColor()};return{title:this.label,inputs:[e],inputsErrorMessages:{}}}getIsValid(t){return"color"===t}isRendered(){return this.model.chart().quote().isIntraday}isRenderedOverlaysLabel(){return this.isRendered()}toString(){return"VWAP"}}Ut(Yt,"type",s.j2.Vwap),Ut(Yt,"label","VWAP (intraday charts)"),Yt.prototype.defaults={color:"#9467bd"};const qt=Yt,Vt=Object.freeze({[s.j2.Overlay]:c,[s.j2.None]:ut,[s.j2.Bb]:p,[s.j2.Dch]:M,[s.j2.Ema]:T,[s.j2.Ema2]:O,[s.j2.Hilo]:N,[s.j2.Hline]:X,[s.j2.Ic]:K,[s.j2.Icf]:$,[s.j2.Kch]:ht,[s.j2.Patterns]:yt,[s.j2.Sar]:xt,[s.j2.Sma]:St,[s.j2.Sma2]:Pt,[s.j2.Str]:Ot,[s.j2.Vp]:Wt,[s.j2.Vwap]:qt})},9431:(t,e,i)=>{"use strict";i.d(e,{$2:()=>h,$8:()=>c,Cd:()=>f,HL:()=>y,Hn:()=>o,Hp:()=>d,Rp:()=>m,U$:()=>p,X2:()=>l,ZP:()=>r,al:()=>u,jQ:()=>v,mq:()=>g,t$:()=>b,yG:()=>x});i(8322),i(9841),i(9582),i(5422);var s=i(3888),n=i(5200);class a{static min(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];if("number"==typeof e[0])return e[0]<+e[1]?e[0]:e[1];let s=e[0][0];for(const t of e)for(const e of t)e<s&&(s=e);return s}static max(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];if("number"==typeof e[0])return e[0]>+e[1]?e[0]:e[1];let s=e[0][0];for(const t of e)for(const e of t)e>s&&(s=e);return s}static minMax(){let t;for(var e=arguments.length,i=new Array(e),s=0;s<e;s++)i[s]=arguments[s];let n=t=i[0][0];for(const e of i)for(const i of e)i<n&&(n=i),i>t&&(t=i);return[n,t]}static getScaleRatio(){return"undefined"!=typeof window&&window.devicePixelRatio||1}static setSizeOnCanvasElement(t){let{canvasElement:e,width:i,height:s,ratio:n=a.getScaleRatio()}=t;e&&(e.width=i*n,e.height=s*n,e.style.width=i+"px",e.style.height=s+"px")}static getQuoteDateTimestampOffsetInSeconds(t){const e=t||new Date;return 60*(function(t){const e=t.getDate(),i=t.getMonth(),s=e-t.getDay();return!(i<2||i>10)&&(i>2&&i<10||(2===i?s>=8:s<=0))}(new Date(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours()-5,e.getUTCMinutes(),e.getUTCSeconds()))?4:5)*60}static convertLocalToNyTime(t,e){const i=new Date(t),s=1e3*a.getQuoteDateTimestampOffsetInSeconds(i),n=60*i.getTimezoneOffset()*1e3,r=e?1:-1;return i.setTime(i.getTime()+(n-s)*r),i}static isStockFastRefreshAvailable(){const t=o(new Date,!0),e=t.getDay(),i=t.getHours(),s=t.getMinutes();return!(0===e||6===e)&&(7===i?s>=30:i>=8)&&!(i>=18)}static dateFromUnixTimestamp(t){const e=new Date(0);return e.setUTCSeconds(t),a.convertLocalToNyTime(e,!0)}static dateStringFromDate(t){return"".concat(t.getFullYear(),"-").concat(String(t.getMonth()+1).padStart(2,"0"),"-").concat(String(t.getDate()).padStart(2,"0"))}static dateFromDateString(t){const[e,i,s]=t.split("-"),a=new Date(Number.parseInt(e),Number.parseInt(i)-1,Number.parseInt(s));return Number.isNaN(a.getTime())&&(0,n.Tb)(new Error("Invalid Date"),{extra:{date:a}}),a}static isMobile(t){if((0,n.EJ)())return!1;let e=!1;if(navigator.userAgent.indexOf("Macintosh")>-1)try{document.createEvent("TouchEvent"),e=!0}catch(t){}else e=!!navigator.userAgent.match(/\b(Android|webOS|i(?:Phone|Pad|Pod)|BlackBerry|Windows (?:Phone|Mobile))\b/i);if(t)try{return e&&(window.navigator.msMaxTouchPoints||window.navigator.maxTouchPoints||"ontouchstart"in document.createElement("div"))}catch(t){}return e}static isIPad(){const t=navigator.userAgent.match(/iPad/i),e=navigator.userAgent.match(/iPhone/i),i=navigator.userAgent.match(/iPod/i);return navigator.userAgent.match(/Mac/)&&navigator.maxTouchPoints>0&&!e&&!i||t}static getCookie(t){const e=new RegExp("(?:(?:^|.*;\\s*)"+t+"\\s*\\=\\s*([^;]*).*$)|^.*$");return document.cookie.replace(e,"$1")}static setCookie(t,e,i){let s=t+"="+e+"; expires="+i.toUTCString();"localhost"!==document.location.hostname&&(s+="; domain=.finviz.com"),document.cookie=s}}const r=a,o=a.convertLocalToNyTime,l=a.dateFromUnixTimestamp,h=a.dateStringFromDate,c=a.dateFromDateString,d=function(){return window.FLibs.getSanitizedTicker(...arguments)};function u(){var t,e,i,s;return null!==(t=null!==(e=null!==(i=null!==(s=document.fullscreenElement)&&void 0!==s?s:document.webkitFullscreenElement)&&void 0!==i?i:document.mozFullScreenElement)&&void 0!==e?e:document.msFullscreenElement)&&void 0!==t&&t}function m(t){var e,i,s;return null!==(e=null!==(i=null!==(s=t.requestFullscreen)&&void 0!==s?s:t.webkitRequestFullScreen)&&void 0!==i?i:t.mozRequestFullScreen)&&void 0!==e?e:t.msRequestFullscreen}function g(){var t,e,i;return null!==(t=null!==(e=null!==(i=document.exitFullscreen)&&void 0!==i?i:document.webkitExitFullscreen)&&void 0!==e?e:document.mozExitFullScreen)&&void 0!==t?t:document.msExitFullscreen}function f(t){"loading"===document.readyState?document.addEventListener("DOMContentLoaded",t):t()}function p(t){var e,i;const s=document.getElementById(t),n=null==s?void 0:s.getBoundingClientRect();return{width:Math.max((null!==(e=null==n?void 0:n.width)&&void 0!==e?e:0)-2,0),height:Math.max((null!==(i=null==n?void 0:n.height)&&void 0!==i?i:0)-2,0)}}function y(){return window.innerWidth<s.QX}function v(t){return!!(null!=t?t:a.isMobile())&&window.orientation%180==0}function b(t){let e="";return t>=1e9?(t/=1e9,e="B"):t>=1e6?(t/=1e6,e="M"):t>=1e3&&(t/=1e3,e="K"),t.toFixed(2)+e}function x(){var t;return"undefined"!=typeof window&&(null===(t=window.FinvizSettings)||void 0===t?void 0:t.hasRedesignEnabled)}},9197:(t,e,i)=>{"use strict";i.d(e,{R$:()=>n,wX:()=>a,xg:()=>r});const s={};function n(t){delete s[t]}function a(t){return"AbortError"===t.name}function r(t){let{key:e,shouldAbortRunningRequest:i=!1}=t;i&&function(t){var e;null===(e=s[t])||void 0===e||e.abort(),n(t)}(e);const a="AbortController"in window?new AbortController:void 0;return a&&(s[e]=a),a}},5822:(t,e,i)=>{"use strict";i.d(e,{w:()=>u,y:()=>m});i(8322);var s=i(560),n=i(7218),a=i(5200),r=i(7824);const o={},l={},h=3;var c;function d(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return t().catch((async i=>{if(e>h)throw i;return await new Promise((t=>setTimeout(t,1e3*e))),d(t,e+1)}))}function u(t){let{importFn:e,onError:i,errorSeverity:h,cacheKey:u,shouldLoadModule:m=!1,isSuspenseMode:g=!1}=t;const f=(0,n.useNotification)(),[p,y]=s.useState(!1),[v,b]=s.useState(!1),x=(0,r.t)(),C=()=>{null==i||i(),b(!0),void 0!==h&&(c[h]===c.high&&(window.handleScriptNotLoaded(),window.renderScriptNotLoaded()),c[h]===c.medium&&f.show(s.createElement(n.Notification,{actions:[],timeoutInMs:6e3},s.createElement(n.Paragraph,{className:"max-w-[17rem]"},"One or more of the required application components couldn’t be loaded. ",s.createElement("br",null)," Please try to repeat the action or"," ",s.createElement("span",{className:"cursor-pointer underline",onClick:()=>window.location.reload()},"refresh the page")," ","if the problem persists."))))},w=async()=>{if(o[u])return o[u];y(!0);try{o[u]=await d(e)}catch(t){(0,a.Tb)(t),C()}finally{x()&&y(!1)}return o[u]};s.useEffect((()=>{m&&w()}),[m]);const S=o[u];if(g){if(l[u])throw l[u];if(!S)throw e().then((t=>o[u]=t)).catch((t=>{C(),l[u]=t}))}return[null!=S?S:null,{isLoading:p,loadModule:w,isError:v}]}function m(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return function(i){return s.createElement(s.Suspense,{fallback:e},s.createElement(t,i))}}!function(t){t[t.medium=0]="medium",t[t.high=1]="high"}(c||(c={}))},5495:(t,e,i)=>{"use strict";i.d(e,{Bs:()=>z,CI:()=>R,D$:()=>F,EI:()=>W,G4:()=>V,GX:()=>L,HQ:()=>X,Ie:()=>j,NM:()=>H,PU:()=>Q,Ym:()=>_,dd:()=>O,ee:()=>M,mQ:()=>B,ow:()=>N,rf:()=>Z,v8:()=>q,wN:()=>U,xP:()=>Y,zG:()=>P});i(6539),i(8322),i(90),i(9841),i(5422);var s=i(2497),n=i(2127),a=i(3104),r=i(2740),o=i(3102),l=i(3888),h=i(9007),c=i(8723),d=i(7256),u=i(5622),m=i(9431),g=i(5200);const f=86400,p=12e4,y={};function v(t){let{ts1:e,ts2:i}=t;const s=e,n=i;return Math.floor(s/f)===Math.floor(n/f)}function b(t){let{idRevision:e,ticker:i,timeframe:s}=t;return"".concat(i,"-").concat(s,"-").concat(e)}function x(t){let{idRevision:e,ticker:i,timeframe:s,fromSeconds:n,toSeconds:a,virtualDates:r}=t;const o=b({idRevision:e,ticker:i,timeframe:s});!function(){const t=Date.now();Object.keys(y).forEach((e=>{y[e].lastUsed<t-p&&delete y[e]}))}(),y[o]={fromSeconds:n,toSeconds:a,virtualDates:r,lastUsed:Date.now()}}const C=1,w=0,S=16;function M(t){let{zoomFactor:e=1,chartLayout:i}=t;const{ChartSettings:s}=i.settings,n=s.center,a=e>1&&0===n.barMargin?Math.min(n.barWidth,1-1/e):n.barMargin;return{barFillWidth:n.barWidth*e,barBorderWidth:Math.min(n.border*e,C),barMarginWidth:Math.max(w,Math.min(a*e,S))}}function P(t){let{zoomFactor:e=1,chartLayout:i,shouldRound:s=!0}=t;const{barFillWidth:n,barBorderWidth:a,barMarginWidth:r}=M({zoomFactor:e,chartLayout:i}),o=n+2*a+r;if(!s)return o;const l=o>100?10:1e4;return Math.round(o*l)/l}const k=.001,E={},T=[],I=t=>{var e;return null!==(e=E[t])&&void 0!==e?e:null},A=(t,e)=>{if(!T.includes(t)&&(T.unshift(t),T.length>10)){const t=T.pop();t&&delete E[t]}E[t]=e};function L(t){let{chartVisibleWidth:e,numOfVisibleBars:i,chartLayout:s}=t;const n=P({chartLayout:s}),a=e/i,r="".concat(n,"-").concat(a);let o=0,l=1,h=I(r),c=0;for(a<=n&&(h=a/n);null===h;){c+=1;const t=.01;l+=o;const e=P({zoomFactor:l,chartLayout:s,shouldRound:!1}),i=a-e;if(i>t?o=o>0?2*o:k:i<-t?o=o<0?2*o:-k:h=l,1e3===c)return(0,g.Tb)(new Error("Invalid zoom factor from getZoomFactorForBarsToDisplay"),{extra:{iteration:c,zoomIncrement:o,barWidthWithMargin:a,barWidth:e,barWidthDiff:i,currentZoomFactor:l,chartLayout:s.toConfig(["colors","panes"])}}),l}return A(r,h),h}function D(t){let{lowerIndex:e,dates:i,timeframe:s}=t;const n=e+1;return![i[n],i[e]].some((t=>void 0===t))?i[n]-i[e]:l.J2[s]}function O(t){var e;let{dateStart:i,dateEnd:a,quote:r}=t;const{date:o,ticker:h,timeframe:c,instrument:d,isIntraday:u,marketStartMinutes:g}=r,f=null!==(e=r.getBarsInDay())&&void 0!==e?e:0,p=i===o[0]&&a===o[o.length-1],C={idRevision:o.length,ticker:h,timeframe:c,fromSeconds:i,toSeconds:a},w=function(t){let{idRevision:e,ticker:i,timeframe:s,fromSeconds:n,toSeconds:a}=t;const r=b({idRevision:e,ticker:i,timeframe:s}),o=y[r];return(null==o?void 0:o.fromSeconds)<=n&&(null==o?void 0:o.toSeconds)>=a?(o.lastUsed=Date.now(),o.fromSeconds===n&&o.toSeconds===a?o.virtualDates:o.virtualDates.filter((t=>t>=n&&t<=a))):null}(C);if(w)return w;if(!u||d!==n.Yx.Stock){if(p)return o;const t=l.J2[c],e=o[0],s=o[o.length-1],n=Math.ceil((e-i)/t),r=Math.ceil((a-s)/t);return[...Array.from({length:n}).map(((i,s)=>e-(s+1)*t)).reverse(),...o,...Array.from({length:r}).map(((e,i)=>s+(i+1)*t))]}const S=p?r.getDaysInQuote():function(t){let{dateStartSeconds:e,dateEndSeconds:i,datesSeconds:n,marketStartMinutes:a}=t;const r=(0,m.X2)(e),o=(0,m.X2)(i),l=e<n[0],h=n.length>0&&n[n.length-1]<i,c=(0,m.X2)(n[0]),d=(0,m.X2)(n[n.length-1]);return s.eachDayOfInterval({start:l&&(s.isWeekend(r)||r.getMinutes()<a)?s.addBusinessDays(r,-1):r,end:h?s.addBusinessDays(o,1):o}).filter((t=>{const e=t.getTime()/1e3-60*t.getTimezoneOffset();return!s.isWithinInterval(t,{start:s.startOfDay(c),end:s.endOfDay(d)})||n.some((t=>v({ts1:t-m.ZP.getQuoteDateTimestampOffsetInSeconds(new Date(1e3*t)),ts2:e})))}))}({dateStartSeconds:i,dateEndSeconds:a,datesSeconds:o,marketStartMinutes:g}),M=60*g,P=Array.from({length:f}).map(((t,e)=>e*l.J2[c])),k=m.ZP.getQuoteDateTimestampOffsetInSeconds(new Date(1e3*i)),E=S.flatMap((t=>{const e=t.getTime()/1e3+m.ZP.getQuoteDateTimestampOffsetInSeconds(t)-60*t.getTimezoneOffset()+M;return P.map(((t,i)=>([l.ih.h,l.ih.h2,l.ih.h4].includes(c)&&i>0?-1800:0)+e+t))}));return p||E.filter(((t,e,s)=>{const n=t>=i||v({ts1:t-m.ZP.getQuoteDateTimestampOffsetInSeconds(new Date(1e3*t)),ts2:i-k}),a=i>t&&i<s[e+1];return n||a})),x({...C,virtualDates:E}),E}function R(t){let{positionX:e,quote:i}=t;const{date:s,timeframe:n}=i,a=O({dateStart:s[0],dateEnd:s[s.length-1],quote:i}),r=a[0],o=a[a.length-1],l=a.length-1;if(e>=0&&e<=l){const t=Math.floor(e),i=D({lowerIndex:t,dates:a,timeframe:n});return a[t]+(e-t)*i}const h=e<0,c=(o-r)/a.length,d=h?Math.abs(e)*c:(e-l)*c;return~~(h?r-d:o+d)}function F(t){let{timestamp:e,quote:i}=t;const{date:s,timeframe:n}=i,a=O({dateStart:s[0],dateEnd:s[s.length-1],quote:i}),r=a[0],o=a[a.length-1],l=a.length-1;if(e>=a[0]&&e<=a[a.length-1]){const t=e===o?l:a.findIndex((t=>t>e)),i=D({lowerIndex:t-1,dates:a,timeframe:n});return t-(a[t]-e)/i}const h=e<r,c=(o-r)/a.length;return h?-(r-e)/c:l+(e-o)/c}function B(t){if(0===t.indexOf("@")){const e=t.substring(1);return l.LI[e]?n.Yx.Crypto:6===e.length?n.Yx.Forex:n.Yx.Futures}return n.Yx.Stock}async function N(t){let{paneWithPerfIndicator:e,timeframe:i,fetchFunc:s,maxBars:n,chartUuid:a}=t;const r=function(t){var e,i;let{paneWithPerfIndicator:s,timeframe:n}=t;const{elements:a}=s,r=a.find((t=>{let{type:e}=t;return"indicators/perf"===e}));return(null!==(e=null==r||null===(i=r.period)||void 0===i?void 0:i.split(","))&&void 0!==e?e:[]).map((t=>({ticker:t,instrument:B(t),timeframe:n})))}({paneWithPerfIndicator:e,timeframe:i});if(r.length>0){const t=r.map((t=>{let{ticker:e,instrument:i,timeframe:r}=t;return d.Z.get({ticker:e,instrument:i,timeframe:r,options:{maxBars:n},fetchFunc:s,chartUuid:a})}));return Promise.all(t)}return Promise.resolve([])}function Z(t){let{context:e,mouseModel:i,paneModel:s,quote:o,contentWidth:d,contentHeight:m,onRenderCrossText:g,getRoundDecimalPlaces:f,isIndicator:p=!1,isPerfIndicator:y=!1}=t;const v=i.getCrossIndexForPane(s),b=s.chart(),{ChartSettings:x,IndicatorSettings:C}=(0,u.getChartLayoutSettings)(b.chart_layout()),w=p?C:x,{Colors:S}=x.general;if(!i.getShouldRenderCrossInPane(s))return!1;const M=i.getPriceForPane(s),P=s.scale.x(v)+b.leftOffset,k=P>0&&P<=d;if(k){const t=P+w.left.width;new a.Z({x1:t,x2:t,y1:w.top.height,y2:w.top.height+m,strokeStyle:S.cross},s).render(e),null==g||g(e,v)}const E=s.scale.y.domain().slice().sort(((t,e)=>t-e));if(null===M||!(E[0]<=M&&M<=E[1]))return k;const T=s.scale.y(M),I=Math.round(T+w.top.height);new a.Z({x1:w.left.width,x2:w.left.width+d,y1:I,y2:I,strokeStyle:S.cross},s).render(e);const A=o.instrument===n.Yx.Crypto&&o.lastClose<=.001?3:8;var L;return new r.Z({text:b.scale!==l.N3.Percentage||p?"".concat(c.ZP.round({value:M,lastClose:o.lastClose,instrument:o.instrument,overridePlaces:null!==(L=null==f?void 0:f(M))&&void 0!==L?L:s.getIsChartPane()?void 0:2})).concat(y?"%":""):"".concat(c.ZP.round({value:(0,h.G$)({number:M,base:b.firstBarClose}),lastClose:o.lastClose,instrument:o.instrument,overridePlaces:2}),"%"),x:w.left.width+w.right.axis.margin.left+d+(p?l.ew.S:A-l.tr.XXS),padding:p?r.Z.getMergedPropsWithDefaults("padding",C.right.axis.font.padding):{top:l.tr.XXS,right:l.tr.XXS,bottom:l.tr.XXS,left:l.tr.XXS},y:I,textBaseline:l.EQ.middle,fillStyle:S.crossText,background:S.crossTextBackground,font:r.Z.getMergedPropsWithDefaults("font",{...w.right.axis.font,style:"bold"}),lineHeight:w.right.axis.font.lineHeight},s).render(e),!0}function z(t){t&&(t.width=0,t.height=0,t.style.width="0px",t.style.height="0px")}function X(t){let{change:e,ChartSettings:i}=t;const{Colors:s}=i.general;return 0===e?s.zeroChange:e>0?s.positiveChange:s.negativeChange}function H(t){let{data:e,num:i,overridePlaces:s}=t;return c.ZP.round({value:i,lastClose:e.lastClose,instrument:e.instrument,overridePlaces:s})}function W(t){let{anchorClose:e,prevClose:i,data:s}=t;const n=e-i,a=100*(e/i-1),r="".concat(H({data:s,num:Math.abs(a),overridePlaces:2}),"%");return{points:n,string:"".concat(n>0?"+":"").concat(H({data:s,num:n})," (").concat(r,")"),percentString:"".concat(n>0?"+":"").concat(n<0?"-":"").concat(r)}}function U(t){let{data:e}=t;const i={tickerChange:null,tickerAfterChange:null};Number.isFinite(e.prevClose)&&(i.tickerChange=W({data:e,anchorClose:e.lastClose,prevClose:e.prevClose}));if(Number.isFinite(e.afterClose)&&e.afterClose!==e.lastClose){const t=W({data:e,anchorClose:e.afterClose,prevClose:e.lastClose});i.tickerAfterChange={...t,string:"AH: ".concat(t.string)}}return i}function Y(t){return[l.oK.forexPage,l.oK.cryptoPage,l.oK.futuresPage].includes(t)}function q(t){let{specificChartFunctionality:e,totalBarWidth:i}=t;const s=Y(e),n=e===l.oK.offScreen&&i<5,a=e===l.oK.quotePage&&i<5;return s||n||a}const V="charts-draw";function j(){return"on"===m.ZP.getCookie(V)}function _(t){return t===l.oK.chartPage&&!!window.FinvizSettings.hasSidebarEnabled}const Q=t=>{let{type:e,chartLayoutModel:i}=t;i.getAllElements().forEach((t=>{if(t.isChart()&&t.instance.attrs.type!==e){const i=t.pane(),s=o.M[e].fromObject({...t.instance.attrs,type:e},i);t.replace(s)}}))}},5965:(t,e,i)=>{"use strict";i.d(e,{Fx:()=>c,Qc:()=>u,Qm:()=>g,_r:()=>m,c5:()=>f});i(9841),i(8322),i(5422);function s(t){const e=h(t);let i=0,s=0,n=0,a=255;return 3===e.length||4===e.length?(i="0x"+e[0]+e[0],s="0x"+e[1]+e[1],n="0x"+e[2]+e[2],a=4===e.length?"0x"+e[3]+e[3]:a):6!==e.length&&8!==e.length||(i="0x"+e[0]+e[1],s="0x"+e[2]+e[3],n="0x"+e[4]+e[5],a=8===e.length?"0x"+e[6]+e[7]:a),{r:Number(i),g:Number(s),b:Number(n),a:Math.min(Math.round(Number(a)/255*100)/100,1)}}function n(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const i=t.r.toString(16),s=t.g.toString(16),n=t.b.toString(16),a="#"+i.padStart(2,"0")+s.padStart(2,"0")+n.padStart(2,"0");return e&&1!==t.a?"".concat(a).concat(function(t){return Math.max(Math.min(Math.round(255*t),255),0).toString(16).padStart(2,"0")}(t.a)):a}function a(t){const e=t.r/255,i=t.g/255,s=t.b/255,n=Math.max(e,i,s),a=n-Math.min(e,i,s),r=a&&(n===e?(i-s)/a:n===i?2+(s-e)/a:4+(e-i)/a);return{h:60*(r<0?r+6:r),s:n?a/n:0,v:n,a:t.a}}function r(t){const e=function(e){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(e+t.h/60)%6;return t.v-t.v*t.s*Math.max(Math.min(i,4-i,1),0)};return{r:Math.round(255*e(5)),g:Math.round(255*e(3)),b:Math.round(255*e(1)),a:Math.round(100*t.a)/100}}function o(t){return"rgba(".concat(t.r,", ").concat(t.g,", ").concat(t.b,", ").concat(t.a,")")}function l(t){const e=/^rgba?\(([0-9]{1,3})[ ,]+([0-9]{1,3})[ ,]+([0-9]{1,3})[ ,]*([01].?[0-9]*)?\)$/.exec(t),[i,s,n,a="1"]=(null==e?void 0:e.slice(1))||[0,0,0,1].map(String);return{r:Number.parseInt(i),g:Number.parseInt(s),b:Number.parseInt(n),a:Number.parseFloat(a)}}function h(t){return t.replace(/#/g,"")}function c(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const i=d(t)?n(l(t),e):t;return e?i:i.slice(0,7)}function d(t){const e=["rgb"];return(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&e.push("rgba"),e.some((e=>t.startsWith(e)))}function u(t){return d(t)?a(l(t)):a(s(t))}function m(t,e,i){return"rgba"===e?o(r(t)):function(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return n(r(t),e)}(t,i)}function g(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return n({...s(t),a:e},!0)}function f(t){return d(t)?o(l(t)):o(s(t))}},353:(t,e,i)=>{"use strict";i.d(e,{s:()=>s});const s=t=>{let{elementId:e,cursor:i,conditionalCursor:s}=t;const n=document.getElementById(e);!n||s&&n.style.cursor===s||(n.style.cursor=i)}},1185:(t,e,i)=>{"use strict";i.d(e,{E9:()=>s,dR:()=>a,j2:()=>n});const s=t=>{let{quote:e,scale:i,fxOverride:s,fromIndexOffset:a=0,toIndexOffset:r=0,leftOffset:o,drawBarCallback:l,width:h}=t;const c=null!=s?s:t=>i.x(e.barIndex[t]);let d=-1;for(let t=Math.max(0,n({quote:e,scale:i,leftOffset:o})-1,a-1);t<e.close.length+r;t++){const e=c(t);if(e+o>h){d=t;break}l(t,e)}if(d>-1){l(d,c(d))}},n=t=>{let{leftOffset:e,quote:i,scale:s}=t;const n=Math.ceil(s.x.invert(-e));return i.barToDataIndex[Math.max(n,0)]},a=t=>{var e;let{leftOffset:i,quote:s,scale:n,chartWidth:a}=t;const{barToDataIndex:r}=s,o=Math.ceil(n.x.invert(-i+a));return null!==(e=r[Math.max(o,0)])&&void 0!==e?e:r[r.length-1]}},6372:(t,e,i)=>{"use strict";i.d(e,{Hl:()=>c,LH:()=>a,ZP:()=>d,ZS:()=>o,dR:()=>h,lY:()=>l,zc:()=>r});i(7012),i(6539);var s=i(9587);function n(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}const a=t=>Object.keys(t).reduce(((e,i)=>(e.append(i,t[i]),e)),new FormData);let r;!function(t){t.ApplicationJson="application/json",t.ApplicationJsonUTF="application/json; charset=utf-8",t.FormUrlEncoded="application/x-www-form-urlencoded",t.Html="text/html; charset=utf-8"}(r||(r={}));class o extends Error{constructor(t,e,i){super(t),n(this,"response",void 0),n(this,"statusCode",void 0),this.response=e,this.statusCode=i}}class l extends o{}class h extends o{}class c extends o{}const d=async t=>{let{location:e,queryParameters:i,method:n,body:a,contentType:d,abortController:u,throwOnStatusCodes:m,fetchFunc:g=fetch,keepalive:f=!1}=t;const p="".concat(e).concat(i?"?".concat(s.stringify(i)):""),y={method:n||"GET",credentials:"include",headers:d&&{"Content-Type":d},signal:null==u?void 0:u.signal,body:a,keepalive:f};try{var v;const t=await g(p,y),e=null!==(v=t.headers.get("Content-Type"))&&void 0!==v?v:r.Html,i=function(t,e){switch(e){case r.ApplicationJson:case r.ApplicationJsonUTF:case r.FormUrlEncoded:return JSON.parse(t);default:return t}}(await t.text(),e);if(null!=m&&m.includes(t.status)){throw new(function(t){switch(t){case 403:return l;case 404:return h;case 500:return c;default:return o}}(t.status))("".concat(p," returned ").concat(t.status),i,t.status)}return i}catch(t){throw t}}},4750:(t,e,i)=>{"use strict";i.d(e,{N:()=>a});i(8322);var s=i(560),n=i.n(s);function a(){const[t,e]=n().useState(0);return{forceUpdate:n().useCallback((()=>{e((t=>t+1))}),[]),forceUpdateKey:t}}},5200:(t,e,i)=>{"use strict";i.d(e,{AH:()=>o,E8:()=>s,EJ:()=>n,Eg:()=>m,G8:()=>a,Tb:()=>r,aB:()=>d,aP:()=>l,c:()=>u,mh:()=>h,pB:()=>g,tO:()=>c});i(9841),i(8322),i(5422),i(4176),i(1237),i(5194),i(701),i(9845),i(7568),i(3748);function s(t){let{number:e,numOfDecimalPlaces:i}=t;const s=Math.pow(10,i);return String(Math.round(e*s)/s)}function n(){return"undefined"!=typeof process&&(process,!1)}function a(t){return t.split(",").map((t=>Number.parseInt(t,10)))}function r(t,e){window.Sentry.captureException(t,e)}function o(t){const e=Number.parseFloat("".concat(t));return!Number.isNaN(e)&&isFinite(e)&&e>0}function l(t){const e="".concat(t);return o(t)&&Number.parseInt(e,10)===Number.parseFloat(e)}function h(t){let{value:e,min:i=Number.MIN_SAFE_INTEGER,max:s=Number.MAX_SAFE_INTEGER}=t;const n=Number.parseFloat("".concat(e));return!Number.isNaN(n)&&n>=i&&n<=s}function c(t){let{value:e,min:i,max:s}=t;return Math.min(Math.max(e,i),s)}function d(t){return!t.hasOwnProperty("button")||void 0===t.button||0===t.button}function u(){const t=new WeakSet;return(e,i)=>{if("object"==typeof i&&null!==i){if(t.has(i))return;t.add(i)}return i}}const m=(t,e)=>t.toLocaleDateString("en-US",{day:"2-digit",month:"2-digit",year:"numeric",...e});function g(){var t,e,i;return null!==(t=null===(e=window.crypto)||void 0===e||null===(i=e.randomUUID)||void 0===i?void 0:i.call(e))&&void 0!==t?t:"".concat(1e7,"-",1e3,"-",4e3,"-",8e3,"-",1e11).replace(/[018]/g,(t=>{const e=Number(t);return(e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16)}))}},3926:(t,e,i)=>{"use strict";i.d(e,{Fp:()=>n,cS:()=>a,hY:()=>s,nW:()=>r});i(8322),i(9841);const s=(t,e)=>({ts:e,count:0,uuid:t}),n=(t,e)=>t.ts===e.ts?t.count===e.count?t.uuid===e.uuid?0:t.uuid<e.uuid?-1:1:t.count-e.count:t.ts-e.ts,a=(t,e)=>e>t.ts?{ts:e,count:0,uuid:t.uuid}:{...t,count:t.count+1},r=(t,e)=>n(t,e)>=0?t:{...t,ts:e.ts,count:e.count}},5055:(t,e,i)=>{"use strict";i.d(e,{N:()=>s,t:()=>n});i(8322);const s=function(){return window.FLibs.decodeQueryString(...arguments)},n=function(){return window.FLibs.encodeQueryString(...arguments)}},7824:(t,e,i)=>{"use strict";i.d(e,{t:()=>n});var s=i(560);function n(){const t=s.useRef(!1),e=s.useCallback((()=>t.current),[]);return s.useEffect((()=>(t.current=!0,()=>{t.current=!1})),[]),e}},2127:(t,e,i)=>{"use strict";let s,n,a,r,o,l;i.d(e,{H3:()=>l,Ly:()=>a,Q2:()=>n,Yx:()=>s,dG:()=>r,wq:()=>o}),function(t){t.Stock="stock",t.Crypto="crypto",t.MarketSentiment="market_sentiment",t.Futures="futures",t.Forex="forex",t.Group="group"}(s||(s={})),function(t){t.light="light",t.dark="dark"}(n||(n={})),function(t){t.Above="above",t.Below="below"}(a||(a={})),function(t){t.Change="change",t.Destroy="destroy",t.Refresh="refresh",t.Update="update"}(r||(r={})),function(t){t.IndicatorsChange="indicatorsChange"}(o||(o={})),function(t){t.Remove="remove"}(l||(l={}))},5812:()=>{},2497:t=>{"use strict";t.exports=FLibs.DateFns},560:t=>{"use strict";t.exports=FLibs.React},1220:t=>{"use strict";t.exports=FLibs.ReactDOM},5251:t=>{"use strict";t.exports=FLibs.ReactRouterDOM},6838:t=>{"use strict";t.exports=FLibs.classnames},264:t=>{"use strict";t.exports=FLibs.d3}},t=>{var e=e=>t(t.s=e);t.O(0,[976],(()=>(e(2340),e(561),e(41),e(5812))));t.O()}]);
//# sourceMappingURL=main.393da18b.js.map